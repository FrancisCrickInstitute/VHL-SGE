SGE analysis pipeline - 230412_VHL_all_no_plots
Version 23.04.12.VHL.
RStudio Version 1.4.1106
Written by Greg Findlay
The Francis Crick Institute

Analysis for VHL experiments, written for .txt data files with 8 samples per experiment in order pre, post, lib, neg, rna (day 6), post2 (day 13), post3 (placeholder data), rna2 (day20). No experiments included a post3 sample, so post3 metrics were populated to equal post2.

Must have mounted SGE project folder via smb. Data files for each exon are named using correct experimental directory and their specific _annotated.txt file name.

Analysis is the same for each sge region, each represented by a chunk of code below. Purpose of analysis is to calculate scores for each experiment (function scores and RNA scores, where applicable) and to derive averages and normalisations across experimental replicates.

Switching replicate names on import to reflect experimental conditions: 
  rLD indicates HAP1 Ligase 4 KO (L), 1N cells enriched with DAB (D)
  rL4 indicates HAP1 Ligase 4 KO (L4), experiments performed without DAB.
  rLH indicates HAP1 Ligase 4 KO (L) + HIF1A KO (H), 1N cells enriched with DAB.

Note:  Performance running in is faster if commands for each section are pasted into console and entered instead of running as chunks.

The first chunk loads packages and defines variables and paths, and is what needs to be updated based on where .sh pipeline output files are located.

Output from running this script in its entirety is saved in VHL project folder under:  230412_VHL_all_no_plots_run.RData


```{r}
#Load packages needed
library(plyr)
library(dplyr)
library(gam)
library(plotROC)
require(tidyverse)
require(ggplot2)
require(gridExtra)
require(mclust)
require(VennDiagram)
library(mixtools)

VHL_editing_info <- read.table("/Volumes/lab-findlayg/home/shared/projects/SGE/VHL/VHL_editing_data.txt",header=TRUE, sep="\t")

#final SGE sequencing .sh pipeline output, as mounted to local drive:  /Volumes/lab-findlayg/home/shared/projects/SGE/VHL/20230408_VHL_all/pipeline_output/variants

#NO DAB x1b, x2, x1p (and x1a, x1c done with v1 libraries of lower quality) 
experiment_dir_210729 = "/Volumes/lab-findlayg/home/shared/projects/SGE/VHL/20230408_VHL_all/pipeline_output/variants/20210729/"
#NO DAB x3a, x3b no DAB
experiment_dir_210915 = "/Volumes/lab-findlayg/home/shared/projects/SGE/VHL/20230408_VHL_all/pipeline_output/variants/20210915/"

#DAB x2, x3a, x3b
experiment_dir_220511 = "/Volumes/lab-findlayg/home/shared/projects/SGE/VHL/20230408_VHL_all/pipeline_output/variants/20220511/"
#DAB:  x1a2, x1b, x1c2, x2-HIF1KO, x3a-HIF1KO 
experiment_dir_220822 = "/Volumes/lab-findlayg/home/shared/projects/SGE/VHL/20230408_VHL_all/pipeline_output/variants/20220822/"
#DAB: x1p 
experiment_dir_221102 = "/Volumes/lab-findlayg/home/shared/projects/SGE/VHL/20230408_VHL_all/pipeline_output/variants/20221102/"

#cut positions -- hg19
VHLx1a_cut_pos = 10183863
VHLx1b_cut_pos = 10183661
VHLx1c_cut_pos = 10183571
VHLx1p_cut_pos = 10184471
VHLx2_cut_pos = 10188239
VHLx3a_cut_pos = 10191502
VHLx3b_cut_pos = 10191631

#Defining colour schemes for plotting
named_conseq_colors_clinvar_path.lp_benign = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#99006B","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "3PRIME_UTR"="#3E6BAA", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#083092","Conflicting interpretations of pathogenicity" = "#EBEAEA","Likely benign" = "#EBEAEA","Likely pathogenic" = "#A40000","Pathogenic" = "#A40000","Uncertain significance" = "#EBEAEA" )
named_conseq_colors = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#0B3DB9", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#3885DB", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#99006B","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "3PRIME_UTR"="#3E6BAA", "REF" = "#000000")
named_conseq_colors_full = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#0B3DB9", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#CF7700", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#99006B","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "3PRIME_UTR"="#3E6BAA", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#013DD3","Conflicting interpretations of pathogenicity" = "#FFCB00","Likely benign" = "#2360F9","Likely pathogenic" = "#FA2039","Pathogenic" = "#A40000","Uncertain significance" = "#00A54D" )
named_conseq_colors_full_simple = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#99006B","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "3PRIME_UTR"="#3E6BAA", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#013DD3","Conflicting interpretations of pathogenicity" = "#FFCB00","Likely benign" = "#2360F9","Likely pathogenic" = "#FA2039","Pathogenic" = "#A40000","Uncertain significance" = "#00A54D","Gray" = "#000000" )
named_missense_colors_by_polyphen = c("possibly_damaging" = "#00925B","probably_damaging" = "#007549", "benign" = "#00BA74")
named_conseq_colors_hide_missense = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#0B3DB9", "NON_SYNONYMOUS" = "#FFFFFF", "SPLICE_SITE" = "#CF7700", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#99006B","REGULATORY"="#47A300", "REF" = "#000000")
named_conseq_colors_highlight_mis = c("STOP_GAINED" = "#B0B2B3","CANONICAL_SPLICE" = "#B0B2B3","INTRONIC" = "#B0B2B3", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#B0B2B3", "SYNONYMOUS" = "#B0B2B3","STOP_LOST" = "#B0B2B3","REGULATORY"="#B0B2B3","5PRIME_UTR"="#B0B2B3", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#00BA74","Conflicting interpretations of pathogenicity" = "#2C2C2C","Likely benign" = "#35CD93","Likely pathogenic" = "#FA2039","Pathogenic" = "#A40000","Uncertain significance" = "#C6C6C6" )
named_conseq_colors_highlight_syn_int = c("STOP_GAINED" = "#B0B2B3","CANONICAL_SPLICE" = "#B0B2B3","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#B0B2B3", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#B0B2B3","REGULATORY"="#B0B2B3","5PRIME_UTR"="#B0B2B3", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#00BA74","Conflicting interpretations of pathogenicity" = "#2C2C2C","Likely benign" = "#35CD93","Likely pathogenic" = "#FA2039","Pathogenic" = "#A40000","Uncertain significance" = "#C6C6C6" )
named_conseq_colors_clinvar_gray = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#99006B","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "3PRIME_UTR"="#3E6BAA", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#EBEAEA","Conflicting interpretations of pathogenicity" = "#EBEAEA","Likely benign" = "#EBEAEA","Likely pathogenic" = "#EBEAEA","Pathogenic" = "#EBEAEA","Uncertain significance" = "#EBEAEA" )
named_conseq_colors_clinvar_path.lp = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#99006B","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "3PRIME_UTR"="#3E6BAA", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#EBEAEA","Conflicting interpretations of pathogenicity" = "#EBEAEA","Likely benign" = "#EBEAEA","Likely pathogenic" = "#A40000","Pathogenic" = "#A40000","Uncertain significance" = "#EBEAEA" )
named_conseq_colors_clinvar_path.lp_benign.lb_confl.vus = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#99006B","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "3PRIME_UTR"="#3E6BAA", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#083092","Conflicting interpretations of pathogenicity" = "#FFB400","Likely benign" = "#083092","Likely pathogenic" = "#A40000","Pathogenic" = "#A40000","Uncertain significance" = "#FFB400" )
named_conseq_colors_clinvar_path.lp_benign.lb = c("STOP_GAINED" = "#F3001C","CANONICAL_SPLICE" = "#FD9100","INTRONIC" = "#456CCC", "NON_SYNONYMOUS" = "#00BA74", "SPLICE_SITE" = "#456CCC", "SYNONYMOUS" = "#456CCC","STOP_LOST" = "#99006B","REGULATORY"="#B5A695","5PRIME_UTR"="#B5A695", "3PRIME_UTR"="#3E6BAA", "REF" = "#000000", "absent" = "#EBEAEA","Benign" = "#083092","Conflicting interpretations of pathogenicity" = "#EBEAEA","Likely benign" = "#083092","Likely pathogenic" = "#A40000","Pathogenic" = "#A40000","Uncertain significance" = "#EBEAEA" )
  
###CODE ABOVE HERE APPLIES TO ALL SGE REGIONS
```

rLD section, experiments performed with DAB
```{r}
#VHLx2rLD
VHLx2rLD1_file <- paste(experiment_dir_220511,'VHLx2rL43','_annotated.txt',sep='')
VHLx2rLD2_file <- paste(experiment_dir_220511,'VHLx2rL44','_annotated.txt',sep='')
VHLx2rLD1 <- read.table(VHLx2rLD1_file, header=TRUE, sep="\t")
VHLx2rLD2 <- read.table(VHLx2rLD2_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx2rLD1 <- VHLx2rLD1 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

VHLx2rLD2 <- VHLx2rLD2 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx2 <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx2'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx2_HDR_5_SNV = as.character(VHL_editing_info_VHLx2$HDR_5_SNV)
VHLx2_HDR_3_SNV = as.character(VHL_editing_info_VHLx2$HDR_3_SNV)
#VHLx2_cut_pos = as.character(VHL_editing_info_VHLx2$cut_pos)
VHLx2_cut_end = as.character(VHL_editing_info_VHLx2$cut_end)
VHLx2_mut_start = as.character(VHL_editing_info_VHLx2$mut_start)
VHLx2_mut_end = as.character(VHL_editing_info_VHLx2$mut_end)

### Replicate 1
VHLx2rLD1_cSNV_all <- which(VHLx2rLD1[,'c_hdr_snv']=='True')
VHLx2rLD1_cSNV_all_df = VHLx2rLD1[VHLx2rLD1_cSNV_all,]
VHLx2rLD1_prog_var_all <- which(VHLx2rLD1[,'all_hdr_variant']=='True' & VHLx2rLD1[,'edit_string']!='-WT')
VHLx2rLD1_prog_var_all_df = VHLx2rLD1[VHLx2rLD1_prog_var_all,]
VHLx2rLD1_prog_map_all = which(VHLx2rLD1_prog_var_all_df[,'pos']!='REF')
VHLx2rLD1_prog_map_all_df = VHLx2rLD1_prog_var_all_df[VHLx2rLD1_prog_map_all,]
VHLx2rLD1_prog_map_exon_all = which(VHLx2rLD1_prog_map_all_df[,'cDNApos']!='REF' & VHLx2rLD1_prog_map_all_df[,'cDNApos']!='NA')
VHLx2rLD1_prog_map_exon_all_df = VHLx2rLD1_prog_map_all_df[VHLx2rLD1_prog_map_exon_all,]
VHLx2rLD1_prog_map_CADD = which(VHLx2rLD1_prog_map_all_df[,'CADD.phred']!='NA')
VHLx2rLD1_prog_map_CADD_df = VHLx2rLD1_prog_map_all_df[VHLx2rLD1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx2rLD1_prog_var_thresh5 <- which(as.numeric(as.character(VHLx2rLD1_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx2rLD1_prog_var_thresh5_df = VHLx2rLD1_prog_var_all_df[VHLx2rLD1_prog_var_thresh5,]
VHLx2rLD1_prog_map_thresh5 <- which(as.numeric(as.character(VHLx2rLD1_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx2rLD1_prog_map_thresh5_df = VHLx2rLD1_prog_map_all_df[VHLx2rLD1_prog_map_thresh5,]
VHLx2rLD1_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx2rLD1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx2rLD1_prog_map_exon_thresh5_df = VHLx2rLD1_prog_map_exon_all_df[VHLx2rLD1_prog_map_exon_thresh5,]
VHLx2rLD1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx2rLD1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx2rLD1_prog_map_CADD_thresh5_df = VHLx2rLD1_prog_map_CADD_df[VHLx2rLD1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx2rLD1_prog_var_all_lib_count = length(VHLx2rLD1_prog_var_all_df$lib)
VHLx2rLD1_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx2rLD1_prog_var_all_min_lib_counts = min(VHLx2rLD1_prog_var_all_df$lib)
VHLx2rLD1_prog_var_all_min_lib_counts
VHLx2rLD1_prog_var_all_max_lib_counts = max(VHLx2rLD1_prog_var_all_df$lib)
VHLx2rLD1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx2rLD1_prog_map_all_lib_count = length(VHLx2rLD1_prog_map_all_df$lib)
VHLx2rLD1_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx2rLD1_prog_map_all_min_lib_counts = min(VHLx2rLD1_prog_map_all_df$lib)
VHLx2rLD1_prog_map_all_min_lib_counts
VHLx2rLD1_prog_map_all_max_lib_counts = max(VHLx2rLD1_prog_map_all_df$lib)
VHLx2rLD1_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx2rLD1_prog_var_all_pre_count = length(VHLx2rLD1_prog_var_all_df$pre)
VHLx2rLD1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx2rLD1_prog_var_all_min_pre_counts = min(VHLx2rLD1_prog_var_all_df$pre)
VHLx2rLD1_prog_var_all_min_pre_counts
VHLx2rLD1_prog_var_all_max_pre_counts = max(VHLx2rLD1_prog_var_all_df$pre)
VHLx2rLD1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx2rLD1_prog_map_all_pre_count = length(VHLx2rLD1_prog_map_all_df$pre)
VHLx2rLD1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx2rLD1_prog_map_all_min_pre_counts = min(VHLx2rLD1_prog_map_all_df$pre)
VHLx2rLD1_prog_map_all_min_pre_counts
VHLx2rLD1_prog_map_all_max_pre_counts = max(VHLx2rLD1_prog_map_all_df$pre)
VHLx2rLD1_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx2rLD1_prog_map_all_post_count = length(VHLx2rLD1_prog_map_all_df$post)
VHLx2rLD1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx2rLD1_prog_map_all_min_post_counts = min(VHLx2rLD1_prog_map_all_df$post)
VHLx2rLD1_prog_map_all_min_post_counts
VHLx2rLD1_prog_map_all_max_post_counts = max(VHLx2rLD1_prog_map_all_df$post)
VHLx2rLD1_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx2rLD1_prog_map_all_syn_df <- VHLx2rLD1_prog_map_all_df[which(VHLx2rLD1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx2rLD1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx2rLD1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx2rLD1_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx2rLD1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx2rLD1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx2rLD1_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx2rLD1_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx2rLD1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx2rLD1_prog_map_all_min_rna_counts = min(VHLx2rLD1_prog_map_exon_all_df$tHDR_rna)
VHLx2rLD1_prog_map_all_min_rna_counts
VHLx2rLD1_prog_map_all_max_rna_counts = max(VHLx2rLD1_prog_map_exon_all_df$tHDR_rna)
VHLx2rLD1_prog_map_all_max_rna_counts
VHLx2rLD1_prog_map_all_min_rna_pseudo_freq = min(VHLx2rLD1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx2rLD1_prog_map_all_min_rna_pseudo_freq
VHLx2rLD1_prog_map_all_max_rna_pseudo_freq = max(VHLx2rLD1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx2rLD1_prog_map_all_max_rna_pseudo_freq
VHLx2rLD1_prog_map_all_min_rna_pre_ratio = min(VHLx2rLD1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx2rLD1_prog_map_all_min_rna_pre_ratio
VHLx2rLD1_prog_map_all_max_rna_pre_ratio = max(VHLx2rLD1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx2rLD1_prog_map_all_max_rna_pre_ratio
VHLx2rLD1_prog_map_all_min_rna_post_ratio = min(VHLx2rLD1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx2rLD1_prog_map_all_min_rna_post_ratio
VHLx2rLD1_prog_map_all_max_rna_post_ratio = max(VHLx2rLD1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx2rLD1_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx2rLD1_cSNV_all_corr_pre_count = length(VHLx2rLD1_cSNV_all_df$corr_pre)
VHLx2rLD1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx2rLD1_cSNV_all_min_corr_pre_counts = min(VHLx2rLD1_cSNV_all_df$corr_pre)
VHLx2rLD1_cSNV_all_min_corr_pre_counts
VHLx2rLD1_cSNV_all_max_corr_pre_counts = max(VHLx2rLD1_cSNV_all_df$corr_pre)
VHLx2rLD1_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLD1_cSNV_all_corr_post_count = length(VHLx2rLD1_cSNV_all_df$corr_post)
VHLx2rLD1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx2rLD1_cSNV_all_min_corr_post_counts = min(VHLx2rLD1_cSNV_all_df$corr_post)
VHLx2rLD1_cSNV_all_min_corr_post_counts
VHLx2rLD1_cSNV_all_max_corr_post_counts = max(VHLx2rLD1_cSNV_all_df$corr_post)
VHLx2rLD1_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx2_p_hdr_snv = paste('p_hdr_',VHLx2_cut_end,'_snv',sep='')
VHLx2rLD1_pSNV_all <- which(VHLx2rLD1[,VHLx2_p_hdr_snv]=='True')
VHLx2rLD1_pSNV_all_df = VHLx2rLD1[VHLx2rLD1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLD1_pSNV_all_lib_count = length(VHLx2rLD1_pSNV_all_df$lib)
VHLx2rLD1_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx2rLD1_pSNV_all_min_lib_counts = min(VHLx2rLD1_pSNV_all_df$lib)
VHLx2rLD1_pSNV_all_min_lib_counts
VHLx2rLD1_pSNV_all_max_lib_counts = max(VHLx2rLD1_pSNV_all_df$lib)
VHLx2rLD1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx2rLD1_pSNV_all_pre_count = length(VHLx2rLD1_pSNV_all_df$pre)
VHLx2rLD1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx2rLD1_pSNV_all_min_pre_counts = min(VHLx2rLD1_pSNV_all_df$pre)
VHLx2rLD1_pSNV_all_min_pre_counts
VHLx2rLD1_pSNV_all_max_pre_counts = max(VHLx2rLD1_pSNV_all_df$pre)
VHLx2rLD1_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLD1_pSNV_all_post_count = length(VHLx2rLD1_pSNV_all_df$post)
VHLx2rLD1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx2rLD1_pSNV_all_min_post_counts = min(VHLx2rLD1_pSNV_all_df$post)
VHLx2rLD1_pSNV_all_min_post_counts
VHLx2rLD1_pSNV_all_max_post_counts = max(VHLx2rLD1_pSNV_all_df$post)
VHLx2rLD1_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLD1_prog_map_thresh5_lib_count = length(VHLx2rLD1_prog_map_thresh5_df$lib)
VHLx2rLD1_prog_map_thresh5_lib_count
VHLx2rLD1_prog_map_thresh5_min_lib_counts = min(VHLx2rLD1_prog_map_thresh5_df$lib)
VHLx2rLD1_prog_map_thresh5_min_lib_counts
VHLx2rLD1_prog_map_thresh5_max_lib_counts = max(VHLx2rLD1_prog_map_thresh5_df$lib)
VHLx2rLD1_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLD1_prog_map_thresh5_pre_count = length(VHLx2rLD1_prog_map_thresh5_df$pre)
VHLx2rLD1_prog_map_thresh5_pre_count
VHLx2rLD1_prog_map_thresh5_min_pre_counts = min(VHLx2rLD1_prog_map_thresh5_df$pre)
VHLx2rLD1_prog_map_thresh5_min_pre_counts
VHLx2rLD1_prog_map_thresh5_max_pre_counts = max(VHLx2rLD1_prog_map_thresh5_df$pre)
VHLx2rLD1_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx2rLD1_prog_map_thresh5_post_count = length(VHLx2rLD1_prog_map_thresh5_df$post)
VHLx2rLD1_prog_map_thresh5_post_count
VHLx2rLD1_prog_map_thresh5_min_post_counts = min(VHLx2rLD1_prog_map_thresh5_df$post)
VHLx2rLD1_prog_map_thresh5_min_post_counts
VHLx2rLD1_prog_map_thresh5_max_post_counts = max(VHLx2rLD1_prog_map_thresh5_df$post)
VHLx2rLD1_prog_map_thresh5_max_post_counts
VHLx2rLD1_prog_map_thresh5_corr_post_count = length(VHLx2rLD1_cSNV_all_df$corr_post)
VHLx2rLD1_prog_map_thresh5_corr_post_count
VHLx2rLD1_prog_map_thresh5_min_corr_post_counts = min(VHLx2rLD1_cSNV_all_df$corr_post)
VHLx2rLD1_prog_map_thresh5_min_corr_post_counts
VHLx2rLD1_prog_map_thresh5_max_corr_post_counts = max(VHLx2rLD1_cSNV_all_df$corr_post)
VHLx2rLD1_prog_map_thresh5_max_corr_post_counts

VHLx2rLD1_pSNV_thresh5 <- which(VHLx2rLD1[,VHLx2_p_hdr_snv]=='True' & as.numeric(as.character(VHLx2rLD1[,'pre_freq']))>=0.00001)
VHLx2rLD1_pSNV_thresh5_df = VHLx2rLD1[VHLx2rLD1_pSNV_thresh5,]
VHLx2rLD1_pSNV_thresh5_lib_count = length(VHLx2rLD1_pSNV_thresh5_df$lib)
VHLx2rLD1_pSNV_thresh5_lib_count
VHLx2rLD1_pSNV_thresh5_min_lib_counts = min(VHLx2rLD1_pSNV_thresh5_df$lib)
VHLx2rLD1_pSNV_thresh5_min_lib_counts
VHLx2rLD1_pSNV_thresh5_max_lib_counts = max(VHLx2rLD1_pSNV_thresh5_df$lib)
VHLx2rLD1_pSNV_thresh5_max_lib_counts
VHLx2rLD1_pSNV_thresh5_pre_count = length(VHLx2rLD1_pSNV_thresh5_df$pre)
VHLx2rLD1_pSNV_thresh5_pre_count
VHLx2rLD1_pSNV_thresh5_min_pre_counts = min(VHLx2rLD1_pSNV_thresh5_df$pre)
VHLx2rLD1_pSNV_thresh5_min_pre_counts
VHLx2rLD1_pSNV_thresh5_max_pre_counts = max(VHLx2rLD1_pSNV_thresh5_df$pre)
VHLx2rLD1_pSNV_thresh5_max_pre_counts
VHLx2rLD1_pSNV_thresh5_post_count = length(VHLx2rLD1_pSNV_thresh5_df$post)
VHLx2rLD1_pSNV_thresh5_post_count
VHLx2rLD1_pSNV_thresh5_min_post_counts = min(VHLx2rLD1_pSNV_thresh5_df$post)
VHLx2rLD1_pSNV_thresh5_min_post_counts
VHLx2rLD1_pSNV_thresh5_max_post_counts = max(VHLx2rLD1_pSNV_thresh5_df$post)
VHLx2rLD1_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx2rLD2_cSNV_all <- which(VHLx2rLD2[,'c_hdr_snv']=='True')
VHLx2rLD2_cSNV_all_df = VHLx2rLD2[VHLx2rLD2_cSNV_all,]
VHLx2rLD2_prog_var_all <- which(VHLx2rLD2[,'all_hdr_variant']=='True' & VHLx2rLD2[,'edit_string']!='-WT')
VHLx2rLD2_prog_var_all_df = VHLx2rLD2[VHLx2rLD2_prog_var_all,]
VHLx2rLD2_prog_map_all = which(VHLx2rLD2_prog_var_all_df[,'pos']!='REF')
VHLx2rLD2_prog_map_all_df = VHLx2rLD2_prog_var_all_df[VHLx2rLD2_prog_map_all,]
VHLx2rLD2_prog_map_exon_all = which(VHLx2rLD2_prog_map_all_df[,'cDNApos']!='REF' & VHLx2rLD2_prog_map_all_df[,'cDNApos']!='NA')
VHLx2rLD2_prog_map_exon_all_df = VHLx2rLD2_prog_map_all_df[VHLx2rLD2_prog_map_exon_all,]
VHLx2rLD2_prog_map_CADD = which(VHLx2rLD2_prog_map_all_df[,'CADD.phred']!='NA')
VHLx2rLD2_prog_map_CADD_df = VHLx2rLD2_prog_map_all_df[VHLx2rLD2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx2rLD2_prog_var_thresh5 <- which(as.numeric(as.character(VHLx2rLD2_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx2rLD2_prog_var_thresh5_df = VHLx2rLD2_prog_var_all_df[VHLx2rLD2_prog_var_thresh5,]
VHLx2rLD2_prog_map_thresh5 <- which(as.numeric(as.character(VHLx2rLD2_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx2rLD2_prog_map_thresh5_df = VHLx2rLD2_prog_map_all_df[VHLx2rLD2_prog_map_thresh5,]
VHLx2rLD2_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx2rLD2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx2rLD2_prog_map_exon_thresh5_df = VHLx2rLD2_prog_map_exon_all_df[VHLx2rLD2_prog_map_exon_thresh5,]
VHLx2rLD2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx2rLD2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx2rLD2_prog_map_CADD_thresh5_df = VHLx2rLD2_prog_map_CADD_df[VHLx2rLD2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx2rLD2_prog_var_all_lib_count = length(VHLx2rLD2_prog_var_all_df$lib)
VHLx2rLD2_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx2rLD2_prog_var_all_min_lib_counts = min(VHLx2rLD2_prog_var_all_df$lib)
VHLx2rLD2_prog_var_all_min_lib_counts
VHLx2rLD2_prog_var_all_max_lib_counts = max(VHLx2rLD2_prog_var_all_df$lib)
VHLx2rLD2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx2rLD2_prog_map_all_lib_count = length(VHLx2rLD2_prog_map_all_df$lib)
VHLx2rLD2_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx2rLD2_prog_map_all_min_lib_counts = min(VHLx2rLD2_prog_map_all_df$lib)
VHLx2rLD2_prog_map_all_min_lib_counts
VHLx2rLD2_prog_map_all_max_lib_counts = max(VHLx2rLD2_prog_map_all_df$lib)
VHLx2rLD2_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx2rLD2_prog_var_all_pre_count = length(VHLx2rLD2_prog_var_all_df$pre)
VHLx2rLD2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx2rLD2_prog_var_all_min_pre_counts = min(VHLx2rLD2_prog_var_all_df$pre)
VHLx2rLD2_prog_var_all_min_pre_counts
VHLx2rLD2_prog_var_all_max_pre_counts = max(VHLx2rLD2_prog_var_all_df$pre)
VHLx2rLD2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx2rLD2_prog_map_all_pre_count = length(VHLx2rLD2_prog_map_all_df$pre)
VHLx2rLD2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx2rLD2_prog_map_all_min_pre_counts = min(VHLx2rLD2_prog_map_all_df$pre)
VHLx2rLD2_prog_map_all_min_pre_counts
VHLx2rLD2_prog_map_all_max_pre_counts = max(VHLx2rLD2_prog_map_all_df$pre)
VHLx2rLD2_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx2rLD2_prog_map_all_post_count = length(VHLx2rLD2_prog_map_all_df$post)
VHLx2rLD2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx2rLD2_prog_map_all_min_post_counts = min(VHLx2rLD2_prog_map_all_df$post)
VHLx2rLD2_prog_map_all_min_post_counts
VHLx2rLD2_prog_map_all_max_post_counts = max(VHLx2rLD2_prog_map_all_df$post)
VHLx2rLD2_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx2rLD2_prog_map_all_syn_df <- VHLx2rLD2_prog_map_all_df[which(VHLx2rLD2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx2rLD2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx2rLD2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx2rLD2_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx2rLD2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx2rLD2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx2rLD2_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx2rLD2_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx2rLD2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx2rLD2_prog_map_all_min_rna_counts = min(VHLx2rLD2_prog_map_exon_all_df$tHDR_rna)
VHLx2rLD2_prog_map_all_min_rna_counts
VHLx2rLD2_prog_map_all_max_rna_counts = max(VHLx2rLD2_prog_map_exon_all_df$tHDR_rna)
VHLx2rLD2_prog_map_all_max_rna_counts
VHLx2rLD2_prog_map_all_min_rna_pseudo_freq = min(VHLx2rLD2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx2rLD2_prog_map_all_min_rna_pseudo_freq
VHLx2rLD2_prog_map_all_max_rna_pseudo_freq = max(VHLx2rLD2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx2rLD2_prog_map_all_max_rna_pseudo_freq
VHLx2rLD2_prog_map_all_min_rna_pre_ratio = min(VHLx2rLD2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx2rLD2_prog_map_all_min_rna_pre_ratio
VHLx2rLD2_prog_map_all_max_rna_pre_ratio = max(VHLx2rLD2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx2rLD2_prog_map_all_max_rna_pre_ratio
VHLx2rLD2_prog_map_all_min_rna_post_ratio = min(VHLx2rLD2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx2rLD2_prog_map_all_min_rna_post_ratio
VHLx2rLD2_prog_map_all_max_rna_post_ratio = max(VHLx2rLD2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx2rLD2_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx2rLD2_cSNV_all_corr_pre_count = length(VHLx2rLD2_cSNV_all_df$corr_pre)
VHLx2rLD2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx2rLD2_cSNV_all_min_corr_pre_counts = min(VHLx2rLD2_cSNV_all_df$corr_pre)
VHLx2rLD2_cSNV_all_min_corr_pre_counts
VHLx2rLD2_cSNV_all_max_corr_pre_counts = max(VHLx2rLD2_cSNV_all_df$corr_pre)
VHLx2rLD2_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLD2_cSNV_all_corr_post_count = length(VHLx2rLD2_cSNV_all_df$corr_post)
VHLx2rLD2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx2rLD2_cSNV_all_min_corr_post_counts = min(VHLx2rLD2_cSNV_all_df$corr_post)
VHLx2rLD2_cSNV_all_min_corr_post_counts
VHLx2rLD2_cSNV_all_max_corr_post_counts = max(VHLx2rLD2_cSNV_all_df$corr_post)
VHLx2rLD2_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx2_p_hdr_snv = paste('p_hdr_',VHLx2_cut_end,'_snv',sep='')
VHLx2rLD2_pSNV_all <- which(VHLx2rLD2[,VHLx2_p_hdr_snv]=='True')
VHLx2rLD2_pSNV_all_df = VHLx2rLD2[VHLx2rLD2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLD2_pSNV_all_lib_count = length(VHLx2rLD2_pSNV_all_df$lib)
VHLx2rLD2_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx2rLD2_pSNV_all_min_lib_counts = min(VHLx2rLD2_pSNV_all_df$lib)
VHLx2rLD2_pSNV_all_min_lib_counts
VHLx2rLD2_pSNV_all_max_lib_counts = max(VHLx2rLD2_pSNV_all_df$lib)
VHLx2rLD2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx2rLD2_pSNV_all_pre_count = length(VHLx2rLD2_pSNV_all_df$pre)
VHLx2rLD2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx2rLD2_pSNV_all_min_pre_counts = min(VHLx2rLD2_pSNV_all_df$pre)
VHLx2rLD2_pSNV_all_min_pre_counts
VHLx2rLD2_pSNV_all_max_pre_counts = max(VHLx2rLD2_pSNV_all_df$pre)
VHLx2rLD2_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLD2_pSNV_all_post_count = length(VHLx2rLD2_pSNV_all_df$post)
VHLx2rLD2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx2rLD2_pSNV_all_min_post_counts = min(VHLx2rLD2_pSNV_all_df$post)
VHLx2rLD2_pSNV_all_min_post_counts
VHLx2rLD2_pSNV_all_max_post_counts = max(VHLx2rLD2_pSNV_all_df$post)
VHLx2rLD2_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLD2_prog_map_thresh5_lib_count = length(VHLx2rLD2_prog_map_thresh5_df$lib)
VHLx2rLD2_prog_map_thresh5_lib_count
VHLx2rLD2_prog_map_thresh5_min_lib_counts = min(VHLx2rLD2_prog_map_thresh5_df$lib)
VHLx2rLD2_prog_map_thresh5_min_lib_counts
VHLx2rLD2_prog_map_thresh5_max_lib_counts = max(VHLx2rLD2_prog_map_thresh5_df$lib)
VHLx2rLD2_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLD2_prog_map_thresh5_pre_count = length(VHLx2rLD2_prog_map_thresh5_df$pre)
VHLx2rLD2_prog_map_thresh5_pre_count
VHLx2rLD2_prog_map_thresh5_min_pre_counts = min(VHLx2rLD2_prog_map_thresh5_df$pre)
VHLx2rLD2_prog_map_thresh5_min_pre_counts
VHLx2rLD2_prog_map_thresh5_max_pre_counts = max(VHLx2rLD2_prog_map_thresh5_df$pre)
VHLx2rLD2_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx2rLD2_prog_map_thresh5_post_count = length(VHLx2rLD2_prog_map_thresh5_df$post)
VHLx2rLD2_prog_map_thresh5_post_count
VHLx2rLD2_prog_map_thresh5_min_post_counts = min(VHLx2rLD2_prog_map_thresh5_df$post)
VHLx2rLD2_prog_map_thresh5_min_post_counts
VHLx2rLD2_prog_map_thresh5_max_post_counts = max(VHLx2rLD2_prog_map_thresh5_df$post)
VHLx2rLD2_prog_map_thresh5_max_post_counts
VHLx2rLD2_prog_map_thresh5_corr_post_count = length(VHLx2rLD2_cSNV_all_df$corr_post)
VHLx2rLD2_prog_map_thresh5_corr_post_count
VHLx2rLD2_prog_map_thresh5_min_corr_post_counts = min(VHLx2rLD2_cSNV_all_df$corr_post)
VHLx2rLD2_prog_map_thresh5_min_corr_post_counts
VHLx2rLD2_prog_map_thresh5_max_corr_post_counts = max(VHLx2rLD2_cSNV_all_df$corr_post)
VHLx2rLD2_prog_map_thresh5_max_corr_post_counts

VHLx2rLD2_pSNV_thresh5 <- which(VHLx2rLD2[,VHLx2_p_hdr_snv]=='True' & as.numeric(as.character(VHLx2rLD2[,'pre_freq']))>=0.00001)
VHLx2rLD2_pSNV_thresh5_df = VHLx2rLD2[VHLx2rLD2_pSNV_thresh5,]
VHLx2rLD2_pSNV_thresh5_lib_count = length(VHLx2rLD2_pSNV_thresh5_df$lib)
VHLx2rLD2_pSNV_thresh5_lib_count
VHLx2rLD2_pSNV_thresh5_min_lib_counts = min(VHLx2rLD2_pSNV_thresh5_df$lib)
VHLx2rLD2_pSNV_thresh5_min_lib_counts
VHLx2rLD2_pSNV_thresh5_max_lib_counts = max(VHLx2rLD2_pSNV_thresh5_df$lib)
VHLx2rLD2_pSNV_thresh5_max_lib_counts
VHLx2rLD2_pSNV_thresh5_pre_count = length(VHLx2rLD2_pSNV_thresh5_df$pre)
VHLx2rLD2_pSNV_thresh5_pre_count
VHLx2rLD2_pSNV_thresh5_min_pre_counts = min(VHLx2rLD2_pSNV_thresh5_df$pre)
VHLx2rLD2_pSNV_thresh5_min_pre_counts
VHLx2rLD2_pSNV_thresh5_max_pre_counts = max(VHLx2rLD2_pSNV_thresh5_df$pre)
VHLx2rLD2_pSNV_thresh5_max_pre_counts
VHLx2rLD2_pSNV_thresh5_post_count = length(VHLx2rLD2_pSNV_thresh5_df$post)
VHLx2rLD2_pSNV_thresh5_post_count
VHLx2rLD2_pSNV_thresh5_min_post_counts = min(VHLx2rLD2_pSNV_thresh5_df$post)
VHLx2rLD2_pSNV_thresh5_min_post_counts
VHLx2rLD2_pSNV_thresh5_max_post_counts = max(VHLx2rLD2_pSNV_thresh5_df$post)
VHLx2rLD2_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx2rLD1_prog_var_thresh5_df:
VHLx2rLD1_prog_var_thresh5_df_rLD2_int <- VHLx2rLD1_prog_var_thresh5_df[which(VHLx2rLD1_prog_var_thresh5_df$variant %in% VHLx2rLD2_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx2rLD2_prog_var_thresh5_df:
VHLx2rLD2_prog_var_thresh5_df_rLD1_int <- VHLx2rLD2_prog_var_thresh5_df[which(VHLx2rLD2_prog_var_thresh5_df$variant %in% VHLx2rLD1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int[order(VHLx2rLD1_prog_var_thresh5_df_rLD2_int$variant),]
VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int[order(VHLx2rLD2_prog_var_thresh5_df_rLD1_int$variant),]
dim(VHLx2rLD1_prog_var_thresh5_df)[1] #Number of prog_vars in rLD1
VHLx2rLD1rLD2int_prog_var_thresh5_pre_count <- dim(VHLx2rLD1_prog_var_thresh5_df_rLD2_int)[1] 
VHLx2rLD1rLD2int_prog_var_thresh5_pre_count #Number of prog_vars in rLD1 also in rLD2
dim(VHLx2rLD2_prog_var_thresh5_df)[1] #Number of prog_vars in rLD2
dim(VHLx2rLD2_prog_var_thresh5_df_rLD1_int)[1] #Number of prog_vars in rLD2 also in rLD1

#Add the following columns from the from rLD2 df to the rLD1 df:
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_lib <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$lib
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2 <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post2
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3 <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post3
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2 <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna2
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre_pseudo
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_pseudo
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pseudo <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pseudo
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pseudo <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pseudo
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pseudo <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pseudo
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_pseudo <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_pseudo
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post2_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post3_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre_pseudo_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_pseudo_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pseudo_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pseudo_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pseudo_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pseudo_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pseudo_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pseudo_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_pseudo_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_pseudo_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre_lib_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_pre_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_lib_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pre_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pre_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_post_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna_post_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pre_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pre_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pre_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_post_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_snv_error_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre_snv_error_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_snv_error_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_snv_error_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_exp_snv_error_reads_pre <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$exp_snv_error_reads_pre
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_exp_snv_error_reads_post <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$exp_snv_error_reads_post
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pre <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pre
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_post <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$corr_post
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pre_pseudo <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pre_pseudo
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_post_pseudo <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$corr_post_pseudo
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pseudo_post_pre_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pseudo_post_pre_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_lib <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_lib
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2 <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3 <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2 <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre_pseudo_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pseudo_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_pseudo_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pseudo_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_pseudo_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pseudo_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2_pseudo_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pseudo_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3_pseudo_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_pseudo_freq <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2_pseudo_freq
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre_lib_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_pre_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_lib_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_pre_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_post_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2_pre_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pre_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3_pre_ratio
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio <- VHLx2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio) + log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio))/2)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio) + log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio))/2)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio) + log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio))/2)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio) + log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio))/2)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post3_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post3_pre_ratio) + log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pre_ratio))/2)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rna2_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rna2_post_ratio) + log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio))/2)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio) + log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio))/2)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio) + log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio))/2)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio) + log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio))/2)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio) + log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio))/2)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio) + log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio))/2)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio) + log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio))/2)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post3_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post3_pre_ratio) + log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pre_ratio))/2)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio) + log2(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_pre_weighted <- ((VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq*VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq/(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq))+(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq*VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq/(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)))/VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq
#rLD1 pre-freq weighting coefficient (rLD1_pre-freq / (rLD1 + rLD2 pre-freq's))
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq/(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq/(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)
#this will be weighted by denominator:  (rLD1_pof/rLD1_prf)(rLD1_prwc)+(rLD2_pof/rLD2_prf)*(rLD2_prwc)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted <- (VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pseudo_freq/VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq)*(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight)+(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq/VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)*(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight)
#this will be weighted by denominator:  (rLD1_pof/lif')*(rLD1_prwc)+(rLD2_pof/lif)*(rLD2_prwc)
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_pre_weighted <- (VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pseudo_freq/VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq)*(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight)+(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq/VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq)*(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight)
#rLD1 tHDR_pre-freq weighting coefficient (rLD1_tHDR_pre-freq / (rLD1 + rLD2 pre-freq's))
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_weight <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq/(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq+VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)
#rLD2 tHDR_pre-freq weighting coefficient
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_weight <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq/(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq+VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rLD1_pof/rLD1_prf)(rLD1_prwc)+(rLD2_pof/rLD2_prf)*(rLD2_prwc)
#tHDR_post_pre_ratio_rLD1rLD2_pre_weighted
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted <- (VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pseudo_freq/VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq)*(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_weight)+(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pseudo_freq/VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)*(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq)) >= 10) {
    VHLx2rLD1_cSNV_pre_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx2rLD1_cSNV_post_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx2rLD1_cSNV_post2_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx2rLD1_cSNV_post_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx2rLD1_tSNV_pre_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx2rLD1_tSNV_post_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx2rLD1_tSNV_post_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx2rLD1_tSNV_rna_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx2rLD1_tSNV_rna_post_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx2rLD1_tSNV_rna2_post_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx2rLD2_cSNV_pre_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_pre_lib_ratio)
VHLx2rLD2_cSNV_post_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post_pre_ratio)
VHLx2rLD2_cSNV_post2_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post2_pre_ratio)

VHLx2rLD2_cSNV_post_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post_lib_ratio)
VHLx2rLD2_tSNV_pre_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_pre_lib_ratio)
VHLx2rLD2_tSNV_post_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post_pre_ratio)
VHLx2rLD2_tSNV_post2_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post2_pre_ratio)
VHLx2rLD2_tSNV_post_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post_lib_ratio)
VHLx2rLD2_tSNV_rna_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna_pre_ratio)
VHLx2rLD2_tSNV_rna_post_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna_post_ratio)
VHLx2rLD2_tSNV_rna2_post_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna2_post_ratio)
VHLx2rLD1rLD2a_cSNV_pre_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_cSNV_post_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_cSNV_post2_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_cSNV_post_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_tSNV_pre_lib_med <- 
  median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_tSNV_post_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_tSNV_post2_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_tSNV_post_lib_med <-
  median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_tSNV_rna_pre_med <-
  median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_tSNV_rna_post_med <-
  median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_tSNV_rna2_post_med <-
  median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2pw_tSNV_post_pre_med  <-
  median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted)
VHLx2rLD1rLD2pw_cSNV_post_pre_med  <-
  median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLD1rLD2_pre_weighted)
  } else {
  VHLx2rLD1_cSNV_pre_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio)
VHLx2rLD1_cSNV_post_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio)
VHLx2rLD1_cSNV_post2_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio)
VHLx2rLD1_cSNV_post_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio)
VHLx2rLD1_tSNV_pre_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio)
VHLx2rLD1_tSNV_post_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio)
VHLx2rLD1_tSNV_post_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio)
VHLx2rLD1_tSNV_rna_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio)
VHLx2rLD1_tSNV_rna_post_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio)
VHLx2rLD1_tSNV_rna2_post_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio)
VHLx2rLD2_cSNV_pre_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio)
VHLx2rLD2_cSNV_post_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio)
VHLx2rLD2_cSNV_post2_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio)

VHLx2rLD2_cSNV_post_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio)
VHLx2rLD2_tSNV_pre_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio)
VHLx2rLD2_tSNV_post_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio)
VHLx2rLD2_tSNV_post2_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio)
VHLx2rLD2_tSNV_post_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio)
VHLx2rLD2_tSNV_rna_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio)
VHLx2rLD2_tSNV_rna_post_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio)
VHLx2rLD2_tSNV_rna2_post_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio)
VHLx2rLD1rLD2a_cSNV_pre_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_cSNV_post_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_cSNV_post2_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_cSNV_post_lib_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_tSNV_pre_lib_med <- 
  median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_tSNV_post_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_tSNV_post2_pre_med <- median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_tSNV_post_lib_med <-
  median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_tSNV_rna_pre_med <-
  median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_tSNV_rna_post_med <-
  median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2a_tSNV_rna2_post_med <-
  median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean)
VHLx2rLD1rLD2pw_tSNV_post_pre_med  <-
  median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted)
VHLx2rLD1rLD2pw_cSNV_post_pre_med  <-
  median(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted)
}

VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio/VHLx2rLD1_cSNV_pre_lib_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio/VHLx2rLD1_cSNV_post_pre_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio/VHLx2rLD1_cSNV_post_lib_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio/VHLx2rLD1_cSNV_post2_pre_med

VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio/VHLx2rLD1_tSNV_pre_lib_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio/VHLx2rLD1_tSNV_post_pre_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio/VHLx2rLD1_tSNV_post_lib_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio/VHLx2rLD1_tSNV_rna_pre_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio/VHLx2rLD1_tSNV_rna_post_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio/VHLx2rLD2_tSNV_post2_pre_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio/VHLx2rLD1_tSNV_rna2_post_med

VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio/VHLx2rLD2_cSNV_pre_lib_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio/VHLx2rLD2_cSNV_post_pre_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio/VHLx2rLD2_cSNV_post_lib_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio/VHLx2rLD1rLD2a_cSNV_post2_pre_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio/VHLx2rLD2_tSNV_rna2_post_med


VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio/VHLx2rLD2_tSNV_pre_lib_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio/VHLx2rLD2_tSNV_post_pre_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio/VHLx2rLD2_tSNV_post2_pre_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio/VHLx2rLD2_tSNV_post_lib_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio/VHLx2rLD2_tSNV_rna_pre_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio/VHLx2rLD2_tSNV_rna_post_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio/VHLx2rLD2_tSNV_rna2_post_med

###normalize the means
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean/VHLx2rLD1rLD2a_cSNV_pre_lib_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean/VHLx2rLD1rLD2a_cSNV_post_pre_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean/VHLx2rLD1rLD2a_cSNV_post_lib_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean/VHLx2rLD1rLD2a_tSNV_pre_lib_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean/VHLx2rLD1rLD2a_tSNV_post_pre_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean/VHLx2rLD1rLD2a_tSNV_post2_pre_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean/VHLx2rLD1rLD2a_tSNV_post_lib_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean/VHLx2rLD1rLD2a_tSNV_rna_pre_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean/VHLx2rLD1rLD2a_tSNV_rna_post_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean/VHLx2rLD1rLD2a_tSNV_rna2_post_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted/VHLx2rLD1rLD2pw_tSNV_post_pre_med
VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm <- VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted/VHLx2rLD1rLD2pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord
VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord = which(VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[,'pos']!='REF')
VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df = VHLx2rLD1_prog_var_thresh5_df_rLD2_int_ord[VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord,]
VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord = which(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'cDNApos']!='REF' & VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'cDNApos']!='NA')
VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df = VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df[VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord,]
VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord = which(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'CADD.phred']!='NA')
VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df = VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df[VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord,]
VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense <- VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df[which(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx2rLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s
VHLx2rLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_p <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='pearson')
VHLx2rLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_p
VHLx2rLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s
VHLx2rLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_p <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='pearson')
VHLx2rLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_p
VHLx2rLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post2_pre_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s
VHLx2rLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_p <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post2_pre_ratio_synnorm),method='pearson')
VHLx2rLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_p
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_s <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_s
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_p <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_p
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_s <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_s
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_p <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_p
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_s <- cor(log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_s
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_p <- cor(log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_p
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_s <- cor(log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_s
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_p <- cor(log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx2rLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_p
VHLx2rLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_s <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_freq),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_freq),method='spearman')
VHLx2rLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_s
VHLx2rLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_p <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pseudo_freq),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pseudo_freq),method='pearson')
VHLx2rLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_p
VHLx2rLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_s <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_s
VHLx2rLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_p <-cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio_synnorm),method='pearson')
VHLx2rLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_p
VHLx2rLD1rLD2_tSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_tSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s
VHLx2rLD1rLD2_tSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_tSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s
VHLx2rLD1rLD2_tSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_tSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s
VHLx2rLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s
VHLx2rLD1rLD2_tSNV_rLD1_rna2_post_by_rLD2_rna2_post_cor_s <- cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_tSNV_rLD1_rna2_post_by_rLD2_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx2rLD1_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1_cSNV_post_pre_by_cadd_cor_s
VHLx2rLD2_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD2_cSNV_post_pre_by_cadd_cor_s
VHLx2rLD1_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1_cSNV_post_lib_by_cadd_cor_s
VHLx2rLD2_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD2_cSNV_post_lib_by_cadd_cor_s
VHLx2rLD1_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1_tSNV_post_pre_by_cadd_cor_s
VHLx2rLD2_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD2_tSNV_post_pre_by_cadd_cor_s
VHLx2rLD1_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1_tSNV_post_lib_by_cadd_cor_s
VHLx2rLD2_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx2rLD1rLD2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2a_cSNV_pre_lib_by_cadd_cor_s
VHLx2rLD1rLD2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2w_cSNV_pre_lib_by_cadd_cor_s
VHLx2rLD1rLD2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2a_cSNV_post_pre_by_cadd_cor_s
VHLx2rLD1rLD2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2w_cSNV_post_pre_by_cadd_cor_s
VHLx2rLD1rLD2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2a_cSNV_post_lib_by_cadd_cor_s
VHLx2rLD1rLD2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2w_cSNV_post_lib_by_cadd_cor_s
VHLx2rLD1rLD2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2a_tSNV_pre_lib_by_cadd_cor_s
VHLx2rLD1rLD2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2a_tSNV_post_pre_by_cadd_cor_s
VHLx2rLD1rLD2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2w_tSNV_post_pre_by_cadd_cor_s
VHLx2rLD1rLD2a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post2_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2a_tSNV_post2_pre_by_cadd_cor_s
VHLx2rLD1rLD2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx2rLD1_cSNV_pre_lib_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx2rLD1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx2rLD1_tSNV_pre_lib_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rLD1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rLD1_cSNV_post_lib_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx2rLD1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx2rLD1_tSNV_post_lib_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rLD1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx2rLD1_cSNV_post_pre_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx2rLD1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx2rLD1_tSNV_post_pre_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx2rLD1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rLD1_cSNV_rna_lib_cors = cor(log2(VHLx2rLD1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx2rLD1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx2rLD1_tSNV_rna_lib_cors = cor(log2(VHLx2rLD1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rLD1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx2rLD1_cSNV_rna_pre_cors = cor(log2(VHLx2rLD1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx2rLD1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx2rLD1_tSNV_rna_pre_cors = cor(log2(VHLx2rLD1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx2rLD1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rLD1rLD2_cSNV_pre_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_freq),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_freq),method='spearman')
VHLx2rLD1rLD2_tSNV_pre_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_pseudo_freq),method='spearman')
VHLx2rLD1rLD2_cSNV_pre_lib_ratio_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio),method='spearman')
VHLx2rLD1rLD2_tSNV_pre_lib_ratio_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio),method='spearman')
VHLx2rLD1rLD2_cSNV_post_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_freq),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_freq),method='spearman')
VHLx2rLD1rLD2_tSNV_post_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pseudo_freq),method='spearman')
VHLx2rLD1rLD2_cSNV_post_lib_ratio_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_tSNV_post_lib_ratio_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_cSNV_post_pre_ratio_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_tSNV_post_pre_ratio_cors = cor(log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_cSNV_rna_cors = cor(log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rna_freq),log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_rna_freq),method='spearman')
VHLx2rLD1rLD2_tSNV_rna_cors = cor(log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pseudo_freq),method='spearman')
VHLx2rLD1rLD2_tSNV_rna_pre_ratio_cors = cor(log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx2rLD1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLD1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLD1_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLD1_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLD1_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLD1_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLD1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rLD1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rLD1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rLD1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rLD1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx2rLD1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx2rLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx2rLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx2rLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLD1rLD2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')

VHLx2rLD1_cors <- c("VHLx2rLD1",VHLx2rLD1_cSNV_pre_lib_cors,VHLx2rLD1_tSNV_pre_lib_cors,VHLx2rLD1_cSNV_post_lib_cors,VHLx2rLD1_tSNV_post_lib_cors,VHLx2rLD1_cSNV_post_pre_cors,VHLx2rLD1_tSNV_post_pre_cors,VHLx2rLD1_cSNV_rna_lib_cors,VHLx2rLD1_tSNV_rna_lib_cors,VHLx2rLD1_cSNV_rna_pre_cors,VHLx2rLD1_tSNV_rna_pre_cors,VHLx2rLD1rLD2_cSNV_pre_cors,VHLx2rLD1rLD2_tSNV_pre_cors,VHLx2rLD1rLD2_cSNV_pre_lib_ratio_cors,VHLx2rLD1rLD2_tSNV_pre_lib_ratio_cors,VHLx2rLD1rLD2_cSNV_post_cors,VHLx2rLD1rLD2_tSNV_post_cors,VHLx2rLD1rLD2_cSNV_post_lib_ratio_cors,VHLx2rLD1rLD2_tSNV_post_lib_ratio_cors,VHLx2rLD1rLD2_cSNV_post_pre_ratio_cors,VHLx2rLD1rLD2_tSNV_post_pre_ratio_cors,VHLx2rLD1rLD2_cSNV_rna_cors,VHLx2rLD1rLD2_tSNV_rna_cors,VHLx2rLD1rLD2_tSNV_rna_pre_ratio_cors,VHLx2rLD1_cSNV_pre_lib_ratio_cadd_cors,VHLx2rLD1_tSNV_pre_lib_ratio_cadd_cors,VHLx2rLD1_cSNV_post_lib_ratio_cadd_cors,VHLx2rLD1_tSNV_post_lib_ratio_cadd_cors,VHLx2rLD1_cSNV_post_pre_ratio_cadd_cors,VHLx2rLD1_tSNV_post_pre_ratio_cadd_cors,VHLx2rLD1_cSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLD1_tSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLD1_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLD1_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLD1_cSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLD1_tSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors,VHLx2rLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors,VHLx2rLD1rLD2a_cSNV_post_lib_ratio_cadd_cors,VHLx2rLD1rLD2a_tSNV_post_lib_ratio_cadd_cors,VHLx2rLD1rLD2a_cSNV_post_pre_ratio_cadd_cors,VHLx2rLD1rLD2a_tSNV_post_pre_ratio_cadd_cors,VHLx2rLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors,VHLx2rLD1rLD2w_cSNV_post_lib_ratio_cadd_cors,VHLx2rLD1rLD2w_cSNV_post_pre_ratio_cadd_cors,VHLx2rLD1rLD2w_tSNV_post_pre_ratio_cadd_cors)

VHLx2rLD2_cSNV_pre_lib_cors = cor(log2(VHLx2rLD2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx2rLD2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx2rLD2_tSNV_pre_lib_cors = cor(log2(VHLx2rLD2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rLD2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rLD2_cSNV_post_lib_cors = cor(log2(VHLx2rLD2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx2rLD2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx2rLD2_tSNV_post_lib_cors = cor(log2(VHLx2rLD2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rLD2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx2rLD2_cSNV_post_pre_cors = cor(log2(VHLx2rLD2_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx2rLD2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx2rLD2_tSNV_post_pre_cors = cor(log2(VHLx2rLD2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx2rLD2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rLD2_cSNV_rna_lib_cors = cor(log2(VHLx2rLD2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx2rLD2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx2rLD2_tSNV_rna_lib_cors = cor(log2(VHLx2rLD2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rLD2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx2rLD2_cSNV_rna_pre_cors = cor(log2(VHLx2rLD2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx2rLD2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx2rLD2_tSNV_rna_pre_cors = cor(log2(VHLx2rLD2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx2rLD2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rLD2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rLD2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLD2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rLD2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLD2_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rLD2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLD2_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rLD2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLD2_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLD2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLD2_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLD2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLD2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rLD2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rLD2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rLD2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rLD2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx2rLD2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')

VHLx2rLD2_cors <- c("VHLx2rLD2",VHLx2rLD2_cSNV_pre_lib_cors,VHLx2rLD2_tSNV_pre_lib_cors,VHLx2rLD2_cSNV_post_lib_cors,VHLx2rLD2_tSNV_post_lib_cors,VHLx2rLD2_cSNV_post_pre_cors,VHLx2rLD2_tSNV_post_pre_cors,VHLx2rLD2_cSNV_rna_lib_cors,VHLx2rLD2_tSNV_rna_lib_cors,VHLx2rLD2_cSNV_rna_pre_cors,VHLx2rLD2_tSNV_rna_pre_cors,VHLx2rLD1rLD2_cSNV_pre_cors,VHLx2rLD1rLD2_tSNV_pre_cors,VHLx2rLD1rLD2_cSNV_pre_lib_ratio_cors,VHLx2rLD1rLD2_tSNV_pre_lib_ratio_cors,VHLx2rLD1rLD2_cSNV_post_cors,VHLx2rLD1rLD2_tSNV_post_cors,VHLx2rLD1rLD2_cSNV_post_lib_ratio_cors,VHLx2rLD1rLD2_tSNV_post_lib_ratio_cors,VHLx2rLD1rLD2_cSNV_post_pre_ratio_cors,VHLx2rLD1rLD2_tSNV_post_pre_ratio_cors,VHLx2rLD1rLD2_cSNV_rna_cors,VHLx2rLD1rLD2_tSNV_rna_cors,VHLx2rLD1rLD2_tSNV_rna_pre_ratio_cors,VHLx2rLD2_cSNV_pre_lib_ratio_cadd_cors,VHLx2rLD2_tSNV_pre_lib_ratio_cadd_cors,VHLx2rLD2_cSNV_post_lib_ratio_cadd_cors,VHLx2rLD2_tSNV_post_lib_ratio_cadd_cors,VHLx2rLD2_cSNV_post_pre_ratio_cadd_cors,VHLx2rLD2_tSNV_post_pre_ratio_cadd_cors,VHLx2rLD2_cSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLD2_tSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLD2_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLD2_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLD2_cSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLD2_tSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors,VHLx2rLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors,VHLx2rLD1rLD2a_cSNV_post_lib_ratio_cadd_cors,VHLx2rLD1rLD2a_tSNV_post_lib_ratio_cadd_cors,VHLx2rLD1rLD2a_cSNV_post_pre_ratio_cadd_cors,VHLx2rLD1rLD2a_tSNV_post_pre_ratio_cadd_cors,VHLx2rLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors,VHLx2rLD1rLD2w_cSNV_post_lib_ratio_cadd_cors,VHLx2rLD1rLD2w_cSNV_post_pre_ratio_cadd_cors,VHLx2rLD1rLD2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx2rLD1)
rm(VHLx2rLD2)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx2rLD1
VHLx2_posrange <- range(as.numeric(as.character(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$pos)))
VHLx2_posseq <- seq(from=VHLx2_posrange[1], to=VHLx2_posrange[2])
VHLx2rLD1_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx2rLD1_tHDR_pre_lib_pred <- predict(VHLx2rLD1_tHDR_pre_lib_ratio.lo, newdata = VHLx2_posseq, se=TRUE)
VHLx2rLD1_tHDR_pre_lib_pos_effects <- VHLx2rLD1_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx2rLD1_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx2rLD1_tHDR_pre_lib_pos_effects)
VHLx2rLD1_tHDR_pre_lib_pos_effects_ci <- VHLx2rLD1_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx2rLD1_tHDR_pre_lib_pred$df)
VHLx2rLD1_tHDR_pre_lib_pos_effects_ci_ymin = VHLx2rLD1_tHDR_pre_lib_pos_effects - VHLx2rLD1_tHDR_pre_lib_pos_effects_ci
VHLx2rLD1_tHDR_pre_lib_pos_effects_ci_ymax = VHLx2rLD1_tHDR_pre_lib_pos_effects + VHLx2rLD1_tHDR_pre_lib_pos_effects_ci
VHLx2rLD1_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx2_posseq, VHLx2rLD1_tHDR_pre_lib_pos_effects, VHLx2rLD1_tHDR_pre_lib_pos_effects.x, VHLx2rLD1_tHDR_pre_lib_pos_effects_ci_ymin, VHLx2rLD1_tHDR_pre_lib_pos_effects_ci_ymax, VHLx2rLD1_tHDR_pre_lib_pred_se = VHLx2rLD1_tHDR_pre_lib_pred$se.fit)
#VHLx2rLD2
VHLx2rLD2_tHDR_pre_lib_ratio.lo <- loess(log2(rLD2_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx2rLD2_tHDR_pre_lib_pred <- predict(VHLx2rLD2_tHDR_pre_lib_ratio.lo, newdata = VHLx2_posseq, se=TRUE)
VHLx2rLD2_tHDR_pre_lib_pos_effects <- VHLx2rLD2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx2rLD2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx2rLD2_tHDR_pre_lib_pos_effects)
VHLx2rLD2_tHDR_pre_lib_pos_effects_ci <- VHLx2rLD2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx2rLD2_tHDR_pre_lib_pred$df)
VHLx2rLD2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx2rLD2_tHDR_pre_lib_pos_effects - VHLx2rLD2_tHDR_pre_lib_pos_effects_ci
VHLx2rLD2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx2rLD2_tHDR_pre_lib_pos_effects + VHLx2rLD2_tHDR_pre_lib_pos_effects_ci
VHLx2rLD2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx2_posseq, VHLx2rLD2_tHDR_pre_lib_pos_effects, VHLx2rLD2_tHDR_pre_lib_pos_effects.x, VHLx2rLD2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx2rLD2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx2rLD2_tHDR_pre_lib_pred_se = VHLx2rLD2_tHDR_pre_lib_pred$se.fit)

#VHLx2rLD1rLD2
VHLx2rLD1rLD2_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm > 0.7 & VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm > 0.3 & VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx2rLD1rLD2_tHDR_pre_lib_pred <- predict(VHLx2rLD1rLD2_tHDR_pre_lib_ratio.lo, newdata = VHLx2_posseq, se=TRUE)
VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects <- VHLx2rLD1rLD2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects)
VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects_ci <- VHLx2rLD1rLD2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx2rLD1rLD2_tHDR_pre_lib_pred$df)
VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects - VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects_ci
VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects + VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects_ci
VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx2_posseq, VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects, VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects.x, VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx2rLD1rLD2_tHDR_pre_lib_pred_se = VHLx2rLD1rLD2_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rLD1, rLD2, rLD1rLD2)
VHLx2rLD_tHDR_pos_merge_df <- VHLx2rLD1_prog_map_thresh5_df_rLD2_int_ord_df 
VHLx2rLD_tHDR_pos_merge_df <- merge(VHLx2rLD_tHDR_pos_merge_df, VHLx2rLD1_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx2rLD1_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx2rLD_tHDR_pos_merge_df <- merge(VHLx2rLD_tHDR_pos_merge_df, VHLx2rLD2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx2rLD2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx2rLD_tHDR_pos_merge_df <- merge(VHLx2rLD_tHDR_pos_merge_df, VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx2rLD_tHDR_pos_merge_df <- VHLx2rLD_tHDR_pos_merge_df %>% 
  rename(
    rLD1_tHDR_pre_lib_pos_effects.x = VHLx2rLD1_tHDR_pre_lib_pos_effects.x,
    rLD2_tHDR_pre_lib_pos_effects.x = VHLx2rLD2_tHDR_pre_lib_pos_effects.x,
    rLD1rLD2_tHDR_pre_lib_pos_effects.x = VHLx2rLD1rLD2_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rLD1 vs. rLD1_fit and vs. mean_fit)
VHLx2rLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1 <- log2(VHLx2rLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx2rLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_pos_effects.x
VHLx2rLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx2rLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2 <- log2(VHLx2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_ratio_synnorm) - VHLx2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_pos_effects.x
VHLx2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_ratio_synnorm) - VHLx2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx2rLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm) - VHLx2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx2rLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_loess_rLD1 <- log2(VHLx2rLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx2rLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_pos_effects.x
VHLx2rLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx2rLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_loess_rLD2 <- log2(VHLx2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_ratio_synnorm) - VHLx2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_pos_effects.x
VHLx2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_ratio_synnorm) - VHLx2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx2rLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm) - VHLx2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rLD1 and rLD2 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx2rLD_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx2rLD_tHDR_post_lib_loess_median_syn_rLD1 <- median(VHLx2rLD_tHDR_pos_merge_df[which(VHLx2rLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLD1_tHDR_post_lib_loess_rLD1')])
  VHLx2rLD_tHDR_post_lib_loess_median_syn_rLD2 <- median(VHLx2rLD_tHDR_pos_merge_df[which(VHLx2rLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLD2_tHDR_post_lib_loess_rLD2')])
  } else {
  VHLx2rLD_tHDR_post_lib_loess_median_syn_rLD1 <- median(VHLx2rLD_tHDR_pos_merge_df[which(VHLx2rLD_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLD1_tHDR_post_lib_loess_rLD1')])
  VHLx2rLD_tHDR_post_lib_loess_median_syn_rLD2 <- median(VHLx2rLD_tHDR_pos_merge_df[which(VHLx2rLD_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLD2_tHDR_post_lib_loess_rLD2')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rLD1 'e.sns' = exon syn/ns norm.
VHLx2rLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1_e.sns <- (VHLx2rLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1-VHLx2rLD_tHDR_post_lib_loess_median_syn_rLD1)
#calculate new b values for rLD2 'e.sns' = exon syn/ns norm.
VHLx2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2_e.sns <- (VHLx2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2-VHLx2rLD_tHDR_post_lib_loess_median_syn_rLD2)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx2rLD_tHDR_pos_merge_df$rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean <- (VHLx2rLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1_e.sns+VHLx2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx2rLD_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx2rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_syn_median <- median(VHLx2rLD_tHDR_pos_merge_df[which(VHLx2rLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('VHLx2rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean')])
  } else {
  VHLx2rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_syn_median <- median(VHLx2rLD_tHDR_pos_merge_df[which(VHLx2rLD_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('VHLx2rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean')])
}

#RNA analysis
VHLx2rLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s <- cor(log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx2rLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1_tHDR_rna2_rna_ratio <- VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_pseudo_freq/VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pseudo_freq
VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_rna_ratio <- VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_pseudo_freq/VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pseudo_freq
VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1rLD2_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1_tHDR_rna2_rna_ratio)+log2(VHLx2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_rna_ratio))/2

```
```{r}
VHLx3arLD1_file <- paste(experiment_dir_220511,'VHLx3arL43','_annotated.txt',sep='')
VHLx3arLD2_file <- paste(experiment_dir_220511,'VHLx3arL44','_annotated.txt',sep='')
VHLx3arLD1 <- read.table(VHLx3arLD1_file, header=TRUE, sep="\t")
VHLx3arLD2 <- read.table(VHLx3arLD2_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx3arLD1 <- VHLx3arLD1 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )
VHLx3arLD2 <- VHLx3arLD2 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx3a <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx3a'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx3a_HDR_5_SNV = as.character(VHL_editing_info_VHLx3a$HDR_5_SNV)
VHLx3a_HDR_3_SNV = as.character(VHL_editing_info_VHLx3a$HDR_3_SNV)
#VHLx3a_cut_pos = as.character(VHL_editing_info_VHLx3a$cut_pos)
VHLx3a_cut_end = as.character(VHL_editing_info_VHLx3a$cut_end)
VHLx3a_mut_start = as.character(VHL_editing_info_VHLx3a$mut_start)
VHLx3a_mut_end = as.character(VHL_editing_info_VHLx3a$mut_end)

### Replicate 1
VHLx3arLD1_cSNV_all <- which(VHLx3arLD1[,'c_hdr_snv']=='True')
VHLx3arLD1_cSNV_all_df = VHLx3arLD1[VHLx3arLD1_cSNV_all,]
VHLx3arLD1_prog_var_all <- which(VHLx3arLD1[,'all_hdr_variant']=='True' & VHLx3arLD1[,'edit_string']!='-WT')
VHLx3arLD1_prog_var_all_df = VHLx3arLD1[VHLx3arLD1_prog_var_all,]
VHLx3arLD1_prog_map_all = which(VHLx3arLD1_prog_var_all_df[,'pos']!='REF')
VHLx3arLD1_prog_map_all_df = VHLx3arLD1_prog_var_all_df[VHLx3arLD1_prog_map_all,]
VHLx3arLD1_prog_map_exon_all = which(VHLx3arLD1_prog_map_all_df[,'cDNApos']!='REF' & VHLx3arLD1_prog_map_all_df[,'cDNApos']!='NA')
VHLx3arLD1_prog_map_exon_all_df = VHLx3arLD1_prog_map_all_df[VHLx3arLD1_prog_map_exon_all,]
VHLx3arLD1_prog_map_CADD = which(VHLx3arLD1_prog_map_all_df[,'CADD.phred']!='NA')
VHLx3arLD1_prog_map_CADD_df = VHLx3arLD1_prog_map_all_df[VHLx3arLD1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx3arLD1_prog_var_thresh5 <- which(as.numeric(as.character(VHLx3arLD1_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx3arLD1_prog_var_thresh5_df = VHLx3arLD1_prog_var_all_df[VHLx3arLD1_prog_var_thresh5,]
VHLx3arLD1_prog_map_thresh5 <- which(as.numeric(as.character(VHLx3arLD1_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx3arLD1_prog_map_thresh5_df = VHLx3arLD1_prog_map_all_df[VHLx3arLD1_prog_map_thresh5,]
VHLx3arLD1_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx3arLD1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx3arLD1_prog_map_exon_thresh5_df = VHLx3arLD1_prog_map_exon_all_df[VHLx3arLD1_prog_map_exon_thresh5,]
VHLx3arLD1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx3arLD1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx3arLD1_prog_map_CADD_thresh5_df = VHLx3arLD1_prog_map_CADD_df[VHLx3arLD1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx3arLD1_prog_var_all_lib_count = length(VHLx3arLD1_prog_var_all_df$lib)
VHLx3arLD1_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx3arLD1_prog_var_all_min_lib_counts = min(VHLx3arLD1_prog_var_all_df$lib)
VHLx3arLD1_prog_var_all_min_lib_counts
VHLx3arLD1_prog_var_all_max_lib_counts = max(VHLx3arLD1_prog_var_all_df$lib)
VHLx3arLD1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx3arLD1_prog_map_all_lib_count = length(VHLx3arLD1_prog_map_all_df$lib)
VHLx3arLD1_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx3arLD1_prog_map_all_min_lib_counts = min(VHLx3arLD1_prog_map_all_df$lib)
VHLx3arLD1_prog_map_all_min_lib_counts
VHLx3arLD1_prog_map_all_max_lib_counts = max(VHLx3arLD1_prog_map_all_df$lib)
VHLx3arLD1_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx3arLD1_prog_var_all_pre_count = length(VHLx3arLD1_prog_var_all_df$pre)
VHLx3arLD1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx3arLD1_prog_var_all_min_pre_counts = min(VHLx3arLD1_prog_var_all_df$pre)
VHLx3arLD1_prog_var_all_min_pre_counts
VHLx3arLD1_prog_var_all_max_pre_counts = max(VHLx3arLD1_prog_var_all_df$pre)
VHLx3arLD1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx3arLD1_prog_map_all_pre_count = length(VHLx3arLD1_prog_map_all_df$pre)
VHLx3arLD1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx3arLD1_prog_map_all_min_pre_counts = min(VHLx3arLD1_prog_map_all_df$pre)
VHLx3arLD1_prog_map_all_min_pre_counts
VHLx3arLD1_prog_map_all_max_pre_counts = max(VHLx3arLD1_prog_map_all_df$pre)
VHLx3arLD1_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx3arLD1_prog_map_all_post_count = length(VHLx3arLD1_prog_map_all_df$post)
VHLx3arLD1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx3arLD1_prog_map_all_min_post_counts = min(VHLx3arLD1_prog_map_all_df$post)
VHLx3arLD1_prog_map_all_min_post_counts
VHLx3arLD1_prog_map_all_max_post_counts = max(VHLx3arLD1_prog_map_all_df$post)
VHLx3arLD1_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx3arLD1_prog_map_all_syn_df <- VHLx3arLD1_prog_map_all_df[which(VHLx3arLD1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx3arLD1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx3arLD1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx3arLD1_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx3arLD1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx3arLD1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx3arLD1_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx3arLD1_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx3arLD1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx3arLD1_prog_map_all_min_rna_counts = min(VHLx3arLD1_prog_map_exon_all_df$tHDR_rna)
VHLx3arLD1_prog_map_all_min_rna_counts
VHLx3arLD1_prog_map_all_max_rna_counts = max(VHLx3arLD1_prog_map_exon_all_df$tHDR_rna)
VHLx3arLD1_prog_map_all_max_rna_counts
VHLx3arLD1_prog_map_all_min_rna_pseudo_freq = min(VHLx3arLD1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3arLD1_prog_map_all_min_rna_pseudo_freq
VHLx3arLD1_prog_map_all_max_rna_pseudo_freq = max(VHLx3arLD1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3arLD1_prog_map_all_max_rna_pseudo_freq
VHLx3arLD1_prog_map_all_min_rna_pre_ratio = min(VHLx3arLD1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3arLD1_prog_map_all_min_rna_pre_ratio
VHLx3arLD1_prog_map_all_max_rna_pre_ratio = max(VHLx3arLD1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3arLD1_prog_map_all_max_rna_pre_ratio
VHLx3arLD1_prog_map_all_min_rna_post_ratio = min(VHLx3arLD1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3arLD1_prog_map_all_min_rna_post_ratio
VHLx3arLD1_prog_map_all_max_rna_post_ratio = max(VHLx3arLD1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3arLD1_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx3arLD1_cSNV_all_corr_pre_count = length(VHLx3arLD1_cSNV_all_df$corr_pre)
VHLx3arLD1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx3arLD1_cSNV_all_min_corr_pre_counts = min(VHLx3arLD1_cSNV_all_df$corr_pre)
VHLx3arLD1_cSNV_all_min_corr_pre_counts
VHLx3arLD1_cSNV_all_max_corr_pre_counts = max(VHLx3arLD1_cSNV_all_df$corr_pre)
VHLx3arLD1_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLD1_cSNV_all_corr_post_count = length(VHLx3arLD1_cSNV_all_df$corr_post)
VHLx3arLD1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx3arLD1_cSNV_all_min_corr_post_counts = min(VHLx3arLD1_cSNV_all_df$corr_post)
VHLx3arLD1_cSNV_all_min_corr_post_counts
VHLx3arLD1_cSNV_all_max_corr_post_counts = max(VHLx3arLD1_cSNV_all_df$corr_post)
VHLx3arLD1_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx3a_p_hdr_snv = paste('p_hdr_',VHLx3a_cut_end,'_snv',sep='')
VHLx3arLD1_pSNV_all <- which(VHLx3arLD1[,VHLx3a_p_hdr_snv]=='True')
VHLx3arLD1_pSNV_all_df = VHLx3arLD1[VHLx3arLD1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLD1_pSNV_all_lib_count = length(VHLx3arLD1_pSNV_all_df$lib)
VHLx3arLD1_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx3arLD1_pSNV_all_min_lib_counts = min(VHLx3arLD1_pSNV_all_df$lib)
VHLx3arLD1_pSNV_all_min_lib_counts
VHLx3arLD1_pSNV_all_max_lib_counts = max(VHLx3arLD1_pSNV_all_df$lib)
VHLx3arLD1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx3arLD1_pSNV_all_pre_count = length(VHLx3arLD1_pSNV_all_df$pre)
VHLx3arLD1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx3arLD1_pSNV_all_min_pre_counts = min(VHLx3arLD1_pSNV_all_df$pre)
VHLx3arLD1_pSNV_all_min_pre_counts
VHLx3arLD1_pSNV_all_max_pre_counts = max(VHLx3arLD1_pSNV_all_df$pre)
VHLx3arLD1_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLD1_pSNV_all_post_count = length(VHLx3arLD1_pSNV_all_df$post)
VHLx3arLD1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx3arLD1_pSNV_all_min_post_counts = min(VHLx3arLD1_pSNV_all_df$post)
VHLx3arLD1_pSNV_all_min_post_counts
VHLx3arLD1_pSNV_all_max_post_counts = max(VHLx3arLD1_pSNV_all_df$post)
VHLx3arLD1_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLD1_prog_map_thresh5_lib_count = length(VHLx3arLD1_prog_map_thresh5_df$lib)
VHLx3arLD1_prog_map_thresh5_lib_count
VHLx3arLD1_prog_map_thresh5_min_lib_counts = min(VHLx3arLD1_prog_map_thresh5_df$lib)
VHLx3arLD1_prog_map_thresh5_min_lib_counts
VHLx3arLD1_prog_map_thresh5_max_lib_counts = max(VHLx3arLD1_prog_map_thresh5_df$lib)
VHLx3arLD1_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLD1_prog_map_thresh5_pre_count = length(VHLx3arLD1_prog_map_thresh5_df$pre)
VHLx3arLD1_prog_map_thresh5_pre_count
VHLx3arLD1_prog_map_thresh5_min_pre_counts = min(VHLx3arLD1_prog_map_thresh5_df$pre)
VHLx3arLD1_prog_map_thresh5_min_pre_counts
VHLx3arLD1_prog_map_thresh5_max_pre_counts = max(VHLx3arLD1_prog_map_thresh5_df$pre)
VHLx3arLD1_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx3arLD1_prog_map_thresh5_post_count = length(VHLx3arLD1_prog_map_thresh5_df$post)
VHLx3arLD1_prog_map_thresh5_post_count
VHLx3arLD1_prog_map_thresh5_min_post_counts = min(VHLx3arLD1_prog_map_thresh5_df$post)
VHLx3arLD1_prog_map_thresh5_min_post_counts
VHLx3arLD1_prog_map_thresh5_max_post_counts = max(VHLx3arLD1_prog_map_thresh5_df$post)
VHLx3arLD1_prog_map_thresh5_max_post_counts
VHLx3arLD1_prog_map_thresh5_corr_post_count = length(VHLx3arLD1_cSNV_all_df$corr_post)
VHLx3arLD1_prog_map_thresh5_corr_post_count
VHLx3arLD1_prog_map_thresh5_min_corr_post_counts = min(VHLx3arLD1_cSNV_all_df$corr_post)
VHLx3arLD1_prog_map_thresh5_min_corr_post_counts
VHLx3arLD1_prog_map_thresh5_max_corr_post_counts = max(VHLx3arLD1_cSNV_all_df$corr_post)
VHLx3arLD1_prog_map_thresh5_max_corr_post_counts

VHLx3arLD1_pSNV_thresh5 <- which(VHLx3arLD1[,VHLx3a_p_hdr_snv]=='True' & as.numeric(as.character(VHLx3arLD1[,'pre_freq']))>=0.00001)
VHLx3arLD1_pSNV_thresh5_df = VHLx3arLD1[VHLx3arLD1_pSNV_thresh5,]
VHLx3arLD1_pSNV_thresh5_lib_count = length(VHLx3arLD1_pSNV_thresh5_df$lib)
VHLx3arLD1_pSNV_thresh5_lib_count
VHLx3arLD1_pSNV_thresh5_min_lib_counts = min(VHLx3arLD1_pSNV_thresh5_df$lib)
VHLx3arLD1_pSNV_thresh5_min_lib_counts
VHLx3arLD1_pSNV_thresh5_max_lib_counts = max(VHLx3arLD1_pSNV_thresh5_df$lib)
VHLx3arLD1_pSNV_thresh5_max_lib_counts
VHLx3arLD1_pSNV_thresh5_pre_count = length(VHLx3arLD1_pSNV_thresh5_df$pre)
VHLx3arLD1_pSNV_thresh5_pre_count
VHLx3arLD1_pSNV_thresh5_min_pre_counts = min(VHLx3arLD1_pSNV_thresh5_df$pre)
VHLx3arLD1_pSNV_thresh5_min_pre_counts
VHLx3arLD1_pSNV_thresh5_max_pre_counts = max(VHLx3arLD1_pSNV_thresh5_df$pre)
VHLx3arLD1_pSNV_thresh5_max_pre_counts
VHLx3arLD1_pSNV_thresh5_post_count = length(VHLx3arLD1_pSNV_thresh5_df$post)
VHLx3arLD1_pSNV_thresh5_post_count
VHLx3arLD1_pSNV_thresh5_min_post_counts = min(VHLx3arLD1_pSNV_thresh5_df$post)
VHLx3arLD1_pSNV_thresh5_min_post_counts
VHLx3arLD1_pSNV_thresh5_max_post_counts = max(VHLx3arLD1_pSNV_thresh5_df$post)
VHLx3arLD1_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx3arLD2_cSNV_all <- which(VHLx3arLD2[,'c_hdr_snv']=='True')
VHLx3arLD2_cSNV_all_df = VHLx3arLD2[VHLx3arLD2_cSNV_all,]
VHLx3arLD2_prog_var_all <- which(VHLx3arLD2[,'all_hdr_variant']=='True' & VHLx3arLD2[,'edit_string']!='-WT')
VHLx3arLD2_prog_var_all_df = VHLx3arLD2[VHLx3arLD2_prog_var_all,]
VHLx3arLD2_prog_map_all = which(VHLx3arLD2_prog_var_all_df[,'pos']!='REF')
VHLx3arLD2_prog_map_all_df = VHLx3arLD2_prog_var_all_df[VHLx3arLD2_prog_map_all,]
VHLx3arLD2_prog_map_exon_all = which(VHLx3arLD2_prog_map_all_df[,'cDNApos']!='REF' & VHLx3arLD2_prog_map_all_df[,'cDNApos']!='NA')
VHLx3arLD2_prog_map_exon_all_df = VHLx3arLD2_prog_map_all_df[VHLx3arLD2_prog_map_exon_all,]
VHLx3arLD2_prog_map_CADD = which(VHLx3arLD2_prog_map_all_df[,'CADD.phred']!='NA')
VHLx3arLD2_prog_map_CADD_df = VHLx3arLD2_prog_map_all_df[VHLx3arLD2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx3arLD2_prog_var_thresh5 <- which(as.numeric(as.character(VHLx3arLD2_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx3arLD2_prog_var_thresh5_df = VHLx3arLD2_prog_var_all_df[VHLx3arLD2_prog_var_thresh5,]
VHLx3arLD2_prog_map_thresh5 <- which(as.numeric(as.character(VHLx3arLD2_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx3arLD2_prog_map_thresh5_df = VHLx3arLD2_prog_map_all_df[VHLx3arLD2_prog_map_thresh5,]
VHLx3arLD2_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx3arLD2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx3arLD2_prog_map_exon_thresh5_df = VHLx3arLD2_prog_map_exon_all_df[VHLx3arLD2_prog_map_exon_thresh5,]
VHLx3arLD2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx3arLD2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx3arLD2_prog_map_CADD_thresh5_df = VHLx3arLD2_prog_map_CADD_df[VHLx3arLD2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx3arLD2_prog_var_all_lib_count = length(VHLx3arLD2_prog_var_all_df$lib)
VHLx3arLD2_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx3arLD2_prog_var_all_min_lib_counts = min(VHLx3arLD2_prog_var_all_df$lib)
VHLx3arLD2_prog_var_all_min_lib_counts
VHLx3arLD2_prog_var_all_max_lib_counts = max(VHLx3arLD2_prog_var_all_df$lib)
VHLx3arLD2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx3arLD2_prog_map_all_lib_count = length(VHLx3arLD2_prog_map_all_df$lib)
VHLx3arLD2_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx3arLD2_prog_map_all_min_lib_counts = min(VHLx3arLD2_prog_map_all_df$lib)
VHLx3arLD2_prog_map_all_min_lib_counts
VHLx3arLD2_prog_map_all_max_lib_counts = max(VHLx3arLD2_prog_map_all_df$lib)
VHLx3arLD2_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx3arLD2_prog_var_all_pre_count = length(VHLx3arLD2_prog_var_all_df$pre)
VHLx3arLD2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx3arLD2_prog_var_all_min_pre_counts = min(VHLx3arLD2_prog_var_all_df$pre)
VHLx3arLD2_prog_var_all_min_pre_counts
VHLx3arLD2_prog_var_all_max_pre_counts = max(VHLx3arLD2_prog_var_all_df$pre)
VHLx3arLD2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx3arLD2_prog_map_all_pre_count = length(VHLx3arLD2_prog_map_all_df$pre)
VHLx3arLD2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx3arLD2_prog_map_all_min_pre_counts = min(VHLx3arLD2_prog_map_all_df$pre)
VHLx3arLD2_prog_map_all_min_pre_counts
VHLx3arLD2_prog_map_all_max_pre_counts = max(VHLx3arLD2_prog_map_all_df$pre)
VHLx3arLD2_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx3arLD2_prog_map_all_post_count = length(VHLx3arLD2_prog_map_all_df$post)
VHLx3arLD2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx3arLD2_prog_map_all_min_post_counts = min(VHLx3arLD2_prog_map_all_df$post)
VHLx3arLD2_prog_map_all_min_post_counts
VHLx3arLD2_prog_map_all_max_post_counts = max(VHLx3arLD2_prog_map_all_df$post)
VHLx3arLD2_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx3arLD2_prog_map_all_syn_df <- VHLx3arLD2_prog_map_all_df[which(VHLx3arLD2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx3arLD2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx3arLD2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx3arLD2_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx3arLD2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx3arLD2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx3arLD2_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx3arLD2_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx3arLD2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx3arLD2_prog_map_all_min_rna_counts = min(VHLx3arLD2_prog_map_exon_all_df$tHDR_rna)
VHLx3arLD2_prog_map_all_min_rna_counts
VHLx3arLD2_prog_map_all_max_rna_counts = max(VHLx3arLD2_prog_map_exon_all_df$tHDR_rna)
VHLx3arLD2_prog_map_all_max_rna_counts
VHLx3arLD2_prog_map_all_min_rna_pseudo_freq = min(VHLx3arLD2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3arLD2_prog_map_all_min_rna_pseudo_freq
VHLx3arLD2_prog_map_all_max_rna_pseudo_freq = max(VHLx3arLD2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3arLD2_prog_map_all_max_rna_pseudo_freq
VHLx3arLD2_prog_map_all_min_rna_pre_ratio = min(VHLx3arLD2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3arLD2_prog_map_all_min_rna_pre_ratio
VHLx3arLD2_prog_map_all_max_rna_pre_ratio = max(VHLx3arLD2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3arLD2_prog_map_all_max_rna_pre_ratio
VHLx3arLD2_prog_map_all_min_rna_post_ratio = min(VHLx3arLD2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3arLD2_prog_map_all_min_rna_post_ratio
VHLx3arLD2_prog_map_all_max_rna_post_ratio = max(VHLx3arLD2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3arLD2_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx3arLD2_cSNV_all_corr_pre_count = length(VHLx3arLD2_cSNV_all_df$corr_pre)
VHLx3arLD2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx3arLD2_cSNV_all_min_corr_pre_counts = min(VHLx3arLD2_cSNV_all_df$corr_pre)
VHLx3arLD2_cSNV_all_min_corr_pre_counts
VHLx3arLD2_cSNV_all_max_corr_pre_counts = max(VHLx3arLD2_cSNV_all_df$corr_pre)
VHLx3arLD2_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLD2_cSNV_all_corr_post_count = length(VHLx3arLD2_cSNV_all_df$corr_post)
VHLx3arLD2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx3arLD2_cSNV_all_min_corr_post_counts = min(VHLx3arLD2_cSNV_all_df$corr_post)
VHLx3arLD2_cSNV_all_min_corr_post_counts
VHLx3arLD2_cSNV_all_max_corr_post_counts = max(VHLx3arLD2_cSNV_all_df$corr_post)
VHLx3arLD2_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx3a_p_hdr_snv = paste('p_hdr_',VHLx3a_cut_end,'_snv',sep='')
VHLx3arLD2_pSNV_all <- which(VHLx3arLD2[,VHLx3a_p_hdr_snv]=='True')
VHLx3arLD2_pSNV_all_df = VHLx3arLD2[VHLx3arLD2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLD2_pSNV_all_lib_count = length(VHLx3arLD2_pSNV_all_df$lib)
VHLx3arLD2_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx3arLD2_pSNV_all_min_lib_counts = min(VHLx3arLD2_pSNV_all_df$lib)
VHLx3arLD2_pSNV_all_min_lib_counts
VHLx3arLD2_pSNV_all_max_lib_counts = max(VHLx3arLD2_pSNV_all_df$lib)
VHLx3arLD2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx3arLD2_pSNV_all_pre_count = length(VHLx3arLD2_pSNV_all_df$pre)
VHLx3arLD2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx3arLD2_pSNV_all_min_pre_counts = min(VHLx3arLD2_pSNV_all_df$pre)
VHLx3arLD2_pSNV_all_min_pre_counts
VHLx3arLD2_pSNV_all_max_pre_counts = max(VHLx3arLD2_pSNV_all_df$pre)
VHLx3arLD2_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLD2_pSNV_all_post_count = length(VHLx3arLD2_pSNV_all_df$post)
VHLx3arLD2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx3arLD2_pSNV_all_min_post_counts = min(VHLx3arLD2_pSNV_all_df$post)
VHLx3arLD2_pSNV_all_min_post_counts
VHLx3arLD2_pSNV_all_max_post_counts = max(VHLx3arLD2_pSNV_all_df$post)
VHLx3arLD2_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLD2_prog_map_thresh5_lib_count = length(VHLx3arLD2_prog_map_thresh5_df$lib)
VHLx3arLD2_prog_map_thresh5_lib_count
VHLx3arLD2_prog_map_thresh5_min_lib_counts = min(VHLx3arLD2_prog_map_thresh5_df$lib)
VHLx3arLD2_prog_map_thresh5_min_lib_counts
VHLx3arLD2_prog_map_thresh5_max_lib_counts = max(VHLx3arLD2_prog_map_thresh5_df$lib)
VHLx3arLD2_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLD2_prog_map_thresh5_pre_count = length(VHLx3arLD2_prog_map_thresh5_df$pre)
VHLx3arLD2_prog_map_thresh5_pre_count
VHLx3arLD2_prog_map_thresh5_min_pre_counts = min(VHLx3arLD2_prog_map_thresh5_df$pre)
VHLx3arLD2_prog_map_thresh5_min_pre_counts
VHLx3arLD2_prog_map_thresh5_max_pre_counts = max(VHLx3arLD2_prog_map_thresh5_df$pre)
VHLx3arLD2_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx3arLD2_prog_map_thresh5_post_count = length(VHLx3arLD2_prog_map_thresh5_df$post)
VHLx3arLD2_prog_map_thresh5_post_count
VHLx3arLD2_prog_map_thresh5_min_post_counts = min(VHLx3arLD2_prog_map_thresh5_df$post)
VHLx3arLD2_prog_map_thresh5_min_post_counts
VHLx3arLD2_prog_map_thresh5_max_post_counts = max(VHLx3arLD2_prog_map_thresh5_df$post)
VHLx3arLD2_prog_map_thresh5_max_post_counts
VHLx3arLD2_prog_map_thresh5_corr_post_count = length(VHLx3arLD2_cSNV_all_df$corr_post)
VHLx3arLD2_prog_map_thresh5_corr_post_count
VHLx3arLD2_prog_map_thresh5_min_corr_post_counts = min(VHLx3arLD2_cSNV_all_df$corr_post)
VHLx3arLD2_prog_map_thresh5_min_corr_post_counts
VHLx3arLD2_prog_map_thresh5_max_corr_post_counts = max(VHLx3arLD2_cSNV_all_df$corr_post)
VHLx3arLD2_prog_map_thresh5_max_corr_post_counts

VHLx3arLD2_pSNV_thresh5 <- which(VHLx3arLD2[,VHLx3a_p_hdr_snv]=='True' & as.numeric(as.character(VHLx3arLD2[,'pre_freq']))>=0.00001)
VHLx3arLD2_pSNV_thresh5_df = VHLx3arLD2[VHLx3arLD2_pSNV_thresh5,]
VHLx3arLD2_pSNV_thresh5_lib_count = length(VHLx3arLD2_pSNV_thresh5_df$lib)
VHLx3arLD2_pSNV_thresh5_lib_count
VHLx3arLD2_pSNV_thresh5_min_lib_counts = min(VHLx3arLD2_pSNV_thresh5_df$lib)
VHLx3arLD2_pSNV_thresh5_min_lib_counts
VHLx3arLD2_pSNV_thresh5_max_lib_counts = max(VHLx3arLD2_pSNV_thresh5_df$lib)
VHLx3arLD2_pSNV_thresh5_max_lib_counts
VHLx3arLD2_pSNV_thresh5_pre_count = length(VHLx3arLD2_pSNV_thresh5_df$pre)
VHLx3arLD2_pSNV_thresh5_pre_count
VHLx3arLD2_pSNV_thresh5_min_pre_counts = min(VHLx3arLD2_pSNV_thresh5_df$pre)
VHLx3arLD2_pSNV_thresh5_min_pre_counts
VHLx3arLD2_pSNV_thresh5_max_pre_counts = max(VHLx3arLD2_pSNV_thresh5_df$pre)
VHLx3arLD2_pSNV_thresh5_max_pre_counts
VHLx3arLD2_pSNV_thresh5_post_count = length(VHLx3arLD2_pSNV_thresh5_df$post)
VHLx3arLD2_pSNV_thresh5_post_count
VHLx3arLD2_pSNV_thresh5_min_post_counts = min(VHLx3arLD2_pSNV_thresh5_df$post)
VHLx3arLD2_pSNV_thresh5_min_post_counts
VHLx3arLD2_pSNV_thresh5_max_post_counts = max(VHLx3arLD2_pSNV_thresh5_df$post)
VHLx3arLD2_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx3arLD1_prog_var_thresh5_df:
VHLx3arLD1_prog_var_thresh5_df_rLD2_int <- VHLx3arLD1_prog_var_thresh5_df[which(VHLx3arLD1_prog_var_thresh5_df$variant %in% VHLx3arLD2_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx3arLD2_prog_var_thresh5_df:
VHLx3arLD2_prog_var_thresh5_df_rLD1_int <- VHLx3arLD2_prog_var_thresh5_df[which(VHLx3arLD2_prog_var_thresh5_df$variant %in% VHLx3arLD1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int[order(VHLx3arLD1_prog_var_thresh5_df_rLD2_int$variant),]
VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int[order(VHLx3arLD2_prog_var_thresh5_df_rLD1_int$variant),]
dim(VHLx3arLD1_prog_var_thresh5_df)[1] #Number of prog_vars in rLD1
VHLx3arLD1rLD2int_prog_var_thresh5_pre_count <- dim(VHLx3arLD1_prog_var_thresh5_df_rLD2_int)[1] 
VHLx3arLD1rLD2int_prog_var_thresh5_pre_count #Number of prog_vars in rLD1 also in rLD2
dim(VHLx3arLD2_prog_var_thresh5_df)[1] #Number of prog_vars in rLD2
dim(VHLx3arLD2_prog_var_thresh5_df_rLD1_int)[1] #Number of prog_vars in rLD2 also in rLD1

#Add the following columns from the from rLD2 df to the rLD1 df:
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$pre
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_lib <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$lib
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$rna
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2 <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post2
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3 <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post3
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2 <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$rna2
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$pre_pseudo
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post_pseudo
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pseudo <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pseudo
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pseudo <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pseudo
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pseudo <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pseudo
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_pseudo <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_pseudo
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$pre_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$rna_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post2_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post3_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$pre_pseudo_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post_pseudo_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pseudo_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pseudo_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pseudo_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pseudo_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pseudo_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pseudo_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_pseudo_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_pseudo_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$pre_lib_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post_pre_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post_lib_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pre_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pre_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_post_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$rna_post_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pre_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pre_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pre_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_post_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_snv_error_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$pre_snv_error_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_snv_error_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$post_snv_error_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_exp_snv_error_reads_pre <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$exp_snv_error_reads_pre
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_exp_snv_error_reads_post <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$exp_snv_error_reads_post
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pre <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pre
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_post <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$corr_post
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pre_pseudo <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pre_pseudo
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_post_pseudo <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$corr_post_pseudo
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pseudo_post_pre_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pseudo_post_pre_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_lib <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_lib
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2 <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3 <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2 <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre_pseudo_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pseudo_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_pseudo_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pseudo_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_pseudo_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pseudo_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2_pseudo_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pseudo_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3_pseudo_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_pseudo_freq <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2_pseudo_freq
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre_lib_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_pre_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_lib_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_pre_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_post_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2_pre_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pre_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3_pre_ratio
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio <- VHLx3arLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio) + log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio))/2)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio) + log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio))/2)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio) + log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio))/2)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio) + log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio))/2)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post3_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post3_pre_ratio) + log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pre_ratio))/2)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rna2_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rna2_post_ratio) + log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio))/2)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio) + log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio))/2)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio) + log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio))/2)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio) + log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio))/2)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio) + log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio))/2)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio) + log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio))/2)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio) + log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio))/2)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post3_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post3_pre_ratio) + log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pre_ratio))/2)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio) + log2(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_pre_weighted <- ((VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq*VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq/(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq))+(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq*VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq/(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)))/VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq
#rLD1 pre-freq weighting coefficient (rLD1_pre-freq / (rLD1 + rLD2 pre-freq's))
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq/(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq/(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)
#this will be weighted by denominator:  (rLD1_pof/rLD1_prf)(rLD1_prwc)+(rLD2_pof/rLD2_prf)*(rLD2_prwc)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted <- (VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_pseudo_freq/VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq)*(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight)+(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq/VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)*(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight)
#this will be weighted by denominator:  (rLD1_pof/lif')*(rLD1_prwc)+(rLD2_pof/lif)*(rLD2_prwc)
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_pre_weighted <- (VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_pseudo_freq/VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq)*(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight)+(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq/VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq)*(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight)
#rLD1 tHDR_pre-freq weighting coefficient (rLD1_tHDR_pre-freq / (rLD1 + rLD2 pre-freq's))
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_weight <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq/(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq+VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)
#rLD2 tHDR_pre-freq weighting coefficient
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_weight <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq/(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq+VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rLD1_pof/rLD1_prf)(rLD1_prwc)+(rLD2_pof/rLD2_prf)*(rLD2_prwc)
#tHDR_post_pre_ratio_rLD1rLD2_pre_weighted
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted <- (VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pseudo_freq/VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq)*(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_weight)+(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pseudo_freq/VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)*(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq)) >= 10) {
    VHLx3arLD1_cSNV_pre_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx3arLD1_cSNV_post_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx3arLD1_cSNV_post2_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx3arLD1_cSNV_post_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx3arLD1_tSNV_pre_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx3arLD1_tSNV_post_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx3arLD1_tSNV_post_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx3arLD1_tSNV_rna_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx3arLD1_tSNV_rna_post_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx3arLD1_tSNV_rna2_post_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx3arLD2_cSNV_pre_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_pre_lib_ratio)
VHLx3arLD2_cSNV_post_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post_pre_ratio)
VHLx3arLD2_cSNV_post2_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post2_pre_ratio)

VHLx3arLD2_cSNV_post_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post_lib_ratio)
VHLx3arLD2_tSNV_pre_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_pre_lib_ratio)
VHLx3arLD2_tSNV_post_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post_pre_ratio)
VHLx3arLD2_tSNV_post2_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post2_pre_ratio)
VHLx3arLD2_tSNV_post_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post_lib_ratio)
VHLx3arLD2_tSNV_rna_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna_pre_ratio)
VHLx3arLD2_tSNV_rna_post_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna_post_ratio)
VHLx3arLD2_tSNV_rna2_post_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna2_post_ratio)
VHLx3arLD1rLD2a_cSNV_pre_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_cSNV_post_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_cSNV_post2_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_cSNV_post_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_tSNV_pre_lib_med <- 
  median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_tSNV_post_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_tSNV_post2_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_tSNV_post_lib_med <-
  median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_tSNV_rna_pre_med <-
  median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_tSNV_rna_post_med <-
  median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_tSNV_rna2_post_med <-
  median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2pw_tSNV_post_pre_med  <-
  median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted)
VHLx3arLD1rLD2pw_cSNV_post_pre_med  <-
  median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLD1rLD2_pre_weighted)
  } else {
  VHLx3arLD1_cSNV_pre_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio)
VHLx3arLD1_cSNV_post_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio)
VHLx3arLD1_cSNV_post2_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio)
VHLx3arLD1_cSNV_post_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio)
VHLx3arLD1_tSNV_pre_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio)
VHLx3arLD1_tSNV_post_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio)
VHLx3arLD1_tSNV_post_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio)
VHLx3arLD1_tSNV_rna_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio)
VHLx3arLD1_tSNV_rna_post_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio)
VHLx3arLD1_tSNV_rna2_post_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio)
VHLx3arLD2_cSNV_pre_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio)
VHLx3arLD2_cSNV_post_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio)
VHLx3arLD2_cSNV_post2_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio)

VHLx3arLD2_cSNV_post_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio)
VHLx3arLD2_tSNV_pre_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio)
VHLx3arLD2_tSNV_post_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio)
VHLx3arLD2_tSNV_post2_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio)
VHLx3arLD2_tSNV_post_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio)
VHLx3arLD2_tSNV_rna_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio)
VHLx3arLD2_tSNV_rna_post_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio)
VHLx3arLD2_tSNV_rna2_post_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio)
VHLx3arLD1rLD2a_cSNV_pre_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_cSNV_post_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_cSNV_post2_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_cSNV_post_lib_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_tSNV_pre_lib_med <- 
  median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_tSNV_post_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_tSNV_post2_pre_med <- median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_tSNV_post_lib_med <-
  median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_tSNV_rna_pre_med <-
  median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_tSNV_rna_post_med <-
  median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2a_tSNV_rna2_post_med <-
  median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean)
VHLx3arLD1rLD2pw_tSNV_post_pre_med  <-
  median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted)
VHLx3arLD1rLD2pw_cSNV_post_pre_med  <-
  median(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted)
}

VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio/VHLx3arLD1_cSNV_pre_lib_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio/VHLx3arLD1_cSNV_post_pre_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio/VHLx3arLD1_cSNV_post_lib_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio/VHLx3arLD1_cSNV_post2_pre_med

VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio/VHLx3arLD1_tSNV_pre_lib_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio/VHLx3arLD1_tSNV_post_pre_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio/VHLx3arLD1_tSNV_post_lib_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio/VHLx3arLD1_tSNV_rna_pre_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio/VHLx3arLD1_tSNV_rna_post_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio/VHLx3arLD2_tSNV_post2_pre_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio/VHLx3arLD1_tSNV_rna2_post_med

VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio/VHLx3arLD2_cSNV_pre_lib_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio/VHLx3arLD2_cSNV_post_pre_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio/VHLx3arLD2_cSNV_post_lib_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio/VHLx3arLD1rLD2a_cSNV_post2_pre_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio/VHLx3arLD2_tSNV_rna2_post_med


VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio/VHLx3arLD2_tSNV_pre_lib_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio/VHLx3arLD2_tSNV_post_pre_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio/VHLx3arLD2_tSNV_post2_pre_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio/VHLx3arLD2_tSNV_post_lib_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio/VHLx3arLD2_tSNV_rna_pre_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio/VHLx3arLD2_tSNV_rna_post_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio/VHLx3arLD2_tSNV_rna2_post_med

###normalize the means
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean/VHLx3arLD1rLD2a_cSNV_pre_lib_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean/VHLx3arLD1rLD2a_cSNV_post_pre_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean/VHLx3arLD1rLD2a_cSNV_post_lib_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean/VHLx3arLD1rLD2a_tSNV_pre_lib_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean/VHLx3arLD1rLD2a_tSNV_post_pre_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean/VHLx3arLD1rLD2a_tSNV_post2_pre_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean/VHLx3arLD1rLD2a_tSNV_post_lib_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean/VHLx3arLD1rLD2a_tSNV_rna_pre_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean/VHLx3arLD1rLD2a_tSNV_rna_post_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean/VHLx3arLD1rLD2a_tSNV_rna2_post_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted/VHLx3arLD1rLD2pw_tSNV_post_pre_med
VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm <- VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted/VHLx3arLD1rLD2pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord
VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord = which(VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[,'pos']!='REF')
VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df = VHLx3arLD1_prog_var_thresh5_df_rLD2_int_ord[VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord,]
VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord = which(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'cDNApos']!='REF' & VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'cDNApos']!='NA')
VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df = VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df[VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord,]
VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord = which(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'CADD.phred']!='NA')
VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df = VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df[VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord,]
VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense <- VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df[which(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx3arLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s
VHLx3arLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_p <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='pearson')
VHLx3arLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_p
VHLx3arLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s
VHLx3arLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_p <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='pearson')
VHLx3arLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_p
VHLx3arLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post2_pre_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s
VHLx3arLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_p <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post2_pre_ratio_synnorm),method='pearson')
VHLx3arLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_p
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_s <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_s
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_p <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_p
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_s <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_s
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_p <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_p
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_s <- cor(log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_s
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_p <- cor(log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_p
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_s <- cor(log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_s
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_p <- cor(log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx3arLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_p
VHLx3arLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_s <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_freq),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_freq),method='spearman')
VHLx3arLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_s
VHLx3arLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_p <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pseudo_freq),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pseudo_freq),method='pearson')
VHLx3arLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_p
VHLx3arLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_s <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_s
VHLx3arLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_p <-cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio_synnorm),method='pearson')
VHLx3arLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_p
VHLx3arLD1rLD2_tSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_tSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s
VHLx3arLD1rLD2_tSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_tSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s
VHLx3arLD1rLD2_tSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_tSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s
VHLx3arLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s
VHLx3arLD1rLD2_tSNV_rLD1_rna2_post_by_rLD2_rna2_post_cor_s <- cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_tSNV_rLD1_rna2_post_by_rLD2_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx3arLD1_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1_cSNV_post_pre_by_cadd_cor_s
VHLx3arLD2_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD2_cSNV_post_pre_by_cadd_cor_s
VHLx3arLD1_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1_cSNV_post_lib_by_cadd_cor_s
VHLx3arLD2_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD2_cSNV_post_lib_by_cadd_cor_s
VHLx3arLD1_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1_tSNV_post_pre_by_cadd_cor_s
VHLx3arLD2_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD2_tSNV_post_pre_by_cadd_cor_s
VHLx3arLD1_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1_tSNV_post_lib_by_cadd_cor_s
VHLx3arLD2_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx3arLD1rLD2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2a_cSNV_pre_lib_by_cadd_cor_s
VHLx3arLD1rLD2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2w_cSNV_pre_lib_by_cadd_cor_s
VHLx3arLD1rLD2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2a_cSNV_post_pre_by_cadd_cor_s
VHLx3arLD1rLD2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2w_cSNV_post_pre_by_cadd_cor_s
VHLx3arLD1rLD2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2a_cSNV_post_lib_by_cadd_cor_s
VHLx3arLD1rLD2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2w_cSNV_post_lib_by_cadd_cor_s
VHLx3arLD1rLD2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2a_tSNV_pre_lib_by_cadd_cor_s
VHLx3arLD1rLD2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2a_tSNV_post_pre_by_cadd_cor_s
VHLx3arLD1rLD2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2w_tSNV_post_pre_by_cadd_cor_s
VHLx3arLD1rLD2a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post2_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2a_tSNV_post2_pre_by_cadd_cor_s
VHLx3arLD1rLD2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx3arLD1_cSNV_pre_lib_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3arLD1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3arLD1_tSNV_pre_lib_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arLD1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arLD1_cSNV_post_lib_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3arLD1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx3arLD1_tSNV_post_lib_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arLD1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx3arLD1_cSNV_post_pre_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx3arLD1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3arLD1_tSNV_post_pre_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx3arLD1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arLD1_cSNV_rna_lib_cors = cor(log2(VHLx3arLD1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx3arLD1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3arLD1_tSNV_rna_lib_cors = cor(log2(VHLx3arLD1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arLD1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx3arLD1_cSNV_rna_pre_cors = cor(log2(VHLx3arLD1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx3arLD1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3arLD1_tSNV_rna_pre_cors = cor(log2(VHLx3arLD1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx3arLD1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arLD1rLD2_cSNV_pre_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_freq),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_freq),method='spearman')
VHLx3arLD1rLD2_tSNV_pre_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_pseudo_freq),method='spearman')
VHLx3arLD1rLD2_cSNV_pre_lib_ratio_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio),method='spearman')
VHLx3arLD1rLD2_tSNV_pre_lib_ratio_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio),method='spearman')
VHLx3arLD1rLD2_cSNV_post_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_freq),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_freq),method='spearman')
VHLx3arLD1rLD2_tSNV_post_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pseudo_freq),method='spearman')
VHLx3arLD1rLD2_cSNV_post_lib_ratio_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_tSNV_post_lib_ratio_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_cSNV_post_pre_ratio_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_tSNV_post_pre_ratio_cors = cor(log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_cSNV_rna_cors = cor(log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rna_freq),log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_rna_freq),method='spearman')
VHLx3arLD1rLD2_tSNV_rna_cors = cor(log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pseudo_freq),method='spearman')
VHLx3arLD1rLD2_tSNV_rna_pre_ratio_cors = cor(log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3arLD1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLD1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLD1_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLD1_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLD1_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLD1_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLD1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arLD1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arLD1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arLD1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arLD1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx3arLD1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx3arLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx3arLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx3arLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLD1rLD2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')

VHLx3arLD1_cors <- c("VHLx3arLD1",VHLx3arLD1_cSNV_pre_lib_cors,VHLx3arLD1_tSNV_pre_lib_cors,VHLx3arLD1_cSNV_post_lib_cors,VHLx3arLD1_tSNV_post_lib_cors,VHLx3arLD1_cSNV_post_pre_cors,VHLx3arLD1_tSNV_post_pre_cors,VHLx3arLD1_cSNV_rna_lib_cors,VHLx3arLD1_tSNV_rna_lib_cors,VHLx3arLD1_cSNV_rna_pre_cors,VHLx3arLD1_tSNV_rna_pre_cors,VHLx3arLD1rLD2_cSNV_pre_cors,VHLx3arLD1rLD2_tSNV_pre_cors,VHLx3arLD1rLD2_cSNV_pre_lib_ratio_cors,VHLx3arLD1rLD2_tSNV_pre_lib_ratio_cors,VHLx3arLD1rLD2_cSNV_post_cors,VHLx3arLD1rLD2_tSNV_post_cors,VHLx3arLD1rLD2_cSNV_post_lib_ratio_cors,VHLx3arLD1rLD2_tSNV_post_lib_ratio_cors,VHLx3arLD1rLD2_cSNV_post_pre_ratio_cors,VHLx3arLD1rLD2_tSNV_post_pre_ratio_cors,VHLx3arLD1rLD2_cSNV_rna_cors,VHLx3arLD1rLD2_tSNV_rna_cors,VHLx3arLD1rLD2_tSNV_rna_pre_ratio_cors,VHLx3arLD1_cSNV_pre_lib_ratio_cadd_cors,VHLx3arLD1_tSNV_pre_lib_ratio_cadd_cors,VHLx3arLD1_cSNV_post_lib_ratio_cadd_cors,VHLx3arLD1_tSNV_post_lib_ratio_cadd_cors,VHLx3arLD1_cSNV_post_pre_ratio_cadd_cors,VHLx3arLD1_tSNV_post_pre_ratio_cadd_cors,VHLx3arLD1_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLD1_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLD1_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLD1_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLD1_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLD1_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors,VHLx3arLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors,VHLx3arLD1rLD2a_cSNV_post_lib_ratio_cadd_cors,VHLx3arLD1rLD2a_tSNV_post_lib_ratio_cadd_cors,VHLx3arLD1rLD2a_cSNV_post_pre_ratio_cadd_cors,VHLx3arLD1rLD2a_tSNV_post_pre_ratio_cadd_cors,VHLx3arLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors,VHLx3arLD1rLD2w_cSNV_post_lib_ratio_cadd_cors,VHLx3arLD1rLD2w_cSNV_post_pre_ratio_cadd_cors,VHLx3arLD1rLD2w_tSNV_post_pre_ratio_cadd_cors)

VHLx3arLD2_cSNV_pre_lib_cors = cor(log2(VHLx3arLD2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3arLD2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3arLD2_tSNV_pre_lib_cors = cor(log2(VHLx3arLD2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arLD2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arLD2_cSNV_post_lib_cors = cor(log2(VHLx3arLD2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3arLD2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx3arLD2_tSNV_post_lib_cors = cor(log2(VHLx3arLD2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arLD2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx3arLD2_cSNV_post_pre_cors = cor(log2(VHLx3arLD2_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx3arLD2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3arLD2_tSNV_post_pre_cors = cor(log2(VHLx3arLD2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx3arLD2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arLD2_cSNV_rna_lib_cors = cor(log2(VHLx3arLD2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx3arLD2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3arLD2_tSNV_rna_lib_cors = cor(log2(VHLx3arLD2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arLD2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx3arLD2_cSNV_rna_pre_cors = cor(log2(VHLx3arLD2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx3arLD2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3arLD2_tSNV_rna_pre_cors = cor(log2(VHLx3arLD2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx3arLD2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arLD2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arLD2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx3arLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLD2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arLD2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx3arLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLD2_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arLD2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx3arLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLD2_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arLD2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx3arLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLD2_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLD2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx3arLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLD2_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLD2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLD2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arLD2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arLD2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arLD2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arLD2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx3arLD2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')

VHLx3arLD2_cors <- c("VHLx3arLD2",VHLx3arLD2_cSNV_pre_lib_cors,VHLx3arLD2_tSNV_pre_lib_cors,VHLx3arLD2_cSNV_post_lib_cors,VHLx3arLD2_tSNV_post_lib_cors,VHLx3arLD2_cSNV_post_pre_cors,VHLx3arLD2_tSNV_post_pre_cors,VHLx3arLD2_cSNV_rna_lib_cors,VHLx3arLD2_tSNV_rna_lib_cors,VHLx3arLD2_cSNV_rna_pre_cors,VHLx3arLD2_tSNV_rna_pre_cors,VHLx3arLD1rLD2_cSNV_pre_cors,VHLx3arLD1rLD2_tSNV_pre_cors,VHLx3arLD1rLD2_cSNV_pre_lib_ratio_cors,VHLx3arLD1rLD2_tSNV_pre_lib_ratio_cors,VHLx3arLD1rLD2_cSNV_post_cors,VHLx3arLD1rLD2_tSNV_post_cors,VHLx3arLD1rLD2_cSNV_post_lib_ratio_cors,VHLx3arLD1rLD2_tSNV_post_lib_ratio_cors,VHLx3arLD1rLD2_cSNV_post_pre_ratio_cors,VHLx3arLD1rLD2_tSNV_post_pre_ratio_cors,VHLx3arLD1rLD2_cSNV_rna_cors,VHLx3arLD1rLD2_tSNV_rna_cors,VHLx3arLD1rLD2_tSNV_rna_pre_ratio_cors,VHLx3arLD2_cSNV_pre_lib_ratio_cadd_cors,VHLx3arLD2_tSNV_pre_lib_ratio_cadd_cors,VHLx3arLD2_cSNV_post_lib_ratio_cadd_cors,VHLx3arLD2_tSNV_post_lib_ratio_cadd_cors,VHLx3arLD2_cSNV_post_pre_ratio_cadd_cors,VHLx3arLD2_tSNV_post_pre_ratio_cadd_cors,VHLx3arLD2_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLD2_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLD2_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLD2_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLD2_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLD2_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors,VHLx3arLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors,VHLx3arLD1rLD2a_cSNV_post_lib_ratio_cadd_cors,VHLx3arLD1rLD2a_tSNV_post_lib_ratio_cadd_cors,VHLx3arLD1rLD2a_cSNV_post_pre_ratio_cadd_cors,VHLx3arLD1rLD2a_tSNV_post_pre_ratio_cadd_cors,VHLx3arLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors,VHLx3arLD1rLD2w_cSNV_post_lib_ratio_cadd_cors,VHLx3arLD1rLD2w_cSNV_post_pre_ratio_cadd_cors,VHLx3arLD1rLD2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx3arLD1)
rm(VHLx3arLD2)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx3arLD1
VHLx3a_posrange <- range(as.numeric(as.character(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$pos)))
VHLx3a_posseq <- seq(from=VHLx3a_posrange[1], to=VHLx3a_posrange[2])
VHLx3arLD1_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx3arLD1_tHDR_pre_lib_pred <- predict(VHLx3arLD1_tHDR_pre_lib_ratio.lo, newdata = VHLx3a_posseq, se=TRUE)
VHLx3arLD1_tHDR_pre_lib_pos_effects <- VHLx3arLD1_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx3arLD1_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx3arLD1_tHDR_pre_lib_pos_effects)
VHLx3arLD1_tHDR_pre_lib_pos_effects_ci <- VHLx3arLD1_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx3arLD1_tHDR_pre_lib_pred$df)
VHLx3arLD1_tHDR_pre_lib_pos_effects_ci_ymin = VHLx3arLD1_tHDR_pre_lib_pos_effects - VHLx3arLD1_tHDR_pre_lib_pos_effects_ci
VHLx3arLD1_tHDR_pre_lib_pos_effects_ci_ymax = VHLx3arLD1_tHDR_pre_lib_pos_effects + VHLx3arLD1_tHDR_pre_lib_pos_effects_ci
VHLx3arLD1_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx3a_posseq, VHLx3arLD1_tHDR_pre_lib_pos_effects, VHLx3arLD1_tHDR_pre_lib_pos_effects.x, VHLx3arLD1_tHDR_pre_lib_pos_effects_ci_ymin, VHLx3arLD1_tHDR_pre_lib_pos_effects_ci_ymax, VHLx3arLD1_tHDR_pre_lib_pred_se = VHLx3arLD1_tHDR_pre_lib_pred$se.fit)
#VHLx3arLD2
VHLx3arLD2_tHDR_pre_lib_ratio.lo <- loess(log2(rLD2_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx3arLD2_tHDR_pre_lib_pred <- predict(VHLx3arLD2_tHDR_pre_lib_ratio.lo, newdata = VHLx3a_posseq, se=TRUE)
VHLx3arLD2_tHDR_pre_lib_pos_effects <- VHLx3arLD2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx3arLD2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx3arLD2_tHDR_pre_lib_pos_effects)
VHLx3arLD2_tHDR_pre_lib_pos_effects_ci <- VHLx3arLD2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx3arLD2_tHDR_pre_lib_pred$df)
VHLx3arLD2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx3arLD2_tHDR_pre_lib_pos_effects - VHLx3arLD2_tHDR_pre_lib_pos_effects_ci
VHLx3arLD2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx3arLD2_tHDR_pre_lib_pos_effects + VHLx3arLD2_tHDR_pre_lib_pos_effects_ci
VHLx3arLD2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx3a_posseq, VHLx3arLD2_tHDR_pre_lib_pos_effects, VHLx3arLD2_tHDR_pre_lib_pos_effects.x, VHLx3arLD2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx3arLD2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx3arLD2_tHDR_pre_lib_pred_se = VHLx3arLD2_tHDR_pre_lib_pred$se.fit)

#VHLx3arLD1rLD2
VHLx3arLD1rLD2_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm > 0.7 & VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm > 0.3 & VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx3arLD1rLD2_tHDR_pre_lib_pred <- predict(VHLx3arLD1rLD2_tHDR_pre_lib_ratio.lo, newdata = VHLx3a_posseq, se=TRUE)
VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects <- VHLx3arLD1rLD2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects)
VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects_ci <- VHLx3arLD1rLD2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx3arLD1rLD2_tHDR_pre_lib_pred$df)
VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects - VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects_ci
VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects + VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects_ci
VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx3a_posseq, VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects, VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects.x, VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx3arLD1rLD2_tHDR_pre_lib_pred_se = VHLx3arLD1rLD2_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rLD1, rLD2, rLD1rLD2)
VHLx3arLD_tHDR_pos_merge_df <- VHLx3arLD1_prog_map_thresh5_df_rLD2_int_ord_df 
VHLx3arLD_tHDR_pos_merge_df <- merge(VHLx3arLD_tHDR_pos_merge_df, VHLx3arLD1_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx3arLD1_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx3arLD_tHDR_pos_merge_df <- merge(VHLx3arLD_tHDR_pos_merge_df, VHLx3arLD2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx3arLD2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx3arLD_tHDR_pos_merge_df <- merge(VHLx3arLD_tHDR_pos_merge_df, VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx3arLD_tHDR_pos_merge_df <- VHLx3arLD_tHDR_pos_merge_df %>% 
  rename(
    rLD1_tHDR_pre_lib_pos_effects.x = VHLx3arLD1_tHDR_pre_lib_pos_effects.x,
    rLD2_tHDR_pre_lib_pos_effects.x = VHLx3arLD2_tHDR_pre_lib_pos_effects.x,
    rLD1rLD2_tHDR_pre_lib_pos_effects.x = VHLx3arLD1rLD2_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rLD1 vs. rLD1_fit and vs. mean_fit)
VHLx3arLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1 <- log2(VHLx3arLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx3arLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_pos_effects.x
VHLx3arLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx3arLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx3arLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx3arLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2 <- log2(VHLx3arLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_ratio_synnorm) - VHLx3arLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_pos_effects.x
VHLx3arLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx3arLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_ratio_synnorm) - VHLx3arLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx3arLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx3arLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm) - VHLx3arLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx3arLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_loess_rLD1 <- log2(VHLx3arLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx3arLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_pos_effects.x
VHLx3arLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx3arLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx3arLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx3arLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_loess_rLD2 <- log2(VHLx3arLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_ratio_synnorm) - VHLx3arLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_pos_effects.x
VHLx3arLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx3arLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_ratio_synnorm) - VHLx3arLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx3arLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx3arLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm) - VHLx3arLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rLD1 and rLD2 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx3arLD_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx3arLD_tHDR_post_lib_loess_median_syn_rLD1 <- median(VHLx3arLD_tHDR_pos_merge_df[which(VHLx3arLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLD1_tHDR_post_lib_loess_rLD1')])
  VHLx3arLD_tHDR_post_lib_loess_median_syn_rLD2 <- median(VHLx3arLD_tHDR_pos_merge_df[which(VHLx3arLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLD2_tHDR_post_lib_loess_rLD2')])
  } else {
  VHLx3arLD_tHDR_post_lib_loess_median_syn_rLD1 <- median(VHLx3arLD_tHDR_pos_merge_df[which(VHLx3arLD_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLD1_tHDR_post_lib_loess_rLD1')])
  VHLx3arLD_tHDR_post_lib_loess_median_syn_rLD2 <- median(VHLx3arLD_tHDR_pos_merge_df[which(VHLx3arLD_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLD2_tHDR_post_lib_loess_rLD2')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rLD1 'e.sns' = exon syn/ns norm.
VHLx3arLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1_e.sns <- (VHLx3arLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1-VHLx3arLD_tHDR_post_lib_loess_median_syn_rLD1)
#calculate new b values for rLD2 'e.sns' = exon syn/ns norm.
VHLx3arLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2_e.sns <- (VHLx3arLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2-VHLx3arLD_tHDR_post_lib_loess_median_syn_rLD2)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx3arLD_tHDR_pos_merge_df$rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean <- (VHLx3arLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1_e.sns+VHLx3arLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx3arLD_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx3arLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_syn_median <- median(VHLx3arLD_tHDR_pos_merge_df[which(VHLx3arLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('VHLx3arLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean')])
  } else {
  VHLx3arLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_syn_median <- median(VHLx3arLD_tHDR_pos_merge_df[which(VHLx3arLD_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('VHLx3arLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean')])
}

#RNA analysis
VHLx3arLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s <- cor(log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3arLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1_tHDR_rna2_rna_ratio <- VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_pseudo_freq/VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pseudo_freq
VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_rna_ratio <- VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_pseudo_freq/VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pseudo_freq
VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1rLD2_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1_tHDR_rna2_rna_ratio)+log2(VHLx3arLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_rna_ratio))/2

```
```{r}
VHLx3brLD1_file <- paste(experiment_dir_220511,'VHLx3brL43','_annotated.txt',sep='')
VHLx3brLD2_file <- paste(experiment_dir_220511,'VHLx3brL44','_annotated.txt',sep='')
VHLx3brLD1 <- read.table(VHLx3brLD1_file, header=TRUE, sep="\t")
VHLx3brLD2 <- read.table(VHLx3brLD2_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx3brLD1 <- VHLx3brLD1 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )
VHLx3brLD2 <- VHLx3brLD2 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx3b <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx3b'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx3b_HDR_5_SNV = as.character(VHL_editing_info_VHLx3b$HDR_5_SNV)
VHLx3b_HDR_3_SNV = as.character(VHL_editing_info_VHLx3b$HDR_3_SNV)
#VHLx3b_cut_pos = as.character(VHL_editing_info_VHLx3b$cut_pos)
VHLx3b_cut_end = as.character(VHL_editing_info_VHLx3b$cut_end)
VHLx3b_mut_start = as.character(VHL_editing_info_VHLx3b$mut_start)
VHLx3b_mut_end = as.character(VHL_editing_info_VHLx3b$mut_end)

### Replicate 1
VHLx3brLD1_cSNV_all <- which(VHLx3brLD1[,'c_hdr_snv']=='True')
VHLx3brLD1_cSNV_all_df = VHLx3brLD1[VHLx3brLD1_cSNV_all,]
VHLx3brLD1_prog_var_all <- which(VHLx3brLD1[,'all_hdr_variant']=='True' & VHLx3brLD1[,'edit_string']!='-WT')
VHLx3brLD1_prog_var_all_df = VHLx3brLD1[VHLx3brLD1_prog_var_all,]
VHLx3brLD1_prog_map_all = which(VHLx3brLD1_prog_var_all_df[,'pos']!='REF')
VHLx3brLD1_prog_map_all_df = VHLx3brLD1_prog_var_all_df[VHLx3brLD1_prog_map_all,]
VHLx3brLD1_prog_map_exon_all = which(VHLx3brLD1_prog_map_all_df[,'cDNApos']!='REF' & VHLx3brLD1_prog_map_all_df[,'cDNApos']!='NA')
VHLx3brLD1_prog_map_exon_all_df = VHLx3brLD1_prog_map_all_df[VHLx3brLD1_prog_map_exon_all,]
VHLx3brLD1_prog_map_CADD = which(VHLx3brLD1_prog_map_all_df[,'CADD.phred']!='NA')
VHLx3brLD1_prog_map_CADD_df = VHLx3brLD1_prog_map_all_df[VHLx3brLD1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx3brLD1_prog_var_thresh5 <- which(as.numeric(as.character(VHLx3brLD1_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx3brLD1_prog_var_thresh5_df = VHLx3brLD1_prog_var_all_df[VHLx3brLD1_prog_var_thresh5,]
VHLx3brLD1_prog_map_thresh5 <- which(as.numeric(as.character(VHLx3brLD1_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx3brLD1_prog_map_thresh5_df = VHLx3brLD1_prog_map_all_df[VHLx3brLD1_prog_map_thresh5,]
VHLx3brLD1_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx3brLD1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx3brLD1_prog_map_exon_thresh5_df = VHLx3brLD1_prog_map_exon_all_df[VHLx3brLD1_prog_map_exon_thresh5,]
VHLx3brLD1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx3brLD1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx3brLD1_prog_map_CADD_thresh5_df = VHLx3brLD1_prog_map_CADD_df[VHLx3brLD1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx3brLD1_prog_var_all_lib_count = length(VHLx3brLD1_prog_var_all_df$lib)
VHLx3brLD1_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx3brLD1_prog_var_all_min_lib_counts = min(VHLx3brLD1_prog_var_all_df$lib)
VHLx3brLD1_prog_var_all_min_lib_counts
VHLx3brLD1_prog_var_all_max_lib_counts = max(VHLx3brLD1_prog_var_all_df$lib)
VHLx3brLD1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx3brLD1_prog_map_all_lib_count = length(VHLx3brLD1_prog_map_all_df$lib)
VHLx3brLD1_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx3brLD1_prog_map_all_min_lib_counts = min(VHLx3brLD1_prog_map_all_df$lib)
VHLx3brLD1_prog_map_all_min_lib_counts
VHLx3brLD1_prog_map_all_max_lib_counts = max(VHLx3brLD1_prog_map_all_df$lib)
VHLx3brLD1_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx3brLD1_prog_var_all_pre_count = length(VHLx3brLD1_prog_var_all_df$pre)
VHLx3brLD1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx3brLD1_prog_var_all_min_pre_counts = min(VHLx3brLD1_prog_var_all_df$pre)
VHLx3brLD1_prog_var_all_min_pre_counts
VHLx3brLD1_prog_var_all_max_pre_counts = max(VHLx3brLD1_prog_var_all_df$pre)
VHLx3brLD1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx3brLD1_prog_map_all_pre_count = length(VHLx3brLD1_prog_map_all_df$pre)
VHLx3brLD1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx3brLD1_prog_map_all_min_pre_counts = min(VHLx3brLD1_prog_map_all_df$pre)
VHLx3brLD1_prog_map_all_min_pre_counts
VHLx3brLD1_prog_map_all_max_pre_counts = max(VHLx3brLD1_prog_map_all_df$pre)
VHLx3brLD1_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx3brLD1_prog_map_all_post_count = length(VHLx3brLD1_prog_map_all_df$post)
VHLx3brLD1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx3brLD1_prog_map_all_min_post_counts = min(VHLx3brLD1_prog_map_all_df$post)
VHLx3brLD1_prog_map_all_min_post_counts
VHLx3brLD1_prog_map_all_max_post_counts = max(VHLx3brLD1_prog_map_all_df$post)
VHLx3brLD1_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx3brLD1_prog_map_all_syn_df <- VHLx3brLD1_prog_map_all_df[which(VHLx3brLD1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx3brLD1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx3brLD1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx3brLD1_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx3brLD1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx3brLD1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx3brLD1_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx3brLD1_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx3brLD1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx3brLD1_prog_map_all_min_rna_counts = min(VHLx3brLD1_prog_map_exon_all_df$tHDR_rna)
VHLx3brLD1_prog_map_all_min_rna_counts
VHLx3brLD1_prog_map_all_max_rna_counts = max(VHLx3brLD1_prog_map_exon_all_df$tHDR_rna)
VHLx3brLD1_prog_map_all_max_rna_counts
VHLx3brLD1_prog_map_all_min_rna_pseudo_freq = min(VHLx3brLD1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3brLD1_prog_map_all_min_rna_pseudo_freq
VHLx3brLD1_prog_map_all_max_rna_pseudo_freq = max(VHLx3brLD1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3brLD1_prog_map_all_max_rna_pseudo_freq
VHLx3brLD1_prog_map_all_min_rna_pre_ratio = min(VHLx3brLD1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3brLD1_prog_map_all_min_rna_pre_ratio
VHLx3brLD1_prog_map_all_max_rna_pre_ratio = max(VHLx3brLD1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3brLD1_prog_map_all_max_rna_pre_ratio
VHLx3brLD1_prog_map_all_min_rna_post_ratio = min(VHLx3brLD1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3brLD1_prog_map_all_min_rna_post_ratio
VHLx3brLD1_prog_map_all_max_rna_post_ratio = max(VHLx3brLD1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3brLD1_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx3brLD1_cSNV_all_corr_pre_count = length(VHLx3brLD1_cSNV_all_df$corr_pre)
VHLx3brLD1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx3brLD1_cSNV_all_min_corr_pre_counts = min(VHLx3brLD1_cSNV_all_df$corr_pre)
VHLx3brLD1_cSNV_all_min_corr_pre_counts
VHLx3brLD1_cSNV_all_max_corr_pre_counts = max(VHLx3brLD1_cSNV_all_df$corr_pre)
VHLx3brLD1_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brLD1_cSNV_all_corr_post_count = length(VHLx3brLD1_cSNV_all_df$corr_post)
VHLx3brLD1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx3brLD1_cSNV_all_min_corr_post_counts = min(VHLx3brLD1_cSNV_all_df$corr_post)
VHLx3brLD1_cSNV_all_min_corr_post_counts
VHLx3brLD1_cSNV_all_max_corr_post_counts = max(VHLx3brLD1_cSNV_all_df$corr_post)
VHLx3brLD1_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx3b_p_hdr_snv = paste('p_hdr_',VHLx3b_cut_end,'_snv',sep='')
VHLx3brLD1_pSNV_all <- which(VHLx3brLD1[,VHLx3b_p_hdr_snv]=='True')
VHLx3brLD1_pSNV_all_df = VHLx3brLD1[VHLx3brLD1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brLD1_pSNV_all_lib_count = length(VHLx3brLD1_pSNV_all_df$lib)
VHLx3brLD1_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx3brLD1_pSNV_all_min_lib_counts = min(VHLx3brLD1_pSNV_all_df$lib)
VHLx3brLD1_pSNV_all_min_lib_counts
VHLx3brLD1_pSNV_all_max_lib_counts = max(VHLx3brLD1_pSNV_all_df$lib)
VHLx3brLD1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx3brLD1_pSNV_all_pre_count = length(VHLx3brLD1_pSNV_all_df$pre)
VHLx3brLD1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx3brLD1_pSNV_all_min_pre_counts = min(VHLx3brLD1_pSNV_all_df$pre)
VHLx3brLD1_pSNV_all_min_pre_counts
VHLx3brLD1_pSNV_all_max_pre_counts = max(VHLx3brLD1_pSNV_all_df$pre)
VHLx3brLD1_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brLD1_pSNV_all_post_count = length(VHLx3brLD1_pSNV_all_df$post)
VHLx3brLD1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx3brLD1_pSNV_all_min_post_counts = min(VHLx3brLD1_pSNV_all_df$post)
VHLx3brLD1_pSNV_all_min_post_counts
VHLx3brLD1_pSNV_all_max_post_counts = max(VHLx3brLD1_pSNV_all_df$post)
VHLx3brLD1_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brLD1_prog_map_thresh5_lib_count = length(VHLx3brLD1_prog_map_thresh5_df$lib)
VHLx3brLD1_prog_map_thresh5_lib_count
VHLx3brLD1_prog_map_thresh5_min_lib_counts = min(VHLx3brLD1_prog_map_thresh5_df$lib)
VHLx3brLD1_prog_map_thresh5_min_lib_counts
VHLx3brLD1_prog_map_thresh5_max_lib_counts = max(VHLx3brLD1_prog_map_thresh5_df$lib)
VHLx3brLD1_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brLD1_prog_map_thresh5_pre_count = length(VHLx3brLD1_prog_map_thresh5_df$pre)
VHLx3brLD1_prog_map_thresh5_pre_count
VHLx3brLD1_prog_map_thresh5_min_pre_counts = min(VHLx3brLD1_prog_map_thresh5_df$pre)
VHLx3brLD1_prog_map_thresh5_min_pre_counts
VHLx3brLD1_prog_map_thresh5_max_pre_counts = max(VHLx3brLD1_prog_map_thresh5_df$pre)
VHLx3brLD1_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx3brLD1_prog_map_thresh5_post_count = length(VHLx3brLD1_prog_map_thresh5_df$post)
VHLx3brLD1_prog_map_thresh5_post_count
VHLx3brLD1_prog_map_thresh5_min_post_counts = min(VHLx3brLD1_prog_map_thresh5_df$post)
VHLx3brLD1_prog_map_thresh5_min_post_counts
VHLx3brLD1_prog_map_thresh5_max_post_counts = max(VHLx3brLD1_prog_map_thresh5_df$post)
VHLx3brLD1_prog_map_thresh5_max_post_counts
VHLx3brLD1_prog_map_thresh5_corr_post_count = length(VHLx3brLD1_cSNV_all_df$corr_post)
VHLx3brLD1_prog_map_thresh5_corr_post_count
VHLx3brLD1_prog_map_thresh5_min_corr_post_counts = min(VHLx3brLD1_cSNV_all_df$corr_post)
VHLx3brLD1_prog_map_thresh5_min_corr_post_counts
VHLx3brLD1_prog_map_thresh5_max_corr_post_counts = max(VHLx3brLD1_cSNV_all_df$corr_post)
VHLx3brLD1_prog_map_thresh5_max_corr_post_counts

VHLx3brLD1_pSNV_thresh5 <- which(VHLx3brLD1[,VHLx3b_p_hdr_snv]=='True' & as.numeric(as.character(VHLx3brLD1[,'pre_freq']))>=0.00001)
VHLx3brLD1_pSNV_thresh5_df = VHLx3brLD1[VHLx3brLD1_pSNV_thresh5,]
VHLx3brLD1_pSNV_thresh5_lib_count = length(VHLx3brLD1_pSNV_thresh5_df$lib)
VHLx3brLD1_pSNV_thresh5_lib_count
VHLx3brLD1_pSNV_thresh5_min_lib_counts = min(VHLx3brLD1_pSNV_thresh5_df$lib)
VHLx3brLD1_pSNV_thresh5_min_lib_counts
VHLx3brLD1_pSNV_thresh5_max_lib_counts = max(VHLx3brLD1_pSNV_thresh5_df$lib)
VHLx3brLD1_pSNV_thresh5_max_lib_counts
VHLx3brLD1_pSNV_thresh5_pre_count = length(VHLx3brLD1_pSNV_thresh5_df$pre)
VHLx3brLD1_pSNV_thresh5_pre_count
VHLx3brLD1_pSNV_thresh5_min_pre_counts = min(VHLx3brLD1_pSNV_thresh5_df$pre)
VHLx3brLD1_pSNV_thresh5_min_pre_counts
VHLx3brLD1_pSNV_thresh5_max_pre_counts = max(VHLx3brLD1_pSNV_thresh5_df$pre)
VHLx3brLD1_pSNV_thresh5_max_pre_counts
VHLx3brLD1_pSNV_thresh5_post_count = length(VHLx3brLD1_pSNV_thresh5_df$post)
VHLx3brLD1_pSNV_thresh5_post_count
VHLx3brLD1_pSNV_thresh5_min_post_counts = min(VHLx3brLD1_pSNV_thresh5_df$post)
VHLx3brLD1_pSNV_thresh5_min_post_counts
VHLx3brLD1_pSNV_thresh5_max_post_counts = max(VHLx3brLD1_pSNV_thresh5_df$post)
VHLx3brLD1_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx3brLD2_cSNV_all <- which(VHLx3brLD2[,'c_hdr_snv']=='True')
VHLx3brLD2_cSNV_all_df = VHLx3brLD2[VHLx3brLD2_cSNV_all,]
VHLx3brLD2_prog_var_all <- which(VHLx3brLD2[,'all_hdr_variant']=='True' & VHLx3brLD2[,'edit_string']!='-WT')
VHLx3brLD2_prog_var_all_df = VHLx3brLD2[VHLx3brLD2_prog_var_all,]
VHLx3brLD2_prog_map_all = which(VHLx3brLD2_prog_var_all_df[,'pos']!='REF')
VHLx3brLD2_prog_map_all_df = VHLx3brLD2_prog_var_all_df[VHLx3brLD2_prog_map_all,]
VHLx3brLD2_prog_map_exon_all = which(VHLx3brLD2_prog_map_all_df[,'cDNApos']!='REF' & VHLx3brLD2_prog_map_all_df[,'cDNApos']!='NA')
VHLx3brLD2_prog_map_exon_all_df = VHLx3brLD2_prog_map_all_df[VHLx3brLD2_prog_map_exon_all,]
VHLx3brLD2_prog_map_CADD = which(VHLx3brLD2_prog_map_all_df[,'CADD.phred']!='NA')
VHLx3brLD2_prog_map_CADD_df = VHLx3brLD2_prog_map_all_df[VHLx3brLD2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx3brLD2_prog_var_thresh5 <- which(as.numeric(as.character(VHLx3brLD2_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx3brLD2_prog_var_thresh5_df = VHLx3brLD2_prog_var_all_df[VHLx3brLD2_prog_var_thresh5,]
VHLx3brLD2_prog_map_thresh5 <- which(as.numeric(as.character(VHLx3brLD2_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx3brLD2_prog_map_thresh5_df = VHLx3brLD2_prog_map_all_df[VHLx3brLD2_prog_map_thresh5,]
VHLx3brLD2_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx3brLD2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx3brLD2_prog_map_exon_thresh5_df = VHLx3brLD2_prog_map_exon_all_df[VHLx3brLD2_prog_map_exon_thresh5,]
VHLx3brLD2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx3brLD2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx3brLD2_prog_map_CADD_thresh5_df = VHLx3brLD2_prog_map_CADD_df[VHLx3brLD2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx3brLD2_prog_var_all_lib_count = length(VHLx3brLD2_prog_var_all_df$lib)
VHLx3brLD2_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx3brLD2_prog_var_all_min_lib_counts = min(VHLx3brLD2_prog_var_all_df$lib)
VHLx3brLD2_prog_var_all_min_lib_counts
VHLx3brLD2_prog_var_all_max_lib_counts = max(VHLx3brLD2_prog_var_all_df$lib)
VHLx3brLD2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx3brLD2_prog_map_all_lib_count = length(VHLx3brLD2_prog_map_all_df$lib)
VHLx3brLD2_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx3brLD2_prog_map_all_min_lib_counts = min(VHLx3brLD2_prog_map_all_df$lib)
VHLx3brLD2_prog_map_all_min_lib_counts
VHLx3brLD2_prog_map_all_max_lib_counts = max(VHLx3brLD2_prog_map_all_df$lib)
VHLx3brLD2_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx3brLD2_prog_var_all_pre_count = length(VHLx3brLD2_prog_var_all_df$pre)
VHLx3brLD2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx3brLD2_prog_var_all_min_pre_counts = min(VHLx3brLD2_prog_var_all_df$pre)
VHLx3brLD2_prog_var_all_min_pre_counts
VHLx3brLD2_prog_var_all_max_pre_counts = max(VHLx3brLD2_prog_var_all_df$pre)
VHLx3brLD2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx3brLD2_prog_map_all_pre_count = length(VHLx3brLD2_prog_map_all_df$pre)
VHLx3brLD2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx3brLD2_prog_map_all_min_pre_counts = min(VHLx3brLD2_prog_map_all_df$pre)
VHLx3brLD2_prog_map_all_min_pre_counts
VHLx3brLD2_prog_map_all_max_pre_counts = max(VHLx3brLD2_prog_map_all_df$pre)
VHLx3brLD2_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx3brLD2_prog_map_all_post_count = length(VHLx3brLD2_prog_map_all_df$post)
VHLx3brLD2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx3brLD2_prog_map_all_min_post_counts = min(VHLx3brLD2_prog_map_all_df$post)
VHLx3brLD2_prog_map_all_min_post_counts
VHLx3brLD2_prog_map_all_max_post_counts = max(VHLx3brLD2_prog_map_all_df$post)
VHLx3brLD2_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx3brLD2_prog_map_all_syn_df <- VHLx3brLD2_prog_map_all_df[which(VHLx3brLD2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx3brLD2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx3brLD2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx3brLD2_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx3brLD2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx3brLD2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx3brLD2_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx3brLD2_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx3brLD2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx3brLD2_prog_map_all_min_rna_counts = min(VHLx3brLD2_prog_map_exon_all_df$tHDR_rna)
VHLx3brLD2_prog_map_all_min_rna_counts
VHLx3brLD2_prog_map_all_max_rna_counts = max(VHLx3brLD2_prog_map_exon_all_df$tHDR_rna)
VHLx3brLD2_prog_map_all_max_rna_counts
VHLx3brLD2_prog_map_all_min_rna_pseudo_freq = min(VHLx3brLD2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3brLD2_prog_map_all_min_rna_pseudo_freq
VHLx3brLD2_prog_map_all_max_rna_pseudo_freq = max(VHLx3brLD2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3brLD2_prog_map_all_max_rna_pseudo_freq
VHLx3brLD2_prog_map_all_min_rna_pre_ratio = min(VHLx3brLD2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3brLD2_prog_map_all_min_rna_pre_ratio
VHLx3brLD2_prog_map_all_max_rna_pre_ratio = max(VHLx3brLD2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3brLD2_prog_map_all_max_rna_pre_ratio
VHLx3brLD2_prog_map_all_min_rna_post_ratio = min(VHLx3brLD2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3brLD2_prog_map_all_min_rna_post_ratio
VHLx3brLD2_prog_map_all_max_rna_post_ratio = max(VHLx3brLD2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3brLD2_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx3brLD2_cSNV_all_corr_pre_count = length(VHLx3brLD2_cSNV_all_df$corr_pre)
VHLx3brLD2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx3brLD2_cSNV_all_min_corr_pre_counts = min(VHLx3brLD2_cSNV_all_df$corr_pre)
VHLx3brLD2_cSNV_all_min_corr_pre_counts
VHLx3brLD2_cSNV_all_max_corr_pre_counts = max(VHLx3brLD2_cSNV_all_df$corr_pre)
VHLx3brLD2_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brLD2_cSNV_all_corr_post_count = length(VHLx3brLD2_cSNV_all_df$corr_post)
VHLx3brLD2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx3brLD2_cSNV_all_min_corr_post_counts = min(VHLx3brLD2_cSNV_all_df$corr_post)
VHLx3brLD2_cSNV_all_min_corr_post_counts
VHLx3brLD2_cSNV_all_max_corr_post_counts = max(VHLx3brLD2_cSNV_all_df$corr_post)
VHLx3brLD2_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx3b_p_hdr_snv = paste('p_hdr_',VHLx3b_cut_end,'_snv',sep='')
VHLx3brLD2_pSNV_all <- which(VHLx3brLD2[,VHLx3b_p_hdr_snv]=='True')
VHLx3brLD2_pSNV_all_df = VHLx3brLD2[VHLx3brLD2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brLD2_pSNV_all_lib_count = length(VHLx3brLD2_pSNV_all_df$lib)
VHLx3brLD2_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx3brLD2_pSNV_all_min_lib_counts = min(VHLx3brLD2_pSNV_all_df$lib)
VHLx3brLD2_pSNV_all_min_lib_counts
VHLx3brLD2_pSNV_all_max_lib_counts = max(VHLx3brLD2_pSNV_all_df$lib)
VHLx3brLD2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx3brLD2_pSNV_all_pre_count = length(VHLx3brLD2_pSNV_all_df$pre)
VHLx3brLD2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx3brLD2_pSNV_all_min_pre_counts = min(VHLx3brLD2_pSNV_all_df$pre)
VHLx3brLD2_pSNV_all_min_pre_counts
VHLx3brLD2_pSNV_all_max_pre_counts = max(VHLx3brLD2_pSNV_all_df$pre)
VHLx3brLD2_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brLD2_pSNV_all_post_count = length(VHLx3brLD2_pSNV_all_df$post)
VHLx3brLD2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx3brLD2_pSNV_all_min_post_counts = min(VHLx3brLD2_pSNV_all_df$post)
VHLx3brLD2_pSNV_all_min_post_counts
VHLx3brLD2_pSNV_all_max_post_counts = max(VHLx3brLD2_pSNV_all_df$post)
VHLx3brLD2_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brLD2_prog_map_thresh5_lib_count = length(VHLx3brLD2_prog_map_thresh5_df$lib)
VHLx3brLD2_prog_map_thresh5_lib_count
VHLx3brLD2_prog_map_thresh5_min_lib_counts = min(VHLx3brLD2_prog_map_thresh5_df$lib)
VHLx3brLD2_prog_map_thresh5_min_lib_counts
VHLx3brLD2_prog_map_thresh5_max_lib_counts = max(VHLx3brLD2_prog_map_thresh5_df$lib)
VHLx3brLD2_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brLD2_prog_map_thresh5_pre_count = length(VHLx3brLD2_prog_map_thresh5_df$pre)
VHLx3brLD2_prog_map_thresh5_pre_count
VHLx3brLD2_prog_map_thresh5_min_pre_counts = min(VHLx3brLD2_prog_map_thresh5_df$pre)
VHLx3brLD2_prog_map_thresh5_min_pre_counts
VHLx3brLD2_prog_map_thresh5_max_pre_counts = max(VHLx3brLD2_prog_map_thresh5_df$pre)
VHLx3brLD2_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx3brLD2_prog_map_thresh5_post_count = length(VHLx3brLD2_prog_map_thresh5_df$post)
VHLx3brLD2_prog_map_thresh5_post_count
VHLx3brLD2_prog_map_thresh5_min_post_counts = min(VHLx3brLD2_prog_map_thresh5_df$post)
VHLx3brLD2_prog_map_thresh5_min_post_counts
VHLx3brLD2_prog_map_thresh5_max_post_counts = max(VHLx3brLD2_prog_map_thresh5_df$post)
VHLx3brLD2_prog_map_thresh5_max_post_counts
VHLx3brLD2_prog_map_thresh5_corr_post_count = length(VHLx3brLD2_cSNV_all_df$corr_post)
VHLx3brLD2_prog_map_thresh5_corr_post_count
VHLx3brLD2_prog_map_thresh5_min_corr_post_counts = min(VHLx3brLD2_cSNV_all_df$corr_post)
VHLx3brLD2_prog_map_thresh5_min_corr_post_counts
VHLx3brLD2_prog_map_thresh5_max_corr_post_counts = max(VHLx3brLD2_cSNV_all_df$corr_post)
VHLx3brLD2_prog_map_thresh5_max_corr_post_counts

VHLx3brLD2_pSNV_thresh5 <- which(VHLx3brLD2[,VHLx3b_p_hdr_snv]=='True' & as.numeric(as.character(VHLx3brLD2[,'pre_freq']))>=0.00001)
VHLx3brLD2_pSNV_thresh5_df = VHLx3brLD2[VHLx3brLD2_pSNV_thresh5,]
VHLx3brLD2_pSNV_thresh5_lib_count = length(VHLx3brLD2_pSNV_thresh5_df$lib)
VHLx3brLD2_pSNV_thresh5_lib_count
VHLx3brLD2_pSNV_thresh5_min_lib_counts = min(VHLx3brLD2_pSNV_thresh5_df$lib)
VHLx3brLD2_pSNV_thresh5_min_lib_counts
VHLx3brLD2_pSNV_thresh5_max_lib_counts = max(VHLx3brLD2_pSNV_thresh5_df$lib)
VHLx3brLD2_pSNV_thresh5_max_lib_counts
VHLx3brLD2_pSNV_thresh5_pre_count = length(VHLx3brLD2_pSNV_thresh5_df$pre)
VHLx3brLD2_pSNV_thresh5_pre_count
VHLx3brLD2_pSNV_thresh5_min_pre_counts = min(VHLx3brLD2_pSNV_thresh5_df$pre)
VHLx3brLD2_pSNV_thresh5_min_pre_counts
VHLx3brLD2_pSNV_thresh5_max_pre_counts = max(VHLx3brLD2_pSNV_thresh5_df$pre)
VHLx3brLD2_pSNV_thresh5_max_pre_counts
VHLx3brLD2_pSNV_thresh5_post_count = length(VHLx3brLD2_pSNV_thresh5_df$post)
VHLx3brLD2_pSNV_thresh5_post_count
VHLx3brLD2_pSNV_thresh5_min_post_counts = min(VHLx3brLD2_pSNV_thresh5_df$post)
VHLx3brLD2_pSNV_thresh5_min_post_counts
VHLx3brLD2_pSNV_thresh5_max_post_counts = max(VHLx3brLD2_pSNV_thresh5_df$post)
VHLx3brLD2_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx3brLD1_prog_var_thresh5_df:
VHLx3brLD1_prog_var_thresh5_df_rLD2_int <- VHLx3brLD1_prog_var_thresh5_df[which(VHLx3brLD1_prog_var_thresh5_df$variant %in% VHLx3brLD2_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx3brLD2_prog_var_thresh5_df:
VHLx3brLD2_prog_var_thresh5_df_rLD1_int <- VHLx3brLD2_prog_var_thresh5_df[which(VHLx3brLD2_prog_var_thresh5_df$variant %in% VHLx3brLD1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int[order(VHLx3brLD1_prog_var_thresh5_df_rLD2_int$variant),]
VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int[order(VHLx3brLD2_prog_var_thresh5_df_rLD1_int$variant),]
dim(VHLx3brLD1_prog_var_thresh5_df)[1] #Number of prog_vars in rLD1
VHLx3brLD1rLD2int_prog_var_thresh5_pre_count <- dim(VHLx3brLD1_prog_var_thresh5_df_rLD2_int)[1] 
VHLx3brLD1rLD2int_prog_var_thresh5_pre_count #Number of prog_vars in rLD1 also in rLD2
dim(VHLx3brLD2_prog_var_thresh5_df)[1] #Number of prog_vars in rLD2
dim(VHLx3brLD2_prog_var_thresh5_df_rLD1_int)[1] #Number of prog_vars in rLD2 also in rLD1

#Add the following columns from the from rLD2 df to the rLD1 df:
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$pre
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_lib <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$lib
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$rna
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2 <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post2
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3 <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post3
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2 <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$rna2
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$pre_pseudo
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post_pseudo
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pseudo <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pseudo
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pseudo <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pseudo
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pseudo <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pseudo
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_pseudo <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_pseudo
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$pre_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$rna_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post2_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post3_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$pre_pseudo_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post_pseudo_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pseudo_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pseudo_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pseudo_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pseudo_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pseudo_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pseudo_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_pseudo_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_pseudo_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$pre_lib_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post_pre_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post_lib_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pre_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pre_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_post_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$rna_post_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pre_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pre_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pre_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_post_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_snv_error_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$pre_snv_error_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_snv_error_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$post_snv_error_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_exp_snv_error_reads_pre <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$exp_snv_error_reads_pre
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_exp_snv_error_reads_post <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$exp_snv_error_reads_post
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pre <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pre
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_post <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$corr_post
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pre_pseudo <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pre_pseudo
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_post_pseudo <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$corr_post_pseudo
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pseudo_post_pre_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pseudo_post_pre_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_lib <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_lib
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2 <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3 <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2 <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre_pseudo_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pseudo_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_pseudo_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pseudo_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_pseudo_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pseudo_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2_pseudo_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pseudo_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3_pseudo_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_pseudo_freq <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2_pseudo_freq
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre_lib_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_pre_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_lib_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_pre_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_post_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2_pre_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pre_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3_pre_ratio
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio <- VHLx3brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio) + log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio))/2)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio) + log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio))/2)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio) + log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio))/2)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio) + log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio))/2)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post3_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post3_pre_ratio) + log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pre_ratio))/2)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rna2_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rna2_post_ratio) + log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio))/2)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio) + log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio))/2)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio) + log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio))/2)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio) + log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio))/2)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio) + log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio))/2)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio) + log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio))/2)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio) + log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio))/2)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post3_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post3_pre_ratio) + log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pre_ratio))/2)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio) + log2(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_pre_weighted <- ((VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq*VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq/(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq))+(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq*VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq/(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)))/VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq
#rLD1 pre-freq weighting coefficient (rLD1_pre-freq / (rLD1 + rLD2 pre-freq's))
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq/(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq/(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)
#this will be weighted by denominator:  (rLD1_pof/rLD1_prf)(rLD1_prwc)+(rLD2_pof/rLD2_prf)*(rLD2_prwc)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted <- (VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pseudo_freq/VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq)*(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight)+(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq/VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)*(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight)
#this will be weighted by denominator:  (rLD1_pof/lif')*(rLD1_prwc)+(rLD2_pof/lif)*(rLD2_prwc)
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_pre_weighted <- (VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pseudo_freq/VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq)*(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight)+(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq/VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq)*(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight)
#rLD1 tHDR_pre-freq weighting coefficient (rLD1_tHDR_pre-freq / (rLD1 + rLD2 pre-freq's))
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_weight <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq/(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq+VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)
#rLD2 tHDR_pre-freq weighting coefficient
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_weight <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq/(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq+VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rLD1_pof/rLD1_prf)(rLD1_prwc)+(rLD2_pof/rLD2_prf)*(rLD2_prwc)
#tHDR_post_pre_ratio_rLD1rLD2_pre_weighted
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted <- (VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pseudo_freq/VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq)*(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_weight)+(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pseudo_freq/VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)*(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq)) >= 10) {
    VHLx3brLD1_cSNV_pre_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx3brLD1_cSNV_post_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx3brLD1_cSNV_post2_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx3brLD1_cSNV_post_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx3brLD1_tSNV_pre_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx3brLD1_tSNV_post_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx3brLD1_tSNV_post_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx3brLD1_tSNV_rna_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx3brLD1_tSNV_rna_post_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx3brLD1_tSNV_rna2_post_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx3brLD2_cSNV_pre_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_pre_lib_ratio)
VHLx3brLD2_cSNV_post_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post_pre_ratio)
VHLx3brLD2_cSNV_post2_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post2_pre_ratio)

VHLx3brLD2_cSNV_post_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post_lib_ratio)
VHLx3brLD2_tSNV_pre_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_pre_lib_ratio)
VHLx3brLD2_tSNV_post_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post_pre_ratio)
VHLx3brLD2_tSNV_post2_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post2_pre_ratio)
VHLx3brLD2_tSNV_post_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post_lib_ratio)
VHLx3brLD2_tSNV_rna_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna_pre_ratio)
VHLx3brLD2_tSNV_rna_post_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna_post_ratio)
VHLx3brLD2_tSNV_rna2_post_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna2_post_ratio)
VHLx3brLD1rLD2a_cSNV_pre_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_cSNV_post_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_cSNV_post2_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_cSNV_post_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_tSNV_pre_lib_med <- 
  median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_tSNV_post_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_tSNV_post2_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_tSNV_post_lib_med <-
  median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_tSNV_rna_pre_med <-
  median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_tSNV_rna_post_med <-
  median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_tSNV_rna2_post_med <-
  median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2pw_tSNV_post_pre_med  <-
  median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted)
VHLx3brLD1rLD2pw_cSNV_post_pre_med  <-
  median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLD1rLD2_pre_weighted)
  } else {
  VHLx3brLD1_cSNV_pre_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio)
VHLx3brLD1_cSNV_post_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio)
VHLx3brLD1_cSNV_post2_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio)
VHLx3brLD1_cSNV_post_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio)
VHLx3brLD1_tSNV_pre_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio)
VHLx3brLD1_tSNV_post_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio)
VHLx3brLD1_tSNV_post_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio)
VHLx3brLD1_tSNV_rna_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio)
VHLx3brLD1_tSNV_rna_post_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio)
VHLx3brLD1_tSNV_rna2_post_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio)
VHLx3brLD2_cSNV_pre_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio)
VHLx3brLD2_cSNV_post_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio)
VHLx3brLD2_cSNV_post2_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio)

VHLx3brLD2_cSNV_post_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio)
VHLx3brLD2_tSNV_pre_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio)
VHLx3brLD2_tSNV_post_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio)
VHLx3brLD2_tSNV_post2_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio)
VHLx3brLD2_tSNV_post_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio)
VHLx3brLD2_tSNV_rna_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio)
VHLx3brLD2_tSNV_rna_post_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio)
VHLx3brLD2_tSNV_rna2_post_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio)
VHLx3brLD1rLD2a_cSNV_pre_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_cSNV_post_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_cSNV_post2_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_cSNV_post_lib_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_tSNV_pre_lib_med <- 
  median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_tSNV_post_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_tSNV_post2_pre_med <- median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_tSNV_post_lib_med <-
  median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_tSNV_rna_pre_med <-
  median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_tSNV_rna_post_med <-
  median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2a_tSNV_rna2_post_med <-
  median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean)
VHLx3brLD1rLD2pw_tSNV_post_pre_med  <-
  median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted)
VHLx3brLD1rLD2pw_cSNV_post_pre_med  <-
  median(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted)
}

VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio/VHLx3brLD1_cSNV_pre_lib_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio/VHLx3brLD1_cSNV_post_pre_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio/VHLx3brLD1_cSNV_post_lib_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio/VHLx3brLD1_cSNV_post2_pre_med

VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio/VHLx3brLD1_tSNV_pre_lib_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio/VHLx3brLD1_tSNV_post_pre_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio/VHLx3brLD1_tSNV_post_lib_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio/VHLx3brLD1_tSNV_rna_pre_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio/VHLx3brLD1_tSNV_rna_post_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio/VHLx3brLD2_tSNV_post2_pre_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio/VHLx3brLD1_tSNV_rna2_post_med

VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio/VHLx3brLD2_cSNV_pre_lib_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio/VHLx3brLD2_cSNV_post_pre_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio/VHLx3brLD2_cSNV_post_lib_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio/VHLx3brLD1rLD2a_cSNV_post2_pre_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio/VHLx3brLD2_tSNV_rna2_post_med


VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio/VHLx3brLD2_tSNV_pre_lib_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio/VHLx3brLD2_tSNV_post_pre_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio/VHLx3brLD2_tSNV_post2_pre_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio/VHLx3brLD2_tSNV_post_lib_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio/VHLx3brLD2_tSNV_rna_pre_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio/VHLx3brLD2_tSNV_rna_post_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio/VHLx3brLD2_tSNV_rna2_post_med

###normalize the means
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean/VHLx3brLD1rLD2a_cSNV_pre_lib_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean/VHLx3brLD1rLD2a_cSNV_post_pre_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean/VHLx3brLD1rLD2a_cSNV_post_lib_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean/VHLx3brLD1rLD2a_tSNV_pre_lib_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean/VHLx3brLD1rLD2a_tSNV_post_pre_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean/VHLx3brLD1rLD2a_tSNV_post2_pre_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean/VHLx3brLD1rLD2a_tSNV_post_lib_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean/VHLx3brLD1rLD2a_tSNV_rna_pre_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean/VHLx3brLD1rLD2a_tSNV_rna_post_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean/VHLx3brLD1rLD2a_tSNV_rna2_post_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted/VHLx3brLD1rLD2pw_tSNV_post_pre_med
VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm <- VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted/VHLx3brLD1rLD2pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord
VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord = which(VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[,'pos']!='REF')
VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df = VHLx3brLD1_prog_var_thresh5_df_rLD2_int_ord[VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord,]
VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord = which(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'cDNApos']!='REF' & VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'cDNApos']!='NA')
VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df = VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df[VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord,]
VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord = which(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'CADD.phred']!='NA')
VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df = VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df[VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord,]
VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense <- VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df[which(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx3brLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s
VHLx3brLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_p <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='pearson')
VHLx3brLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_p
VHLx3brLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s
VHLx3brLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_p <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='pearson')
VHLx3brLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_p
VHLx3brLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post2_pre_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s
VHLx3brLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_p <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post2_pre_ratio_synnorm),method='pearson')
VHLx3brLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_p
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_s <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_s
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_p <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_p
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_s <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_s
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_p <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_p
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_s <- cor(log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_s
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_p <- cor(log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_p
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_s <- cor(log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_s
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_p <- cor(log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx3brLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_p
VHLx3brLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_s <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_freq),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_freq),method='spearman')
VHLx3brLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_s
VHLx3brLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_p <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pseudo_freq),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pseudo_freq),method='pearson')
VHLx3brLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_p
VHLx3brLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_s <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_s
VHLx3brLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_p <-cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio_synnorm),method='pearson')
VHLx3brLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_p
VHLx3brLD1rLD2_tSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_tSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s
VHLx3brLD1rLD2_tSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_tSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s
VHLx3brLD1rLD2_tSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_tSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s
VHLx3brLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s
VHLx3brLD1rLD2_tSNV_rLD1_rna2_post_by_rLD2_rna2_post_cor_s <- cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_tSNV_rLD1_rna2_post_by_rLD2_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx3brLD1_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1_cSNV_post_pre_by_cadd_cor_s
VHLx3brLD2_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD2_cSNV_post_pre_by_cadd_cor_s
VHLx3brLD1_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1_cSNV_post_lib_by_cadd_cor_s
VHLx3brLD2_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD2_cSNV_post_lib_by_cadd_cor_s
VHLx3brLD1_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1_tSNV_post_pre_by_cadd_cor_s
VHLx3brLD2_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD2_tSNV_post_pre_by_cadd_cor_s
VHLx3brLD1_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1_tSNV_post_lib_by_cadd_cor_s
VHLx3brLD2_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx3brLD1rLD2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2a_cSNV_pre_lib_by_cadd_cor_s
VHLx3brLD1rLD2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2w_cSNV_pre_lib_by_cadd_cor_s
VHLx3brLD1rLD2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2a_cSNV_post_pre_by_cadd_cor_s
VHLx3brLD1rLD2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2w_cSNV_post_pre_by_cadd_cor_s
VHLx3brLD1rLD2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2a_cSNV_post_lib_by_cadd_cor_s
VHLx3brLD1rLD2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2w_cSNV_post_lib_by_cadd_cor_s
VHLx3brLD1rLD2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2a_tSNV_pre_lib_by_cadd_cor_s
VHLx3brLD1rLD2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2a_tSNV_post_pre_by_cadd_cor_s
VHLx3brLD1rLD2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2w_tSNV_post_pre_by_cadd_cor_s
VHLx3brLD1rLD2a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post2_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2a_tSNV_post2_pre_by_cadd_cor_s
VHLx3brLD1rLD2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx3brLD1_cSNV_pre_lib_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3brLD1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3brLD1_tSNV_pre_lib_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3brLD1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3brLD1_cSNV_post_lib_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3brLD1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx3brLD1_tSNV_post_lib_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3brLD1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx3brLD1_cSNV_post_pre_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx3brLD1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3brLD1_tSNV_post_pre_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx3brLD1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3brLD1_cSNV_rna_lib_cors = cor(log2(VHLx3brLD1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx3brLD1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3brLD1_tSNV_rna_lib_cors = cor(log2(VHLx3brLD1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3brLD1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx3brLD1_cSNV_rna_pre_cors = cor(log2(VHLx3brLD1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx3brLD1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3brLD1_tSNV_rna_pre_cors = cor(log2(VHLx3brLD1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx3brLD1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3brLD1rLD2_cSNV_pre_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_freq),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_freq),method='spearman')
VHLx3brLD1rLD2_tSNV_pre_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_pseudo_freq),method='spearman')
VHLx3brLD1rLD2_cSNV_pre_lib_ratio_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio),method='spearman')
VHLx3brLD1rLD2_tSNV_pre_lib_ratio_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio),method='spearman')
VHLx3brLD1rLD2_cSNV_post_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_freq),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_freq),method='spearman')
VHLx3brLD1rLD2_tSNV_post_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pseudo_freq),method='spearman')
VHLx3brLD1rLD2_cSNV_post_lib_ratio_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_tSNV_post_lib_ratio_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_cSNV_post_pre_ratio_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_tSNV_post_pre_ratio_cors = cor(log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_cSNV_rna_cors = cor(log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rna_freq),log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_rna_freq),method='spearman')
VHLx3brLD1rLD2_tSNV_rna_cors = cor(log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pseudo_freq),method='spearman')
VHLx3brLD1rLD2_tSNV_rna_pre_ratio_cors = cor(log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3brLD1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brLD1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brLD1_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brLD1_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brLD1_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brLD1_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brLD1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3brLD1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3brLD1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3brLD1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3brLD1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx3brLD1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx3brLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3brLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3brLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3brLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3brLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx3brLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx3brLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx3brLD1rLD2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')

VHLx3brLD1_cors <- c("VHLx3brLD1",VHLx3brLD1_cSNV_pre_lib_cors,VHLx3brLD1_tSNV_pre_lib_cors,VHLx3brLD1_cSNV_post_lib_cors,VHLx3brLD1_tSNV_post_lib_cors,VHLx3brLD1_cSNV_post_pre_cors,VHLx3brLD1_tSNV_post_pre_cors,VHLx3brLD1_cSNV_rna_lib_cors,VHLx3brLD1_tSNV_rna_lib_cors,VHLx3brLD1_cSNV_rna_pre_cors,VHLx3brLD1_tSNV_rna_pre_cors,VHLx3brLD1rLD2_cSNV_pre_cors,VHLx3brLD1rLD2_tSNV_pre_cors,VHLx3brLD1rLD2_cSNV_pre_lib_ratio_cors,VHLx3brLD1rLD2_tSNV_pre_lib_ratio_cors,VHLx3brLD1rLD2_cSNV_post_cors,VHLx3brLD1rLD2_tSNV_post_cors,VHLx3brLD1rLD2_cSNV_post_lib_ratio_cors,VHLx3brLD1rLD2_tSNV_post_lib_ratio_cors,VHLx3brLD1rLD2_cSNV_post_pre_ratio_cors,VHLx3brLD1rLD2_tSNV_post_pre_ratio_cors,VHLx3brLD1rLD2_cSNV_rna_cors,VHLx3brLD1rLD2_tSNV_rna_cors,VHLx3brLD1rLD2_tSNV_rna_pre_ratio_cors,VHLx3brLD1_cSNV_pre_lib_ratio_cadd_cors,VHLx3brLD1_tSNV_pre_lib_ratio_cadd_cors,VHLx3brLD1_cSNV_post_lib_ratio_cadd_cors,VHLx3brLD1_tSNV_post_lib_ratio_cadd_cors,VHLx3brLD1_cSNV_post_pre_ratio_cadd_cors,VHLx3brLD1_tSNV_post_pre_ratio_cadd_cors,VHLx3brLD1_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3brLD1_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3brLD1_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brLD1_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brLD1_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3brLD1_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3brLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors,VHLx3brLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors,VHLx3brLD1rLD2a_cSNV_post_lib_ratio_cadd_cors,VHLx3brLD1rLD2a_tSNV_post_lib_ratio_cadd_cors,VHLx3brLD1rLD2a_cSNV_post_pre_ratio_cadd_cors,VHLx3brLD1rLD2a_tSNV_post_pre_ratio_cadd_cors,VHLx3brLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3brLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3brLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3brLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3brLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors,VHLx3brLD1rLD2w_cSNV_post_lib_ratio_cadd_cors,VHLx3brLD1rLD2w_cSNV_post_pre_ratio_cadd_cors,VHLx3brLD1rLD2w_tSNV_post_pre_ratio_cadd_cors)

VHLx3brLD2_cSNV_pre_lib_cors = cor(log2(VHLx3brLD2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3brLD2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3brLD2_tSNV_pre_lib_cors = cor(log2(VHLx3brLD2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3brLD2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3brLD2_cSNV_post_lib_cors = cor(log2(VHLx3brLD2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3brLD2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx3brLD2_tSNV_post_lib_cors = cor(log2(VHLx3brLD2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3brLD2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx3brLD2_cSNV_post_pre_cors = cor(log2(VHLx3brLD2_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx3brLD2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3brLD2_tSNV_post_pre_cors = cor(log2(VHLx3brLD2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx3brLD2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3brLD2_cSNV_rna_lib_cors = cor(log2(VHLx3brLD2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx3brLD2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3brLD2_tSNV_rna_lib_cors = cor(log2(VHLx3brLD2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3brLD2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx3brLD2_cSNV_rna_pre_cors = cor(log2(VHLx3brLD2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx3brLD2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3brLD2_tSNV_rna_pre_cors = cor(log2(VHLx3brLD2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx3brLD2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3brLD2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3brLD2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx3brLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brLD2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3brLD2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx3brLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brLD2_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3brLD2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx3brLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brLD2_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3brLD2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx3brLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brLD2_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brLD2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx3brLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brLD2_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brLD2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brLD2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3brLD2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3brLD2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3brLD2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3brLD2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx3brLD2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')

VHLx3brLD2_cors <- c("VHLx3brLD2",VHLx3brLD2_cSNV_pre_lib_cors,VHLx3brLD2_tSNV_pre_lib_cors,VHLx3brLD2_cSNV_post_lib_cors,VHLx3brLD2_tSNV_post_lib_cors,VHLx3brLD2_cSNV_post_pre_cors,VHLx3brLD2_tSNV_post_pre_cors,VHLx3brLD2_cSNV_rna_lib_cors,VHLx3brLD2_tSNV_rna_lib_cors,VHLx3brLD2_cSNV_rna_pre_cors,VHLx3brLD2_tSNV_rna_pre_cors,VHLx3brLD1rLD2_cSNV_pre_cors,VHLx3brLD1rLD2_tSNV_pre_cors,VHLx3brLD1rLD2_cSNV_pre_lib_ratio_cors,VHLx3brLD1rLD2_tSNV_pre_lib_ratio_cors,VHLx3brLD1rLD2_cSNV_post_cors,VHLx3brLD1rLD2_tSNV_post_cors,VHLx3brLD1rLD2_cSNV_post_lib_ratio_cors,VHLx3brLD1rLD2_tSNV_post_lib_ratio_cors,VHLx3brLD1rLD2_cSNV_post_pre_ratio_cors,VHLx3brLD1rLD2_tSNV_post_pre_ratio_cors,VHLx3brLD1rLD2_cSNV_rna_cors,VHLx3brLD1rLD2_tSNV_rna_cors,VHLx3brLD1rLD2_tSNV_rna_pre_ratio_cors,VHLx3brLD2_cSNV_pre_lib_ratio_cadd_cors,VHLx3brLD2_tSNV_pre_lib_ratio_cadd_cors,VHLx3brLD2_cSNV_post_lib_ratio_cadd_cors,VHLx3brLD2_tSNV_post_lib_ratio_cadd_cors,VHLx3brLD2_cSNV_post_pre_ratio_cadd_cors,VHLx3brLD2_tSNV_post_pre_ratio_cadd_cors,VHLx3brLD2_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3brLD2_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3brLD2_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brLD2_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brLD2_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3brLD2_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3brLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors,VHLx3brLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors,VHLx3brLD1rLD2a_cSNV_post_lib_ratio_cadd_cors,VHLx3brLD1rLD2a_tSNV_post_lib_ratio_cadd_cors,VHLx3brLD1rLD2a_cSNV_post_pre_ratio_cadd_cors,VHLx3brLD1rLD2a_tSNV_post_pre_ratio_cadd_cors,VHLx3brLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3brLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3brLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3brLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3brLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors,VHLx3brLD1rLD2w_cSNV_post_lib_ratio_cadd_cors,VHLx3brLD1rLD2w_cSNV_post_pre_ratio_cadd_cors,VHLx3brLD1rLD2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx3brLD1)
rm(VHLx3brLD2)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx3brLD1
VHLx3b_posrange <- range(as.numeric(as.character(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$pos)))
VHLx3b_posseq <- seq(from=VHLx3b_posrange[1], to=VHLx3b_posrange[2])
VHLx3brLD1_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx3brLD1_tHDR_pre_lib_pred <- predict(VHLx3brLD1_tHDR_pre_lib_ratio.lo, newdata = VHLx3b_posseq, se=TRUE)
VHLx3brLD1_tHDR_pre_lib_pos_effects <- VHLx3brLD1_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx3brLD1_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx3brLD1_tHDR_pre_lib_pos_effects)
VHLx3brLD1_tHDR_pre_lib_pos_effects_ci <- VHLx3brLD1_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx3brLD1_tHDR_pre_lib_pred$df)
VHLx3brLD1_tHDR_pre_lib_pos_effects_ci_ymin = VHLx3brLD1_tHDR_pre_lib_pos_effects - VHLx3brLD1_tHDR_pre_lib_pos_effects_ci
VHLx3brLD1_tHDR_pre_lib_pos_effects_ci_ymax = VHLx3brLD1_tHDR_pre_lib_pos_effects + VHLx3brLD1_tHDR_pre_lib_pos_effects_ci
VHLx3brLD1_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx3b_posseq, VHLx3brLD1_tHDR_pre_lib_pos_effects, VHLx3brLD1_tHDR_pre_lib_pos_effects.x, VHLx3brLD1_tHDR_pre_lib_pos_effects_ci_ymin, VHLx3brLD1_tHDR_pre_lib_pos_effects_ci_ymax, VHLx3brLD1_tHDR_pre_lib_pred_se = VHLx3brLD1_tHDR_pre_lib_pred$se.fit)
#VHLx3brLD2
VHLx3brLD2_tHDR_pre_lib_ratio.lo <- loess(log2(rLD2_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx3brLD2_tHDR_pre_lib_pred <- predict(VHLx3brLD2_tHDR_pre_lib_ratio.lo, newdata = VHLx3b_posseq, se=TRUE)
VHLx3brLD2_tHDR_pre_lib_pos_effects <- VHLx3brLD2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx3brLD2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx3brLD2_tHDR_pre_lib_pos_effects)
VHLx3brLD2_tHDR_pre_lib_pos_effects_ci <- VHLx3brLD2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx3brLD2_tHDR_pre_lib_pred$df)
VHLx3brLD2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx3brLD2_tHDR_pre_lib_pos_effects - VHLx3brLD2_tHDR_pre_lib_pos_effects_ci
VHLx3brLD2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx3brLD2_tHDR_pre_lib_pos_effects + VHLx3brLD2_tHDR_pre_lib_pos_effects_ci
VHLx3brLD2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx3b_posseq, VHLx3brLD2_tHDR_pre_lib_pos_effects, VHLx3brLD2_tHDR_pre_lib_pos_effects.x, VHLx3brLD2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx3brLD2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx3brLD2_tHDR_pre_lib_pred_se = VHLx3brLD2_tHDR_pre_lib_pred$se.fit)

#VHLx3brLD1rLD2
VHLx3brLD1rLD2_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm > 0.7 & VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm > 0.3 & VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx3brLD1rLD2_tHDR_pre_lib_pred <- predict(VHLx3brLD1rLD2_tHDR_pre_lib_ratio.lo, newdata = VHLx3b_posseq, se=TRUE)
VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects <- VHLx3brLD1rLD2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects)
VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects_ci <- VHLx3brLD1rLD2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx3brLD1rLD2_tHDR_pre_lib_pred$df)
VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects - VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects_ci
VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects + VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects_ci
VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx3b_posseq, VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects, VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects.x, VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx3brLD1rLD2_tHDR_pre_lib_pred_se = VHLx3brLD1rLD2_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rLD1, rLD2, rLD1rLD2)
VHLx3brLD_tHDR_pos_merge_df <- VHLx3brLD1_prog_map_thresh5_df_rLD2_int_ord_df 
VHLx3brLD_tHDR_pos_merge_df <- merge(VHLx3brLD_tHDR_pos_merge_df, VHLx3brLD1_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx3brLD1_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx3brLD_tHDR_pos_merge_df <- merge(VHLx3brLD_tHDR_pos_merge_df, VHLx3brLD2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx3brLD2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx3brLD_tHDR_pos_merge_df <- merge(VHLx3brLD_tHDR_pos_merge_df, VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx3brLD_tHDR_pos_merge_df <- VHLx3brLD_tHDR_pos_merge_df %>% 
  rename(
    rLD1_tHDR_pre_lib_pos_effects.x = VHLx3brLD1_tHDR_pre_lib_pos_effects.x,
    rLD2_tHDR_pre_lib_pos_effects.x = VHLx3brLD2_tHDR_pre_lib_pos_effects.x,
    rLD1rLD2_tHDR_pre_lib_pos_effects.x = VHLx3brLD1rLD2_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rLD1 vs. rLD1_fit and vs. mean_fit)
VHLx3brLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1 <- log2(VHLx3brLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx3brLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_pos_effects.x
VHLx3brLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx3brLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx3brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx3brLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2 <- log2(VHLx3brLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_ratio_synnorm) - VHLx3brLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_pos_effects.x
VHLx3brLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx3brLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_ratio_synnorm) - VHLx3brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx3brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx3brLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm) - VHLx3brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx3brLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_loess_rLD1 <- log2(VHLx3brLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx3brLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_pos_effects.x
VHLx3brLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx3brLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx3brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx3brLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_loess_rLD2 <- log2(VHLx3brLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_ratio_synnorm) - VHLx3brLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_pos_effects.x
VHLx3brLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx3brLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_ratio_synnorm) - VHLx3brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx3brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx3brLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm) - VHLx3brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rLD1 and rLD2 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx3brLD_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx3brLD_tHDR_post_lib_loess_median_syn_rLD1 <- median(VHLx3brLD_tHDR_pos_merge_df[which(VHLx3brLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLD1_tHDR_post_lib_loess_rLD1')])
  VHLx3brLD_tHDR_post_lib_loess_median_syn_rLD2 <- median(VHLx3brLD_tHDR_pos_merge_df[which(VHLx3brLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLD2_tHDR_post_lib_loess_rLD2')])
  } else {
  VHLx3brLD_tHDR_post_lib_loess_median_syn_rLD1 <- median(VHLx3brLD_tHDR_pos_merge_df[which(VHLx3brLD_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLD1_tHDR_post_lib_loess_rLD1')])
  VHLx3brLD_tHDR_post_lib_loess_median_syn_rLD2 <- median(VHLx3brLD_tHDR_pos_merge_df[which(VHLx3brLD_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLD2_tHDR_post_lib_loess_rLD2')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rLD1 'e.sns' = exon syn/ns norm.
VHLx3brLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1_e.sns <- (VHLx3brLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1-VHLx3brLD_tHDR_post_lib_loess_median_syn_rLD1)
#calculate new b values for rLD2 'e.sns' = exon syn/ns norm.
VHLx3brLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2_e.sns <- (VHLx3brLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2-VHLx3brLD_tHDR_post_lib_loess_median_syn_rLD2)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx3brLD_tHDR_pos_merge_df$rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean <- (VHLx3brLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1_e.sns+VHLx3brLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx3brLD_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx3brLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_syn_median <- median(VHLx3brLD_tHDR_pos_merge_df[which(VHLx3brLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('VHLx3brLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean')])
  } else {
  VHLx3brLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_syn_median <- median(VHLx3brLD_tHDR_pos_merge_df[which(VHLx3brLD_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('VHLx3brLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean')])
}

#RNA analysis
VHLx3brLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s <- cor(log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3brLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1_tHDR_rna2_rna_ratio <- VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_pseudo_freq/VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pseudo_freq
VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_rna_ratio <- VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_pseudo_freq/VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pseudo_freq
VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1rLD2_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1_tHDR_rna2_rna_ratio)+log2(VHLx3brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_rna_ratio))/2

```

```{r}
VHLx1brLD1_file <- paste(experiment_dir_220822,'VHLx1brL43','_annotated.txt',sep='')
VHLx1brLD2_file <- paste(experiment_dir_220822,'VHLx1brL44','_annotated.txt',sep='')
VHLx1brLD1 <- read.table(VHLx1brLD1_file, header=TRUE, sep="\t")
VHLx1brLD2 <- read.table(VHLx1brLD2_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx1brLD1 <- VHLx1brLD1 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )
VHLx1brLD2 <- VHLx1brLD2 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx1b <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx1b'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx1b_HDR_5_SNV = as.character(VHL_editing_info_VHLx1b$HDR_5_SNV)
VHLx1b_HDR_3_SNV = as.character(VHL_editing_info_VHLx1b$HDR_3_SNV)
#VHLx1b_cut_pos = as.character(VHL_editing_info_VHLx1b$cut_pos)
VHLx1b_cut_end = as.character(VHL_editing_info_VHLx1b$cut_end)
VHLx1b_mut_start = as.character(VHL_editing_info_VHLx1b$mut_start)
VHLx1b_mut_end = as.character(VHL_editing_info_VHLx1b$mut_end)

### Replicate 1
VHLx1brLD1_cSNV_all <- which(VHLx1brLD1[,'c_hdr_snv']=='True')
VHLx1brLD1_cSNV_all_df = VHLx1brLD1[VHLx1brLD1_cSNV_all,]
VHLx1brLD1_prog_var_all <- which(VHLx1brLD1[,'all_hdr_variant']=='True' & VHLx1brLD1[,'edit_string']!='-WT')
VHLx1brLD1_prog_var_all_df = VHLx1brLD1[VHLx1brLD1_prog_var_all,]
VHLx1brLD1_prog_map_all = which(VHLx1brLD1_prog_var_all_df[,'pos']!='REF')
VHLx1brLD1_prog_map_all_df = VHLx1brLD1_prog_var_all_df[VHLx1brLD1_prog_map_all,]
VHLx1brLD1_prog_map_exon_all = which(VHLx1brLD1_prog_map_all_df[,'cDNApos']!='REF' & VHLx1brLD1_prog_map_all_df[,'cDNApos']!='NA')
VHLx1brLD1_prog_map_exon_all_df = VHLx1brLD1_prog_map_all_df[VHLx1brLD1_prog_map_exon_all,]
VHLx1brLD1_prog_map_CADD = which(VHLx1brLD1_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1brLD1_prog_map_CADD_df = VHLx1brLD1_prog_map_all_df[VHLx1brLD1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx1brLD1_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1brLD1_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx1brLD1_prog_var_thresh5_df = VHLx1brLD1_prog_var_all_df[VHLx1brLD1_prog_var_thresh5,]
VHLx1brLD1_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1brLD1_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx1brLD1_prog_map_thresh5_df = VHLx1brLD1_prog_map_all_df[VHLx1brLD1_prog_map_thresh5,]
VHLx1brLD1_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1brLD1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx1brLD1_prog_map_exon_thresh5_df = VHLx1brLD1_prog_map_exon_all_df[VHLx1brLD1_prog_map_exon_thresh5,]
VHLx1brLD1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1brLD1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx1brLD1_prog_map_CADD_thresh5_df = VHLx1brLD1_prog_map_CADD_df[VHLx1brLD1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1brLD1_prog_var_all_lib_count = length(VHLx1brLD1_prog_var_all_df$lib)
VHLx1brLD1_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx1brLD1_prog_var_all_min_lib_counts = min(VHLx1brLD1_prog_var_all_df$lib)
VHLx1brLD1_prog_var_all_min_lib_counts
VHLx1brLD1_prog_var_all_max_lib_counts = max(VHLx1brLD1_prog_var_all_df$lib)
VHLx1brLD1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1brLD1_prog_map_all_lib_count = length(VHLx1brLD1_prog_map_all_df$lib)
VHLx1brLD1_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx1brLD1_prog_map_all_min_lib_counts = min(VHLx1brLD1_prog_map_all_df$lib)
VHLx1brLD1_prog_map_all_min_lib_counts
VHLx1brLD1_prog_map_all_max_lib_counts = max(VHLx1brLD1_prog_map_all_df$lib)
VHLx1brLD1_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx1brLD1_prog_var_all_pre_count = length(VHLx1brLD1_prog_var_all_df$pre)
VHLx1brLD1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx1brLD1_prog_var_all_min_pre_counts = min(VHLx1brLD1_prog_var_all_df$pre)
VHLx1brLD1_prog_var_all_min_pre_counts
VHLx1brLD1_prog_var_all_max_pre_counts = max(VHLx1brLD1_prog_var_all_df$pre)
VHLx1brLD1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1brLD1_prog_map_all_pre_count = length(VHLx1brLD1_prog_map_all_df$pre)
VHLx1brLD1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx1brLD1_prog_map_all_min_pre_counts = min(VHLx1brLD1_prog_map_all_df$pre)
VHLx1brLD1_prog_map_all_min_pre_counts
VHLx1brLD1_prog_map_all_max_pre_counts = max(VHLx1brLD1_prog_map_all_df$pre)
VHLx1brLD1_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx1brLD1_prog_map_all_post_count = length(VHLx1brLD1_prog_map_all_df$post)
VHLx1brLD1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx1brLD1_prog_map_all_min_post_counts = min(VHLx1brLD1_prog_map_all_df$post)
VHLx1brLD1_prog_map_all_min_post_counts
VHLx1brLD1_prog_map_all_max_post_counts = max(VHLx1brLD1_prog_map_all_df$post)
VHLx1brLD1_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx1brLD1_prog_map_all_syn_df <- VHLx1brLD1_prog_map_all_df[which(VHLx1brLD1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1brLD1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1brLD1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1brLD1_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1brLD1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1brLD1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1brLD1_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1brLD1_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1brLD1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx1brLD1_prog_map_all_min_rna_counts = min(VHLx1brLD1_prog_map_exon_all_df$tHDR_rna)
VHLx1brLD1_prog_map_all_min_rna_counts
VHLx1brLD1_prog_map_all_max_rna_counts = max(VHLx1brLD1_prog_map_exon_all_df$tHDR_rna)
VHLx1brLD1_prog_map_all_max_rna_counts
VHLx1brLD1_prog_map_all_min_rna_pseudo_freq = min(VHLx1brLD1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1brLD1_prog_map_all_min_rna_pseudo_freq
VHLx1brLD1_prog_map_all_max_rna_pseudo_freq = max(VHLx1brLD1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1brLD1_prog_map_all_max_rna_pseudo_freq
VHLx1brLD1_prog_map_all_min_rna_pre_ratio = min(VHLx1brLD1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1brLD1_prog_map_all_min_rna_pre_ratio
VHLx1brLD1_prog_map_all_max_rna_pre_ratio = max(VHLx1brLD1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1brLD1_prog_map_all_max_rna_pre_ratio
VHLx1brLD1_prog_map_all_min_rna_post_ratio = min(VHLx1brLD1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1brLD1_prog_map_all_min_rna_post_ratio
VHLx1brLD1_prog_map_all_max_rna_post_ratio = max(VHLx1brLD1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1brLD1_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1brLD1_cSNV_all_corr_pre_count = length(VHLx1brLD1_cSNV_all_df$corr_pre)
VHLx1brLD1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx1brLD1_cSNV_all_min_corr_pre_counts = min(VHLx1brLD1_cSNV_all_df$corr_pre)
VHLx1brLD1_cSNV_all_min_corr_pre_counts
VHLx1brLD1_cSNV_all_max_corr_pre_counts = max(VHLx1brLD1_cSNV_all_df$corr_pre)
VHLx1brLD1_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brLD1_cSNV_all_corr_post_count = length(VHLx1brLD1_cSNV_all_df$corr_post)
VHLx1brLD1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx1brLD1_cSNV_all_min_corr_post_counts = min(VHLx1brLD1_cSNV_all_df$corr_post)
VHLx1brLD1_cSNV_all_min_corr_post_counts
VHLx1brLD1_cSNV_all_max_corr_post_counts = max(VHLx1brLD1_cSNV_all_df$corr_post)
VHLx1brLD1_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx1b_p_hdr_snv = paste('p_hdr_',VHLx1b_cut_end,'_snv',sep='')
VHLx1brLD1_pSNV_all <- which(VHLx1brLD1[,VHLx1b_p_hdr_snv]=='True')
VHLx1brLD1_pSNV_all_df = VHLx1brLD1[VHLx1brLD1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brLD1_pSNV_all_lib_count = length(VHLx1brLD1_pSNV_all_df$lib)
VHLx1brLD1_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx1brLD1_pSNV_all_min_lib_counts = min(VHLx1brLD1_pSNV_all_df$lib)
VHLx1brLD1_pSNV_all_min_lib_counts
VHLx1brLD1_pSNV_all_max_lib_counts = max(VHLx1brLD1_pSNV_all_df$lib)
VHLx1brLD1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx1brLD1_pSNV_all_pre_count = length(VHLx1brLD1_pSNV_all_df$pre)
VHLx1brLD1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx1brLD1_pSNV_all_min_pre_counts = min(VHLx1brLD1_pSNV_all_df$pre)
VHLx1brLD1_pSNV_all_min_pre_counts
VHLx1brLD1_pSNV_all_max_pre_counts = max(VHLx1brLD1_pSNV_all_df$pre)
VHLx1brLD1_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brLD1_pSNV_all_post_count = length(VHLx1brLD1_pSNV_all_df$post)
VHLx1brLD1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx1brLD1_pSNV_all_min_post_counts = min(VHLx1brLD1_pSNV_all_df$post)
VHLx1brLD1_pSNV_all_min_post_counts
VHLx1brLD1_pSNV_all_max_post_counts = max(VHLx1brLD1_pSNV_all_df$post)
VHLx1brLD1_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brLD1_prog_map_thresh5_lib_count = length(VHLx1brLD1_prog_map_thresh5_df$lib)
VHLx1brLD1_prog_map_thresh5_lib_count
VHLx1brLD1_prog_map_thresh5_min_lib_counts = min(VHLx1brLD1_prog_map_thresh5_df$lib)
VHLx1brLD1_prog_map_thresh5_min_lib_counts
VHLx1brLD1_prog_map_thresh5_max_lib_counts = max(VHLx1brLD1_prog_map_thresh5_df$lib)
VHLx1brLD1_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brLD1_prog_map_thresh5_pre_count = length(VHLx1brLD1_prog_map_thresh5_df$pre)
VHLx1brLD1_prog_map_thresh5_pre_count
VHLx1brLD1_prog_map_thresh5_min_pre_counts = min(VHLx1brLD1_prog_map_thresh5_df$pre)
VHLx1brLD1_prog_map_thresh5_min_pre_counts
VHLx1brLD1_prog_map_thresh5_max_pre_counts = max(VHLx1brLD1_prog_map_thresh5_df$pre)
VHLx1brLD1_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1brLD1_prog_map_thresh5_post_count = length(VHLx1brLD1_prog_map_thresh5_df$post)
VHLx1brLD1_prog_map_thresh5_post_count
VHLx1brLD1_prog_map_thresh5_min_post_counts = min(VHLx1brLD1_prog_map_thresh5_df$post)
VHLx1brLD1_prog_map_thresh5_min_post_counts
VHLx1brLD1_prog_map_thresh5_max_post_counts = max(VHLx1brLD1_prog_map_thresh5_df$post)
VHLx1brLD1_prog_map_thresh5_max_post_counts
VHLx1brLD1_prog_map_thresh5_corr_post_count = length(VHLx1brLD1_cSNV_all_df$corr_post)
VHLx1brLD1_prog_map_thresh5_corr_post_count
VHLx1brLD1_prog_map_thresh5_min_corr_post_counts = min(VHLx1brLD1_cSNV_all_df$corr_post)
VHLx1brLD1_prog_map_thresh5_min_corr_post_counts
VHLx1brLD1_prog_map_thresh5_max_corr_post_counts = max(VHLx1brLD1_cSNV_all_df$corr_post)
VHLx1brLD1_prog_map_thresh5_max_corr_post_counts

VHLx1brLD1_pSNV_thresh5 <- which(VHLx1brLD1[,VHLx1b_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1brLD1[,'pre_freq']))>=0.00001)
VHLx1brLD1_pSNV_thresh5_df = VHLx1brLD1[VHLx1brLD1_pSNV_thresh5,]
VHLx1brLD1_pSNV_thresh5_lib_count = length(VHLx1brLD1_pSNV_thresh5_df$lib)
VHLx1brLD1_pSNV_thresh5_lib_count
VHLx1brLD1_pSNV_thresh5_min_lib_counts = min(VHLx1brLD1_pSNV_thresh5_df$lib)
VHLx1brLD1_pSNV_thresh5_min_lib_counts
VHLx1brLD1_pSNV_thresh5_max_lib_counts = max(VHLx1brLD1_pSNV_thresh5_df$lib)
VHLx1brLD1_pSNV_thresh5_max_lib_counts
VHLx1brLD1_pSNV_thresh5_pre_count = length(VHLx1brLD1_pSNV_thresh5_df$pre)
VHLx1brLD1_pSNV_thresh5_pre_count
VHLx1brLD1_pSNV_thresh5_min_pre_counts = min(VHLx1brLD1_pSNV_thresh5_df$pre)
VHLx1brLD1_pSNV_thresh5_min_pre_counts
VHLx1brLD1_pSNV_thresh5_max_pre_counts = max(VHLx1brLD1_pSNV_thresh5_df$pre)
VHLx1brLD1_pSNV_thresh5_max_pre_counts
VHLx1brLD1_pSNV_thresh5_post_count = length(VHLx1brLD1_pSNV_thresh5_df$post)
VHLx1brLD1_pSNV_thresh5_post_count
VHLx1brLD1_pSNV_thresh5_min_post_counts = min(VHLx1brLD1_pSNV_thresh5_df$post)
VHLx1brLD1_pSNV_thresh5_min_post_counts
VHLx1brLD1_pSNV_thresh5_max_post_counts = max(VHLx1brLD1_pSNV_thresh5_df$post)
VHLx1brLD1_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx1brLD2_cSNV_all <- which(VHLx1brLD2[,'c_hdr_snv']=='True')
VHLx1brLD2_cSNV_all_df = VHLx1brLD2[VHLx1brLD2_cSNV_all,]
VHLx1brLD2_prog_var_all <- which(VHLx1brLD2[,'all_hdr_variant']=='True' & VHLx1brLD2[,'edit_string']!='-WT')
VHLx1brLD2_prog_var_all_df = VHLx1brLD2[VHLx1brLD2_prog_var_all,]
VHLx1brLD2_prog_map_all = which(VHLx1brLD2_prog_var_all_df[,'pos']!='REF')
VHLx1brLD2_prog_map_all_df = VHLx1brLD2_prog_var_all_df[VHLx1brLD2_prog_map_all,]
VHLx1brLD2_prog_map_exon_all = which(VHLx1brLD2_prog_map_all_df[,'cDNApos']!='REF' & VHLx1brLD2_prog_map_all_df[,'cDNApos']!='NA')
VHLx1brLD2_prog_map_exon_all_df = VHLx1brLD2_prog_map_all_df[VHLx1brLD2_prog_map_exon_all,]
VHLx1brLD2_prog_map_CADD = which(VHLx1brLD2_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1brLD2_prog_map_CADD_df = VHLx1brLD2_prog_map_all_df[VHLx1brLD2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx1brLD2_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1brLD2_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx1brLD2_prog_var_thresh5_df = VHLx1brLD2_prog_var_all_df[VHLx1brLD2_prog_var_thresh5,]
VHLx1brLD2_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1brLD2_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx1brLD2_prog_map_thresh5_df = VHLx1brLD2_prog_map_all_df[VHLx1brLD2_prog_map_thresh5,]
VHLx1brLD2_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1brLD2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx1brLD2_prog_map_exon_thresh5_df = VHLx1brLD2_prog_map_exon_all_df[VHLx1brLD2_prog_map_exon_thresh5,]
VHLx1brLD2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1brLD2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx1brLD2_prog_map_CADD_thresh5_df = VHLx1brLD2_prog_map_CADD_df[VHLx1brLD2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1brLD2_prog_var_all_lib_count = length(VHLx1brLD2_prog_var_all_df$lib)
VHLx1brLD2_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx1brLD2_prog_var_all_min_lib_counts = min(VHLx1brLD2_prog_var_all_df$lib)
VHLx1brLD2_prog_var_all_min_lib_counts
VHLx1brLD2_prog_var_all_max_lib_counts = max(VHLx1brLD2_prog_var_all_df$lib)
VHLx1brLD2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1brLD2_prog_map_all_lib_count = length(VHLx1brLD2_prog_map_all_df$lib)
VHLx1brLD2_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx1brLD2_prog_map_all_min_lib_counts = min(VHLx1brLD2_prog_map_all_df$lib)
VHLx1brLD2_prog_map_all_min_lib_counts
VHLx1brLD2_prog_map_all_max_lib_counts = max(VHLx1brLD2_prog_map_all_df$lib)
VHLx1brLD2_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx1brLD2_prog_var_all_pre_count = length(VHLx1brLD2_prog_var_all_df$pre)
VHLx1brLD2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx1brLD2_prog_var_all_min_pre_counts = min(VHLx1brLD2_prog_var_all_df$pre)
VHLx1brLD2_prog_var_all_min_pre_counts
VHLx1brLD2_prog_var_all_max_pre_counts = max(VHLx1brLD2_prog_var_all_df$pre)
VHLx1brLD2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1brLD2_prog_map_all_pre_count = length(VHLx1brLD2_prog_map_all_df$pre)
VHLx1brLD2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx1brLD2_prog_map_all_min_pre_counts = min(VHLx1brLD2_prog_map_all_df$pre)
VHLx1brLD2_prog_map_all_min_pre_counts
VHLx1brLD2_prog_map_all_max_pre_counts = max(VHLx1brLD2_prog_map_all_df$pre)
VHLx1brLD2_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx1brLD2_prog_map_all_post_count = length(VHLx1brLD2_prog_map_all_df$post)
VHLx1brLD2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx1brLD2_prog_map_all_min_post_counts = min(VHLx1brLD2_prog_map_all_df$post)
VHLx1brLD2_prog_map_all_min_post_counts
VHLx1brLD2_prog_map_all_max_post_counts = max(VHLx1brLD2_prog_map_all_df$post)
VHLx1brLD2_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx1brLD2_prog_map_all_syn_df <- VHLx1brLD2_prog_map_all_df[which(VHLx1brLD2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1brLD2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1brLD2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1brLD2_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1brLD2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1brLD2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1brLD2_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1brLD2_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1brLD2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx1brLD2_prog_map_all_min_rna_counts = min(VHLx1brLD2_prog_map_exon_all_df$tHDR_rna)
VHLx1brLD2_prog_map_all_min_rna_counts
VHLx1brLD2_prog_map_all_max_rna_counts = max(VHLx1brLD2_prog_map_exon_all_df$tHDR_rna)
VHLx1brLD2_prog_map_all_max_rna_counts
VHLx1brLD2_prog_map_all_min_rna_pseudo_freq = min(VHLx1brLD2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1brLD2_prog_map_all_min_rna_pseudo_freq
VHLx1brLD2_prog_map_all_max_rna_pseudo_freq = max(VHLx1brLD2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1brLD2_prog_map_all_max_rna_pseudo_freq
VHLx1brLD2_prog_map_all_min_rna_pre_ratio = min(VHLx1brLD2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1brLD2_prog_map_all_min_rna_pre_ratio
VHLx1brLD2_prog_map_all_max_rna_pre_ratio = max(VHLx1brLD2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1brLD2_prog_map_all_max_rna_pre_ratio
VHLx1brLD2_prog_map_all_min_rna_post_ratio = min(VHLx1brLD2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1brLD2_prog_map_all_min_rna_post_ratio
VHLx1brLD2_prog_map_all_max_rna_post_ratio = max(VHLx1brLD2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1brLD2_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1brLD2_cSNV_all_corr_pre_count = length(VHLx1brLD2_cSNV_all_df$corr_pre)
VHLx1brLD2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx1brLD2_cSNV_all_min_corr_pre_counts = min(VHLx1brLD2_cSNV_all_df$corr_pre)
VHLx1brLD2_cSNV_all_min_corr_pre_counts
VHLx1brLD2_cSNV_all_max_corr_pre_counts = max(VHLx1brLD2_cSNV_all_df$corr_pre)
VHLx1brLD2_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brLD2_cSNV_all_corr_post_count = length(VHLx1brLD2_cSNV_all_df$corr_post)
VHLx1brLD2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx1brLD2_cSNV_all_min_corr_post_counts = min(VHLx1brLD2_cSNV_all_df$corr_post)
VHLx1brLD2_cSNV_all_min_corr_post_counts
VHLx1brLD2_cSNV_all_max_corr_post_counts = max(VHLx1brLD2_cSNV_all_df$corr_post)
VHLx1brLD2_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx1b_p_hdr_snv = paste('p_hdr_',VHLx1b_cut_end,'_snv',sep='')
VHLx1brLD2_pSNV_all <- which(VHLx1brLD2[,VHLx1b_p_hdr_snv]=='True')
VHLx1brLD2_pSNV_all_df = VHLx1brLD2[VHLx1brLD2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brLD2_pSNV_all_lib_count = length(VHLx1brLD2_pSNV_all_df$lib)
VHLx1brLD2_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx1brLD2_pSNV_all_min_lib_counts = min(VHLx1brLD2_pSNV_all_df$lib)
VHLx1brLD2_pSNV_all_min_lib_counts
VHLx1brLD2_pSNV_all_max_lib_counts = max(VHLx1brLD2_pSNV_all_df$lib)
VHLx1brLD2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx1brLD2_pSNV_all_pre_count = length(VHLx1brLD2_pSNV_all_df$pre)
VHLx1brLD2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx1brLD2_pSNV_all_min_pre_counts = min(VHLx1brLD2_pSNV_all_df$pre)
VHLx1brLD2_pSNV_all_min_pre_counts
VHLx1brLD2_pSNV_all_max_pre_counts = max(VHLx1brLD2_pSNV_all_df$pre)
VHLx1brLD2_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brLD2_pSNV_all_post_count = length(VHLx1brLD2_pSNV_all_df$post)
VHLx1brLD2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx1brLD2_pSNV_all_min_post_counts = min(VHLx1brLD2_pSNV_all_df$post)
VHLx1brLD2_pSNV_all_min_post_counts
VHLx1brLD2_pSNV_all_max_post_counts = max(VHLx1brLD2_pSNV_all_df$post)
VHLx1brLD2_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brLD2_prog_map_thresh5_lib_count = length(VHLx1brLD2_prog_map_thresh5_df$lib)
VHLx1brLD2_prog_map_thresh5_lib_count
VHLx1brLD2_prog_map_thresh5_min_lib_counts = min(VHLx1brLD2_prog_map_thresh5_df$lib)
VHLx1brLD2_prog_map_thresh5_min_lib_counts
VHLx1brLD2_prog_map_thresh5_max_lib_counts = max(VHLx1brLD2_prog_map_thresh5_df$lib)
VHLx1brLD2_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brLD2_prog_map_thresh5_pre_count = length(VHLx1brLD2_prog_map_thresh5_df$pre)
VHLx1brLD2_prog_map_thresh5_pre_count
VHLx1brLD2_prog_map_thresh5_min_pre_counts = min(VHLx1brLD2_prog_map_thresh5_df$pre)
VHLx1brLD2_prog_map_thresh5_min_pre_counts
VHLx1brLD2_prog_map_thresh5_max_pre_counts = max(VHLx1brLD2_prog_map_thresh5_df$pre)
VHLx1brLD2_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1brLD2_prog_map_thresh5_post_count = length(VHLx1brLD2_prog_map_thresh5_df$post)
VHLx1brLD2_prog_map_thresh5_post_count
VHLx1brLD2_prog_map_thresh5_min_post_counts = min(VHLx1brLD2_prog_map_thresh5_df$post)
VHLx1brLD2_prog_map_thresh5_min_post_counts
VHLx1brLD2_prog_map_thresh5_max_post_counts = max(VHLx1brLD2_prog_map_thresh5_df$post)
VHLx1brLD2_prog_map_thresh5_max_post_counts
VHLx1brLD2_prog_map_thresh5_corr_post_count = length(VHLx1brLD2_cSNV_all_df$corr_post)
VHLx1brLD2_prog_map_thresh5_corr_post_count
VHLx1brLD2_prog_map_thresh5_min_corr_post_counts = min(VHLx1brLD2_cSNV_all_df$corr_post)
VHLx1brLD2_prog_map_thresh5_min_corr_post_counts
VHLx1brLD2_prog_map_thresh5_max_corr_post_counts = max(VHLx1brLD2_cSNV_all_df$corr_post)
VHLx1brLD2_prog_map_thresh5_max_corr_post_counts

VHLx1brLD2_pSNV_thresh5 <- which(VHLx1brLD2[,VHLx1b_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1brLD2[,'pre_freq']))>=0.00001)
VHLx1brLD2_pSNV_thresh5_df = VHLx1brLD2[VHLx1brLD2_pSNV_thresh5,]
VHLx1brLD2_pSNV_thresh5_lib_count = length(VHLx1brLD2_pSNV_thresh5_df$lib)
VHLx1brLD2_pSNV_thresh5_lib_count
VHLx1brLD2_pSNV_thresh5_min_lib_counts = min(VHLx1brLD2_pSNV_thresh5_df$lib)
VHLx1brLD2_pSNV_thresh5_min_lib_counts
VHLx1brLD2_pSNV_thresh5_max_lib_counts = max(VHLx1brLD2_pSNV_thresh5_df$lib)
VHLx1brLD2_pSNV_thresh5_max_lib_counts
VHLx1brLD2_pSNV_thresh5_pre_count = length(VHLx1brLD2_pSNV_thresh5_df$pre)
VHLx1brLD2_pSNV_thresh5_pre_count
VHLx1brLD2_pSNV_thresh5_min_pre_counts = min(VHLx1brLD2_pSNV_thresh5_df$pre)
VHLx1brLD2_pSNV_thresh5_min_pre_counts
VHLx1brLD2_pSNV_thresh5_max_pre_counts = max(VHLx1brLD2_pSNV_thresh5_df$pre)
VHLx1brLD2_pSNV_thresh5_max_pre_counts
VHLx1brLD2_pSNV_thresh5_post_count = length(VHLx1brLD2_pSNV_thresh5_df$post)
VHLx1brLD2_pSNV_thresh5_post_count
VHLx1brLD2_pSNV_thresh5_min_post_counts = min(VHLx1brLD2_pSNV_thresh5_df$post)
VHLx1brLD2_pSNV_thresh5_min_post_counts
VHLx1brLD2_pSNV_thresh5_max_post_counts = max(VHLx1brLD2_pSNV_thresh5_df$post)
VHLx1brLD2_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx1brLD1_prog_var_thresh5_df:
VHLx1brLD1_prog_var_thresh5_df_rLD2_int <- VHLx1brLD1_prog_var_thresh5_df[which(VHLx1brLD1_prog_var_thresh5_df$variant %in% VHLx1brLD2_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx1brLD2_prog_var_thresh5_df:
VHLx1brLD2_prog_var_thresh5_df_rLD1_int <- VHLx1brLD2_prog_var_thresh5_df[which(VHLx1brLD2_prog_var_thresh5_df$variant %in% VHLx1brLD1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int[order(VHLx1brLD1_prog_var_thresh5_df_rLD2_int$variant),]
VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int[order(VHLx1brLD2_prog_var_thresh5_df_rLD1_int$variant),]
dim(VHLx1brLD1_prog_var_thresh5_df)[1] #Number of prog_vars in rLD1
VHLx1brLD1rLD2int_prog_var_thresh5_pre_count <- dim(VHLx1brLD1_prog_var_thresh5_df_rLD2_int)[1] 
VHLx1brLD1rLD2int_prog_var_thresh5_pre_count #Number of prog_vars in rLD1 also in rLD2
dim(VHLx1brLD2_prog_var_thresh5_df)[1] #Number of prog_vars in rLD2
dim(VHLx1brLD2_prog_var_thresh5_df_rLD1_int)[1] #Number of prog_vars in rLD2 also in rLD1

#Add the following columns from the from rLD2 df to the rLD1 df:
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$pre
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_lib <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$lib
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$rna
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2 <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post2
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3 <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post3
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2 <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$rna2
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$pre_pseudo
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post_pseudo
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pseudo <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pseudo
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pseudo <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pseudo
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pseudo <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pseudo
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_pseudo <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_pseudo
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$pre_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$rna_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post2_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post3_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$pre_pseudo_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post_pseudo_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pseudo_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pseudo_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pseudo_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pseudo_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pseudo_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pseudo_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_pseudo_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_pseudo_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$pre_lib_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post_pre_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post_lib_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pre_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pre_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_post_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$rna_post_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pre_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pre_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pre_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_post_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_snv_error_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$pre_snv_error_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_snv_error_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$post_snv_error_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_exp_snv_error_reads_pre <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$exp_snv_error_reads_pre
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_exp_snv_error_reads_post <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$exp_snv_error_reads_post
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pre <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pre
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_post <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$corr_post
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pre_pseudo <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pre_pseudo
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_post_pseudo <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$corr_post_pseudo
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pseudo_post_pre_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pseudo_post_pre_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_lib <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_lib
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2 <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3 <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2 <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre_pseudo_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pseudo_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_pseudo_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pseudo_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_pseudo_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pseudo_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2_pseudo_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pseudo_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3_pseudo_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_pseudo_freq <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2_pseudo_freq
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre_lib_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_pre_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_lib_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_pre_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_post_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2_pre_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pre_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3_pre_ratio
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio <- VHLx1brLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio) + log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio))/2)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio) + log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio))/2)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio) + log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio))/2)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio) + log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio))/2)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post3_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post3_pre_ratio) + log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pre_ratio))/2)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rna2_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rna2_post_ratio) + log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio))/2)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio) + log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio))/2)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio) + log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio))/2)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio) + log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio))/2)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio) + log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio))/2)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio) + log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio))/2)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio) + log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio))/2)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post3_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post3_pre_ratio) + log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pre_ratio))/2)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio) + log2(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_pre_weighted <- ((VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq*VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq/(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq))+(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq*VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq/(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)))/VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq
#rLD1 pre-freq weighting coefficient (rLD1_pre-freq / (rLD1 + rLD2 pre-freq's))
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq/(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq/(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)
#this will be weighted by denominator:  (rLD1_pof/rLD1_prf)(rLD1_prwc)+(rLD2_pof/rLD2_prf)*(rLD2_prwc)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted <- (VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pseudo_freq/VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq)*(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight)+(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq/VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)*(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight)
#this will be weighted by denominator:  (rLD1_pof/lif')*(rLD1_prwc)+(rLD2_pof/lif)*(rLD2_prwc)
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_pre_weighted <- (VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pseudo_freq/VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq)*(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight)+(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq/VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq)*(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight)
#rLD1 tHDR_pre-freq weighting coefficient (rLD1_tHDR_pre-freq / (rLD1 + rLD2 pre-freq's))
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_weight <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq/(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq+VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)
#rLD2 tHDR_pre-freq weighting coefficient
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_weight <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq/(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq+VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rLD1_pof/rLD1_prf)(rLD1_prwc)+(rLD2_pof/rLD2_prf)*(rLD2_prwc)
#tHDR_post_pre_ratio_rLD1rLD2_pre_weighted
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted <- (VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pseudo_freq/VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq)*(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_weight)+(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pseudo_freq/VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)*(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq)) >= 10) {
    VHLx1brLD1_cSNV_pre_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx1brLD1_cSNV_post_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx1brLD1_cSNV_post2_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx1brLD1_cSNV_post_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx1brLD1_tSNV_pre_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx1brLD1_tSNV_post_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx1brLD1_tSNV_post_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx1brLD1_tSNV_rna_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx1brLD1_tSNV_rna_post_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx1brLD1_tSNV_rna2_post_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx1brLD2_cSNV_pre_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_pre_lib_ratio)
VHLx1brLD2_cSNV_post_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post_pre_ratio)
VHLx1brLD2_cSNV_post2_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post2_pre_ratio)

VHLx1brLD2_cSNV_post_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post_lib_ratio)
VHLx1brLD2_tSNV_pre_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_pre_lib_ratio)
VHLx1brLD2_tSNV_post_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post_pre_ratio)
VHLx1brLD2_tSNV_post2_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post2_pre_ratio)
VHLx1brLD2_tSNV_post_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post_lib_ratio)
VHLx1brLD2_tSNV_rna_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna_pre_ratio)
VHLx1brLD2_tSNV_rna_post_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna_post_ratio)
VHLx1brLD2_tSNV_rna2_post_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna2_post_ratio)
VHLx1brLD1rLD2a_cSNV_pre_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_cSNV_post_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_cSNV_post2_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_cSNV_post_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_tSNV_pre_lib_med <- 
  median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_tSNV_post_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_tSNV_post2_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_tSNV_post_lib_med <-
  median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_tSNV_rna_pre_med <-
  median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_tSNV_rna_post_med <-
  median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_tSNV_rna2_post_med <-
  median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2pw_tSNV_post_pre_med  <-
  median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted)
VHLx1brLD1rLD2pw_cSNV_post_pre_med  <-
  median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLD1rLD2_pre_weighted)
  } else {
  VHLx1brLD1_cSNV_pre_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio)
VHLx1brLD1_cSNV_post_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio)
VHLx1brLD1_cSNV_post2_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio)
VHLx1brLD1_cSNV_post_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio)
VHLx1brLD1_tSNV_pre_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio)
VHLx1brLD1_tSNV_post_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio)
VHLx1brLD1_tSNV_post_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio)
VHLx1brLD1_tSNV_rna_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio)
VHLx1brLD1_tSNV_rna_post_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio)
VHLx1brLD1_tSNV_rna2_post_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio)
VHLx1brLD2_cSNV_pre_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio)
VHLx1brLD2_cSNV_post_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio)
VHLx1brLD2_cSNV_post2_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio)

VHLx1brLD2_cSNV_post_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio)
VHLx1brLD2_tSNV_pre_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio)
VHLx1brLD2_tSNV_post_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio)
VHLx1brLD2_tSNV_post2_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio)
VHLx1brLD2_tSNV_post_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio)
VHLx1brLD2_tSNV_rna_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio)
VHLx1brLD2_tSNV_rna_post_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio)
VHLx1brLD2_tSNV_rna2_post_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio)
VHLx1brLD1rLD2a_cSNV_pre_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_cSNV_post_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_cSNV_post2_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_cSNV_post_lib_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_tSNV_pre_lib_med <- 
  median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_tSNV_post_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_tSNV_post2_pre_med <- median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_tSNV_post_lib_med <-
  median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_tSNV_rna_pre_med <-
  median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_tSNV_rna_post_med <-
  median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2a_tSNV_rna2_post_med <-
  median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean)
VHLx1brLD1rLD2pw_tSNV_post_pre_med  <-
  median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted)
VHLx1brLD1rLD2pw_cSNV_post_pre_med  <-
  median(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted)
}

VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio/VHLx1brLD1_cSNV_pre_lib_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio/VHLx1brLD1_cSNV_post_pre_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio/VHLx1brLD1_cSNV_post_lib_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio/VHLx1brLD1_cSNV_post2_pre_med

VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio/VHLx1brLD1_tSNV_pre_lib_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio/VHLx1brLD1_tSNV_post_pre_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio/VHLx1brLD1_tSNV_post_lib_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio/VHLx1brLD1_tSNV_rna_pre_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio/VHLx1brLD1_tSNV_rna_post_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio/VHLx1brLD2_tSNV_post2_pre_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio/VHLx1brLD1_tSNV_rna2_post_med

VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio/VHLx1brLD2_cSNV_pre_lib_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio/VHLx1brLD2_cSNV_post_pre_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio/VHLx1brLD2_cSNV_post_lib_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio/VHLx1brLD1rLD2a_cSNV_post2_pre_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio/VHLx1brLD2_tSNV_rna2_post_med


VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio/VHLx1brLD2_tSNV_pre_lib_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio/VHLx1brLD2_tSNV_post_pre_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio/VHLx1brLD2_tSNV_post2_pre_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio/VHLx1brLD2_tSNV_post_lib_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio/VHLx1brLD2_tSNV_rna_pre_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio/VHLx1brLD2_tSNV_rna_post_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio/VHLx1brLD2_tSNV_rna2_post_med

###normalize the means
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean/VHLx1brLD1rLD2a_cSNV_pre_lib_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean/VHLx1brLD1rLD2a_cSNV_post_pre_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean/VHLx1brLD1rLD2a_cSNV_post_lib_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean/VHLx1brLD1rLD2a_tSNV_pre_lib_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean/VHLx1brLD1rLD2a_tSNV_post_pre_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean/VHLx1brLD1rLD2a_tSNV_post2_pre_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean/VHLx1brLD1rLD2a_tSNV_post_lib_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean/VHLx1brLD1rLD2a_tSNV_rna_pre_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean/VHLx1brLD1rLD2a_tSNV_rna_post_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean/VHLx1brLD1rLD2a_tSNV_rna2_post_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted/VHLx1brLD1rLD2pw_tSNV_post_pre_med
VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm <- VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted/VHLx1brLD1rLD2pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord
VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord = which(VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[,'pos']!='REF')
VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df = VHLx1brLD1_prog_var_thresh5_df_rLD2_int_ord[VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord,]
VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord = which(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'cDNApos']!='REF' & VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'cDNApos']!='NA')
VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df = VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df[VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord,]
VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord = which(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'CADD.phred']!='NA')
VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df = VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df[VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord,]
VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense <- VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df[which(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx1brLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s
VHLx1brLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_p <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='pearson')
VHLx1brLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_p
VHLx1brLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s
VHLx1brLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_p <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='pearson')
VHLx1brLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_p
VHLx1brLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post2_pre_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s
VHLx1brLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_p <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post2_pre_ratio_synnorm),method='pearson')
VHLx1brLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_p
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_s <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_s
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_p <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_p
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_s <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_s
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_p <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_p
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_s <- cor(log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_s
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_p <- cor(log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_p
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_s <- cor(log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_s
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_p <- cor(log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx1brLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_p
VHLx1brLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_s <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_freq),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_freq),method='spearman')
VHLx1brLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_s
VHLx1brLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_p <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pseudo_freq),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pseudo_freq),method='pearson')
VHLx1brLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_p
VHLx1brLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_s <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_s
VHLx1brLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_p <-cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio_synnorm),method='pearson')
VHLx1brLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_p
VHLx1brLD1rLD2_tSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_tSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s
VHLx1brLD1rLD2_tSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_tSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s
VHLx1brLD1rLD2_tSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_tSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s
VHLx1brLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s
VHLx1brLD1rLD2_tSNV_rLD1_rna2_post_by_rLD2_rna2_post_cor_s <- cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_tSNV_rLD1_rna2_post_by_rLD2_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx1brLD1_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1_cSNV_post_pre_by_cadd_cor_s
VHLx1brLD2_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD2_cSNV_post_pre_by_cadd_cor_s
VHLx1brLD1_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1_cSNV_post_lib_by_cadd_cor_s
VHLx1brLD2_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD2_cSNV_post_lib_by_cadd_cor_s
VHLx1brLD1_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1_tSNV_post_pre_by_cadd_cor_s
VHLx1brLD2_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD2_tSNV_post_pre_by_cadd_cor_s
VHLx1brLD1_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1_tSNV_post_lib_by_cadd_cor_s
VHLx1brLD2_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx1brLD1rLD2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2a_cSNV_pre_lib_by_cadd_cor_s
VHLx1brLD1rLD2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2w_cSNV_pre_lib_by_cadd_cor_s
VHLx1brLD1rLD2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2a_cSNV_post_pre_by_cadd_cor_s
VHLx1brLD1rLD2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2w_cSNV_post_pre_by_cadd_cor_s
VHLx1brLD1rLD2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2a_cSNV_post_lib_by_cadd_cor_s
VHLx1brLD1rLD2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2w_cSNV_post_lib_by_cadd_cor_s
VHLx1brLD1rLD2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2a_tSNV_pre_lib_by_cadd_cor_s
VHLx1brLD1rLD2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2a_tSNV_post_pre_by_cadd_cor_s
VHLx1brLD1rLD2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2w_tSNV_post_pre_by_cadd_cor_s
VHLx1brLD1rLD2a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post2_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2a_tSNV_post2_pre_by_cadd_cor_s
VHLx1brLD1rLD2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx1brLD1_cSNV_pre_lib_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1brLD1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1brLD1_tSNV_pre_lib_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1brLD1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1brLD1_cSNV_post_lib_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1brLD1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1brLD1_tSNV_post_lib_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1brLD1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1brLD1_cSNV_post_pre_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1brLD1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1brLD1_tSNV_post_pre_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1brLD1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1brLD1_cSNV_rna_lib_cors = cor(log2(VHLx1brLD1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1brLD1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1brLD1_tSNV_rna_lib_cors = cor(log2(VHLx1brLD1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1brLD1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1brLD1_cSNV_rna_pre_cors = cor(log2(VHLx1brLD1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1brLD1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1brLD1_tSNV_rna_pre_cors = cor(log2(VHLx1brLD1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1brLD1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1brLD1rLD2_cSNV_pre_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_freq),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_freq),method='spearman')
VHLx1brLD1rLD2_tSNV_pre_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_pseudo_freq),method='spearman')
VHLx1brLD1rLD2_cSNV_pre_lib_ratio_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio),method='spearman')
VHLx1brLD1rLD2_tSNV_pre_lib_ratio_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio),method='spearman')
VHLx1brLD1rLD2_cSNV_post_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_freq),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_freq),method='spearman')
VHLx1brLD1rLD2_tSNV_post_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pseudo_freq),method='spearman')
VHLx1brLD1rLD2_cSNV_post_lib_ratio_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_tSNV_post_lib_ratio_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_cSNV_post_pre_ratio_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_tSNV_post_pre_ratio_cors = cor(log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_cSNV_rna_cors = cor(log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rna_freq),log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_rna_freq),method='spearman')
VHLx1brLD1rLD2_tSNV_rna_cors = cor(log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pseudo_freq),method='spearman')
VHLx1brLD1rLD2_tSNV_rna_pre_ratio_cors = cor(log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1brLD1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brLD1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brLD1_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brLD1_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brLD1_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brLD1_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brLD1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1brLD1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1brLD1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1brLD1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1brLD1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1brLD1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1brLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1brLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1brLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1brLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1brLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1brLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1brLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1brLD1rLD2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')

VHLx1brLD1_cors <- c("VHLx1brLD1",VHLx1brLD1_cSNV_pre_lib_cors,VHLx1brLD1_tSNV_pre_lib_cors,VHLx1brLD1_cSNV_post_lib_cors,VHLx1brLD1_tSNV_post_lib_cors,VHLx1brLD1_cSNV_post_pre_cors,VHLx1brLD1_tSNV_post_pre_cors,VHLx1brLD1_cSNV_rna_lib_cors,VHLx1brLD1_tSNV_rna_lib_cors,VHLx1brLD1_cSNV_rna_pre_cors,VHLx1brLD1_tSNV_rna_pre_cors,VHLx1brLD1rLD2_cSNV_pre_cors,VHLx1brLD1rLD2_tSNV_pre_cors,VHLx1brLD1rLD2_cSNV_pre_lib_ratio_cors,VHLx1brLD1rLD2_tSNV_pre_lib_ratio_cors,VHLx1brLD1rLD2_cSNV_post_cors,VHLx1brLD1rLD2_tSNV_post_cors,VHLx1brLD1rLD2_cSNV_post_lib_ratio_cors,VHLx1brLD1rLD2_tSNV_post_lib_ratio_cors,VHLx1brLD1rLD2_cSNV_post_pre_ratio_cors,VHLx1brLD1rLD2_tSNV_post_pre_ratio_cors,VHLx1brLD1rLD2_cSNV_rna_cors,VHLx1brLD1rLD2_tSNV_rna_cors,VHLx1brLD1rLD2_tSNV_rna_pre_ratio_cors,VHLx1brLD1_cSNV_pre_lib_ratio_cadd_cors,VHLx1brLD1_tSNV_pre_lib_ratio_cadd_cors,VHLx1brLD1_cSNV_post_lib_ratio_cadd_cors,VHLx1brLD1_tSNV_post_lib_ratio_cadd_cors,VHLx1brLD1_cSNV_post_pre_ratio_cadd_cors,VHLx1brLD1_tSNV_post_pre_ratio_cadd_cors,VHLx1brLD1_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1brLD1_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1brLD1_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brLD1_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brLD1_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1brLD1_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1brLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors,VHLx1brLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors,VHLx1brLD1rLD2a_cSNV_post_lib_ratio_cadd_cors,VHLx1brLD1rLD2a_tSNV_post_lib_ratio_cadd_cors,VHLx1brLD1rLD2a_cSNV_post_pre_ratio_cadd_cors,VHLx1brLD1rLD2a_tSNV_post_pre_ratio_cadd_cors,VHLx1brLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1brLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1brLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1brLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1brLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors,VHLx1brLD1rLD2w_cSNV_post_lib_ratio_cadd_cors,VHLx1brLD1rLD2w_cSNV_post_pre_ratio_cadd_cors,VHLx1brLD1rLD2w_tSNV_post_pre_ratio_cadd_cors)

VHLx1brLD2_cSNV_pre_lib_cors = cor(log2(VHLx1brLD2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1brLD2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1brLD2_tSNV_pre_lib_cors = cor(log2(VHLx1brLD2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1brLD2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1brLD2_cSNV_post_lib_cors = cor(log2(VHLx1brLD2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1brLD2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1brLD2_tSNV_post_lib_cors = cor(log2(VHLx1brLD2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1brLD2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1brLD2_cSNV_post_pre_cors = cor(log2(VHLx1brLD2_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1brLD2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1brLD2_tSNV_post_pre_cors = cor(log2(VHLx1brLD2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1brLD2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1brLD2_cSNV_rna_lib_cors = cor(log2(VHLx1brLD2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1brLD2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1brLD2_tSNV_rna_lib_cors = cor(log2(VHLx1brLD2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1brLD2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1brLD2_cSNV_rna_pre_cors = cor(log2(VHLx1brLD2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1brLD2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1brLD2_tSNV_rna_pre_cors = cor(log2(VHLx1brLD2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1brLD2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1brLD2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1brLD2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1brLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brLD2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1brLD2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1brLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brLD2_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1brLD2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1brLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brLD2_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1brLD2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1brLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brLD2_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brLD2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1brLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brLD2_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brLD2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brLD2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1brLD2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1brLD2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1brLD2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1brLD2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1brLD2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')

VHLx1brLD2_cors <- c("VHLx1brLD2",VHLx1brLD2_cSNV_pre_lib_cors,VHLx1brLD2_tSNV_pre_lib_cors,VHLx1brLD2_cSNV_post_lib_cors,VHLx1brLD2_tSNV_post_lib_cors,VHLx1brLD2_cSNV_post_pre_cors,VHLx1brLD2_tSNV_post_pre_cors,VHLx1brLD2_cSNV_rna_lib_cors,VHLx1brLD2_tSNV_rna_lib_cors,VHLx1brLD2_cSNV_rna_pre_cors,VHLx1brLD2_tSNV_rna_pre_cors,VHLx1brLD1rLD2_cSNV_pre_cors,VHLx1brLD1rLD2_tSNV_pre_cors,VHLx1brLD1rLD2_cSNV_pre_lib_ratio_cors,VHLx1brLD1rLD2_tSNV_pre_lib_ratio_cors,VHLx1brLD1rLD2_cSNV_post_cors,VHLx1brLD1rLD2_tSNV_post_cors,VHLx1brLD1rLD2_cSNV_post_lib_ratio_cors,VHLx1brLD1rLD2_tSNV_post_lib_ratio_cors,VHLx1brLD1rLD2_cSNV_post_pre_ratio_cors,VHLx1brLD1rLD2_tSNV_post_pre_ratio_cors,VHLx1brLD1rLD2_cSNV_rna_cors,VHLx1brLD1rLD2_tSNV_rna_cors,VHLx1brLD1rLD2_tSNV_rna_pre_ratio_cors,VHLx1brLD2_cSNV_pre_lib_ratio_cadd_cors,VHLx1brLD2_tSNV_pre_lib_ratio_cadd_cors,VHLx1brLD2_cSNV_post_lib_ratio_cadd_cors,VHLx1brLD2_tSNV_post_lib_ratio_cadd_cors,VHLx1brLD2_cSNV_post_pre_ratio_cadd_cors,VHLx1brLD2_tSNV_post_pre_ratio_cadd_cors,VHLx1brLD2_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1brLD2_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1brLD2_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brLD2_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brLD2_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1brLD2_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1brLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors,VHLx1brLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors,VHLx1brLD1rLD2a_cSNV_post_lib_ratio_cadd_cors,VHLx1brLD1rLD2a_tSNV_post_lib_ratio_cadd_cors,VHLx1brLD1rLD2a_cSNV_post_pre_ratio_cadd_cors,VHLx1brLD1rLD2a_tSNV_post_pre_ratio_cadd_cors,VHLx1brLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1brLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1brLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1brLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1brLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors,VHLx1brLD1rLD2w_cSNV_post_lib_ratio_cadd_cors,VHLx1brLD1rLD2w_cSNV_post_pre_ratio_cadd_cors,VHLx1brLD1rLD2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx1brLD1)
rm(VHLx1brLD2)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx1brLD1
VHLx1b_posrange <- range(as.numeric(as.character(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$pos)))
VHLx1b_posseq <- seq(from=VHLx1b_posrange[1], to=VHLx1b_posrange[2])
VHLx1brLD1_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1brLD1_tHDR_pre_lib_pred <- predict(VHLx1brLD1_tHDR_pre_lib_ratio.lo, newdata = VHLx1b_posseq, se=TRUE)
VHLx1brLD1_tHDR_pre_lib_pos_effects <- VHLx1brLD1_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1brLD1_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1brLD1_tHDR_pre_lib_pos_effects)
VHLx1brLD1_tHDR_pre_lib_pos_effects_ci <- VHLx1brLD1_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1brLD1_tHDR_pre_lib_pred$df)
VHLx1brLD1_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1brLD1_tHDR_pre_lib_pos_effects - VHLx1brLD1_tHDR_pre_lib_pos_effects_ci
VHLx1brLD1_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1brLD1_tHDR_pre_lib_pos_effects + VHLx1brLD1_tHDR_pre_lib_pos_effects_ci
VHLx1brLD1_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1b_posseq, VHLx1brLD1_tHDR_pre_lib_pos_effects, VHLx1brLD1_tHDR_pre_lib_pos_effects.x, VHLx1brLD1_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1brLD1_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1brLD1_tHDR_pre_lib_pred_se = VHLx1brLD1_tHDR_pre_lib_pred$se.fit)
#VHLx1brLD2
VHLx1brLD2_tHDR_pre_lib_ratio.lo <- loess(log2(rLD2_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1brLD2_tHDR_pre_lib_pred <- predict(VHLx1brLD2_tHDR_pre_lib_ratio.lo, newdata = VHLx1b_posseq, se=TRUE)
VHLx1brLD2_tHDR_pre_lib_pos_effects <- VHLx1brLD2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1brLD2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1brLD2_tHDR_pre_lib_pos_effects)
VHLx1brLD2_tHDR_pre_lib_pos_effects_ci <- VHLx1brLD2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1brLD2_tHDR_pre_lib_pred$df)
VHLx1brLD2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1brLD2_tHDR_pre_lib_pos_effects - VHLx1brLD2_tHDR_pre_lib_pos_effects_ci
VHLx1brLD2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1brLD2_tHDR_pre_lib_pos_effects + VHLx1brLD2_tHDR_pre_lib_pos_effects_ci
VHLx1brLD2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1b_posseq, VHLx1brLD2_tHDR_pre_lib_pos_effects, VHLx1brLD2_tHDR_pre_lib_pos_effects.x, VHLx1brLD2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1brLD2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1brLD2_tHDR_pre_lib_pred_se = VHLx1brLD2_tHDR_pre_lib_pred$se.fit)

#VHLx1brLD1rLD2
VHLx1brLD1rLD2_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm > 0.7 & VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm > 0.3 & VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1brLD1rLD2_tHDR_pre_lib_pred <- predict(VHLx1brLD1rLD2_tHDR_pre_lib_ratio.lo, newdata = VHLx1b_posseq, se=TRUE)
VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects <- VHLx1brLD1rLD2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects)
VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects_ci <- VHLx1brLD1rLD2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1brLD1rLD2_tHDR_pre_lib_pred$df)
VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects - VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects_ci
VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects + VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects_ci
VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1b_posseq, VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects, VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects.x, VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1brLD1rLD2_tHDR_pre_lib_pred_se = VHLx1brLD1rLD2_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rLD1, rLD2, rLD1rLD2)
VHLx1brLD_tHDR_pos_merge_df <- VHLx1brLD1_prog_map_thresh5_df_rLD2_int_ord_df 
VHLx1brLD_tHDR_pos_merge_df <- merge(VHLx1brLD_tHDR_pos_merge_df, VHLx1brLD1_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx1brLD1_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1brLD_tHDR_pos_merge_df <- merge(VHLx1brLD_tHDR_pos_merge_df, VHLx1brLD2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1brLD2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1brLD_tHDR_pos_merge_df <- merge(VHLx1brLD_tHDR_pos_merge_df, VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx1brLD_tHDR_pos_merge_df <- VHLx1brLD_tHDR_pos_merge_df %>% 
  rename(
    rLD1_tHDR_pre_lib_pos_effects.x = VHLx1brLD1_tHDR_pre_lib_pos_effects.x,
    rLD2_tHDR_pre_lib_pos_effects.x = VHLx1brLD2_tHDR_pre_lib_pos_effects.x,
    rLD1rLD2_tHDR_pre_lib_pos_effects.x = VHLx1brLD1rLD2_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rLD1 vs. rLD1_fit and vs. mean_fit)
VHLx1brLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1 <- log2(VHLx1brLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1brLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_pos_effects.x
VHLx1brLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx1brLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1brLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2 <- log2(VHLx1brLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_ratio_synnorm) - VHLx1brLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_pos_effects.x
VHLx1brLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx1brLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_ratio_synnorm) - VHLx1brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx1brLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm) - VHLx1brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx1brLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_loess_rLD1 <- log2(VHLx1brLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1brLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_pos_effects.x
VHLx1brLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx1brLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1brLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_loess_rLD2 <- log2(VHLx1brLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_ratio_synnorm) - VHLx1brLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_pos_effects.x
VHLx1brLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx1brLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_ratio_synnorm) - VHLx1brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx1brLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm) - VHLx1brLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rLD1 and rLD2 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx1brLD_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1brLD_tHDR_post_lib_loess_median_syn_rLD1 <- median(VHLx1brLD_tHDR_pos_merge_df[which(VHLx1brLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLD1_tHDR_post_lib_loess_rLD1')])
  VHLx1brLD_tHDR_post_lib_loess_median_syn_rLD2 <- median(VHLx1brLD_tHDR_pos_merge_df[which(VHLx1brLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLD2_tHDR_post_lib_loess_rLD2')])
  } else {
  VHLx1brLD_tHDR_post_lib_loess_median_syn_rLD1 <- median(VHLx1brLD_tHDR_pos_merge_df[which(VHLx1brLD_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLD1_tHDR_post_lib_loess_rLD1')])
  VHLx1brLD_tHDR_post_lib_loess_median_syn_rLD2 <- median(VHLx1brLD_tHDR_pos_merge_df[which(VHLx1brLD_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLD2_tHDR_post_lib_loess_rLD2')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rLD1 'e.sns' = exon syn/ns norm.
VHLx1brLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1_e.sns <- (VHLx1brLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1-VHLx1brLD_tHDR_post_lib_loess_median_syn_rLD1)
#calculate new b values for rLD2 'e.sns' = exon syn/ns norm.
VHLx1brLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2_e.sns <- (VHLx1brLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2-VHLx1brLD_tHDR_post_lib_loess_median_syn_rLD2)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx1brLD_tHDR_pos_merge_df$rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean <- (VHLx1brLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1_e.sns+VHLx1brLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx1brLD_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1brLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_syn_median <- median(VHLx1brLD_tHDR_pos_merge_df[which(VHLx1brLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('VHLx1brLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean')])
  } else {
  VHLx1brLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_syn_median <- median(VHLx1brLD_tHDR_pos_merge_df[which(VHLx1brLD_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('VHLx1brLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean')])
}

#RNA analysis
VHLx1brLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s <- cor(log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1brLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1_tHDR_rna2_rna_ratio <- VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_pseudo_freq/VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pseudo_freq
VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_rna_ratio <- VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_pseudo_freq/VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pseudo_freq
VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1rLD2_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1_tHDR_rna2_rna_ratio)+log2(VHLx1brLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_rna_ratio))/2

```
```{r}
VHLx1a2rLD1_file <- paste(experiment_dir_220822,'VHLx1a2rL41','_annotated.txt',sep='')
VHLx1a2rLD2_file <- paste(experiment_dir_220822,'VHLx1a2rL42','_annotated.txt',sep='')
VHLx1a2rLD1 <- read.table(VHLx1a2rLD1_file, header=TRUE, sep="\t")
VHLx1a2rLD2 <- read.table(VHLx1a2rLD2_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx1a2rLD1 <- VHLx1a2rLD1 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )
VHLx1a2rLD2 <- VHLx1a2rLD2 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx1a2 <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx1a2'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx1a2_HDR_5_SNV = as.character(VHL_editing_info_VHLx1a2$HDR_5_SNV)
VHLx1a2_HDR_3_SNV = as.character(VHL_editing_info_VHLx1a2$HDR_3_SNV)
#VHLx1a2_cut_pos = as.character(VHL_editing_info_VHLx1a2$cut_pos)
VHLx1a2_cut_end = as.character(VHL_editing_info_VHLx1a2$cut_end)
VHLx1a2_mut_start = as.character(VHL_editing_info_VHLx1a2$mut_start)
VHLx1a2_mut_end = as.character(VHL_editing_info_VHLx1a2$mut_end)

### Replicate 1
VHLx1a2rLD1_cSNV_all <- which(VHLx1a2rLD1[,'c_hdr_snv']=='True')
VHLx1a2rLD1_cSNV_all_df = VHLx1a2rLD1[VHLx1a2rLD1_cSNV_all,]
VHLx1a2rLD1_prog_var_all <- which(VHLx1a2rLD1[,'all_hdr_variant']=='True' & VHLx1a2rLD1[,'edit_string']!='-WT')
VHLx1a2rLD1_prog_var_all_df = VHLx1a2rLD1[VHLx1a2rLD1_prog_var_all,]
VHLx1a2rLD1_prog_map_all = which(VHLx1a2rLD1_prog_var_all_df[,'pos']!='REF')
VHLx1a2rLD1_prog_map_all_df = VHLx1a2rLD1_prog_var_all_df[VHLx1a2rLD1_prog_map_all,]
VHLx1a2rLD1_prog_map_exon_all = which(VHLx1a2rLD1_prog_map_all_df[,'cDNApos']!='REF' & VHLx1a2rLD1_prog_map_all_df[,'cDNApos']!='NA')
VHLx1a2rLD1_prog_map_exon_all_df = VHLx1a2rLD1_prog_map_all_df[VHLx1a2rLD1_prog_map_exon_all,]
VHLx1a2rLD1_prog_map_CADD = which(VHLx1a2rLD1_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1a2rLD1_prog_map_CADD_df = VHLx1a2rLD1_prog_map_all_df[VHLx1a2rLD1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx1a2rLD1_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1a2rLD1_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx1a2rLD1_prog_var_thresh5_df = VHLx1a2rLD1_prog_var_all_df[VHLx1a2rLD1_prog_var_thresh5,]
VHLx1a2rLD1_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1a2rLD1_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx1a2rLD1_prog_map_thresh5_df = VHLx1a2rLD1_prog_map_all_df[VHLx1a2rLD1_prog_map_thresh5,]
VHLx1a2rLD1_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1a2rLD1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx1a2rLD1_prog_map_exon_thresh5_df = VHLx1a2rLD1_prog_map_exon_all_df[VHLx1a2rLD1_prog_map_exon_thresh5,]
VHLx1a2rLD1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx1a2rLD1_prog_map_CADD_thresh5_df = VHLx1a2rLD1_prog_map_CADD_df[VHLx1a2rLD1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1a2rLD1_prog_var_all_lib_count = length(VHLx1a2rLD1_prog_var_all_df$lib)
VHLx1a2rLD1_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx1a2rLD1_prog_var_all_min_lib_counts = min(VHLx1a2rLD1_prog_var_all_df$lib)
VHLx1a2rLD1_prog_var_all_min_lib_counts
VHLx1a2rLD1_prog_var_all_max_lib_counts = max(VHLx1a2rLD1_prog_var_all_df$lib)
VHLx1a2rLD1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1a2rLD1_prog_map_all_lib_count = length(VHLx1a2rLD1_prog_map_all_df$lib)
VHLx1a2rLD1_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx1a2rLD1_prog_map_all_min_lib_counts = min(VHLx1a2rLD1_prog_map_all_df$lib)
VHLx1a2rLD1_prog_map_all_min_lib_counts
VHLx1a2rLD1_prog_map_all_max_lib_counts = max(VHLx1a2rLD1_prog_map_all_df$lib)
VHLx1a2rLD1_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx1a2rLD1_prog_var_all_pre_count = length(VHLx1a2rLD1_prog_var_all_df$pre)
VHLx1a2rLD1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx1a2rLD1_prog_var_all_min_pre_counts = min(VHLx1a2rLD1_prog_var_all_df$pre)
VHLx1a2rLD1_prog_var_all_min_pre_counts
VHLx1a2rLD1_prog_var_all_max_pre_counts = max(VHLx1a2rLD1_prog_var_all_df$pre)
VHLx1a2rLD1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1a2rLD1_prog_map_all_pre_count = length(VHLx1a2rLD1_prog_map_all_df$pre)
VHLx1a2rLD1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx1a2rLD1_prog_map_all_min_pre_counts = min(VHLx1a2rLD1_prog_map_all_df$pre)
VHLx1a2rLD1_prog_map_all_min_pre_counts
VHLx1a2rLD1_prog_map_all_max_pre_counts = max(VHLx1a2rLD1_prog_map_all_df$pre)
VHLx1a2rLD1_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx1a2rLD1_prog_map_all_post_count = length(VHLx1a2rLD1_prog_map_all_df$post)
VHLx1a2rLD1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx1a2rLD1_prog_map_all_min_post_counts = min(VHLx1a2rLD1_prog_map_all_df$post)
VHLx1a2rLD1_prog_map_all_min_post_counts
VHLx1a2rLD1_prog_map_all_max_post_counts = max(VHLx1a2rLD1_prog_map_all_df$post)
VHLx1a2rLD1_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx1a2rLD1_prog_map_all_syn_df <- VHLx1a2rLD1_prog_map_all_df[which(VHLx1a2rLD1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1a2rLD1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1a2rLD1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1a2rLD1_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1a2rLD1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1a2rLD1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1a2rLD1_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1a2rLD1_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1a2rLD1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx1a2rLD1_prog_map_all_min_rna_counts = min(VHLx1a2rLD1_prog_map_exon_all_df$tHDR_rna)
VHLx1a2rLD1_prog_map_all_min_rna_counts
VHLx1a2rLD1_prog_map_all_max_rna_counts = max(VHLx1a2rLD1_prog_map_exon_all_df$tHDR_rna)
VHLx1a2rLD1_prog_map_all_max_rna_counts
VHLx1a2rLD1_prog_map_all_min_rna_pseudo_freq = min(VHLx1a2rLD1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1a2rLD1_prog_map_all_min_rna_pseudo_freq
VHLx1a2rLD1_prog_map_all_max_rna_pseudo_freq = max(VHLx1a2rLD1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1a2rLD1_prog_map_all_max_rna_pseudo_freq
VHLx1a2rLD1_prog_map_all_min_rna_pre_ratio = min(VHLx1a2rLD1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1a2rLD1_prog_map_all_min_rna_pre_ratio
VHLx1a2rLD1_prog_map_all_max_rna_pre_ratio = max(VHLx1a2rLD1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1a2rLD1_prog_map_all_max_rna_pre_ratio
VHLx1a2rLD1_prog_map_all_min_rna_post_ratio = min(VHLx1a2rLD1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1a2rLD1_prog_map_all_min_rna_post_ratio
VHLx1a2rLD1_prog_map_all_max_rna_post_ratio = max(VHLx1a2rLD1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1a2rLD1_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1a2rLD1_cSNV_all_corr_pre_count = length(VHLx1a2rLD1_cSNV_all_df$corr_pre)
VHLx1a2rLD1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx1a2rLD1_cSNV_all_min_corr_pre_counts = min(VHLx1a2rLD1_cSNV_all_df$corr_pre)
VHLx1a2rLD1_cSNV_all_min_corr_pre_counts
VHLx1a2rLD1_cSNV_all_max_corr_pre_counts = max(VHLx1a2rLD1_cSNV_all_df$corr_pre)
VHLx1a2rLD1_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx1a2 less than SGE region length x 3 due to PAM edits
VHLx1a2rLD1_cSNV_all_corr_post_count = length(VHLx1a2rLD1_cSNV_all_df$corr_post)
VHLx1a2rLD1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx1a2rLD1_cSNV_all_min_corr_post_counts = min(VHLx1a2rLD1_cSNV_all_df$corr_post)
VHLx1a2rLD1_cSNV_all_min_corr_post_counts
VHLx1a2rLD1_cSNV_all_max_corr_post_counts = max(VHLx1a2rLD1_cSNV_all_df$corr_post)
VHLx1a2rLD1_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx1a2_p_hdr_snv = paste('p_hdr_',VHLx1a2_cut_end,'_snv',sep='')
VHLx1a2rLD1_pSNV_all <- which(VHLx1a2rLD1[,VHLx1a2_p_hdr_snv]=='True')
VHLx1a2rLD1_pSNV_all_df = VHLx1a2rLD1[VHLx1a2rLD1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx1a2 less than SGE region length x 3 due to PAM edits
VHLx1a2rLD1_pSNV_all_lib_count = length(VHLx1a2rLD1_pSNV_all_df$lib)
VHLx1a2rLD1_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx1a2rLD1_pSNV_all_min_lib_counts = min(VHLx1a2rLD1_pSNV_all_df$lib)
VHLx1a2rLD1_pSNV_all_min_lib_counts
VHLx1a2rLD1_pSNV_all_max_lib_counts = max(VHLx1a2rLD1_pSNV_all_df$lib)
VHLx1a2rLD1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx1a2rLD1_pSNV_all_pre_count = length(VHLx1a2rLD1_pSNV_all_df$pre)
VHLx1a2rLD1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx1a2rLD1_pSNV_all_min_pre_counts = min(VHLx1a2rLD1_pSNV_all_df$pre)
VHLx1a2rLD1_pSNV_all_min_pre_counts
VHLx1a2rLD1_pSNV_all_max_pre_counts = max(VHLx1a2rLD1_pSNV_all_df$pre)
VHLx1a2rLD1_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx1a2 less than SGE region length x 3 due to PAM edits
VHLx1a2rLD1_pSNV_all_post_count = length(VHLx1a2rLD1_pSNV_all_df$post)
VHLx1a2rLD1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx1a2rLD1_pSNV_all_min_post_counts = min(VHLx1a2rLD1_pSNV_all_df$post)
VHLx1a2rLD1_pSNV_all_min_post_counts
VHLx1a2rLD1_pSNV_all_max_post_counts = max(VHLx1a2rLD1_pSNV_all_df$post)
VHLx1a2rLD1_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx1a2 less than SGE region length x 3 due to PAM edits
VHLx1a2rLD1_prog_map_thresh5_lib_count = length(VHLx1a2rLD1_prog_map_thresh5_df$lib)
VHLx1a2rLD1_prog_map_thresh5_lib_count
VHLx1a2rLD1_prog_map_thresh5_min_lib_counts = min(VHLx1a2rLD1_prog_map_thresh5_df$lib)
VHLx1a2rLD1_prog_map_thresh5_min_lib_counts
VHLx1a2rLD1_prog_map_thresh5_max_lib_counts = max(VHLx1a2rLD1_prog_map_thresh5_df$lib)
VHLx1a2rLD1_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx1a2 less than SGE region length x 3 due to PAM edits
VHLx1a2rLD1_prog_map_thresh5_pre_count = length(VHLx1a2rLD1_prog_map_thresh5_df$pre)
VHLx1a2rLD1_prog_map_thresh5_pre_count
VHLx1a2rLD1_prog_map_thresh5_min_pre_counts = min(VHLx1a2rLD1_prog_map_thresh5_df$pre)
VHLx1a2rLD1_prog_map_thresh5_min_pre_counts
VHLx1a2rLD1_prog_map_thresh5_max_pre_counts = max(VHLx1a2rLD1_prog_map_thresh5_df$pre)
VHLx1a2rLD1_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1a2rLD1_prog_map_thresh5_post_count = length(VHLx1a2rLD1_prog_map_thresh5_df$post)
VHLx1a2rLD1_prog_map_thresh5_post_count
VHLx1a2rLD1_prog_map_thresh5_min_post_counts = min(VHLx1a2rLD1_prog_map_thresh5_df$post)
VHLx1a2rLD1_prog_map_thresh5_min_post_counts
VHLx1a2rLD1_prog_map_thresh5_max_post_counts = max(VHLx1a2rLD1_prog_map_thresh5_df$post)
VHLx1a2rLD1_prog_map_thresh5_max_post_counts
VHLx1a2rLD1_prog_map_thresh5_corr_post_count = length(VHLx1a2rLD1_cSNV_all_df$corr_post)
VHLx1a2rLD1_prog_map_thresh5_corr_post_count
VHLx1a2rLD1_prog_map_thresh5_min_corr_post_counts = min(VHLx1a2rLD1_cSNV_all_df$corr_post)
VHLx1a2rLD1_prog_map_thresh5_min_corr_post_counts
VHLx1a2rLD1_prog_map_thresh5_max_corr_post_counts = max(VHLx1a2rLD1_cSNV_all_df$corr_post)
VHLx1a2rLD1_prog_map_thresh5_max_corr_post_counts

VHLx1a2rLD1_pSNV_thresh5 <- which(VHLx1a2rLD1[,VHLx1a2_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1a2rLD1[,'pre_freq']))>=0.00001)
VHLx1a2rLD1_pSNV_thresh5_df = VHLx1a2rLD1[VHLx1a2rLD1_pSNV_thresh5,]
VHLx1a2rLD1_pSNV_thresh5_lib_count = length(VHLx1a2rLD1_pSNV_thresh5_df$lib)
VHLx1a2rLD1_pSNV_thresh5_lib_count
VHLx1a2rLD1_pSNV_thresh5_min_lib_counts = min(VHLx1a2rLD1_pSNV_thresh5_df$lib)
VHLx1a2rLD1_pSNV_thresh5_min_lib_counts
VHLx1a2rLD1_pSNV_thresh5_max_lib_counts = max(VHLx1a2rLD1_pSNV_thresh5_df$lib)
VHLx1a2rLD1_pSNV_thresh5_max_lib_counts
VHLx1a2rLD1_pSNV_thresh5_pre_count = length(VHLx1a2rLD1_pSNV_thresh5_df$pre)
VHLx1a2rLD1_pSNV_thresh5_pre_count
VHLx1a2rLD1_pSNV_thresh5_min_pre_counts = min(VHLx1a2rLD1_pSNV_thresh5_df$pre)
VHLx1a2rLD1_pSNV_thresh5_min_pre_counts
VHLx1a2rLD1_pSNV_thresh5_max_pre_counts = max(VHLx1a2rLD1_pSNV_thresh5_df$pre)
VHLx1a2rLD1_pSNV_thresh5_max_pre_counts
VHLx1a2rLD1_pSNV_thresh5_post_count = length(VHLx1a2rLD1_pSNV_thresh5_df$post)
VHLx1a2rLD1_pSNV_thresh5_post_count
VHLx1a2rLD1_pSNV_thresh5_min_post_counts = min(VHLx1a2rLD1_pSNV_thresh5_df$post)
VHLx1a2rLD1_pSNV_thresh5_min_post_counts
VHLx1a2rLD1_pSNV_thresh5_max_post_counts = max(VHLx1a2rLD1_pSNV_thresh5_df$post)
VHLx1a2rLD1_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx1a2rLD2_cSNV_all <- which(VHLx1a2rLD2[,'c_hdr_snv']=='True')
VHLx1a2rLD2_cSNV_all_df = VHLx1a2rLD2[VHLx1a2rLD2_cSNV_all,]
VHLx1a2rLD2_prog_var_all <- which(VHLx1a2rLD2[,'all_hdr_variant']=='True' & VHLx1a2rLD2[,'edit_string']!='-WT')
VHLx1a2rLD2_prog_var_all_df = VHLx1a2rLD2[VHLx1a2rLD2_prog_var_all,]
VHLx1a2rLD2_prog_map_all = which(VHLx1a2rLD2_prog_var_all_df[,'pos']!='REF')
VHLx1a2rLD2_prog_map_all_df = VHLx1a2rLD2_prog_var_all_df[VHLx1a2rLD2_prog_map_all,]
VHLx1a2rLD2_prog_map_exon_all = which(VHLx1a2rLD2_prog_map_all_df[,'cDNApos']!='REF' & VHLx1a2rLD2_prog_map_all_df[,'cDNApos']!='NA')
VHLx1a2rLD2_prog_map_exon_all_df = VHLx1a2rLD2_prog_map_all_df[VHLx1a2rLD2_prog_map_exon_all,]
VHLx1a2rLD2_prog_map_CADD = which(VHLx1a2rLD2_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1a2rLD2_prog_map_CADD_df = VHLx1a2rLD2_prog_map_all_df[VHLx1a2rLD2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx1a2rLD2_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1a2rLD2_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx1a2rLD2_prog_var_thresh5_df = VHLx1a2rLD2_prog_var_all_df[VHLx1a2rLD2_prog_var_thresh5,]
VHLx1a2rLD2_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1a2rLD2_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx1a2rLD2_prog_map_thresh5_df = VHLx1a2rLD2_prog_map_all_df[VHLx1a2rLD2_prog_map_thresh5,]
VHLx1a2rLD2_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1a2rLD2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx1a2rLD2_prog_map_exon_thresh5_df = VHLx1a2rLD2_prog_map_exon_all_df[VHLx1a2rLD2_prog_map_exon_thresh5,]
VHLx1a2rLD2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1a2rLD2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx1a2rLD2_prog_map_CADD_thresh5_df = VHLx1a2rLD2_prog_map_CADD_df[VHLx1a2rLD2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1a2rLD2_prog_var_all_lib_count = length(VHLx1a2rLD2_prog_var_all_df$lib)
VHLx1a2rLD2_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx1a2rLD2_prog_var_all_min_lib_counts = min(VHLx1a2rLD2_prog_var_all_df$lib)
VHLx1a2rLD2_prog_var_all_min_lib_counts
VHLx1a2rLD2_prog_var_all_max_lib_counts = max(VHLx1a2rLD2_prog_var_all_df$lib)
VHLx1a2rLD2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1a2rLD2_prog_map_all_lib_count = length(VHLx1a2rLD2_prog_map_all_df$lib)
VHLx1a2rLD2_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx1a2rLD2_prog_map_all_min_lib_counts = min(VHLx1a2rLD2_prog_map_all_df$lib)
VHLx1a2rLD2_prog_map_all_min_lib_counts
VHLx1a2rLD2_prog_map_all_max_lib_counts = max(VHLx1a2rLD2_prog_map_all_df$lib)
VHLx1a2rLD2_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx1a2rLD2_prog_var_all_pre_count = length(VHLx1a2rLD2_prog_var_all_df$pre)
VHLx1a2rLD2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx1a2rLD2_prog_var_all_min_pre_counts = min(VHLx1a2rLD2_prog_var_all_df$pre)
VHLx1a2rLD2_prog_var_all_min_pre_counts
VHLx1a2rLD2_prog_var_all_max_pre_counts = max(VHLx1a2rLD2_prog_var_all_df$pre)
VHLx1a2rLD2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1a2rLD2_prog_map_all_pre_count = length(VHLx1a2rLD2_prog_map_all_df$pre)
VHLx1a2rLD2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx1a2rLD2_prog_map_all_min_pre_counts = min(VHLx1a2rLD2_prog_map_all_df$pre)
VHLx1a2rLD2_prog_map_all_min_pre_counts
VHLx1a2rLD2_prog_map_all_max_pre_counts = max(VHLx1a2rLD2_prog_map_all_df$pre)
VHLx1a2rLD2_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx1a2rLD2_prog_map_all_post_count = length(VHLx1a2rLD2_prog_map_all_df$post)
VHLx1a2rLD2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx1a2rLD2_prog_map_all_min_post_counts = min(VHLx1a2rLD2_prog_map_all_df$post)
VHLx1a2rLD2_prog_map_all_min_post_counts
VHLx1a2rLD2_prog_map_all_max_post_counts = max(VHLx1a2rLD2_prog_map_all_df$post)
VHLx1a2rLD2_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx1a2rLD2_prog_map_all_syn_df <- VHLx1a2rLD2_prog_map_all_df[which(VHLx1a2rLD2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1a2rLD2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1a2rLD2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1a2rLD2_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1a2rLD2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1a2rLD2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1a2rLD2_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1a2rLD2_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1a2rLD2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx1a2rLD2_prog_map_all_min_rna_counts = min(VHLx1a2rLD2_prog_map_exon_all_df$tHDR_rna)
VHLx1a2rLD2_prog_map_all_min_rna_counts
VHLx1a2rLD2_prog_map_all_max_rna_counts = max(VHLx1a2rLD2_prog_map_exon_all_df$tHDR_rna)
VHLx1a2rLD2_prog_map_all_max_rna_counts
VHLx1a2rLD2_prog_map_all_min_rna_pseudo_freq = min(VHLx1a2rLD2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1a2rLD2_prog_map_all_min_rna_pseudo_freq
VHLx1a2rLD2_prog_map_all_max_rna_pseudo_freq = max(VHLx1a2rLD2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1a2rLD2_prog_map_all_max_rna_pseudo_freq
VHLx1a2rLD2_prog_map_all_min_rna_pre_ratio = min(VHLx1a2rLD2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1a2rLD2_prog_map_all_min_rna_pre_ratio
VHLx1a2rLD2_prog_map_all_max_rna_pre_ratio = max(VHLx1a2rLD2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1a2rLD2_prog_map_all_max_rna_pre_ratio
VHLx1a2rLD2_prog_map_all_min_rna_post_ratio = min(VHLx1a2rLD2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1a2rLD2_prog_map_all_min_rna_post_ratio
VHLx1a2rLD2_prog_map_all_max_rna_post_ratio = max(VHLx1a2rLD2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1a2rLD2_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1a2rLD2_cSNV_all_corr_pre_count = length(VHLx1a2rLD2_cSNV_all_df$corr_pre)
VHLx1a2rLD2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx1a2rLD2_cSNV_all_min_corr_pre_counts = min(VHLx1a2rLD2_cSNV_all_df$corr_pre)
VHLx1a2rLD2_cSNV_all_min_corr_pre_counts
VHLx1a2rLD2_cSNV_all_max_corr_pre_counts = max(VHLx1a2rLD2_cSNV_all_df$corr_pre)
VHLx1a2rLD2_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx1a2 less than SGE region length x 3 due to PAM edits
VHLx1a2rLD2_cSNV_all_corr_post_count = length(VHLx1a2rLD2_cSNV_all_df$corr_post)
VHLx1a2rLD2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx1a2rLD2_cSNV_all_min_corr_post_counts = min(VHLx1a2rLD2_cSNV_all_df$corr_post)
VHLx1a2rLD2_cSNV_all_min_corr_post_counts
VHLx1a2rLD2_cSNV_all_max_corr_post_counts = max(VHLx1a2rLD2_cSNV_all_df$corr_post)
VHLx1a2rLD2_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx1a2_p_hdr_snv = paste('p_hdr_',VHLx1a2_cut_end,'_snv',sep='')
VHLx1a2rLD2_pSNV_all <- which(VHLx1a2rLD2[,VHLx1a2_p_hdr_snv]=='True')
VHLx1a2rLD2_pSNV_all_df = VHLx1a2rLD2[VHLx1a2rLD2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx1a2 less than SGE region length x 3 due to PAM edits
VHLx1a2rLD2_pSNV_all_lib_count = length(VHLx1a2rLD2_pSNV_all_df$lib)
VHLx1a2rLD2_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx1a2rLD2_pSNV_all_min_lib_counts = min(VHLx1a2rLD2_pSNV_all_df$lib)
VHLx1a2rLD2_pSNV_all_min_lib_counts
VHLx1a2rLD2_pSNV_all_max_lib_counts = max(VHLx1a2rLD2_pSNV_all_df$lib)
VHLx1a2rLD2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx1a2rLD2_pSNV_all_pre_count = length(VHLx1a2rLD2_pSNV_all_df$pre)
VHLx1a2rLD2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx1a2rLD2_pSNV_all_min_pre_counts = min(VHLx1a2rLD2_pSNV_all_df$pre)
VHLx1a2rLD2_pSNV_all_min_pre_counts
VHLx1a2rLD2_pSNV_all_max_pre_counts = max(VHLx1a2rLD2_pSNV_all_df$pre)
VHLx1a2rLD2_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx1a2 less than SGE region length x 3 due to PAM edits
VHLx1a2rLD2_pSNV_all_post_count = length(VHLx1a2rLD2_pSNV_all_df$post)
VHLx1a2rLD2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx1a2rLD2_pSNV_all_min_post_counts = min(VHLx1a2rLD2_pSNV_all_df$post)
VHLx1a2rLD2_pSNV_all_min_post_counts
VHLx1a2rLD2_pSNV_all_max_post_counts = max(VHLx1a2rLD2_pSNV_all_df$post)
VHLx1a2rLD2_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx1a2 less than SGE region length x 3 due to PAM edits
VHLx1a2rLD2_prog_map_thresh5_lib_count = length(VHLx1a2rLD2_prog_map_thresh5_df$lib)
VHLx1a2rLD2_prog_map_thresh5_lib_count
VHLx1a2rLD2_prog_map_thresh5_min_lib_counts = min(VHLx1a2rLD2_prog_map_thresh5_df$lib)
VHLx1a2rLD2_prog_map_thresh5_min_lib_counts
VHLx1a2rLD2_prog_map_thresh5_max_lib_counts = max(VHLx1a2rLD2_prog_map_thresh5_df$lib)
VHLx1a2rLD2_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx1a2 less than SGE region length x 3 due to PAM edits
VHLx1a2rLD2_prog_map_thresh5_pre_count = length(VHLx1a2rLD2_prog_map_thresh5_df$pre)
VHLx1a2rLD2_prog_map_thresh5_pre_count
VHLx1a2rLD2_prog_map_thresh5_min_pre_counts = min(VHLx1a2rLD2_prog_map_thresh5_df$pre)
VHLx1a2rLD2_prog_map_thresh5_min_pre_counts
VHLx1a2rLD2_prog_map_thresh5_max_pre_counts = max(VHLx1a2rLD2_prog_map_thresh5_df$pre)
VHLx1a2rLD2_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1a2rLD2_prog_map_thresh5_post_count = length(VHLx1a2rLD2_prog_map_thresh5_df$post)
VHLx1a2rLD2_prog_map_thresh5_post_count
VHLx1a2rLD2_prog_map_thresh5_min_post_counts = min(VHLx1a2rLD2_prog_map_thresh5_df$post)
VHLx1a2rLD2_prog_map_thresh5_min_post_counts
VHLx1a2rLD2_prog_map_thresh5_max_post_counts = max(VHLx1a2rLD2_prog_map_thresh5_df$post)
VHLx1a2rLD2_prog_map_thresh5_max_post_counts
VHLx1a2rLD2_prog_map_thresh5_corr_post_count = length(VHLx1a2rLD2_cSNV_all_df$corr_post)
VHLx1a2rLD2_prog_map_thresh5_corr_post_count
VHLx1a2rLD2_prog_map_thresh5_min_corr_post_counts = min(VHLx1a2rLD2_cSNV_all_df$corr_post)
VHLx1a2rLD2_prog_map_thresh5_min_corr_post_counts
VHLx1a2rLD2_prog_map_thresh5_max_corr_post_counts = max(VHLx1a2rLD2_cSNV_all_df$corr_post)
VHLx1a2rLD2_prog_map_thresh5_max_corr_post_counts

VHLx1a2rLD2_pSNV_thresh5 <- which(VHLx1a2rLD2[,VHLx1a2_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1a2rLD2[,'pre_freq']))>=0.00001)
VHLx1a2rLD2_pSNV_thresh5_df = VHLx1a2rLD2[VHLx1a2rLD2_pSNV_thresh5,]
VHLx1a2rLD2_pSNV_thresh5_lib_count = length(VHLx1a2rLD2_pSNV_thresh5_df$lib)
VHLx1a2rLD2_pSNV_thresh5_lib_count
VHLx1a2rLD2_pSNV_thresh5_min_lib_counts = min(VHLx1a2rLD2_pSNV_thresh5_df$lib)
VHLx1a2rLD2_pSNV_thresh5_min_lib_counts
VHLx1a2rLD2_pSNV_thresh5_max_lib_counts = max(VHLx1a2rLD2_pSNV_thresh5_df$lib)
VHLx1a2rLD2_pSNV_thresh5_max_lib_counts
VHLx1a2rLD2_pSNV_thresh5_pre_count = length(VHLx1a2rLD2_pSNV_thresh5_df$pre)
VHLx1a2rLD2_pSNV_thresh5_pre_count
VHLx1a2rLD2_pSNV_thresh5_min_pre_counts = min(VHLx1a2rLD2_pSNV_thresh5_df$pre)
VHLx1a2rLD2_pSNV_thresh5_min_pre_counts
VHLx1a2rLD2_pSNV_thresh5_max_pre_counts = max(VHLx1a2rLD2_pSNV_thresh5_df$pre)
VHLx1a2rLD2_pSNV_thresh5_max_pre_counts
VHLx1a2rLD2_pSNV_thresh5_post_count = length(VHLx1a2rLD2_pSNV_thresh5_df$post)
VHLx1a2rLD2_pSNV_thresh5_post_count
VHLx1a2rLD2_pSNV_thresh5_min_post_counts = min(VHLx1a2rLD2_pSNV_thresh5_df$post)
VHLx1a2rLD2_pSNV_thresh5_min_post_counts
VHLx1a2rLD2_pSNV_thresh5_max_post_counts = max(VHLx1a2rLD2_pSNV_thresh5_df$post)
VHLx1a2rLD2_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx1a2rLD1_prog_var_thresh5_df:
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int <- VHLx1a2rLD1_prog_var_thresh5_df[which(VHLx1a2rLD1_prog_var_thresh5_df$variant %in% VHLx1a2rLD2_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx1a2rLD2_prog_var_thresh5_df:
VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int <- VHLx1a2rLD2_prog_var_thresh5_df[which(VHLx1a2rLD2_prog_var_thresh5_df$variant %in% VHLx1a2rLD1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int[order(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int$variant),]
VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int[order(VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int$variant),]
dim(VHLx1a2rLD1_prog_var_thresh5_df)[1] #Number of prog_vars in rLD1
VHLx1a2rLD1rLD2int_prog_var_thresh5_pre_count <- dim(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int)[1] 
VHLx1a2rLD1rLD2int_prog_var_thresh5_pre_count #Number of prog_vars in rLD1 also in rLD2
dim(VHLx1a2rLD2_prog_var_thresh5_df)[1] #Number of prog_vars in rLD2
dim(VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int)[1] #Number of prog_vars in rLD2 also in rLD1

#Add the following columns from the from rLD2 df to the rLD1 df:
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_lib <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$lib
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2 <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post2
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3 <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post3
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2 <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna2
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre_pseudo
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_pseudo
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pseudo <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pseudo
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pseudo <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pseudo
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pseudo <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pseudo
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_pseudo <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_pseudo
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post2_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post3_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre_pseudo_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_pseudo_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pseudo_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pseudo_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pseudo_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pseudo_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pseudo_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pseudo_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_pseudo_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_pseudo_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre_lib_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_pre_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_lib_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pre_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pre_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_post_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna_post_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pre_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pre_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pre_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_post_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_snv_error_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre_snv_error_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_snv_error_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_snv_error_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_exp_snv_error_reads_pre <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$exp_snv_error_reads_pre
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_exp_snv_error_reads_post <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$exp_snv_error_reads_post
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pre <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pre
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_post <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$corr_post
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pre_pseudo <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pre_pseudo
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_post_pseudo <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$corr_post_pseudo
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pseudo_post_pre_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pseudo_post_pre_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_lib <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_lib
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2 <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3 <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2 <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre_pseudo_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pseudo_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_pseudo_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pseudo_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_pseudo_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pseudo_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2_pseudo_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pseudo_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3_pseudo_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_pseudo_freq <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2_pseudo_freq
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre_lib_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_pre_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_lib_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_pre_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_post_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2_pre_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pre_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3_pre_ratio
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio <- VHLx1a2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio) + log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio))/2)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio) + log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio))/2)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio) + log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio))/2)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio) + log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio))/2)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post3_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post3_pre_ratio) + log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pre_ratio))/2)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rna2_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rna2_post_ratio) + log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio))/2)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio) + log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio))/2)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio) + log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio))/2)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio) + log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio))/2)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio) + log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio))/2)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio) + log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio))/2)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio) + log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio))/2)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post3_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post3_pre_ratio) + log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pre_ratio))/2)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio) + log2(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_pre_weighted <- ((VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq*VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq/(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq))+(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq*VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq/(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)))/VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq
#rLD1 pre-freq weighting coefficient (rLD1_pre-freq / (rLD1 + rLD2 pre-freq's))
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq/(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq/(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)
#this will be weighted by denominator:  (rLD1_pof/rLD1_prf)(rLD1_prwc)+(rLD2_pof/rLD2_prf)*(rLD2_prwc)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted <- (VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pseudo_freq/VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq)*(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight)+(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq/VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)*(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight)
#this will be weighted by denominator:  (rLD1_pof/lif')*(rLD1_prwc)+(rLD2_pof/lif)*(rLD2_prwc)
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_pre_weighted <- (VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pseudo_freq/VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq)*(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight)+(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq/VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq)*(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight)
#rLD1 tHDR_pre-freq weighting coefficient (rLD1_tHDR_pre-freq / (rLD1 + rLD2 pre-freq's))
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_weight <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq/(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq+VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)
#rLD2 tHDR_pre-freq weighting coefficient
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_weight <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq/(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq+VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rLD1_pof/rLD1_prf)(rLD1_prwc)+(rLD2_pof/rLD2_prf)*(rLD2_prwc)
#tHDR_post_pre_ratio_rLD1rLD2_pre_weighted
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted <- (VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pseudo_freq/VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq)*(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_weight)+(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pseudo_freq/VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)*(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq)) >= 10) {
    VHLx1a2rLD1_cSNV_pre_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx1a2rLD1_cSNV_post_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx1a2rLD1_cSNV_post2_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx1a2rLD1_cSNV_post_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx1a2rLD1_tSNV_pre_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx1a2rLD1_tSNV_post_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx1a2rLD1_tSNV_post_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx1a2rLD1_tSNV_rna_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx1a2rLD1_tSNV_rna_post_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx1a2rLD1_tSNV_rna2_post_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx1a2rLD2_cSNV_pre_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_pre_lib_ratio)
VHLx1a2rLD2_cSNV_post_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post_pre_ratio)
VHLx1a2rLD2_cSNV_post2_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post2_pre_ratio)

VHLx1a2rLD2_cSNV_post_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post_lib_ratio)
VHLx1a2rLD2_tSNV_pre_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_pre_lib_ratio)
VHLx1a2rLD2_tSNV_post_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post_pre_ratio)
VHLx1a2rLD2_tSNV_post2_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post2_pre_ratio)
VHLx1a2rLD2_tSNV_post_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post_lib_ratio)
VHLx1a2rLD2_tSNV_rna_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna_pre_ratio)
VHLx1a2rLD2_tSNV_rna_post_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna_post_ratio)
VHLx1a2rLD2_tSNV_rna2_post_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna2_post_ratio)
VHLx1a2rLD1rLD2a_cSNV_pre_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_cSNV_post_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_cSNV_post2_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_cSNV_post_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_tSNV_pre_lib_med <- 
  median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_tSNV_post_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_tSNV_post2_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_tSNV_post_lib_med <-
  median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_tSNV_rna_pre_med <-
  median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_tSNV_rna_post_med <-
  median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_tSNV_rna2_post_med <-
  median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2pw_tSNV_post_pre_med  <-
  median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted)
VHLx1a2rLD1rLD2pw_cSNV_post_pre_med  <-
  median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLD1rLD2_pre_weighted)
  } else {
  VHLx1a2rLD1_cSNV_pre_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio)
VHLx1a2rLD1_cSNV_post_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio)
VHLx1a2rLD1_cSNV_post2_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio)
VHLx1a2rLD1_cSNV_post_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio)
VHLx1a2rLD1_tSNV_pre_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio)
VHLx1a2rLD1_tSNV_post_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio)
VHLx1a2rLD1_tSNV_post_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio)
VHLx1a2rLD1_tSNV_rna_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio)
VHLx1a2rLD1_tSNV_rna_post_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio)
VHLx1a2rLD1_tSNV_rna2_post_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio)
VHLx1a2rLD2_cSNV_pre_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio)
VHLx1a2rLD2_cSNV_post_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio)
VHLx1a2rLD2_cSNV_post2_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio)

VHLx1a2rLD2_cSNV_post_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio)
VHLx1a2rLD2_tSNV_pre_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio)
VHLx1a2rLD2_tSNV_post_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio)
VHLx1a2rLD2_tSNV_post2_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio)
VHLx1a2rLD2_tSNV_post_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio)
VHLx1a2rLD2_tSNV_rna_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio)
VHLx1a2rLD2_tSNV_rna_post_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio)
VHLx1a2rLD2_tSNV_rna2_post_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio)
VHLx1a2rLD1rLD2a_cSNV_pre_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_cSNV_post_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_cSNV_post2_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_cSNV_post_lib_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_tSNV_pre_lib_med <- 
  median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_tSNV_post_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_tSNV_post2_pre_med <- median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_tSNV_post_lib_med <-
  median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_tSNV_rna_pre_med <-
  median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_tSNV_rna_post_med <-
  median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2a_tSNV_rna2_post_med <-
  median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean)
VHLx1a2rLD1rLD2pw_tSNV_post_pre_med  <-
  median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted)
VHLx1a2rLD1rLD2pw_cSNV_post_pre_med  <-
  median(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted)
}

VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio/VHLx1a2rLD1_cSNV_pre_lib_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio/VHLx1a2rLD1_cSNV_post_pre_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio/VHLx1a2rLD1_cSNV_post_lib_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio/VHLx1a2rLD1_cSNV_post2_pre_med

VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio/VHLx1a2rLD1_tSNV_pre_lib_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio/VHLx1a2rLD1_tSNV_post_pre_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio/VHLx1a2rLD1_tSNV_post_lib_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio/VHLx1a2rLD1_tSNV_rna_pre_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio/VHLx1a2rLD1_tSNV_rna_post_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio/VHLx1a2rLD2_tSNV_post2_pre_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio/VHLx1a2rLD1_tSNV_rna2_post_med

VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio/VHLx1a2rLD2_cSNV_pre_lib_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio/VHLx1a2rLD2_cSNV_post_pre_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio/VHLx1a2rLD2_cSNV_post_lib_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio/VHLx1a2rLD1rLD2a_cSNV_post2_pre_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio/VHLx1a2rLD2_tSNV_rna2_post_med


VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio/VHLx1a2rLD2_tSNV_pre_lib_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio/VHLx1a2rLD2_tSNV_post_pre_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio/VHLx1a2rLD2_tSNV_post2_pre_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio/VHLx1a2rLD2_tSNV_post_lib_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio/VHLx1a2rLD2_tSNV_rna_pre_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio/VHLx1a2rLD2_tSNV_rna_post_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio/VHLx1a2rLD2_tSNV_rna2_post_med

###normalize the means
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean/VHLx1a2rLD1rLD2a_cSNV_pre_lib_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean/VHLx1a2rLD1rLD2a_cSNV_post_pre_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean/VHLx1a2rLD1rLD2a_cSNV_post_lib_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean/VHLx1a2rLD1rLD2a_tSNV_pre_lib_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean/VHLx1a2rLD1rLD2a_tSNV_post_pre_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean/VHLx1a2rLD1rLD2a_tSNV_post2_pre_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean/VHLx1a2rLD1rLD2a_tSNV_post_lib_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean/VHLx1a2rLD1rLD2a_tSNV_rna_pre_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean/VHLx1a2rLD1rLD2a_tSNV_rna_post_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean/VHLx1a2rLD1rLD2a_tSNV_rna2_post_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted/VHLx1a2rLD1rLD2pw_tSNV_post_pre_med
VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm <- VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted/VHLx1a2rLD1rLD2pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord
VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord = which(VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[,'pos']!='REF')
VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df = VHLx1a2rLD1_prog_var_thresh5_df_rLD2_int_ord[VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord,]
VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord = which(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'cDNApos']!='REF' & VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'cDNApos']!='NA')
VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df = VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df[VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord,]
VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord = which(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'CADD.phred']!='NA')
VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df = VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df[VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord,]
VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense <- VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df[which(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx1a2rLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s
VHLx1a2rLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_p <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='pearson')
VHLx1a2rLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_p
VHLx1a2rLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s
VHLx1a2rLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_p <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='pearson')
VHLx1a2rLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_p
VHLx1a2rLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post2_pre_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s
VHLx1a2rLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_p <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post2_pre_ratio_synnorm),method='pearson')
VHLx1a2rLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_p
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_s <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_s
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_p <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_p
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_s <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_s
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_p <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_p
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_s <- cor(log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_s
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_p <- cor(log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_p
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_s <- cor(log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_s
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_p <- cor(log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx1a2rLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_p
VHLx1a2rLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_s <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_freq),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_freq),method='spearman')
VHLx1a2rLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_s
VHLx1a2rLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_p <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pseudo_freq),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pseudo_freq),method='pearson')
VHLx1a2rLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_p
VHLx1a2rLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_s <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_s
VHLx1a2rLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_p <-cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio_synnorm),method='pearson')
VHLx1a2rLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_p
VHLx1a2rLD1rLD2_tSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_tSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s
VHLx1a2rLD1rLD2_tSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_tSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s
VHLx1a2rLD1rLD2_tSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_tSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s
VHLx1a2rLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s
VHLx1a2rLD1rLD2_tSNV_rLD1_rna2_post_by_rLD2_rna2_post_cor_s <- cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_tSNV_rLD1_rna2_post_by_rLD2_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx1a2rLD1_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1_cSNV_post_pre_by_cadd_cor_s
VHLx1a2rLD2_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD2_cSNV_post_pre_by_cadd_cor_s
VHLx1a2rLD1_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1_cSNV_post_lib_by_cadd_cor_s
VHLx1a2rLD2_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD2_cSNV_post_lib_by_cadd_cor_s
VHLx1a2rLD1_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1_tSNV_post_pre_by_cadd_cor_s
VHLx1a2rLD2_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD2_tSNV_post_pre_by_cadd_cor_s
VHLx1a2rLD1_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1_tSNV_post_lib_by_cadd_cor_s
VHLx1a2rLD2_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx1a2rLD1rLD2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2a_cSNV_pre_lib_by_cadd_cor_s
VHLx1a2rLD1rLD2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2w_cSNV_pre_lib_by_cadd_cor_s
VHLx1a2rLD1rLD2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2a_cSNV_post_pre_by_cadd_cor_s
VHLx1a2rLD1rLD2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2w_cSNV_post_pre_by_cadd_cor_s
VHLx1a2rLD1rLD2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2a_cSNV_post_lib_by_cadd_cor_s
VHLx1a2rLD1rLD2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2w_cSNV_post_lib_by_cadd_cor_s
VHLx1a2rLD1rLD2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2a_tSNV_pre_lib_by_cadd_cor_s
VHLx1a2rLD1rLD2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2a_tSNV_post_pre_by_cadd_cor_s
VHLx1a2rLD1rLD2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2w_tSNV_post_pre_by_cadd_cor_s
VHLx1a2rLD1rLD2a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post2_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2a_tSNV_post2_pre_by_cadd_cor_s
VHLx1a2rLD1rLD2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx1a2rLD1_cSNV_pre_lib_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1a2rLD1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1a2rLD1_tSNV_pre_lib_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1a2rLD1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1a2rLD1_cSNV_post_lib_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1a2rLD1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1a2rLD1_tSNV_post_lib_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1a2rLD1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1a2rLD1_cSNV_post_pre_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1a2rLD1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1a2rLD1_tSNV_post_pre_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1a2rLD1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1a2rLD1_cSNV_rna_lib_cors = cor(log2(VHLx1a2rLD1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1a2rLD1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1a2rLD1_tSNV_rna_lib_cors = cor(log2(VHLx1a2rLD1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1a2rLD1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1a2rLD1_cSNV_rna_pre_cors = cor(log2(VHLx1a2rLD1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1a2rLD1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1a2rLD1_tSNV_rna_pre_cors = cor(log2(VHLx1a2rLD1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1a2rLD1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1a2rLD1rLD2_cSNV_pre_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_freq),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_freq),method='spearman')
VHLx1a2rLD1rLD2_tSNV_pre_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_pseudo_freq),method='spearman')
VHLx1a2rLD1rLD2_cSNV_pre_lib_ratio_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio),method='spearman')
VHLx1a2rLD1rLD2_tSNV_pre_lib_ratio_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio),method='spearman')
VHLx1a2rLD1rLD2_cSNV_post_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_freq),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_freq),method='spearman')
VHLx1a2rLD1rLD2_tSNV_post_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pseudo_freq),method='spearman')
VHLx1a2rLD1rLD2_cSNV_post_lib_ratio_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_tSNV_post_lib_ratio_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_cSNV_post_pre_ratio_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_tSNV_post_pre_ratio_cors = cor(log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_cSNV_rna_cors = cor(log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rna_freq),log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_rna_freq),method='spearman')
VHLx1a2rLD1rLD2_tSNV_rna_cors = cor(log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pseudo_freq),method='spearman')
VHLx1a2rLD1rLD2_tSNV_rna_pre_ratio_cors = cor(log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1a2rLD1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1a2rLD1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1a2rLD1_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1a2rLD1_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1a2rLD1_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1a2rLD1_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1a2rLD1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1a2rLD1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1a2rLD1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1a2rLD1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1a2rLD1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1a2rLD1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1a2rLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1a2rLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1a2rLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1a2rLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1a2rLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1a2rLD1rLD2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')

VHLx1a2rLD1_cors <- c("VHLx1a2rLD1",VHLx1a2rLD1_cSNV_pre_lib_cors,VHLx1a2rLD1_tSNV_pre_lib_cors,VHLx1a2rLD1_cSNV_post_lib_cors,VHLx1a2rLD1_tSNV_post_lib_cors,VHLx1a2rLD1_cSNV_post_pre_cors,VHLx1a2rLD1_tSNV_post_pre_cors,VHLx1a2rLD1_cSNV_rna_lib_cors,VHLx1a2rLD1_tSNV_rna_lib_cors,VHLx1a2rLD1_cSNV_rna_pre_cors,VHLx1a2rLD1_tSNV_rna_pre_cors,VHLx1a2rLD1rLD2_cSNV_pre_cors,VHLx1a2rLD1rLD2_tSNV_pre_cors,VHLx1a2rLD1rLD2_cSNV_pre_lib_ratio_cors,VHLx1a2rLD1rLD2_tSNV_pre_lib_ratio_cors,VHLx1a2rLD1rLD2_cSNV_post_cors,VHLx1a2rLD1rLD2_tSNV_post_cors,VHLx1a2rLD1rLD2_cSNV_post_lib_ratio_cors,VHLx1a2rLD1rLD2_tSNV_post_lib_ratio_cors,VHLx1a2rLD1rLD2_cSNV_post_pre_ratio_cors,VHLx1a2rLD1rLD2_tSNV_post_pre_ratio_cors,VHLx1a2rLD1rLD2_cSNV_rna_cors,VHLx1a2rLD1rLD2_tSNV_rna_cors,VHLx1a2rLD1rLD2_tSNV_rna_pre_ratio_cors,VHLx1a2rLD1_cSNV_pre_lib_ratio_cadd_cors,VHLx1a2rLD1_tSNV_pre_lib_ratio_cadd_cors,VHLx1a2rLD1_cSNV_post_lib_ratio_cadd_cors,VHLx1a2rLD1_tSNV_post_lib_ratio_cadd_cors,VHLx1a2rLD1_cSNV_post_pre_ratio_cadd_cors,VHLx1a2rLD1_tSNV_post_pre_ratio_cadd_cors,VHLx1a2rLD1_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1a2rLD1_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1a2rLD1_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1a2rLD1_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1a2rLD1_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1a2rLD1_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1a2rLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors,VHLx1a2rLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors,VHLx1a2rLD1rLD2a_cSNV_post_lib_ratio_cadd_cors,VHLx1a2rLD1rLD2a_tSNV_post_lib_ratio_cadd_cors,VHLx1a2rLD1rLD2a_cSNV_post_pre_ratio_cadd_cors,VHLx1a2rLD1rLD2a_tSNV_post_pre_ratio_cadd_cors,VHLx1a2rLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1a2rLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1a2rLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1a2rLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1a2rLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1a2rLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1a2rLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors,VHLx1a2rLD1rLD2w_cSNV_post_lib_ratio_cadd_cors,VHLx1a2rLD1rLD2w_cSNV_post_pre_ratio_cadd_cors,VHLx1a2rLD1rLD2w_tSNV_post_pre_ratio_cadd_cors)

VHLx1a2rLD2_cSNV_pre_lib_cors = cor(log2(VHLx1a2rLD2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1a2rLD2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1a2rLD2_tSNV_pre_lib_cors = cor(log2(VHLx1a2rLD2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1a2rLD2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1a2rLD2_cSNV_post_lib_cors = cor(log2(VHLx1a2rLD2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1a2rLD2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1a2rLD2_tSNV_post_lib_cors = cor(log2(VHLx1a2rLD2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1a2rLD2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1a2rLD2_cSNV_post_pre_cors = cor(log2(VHLx1a2rLD2_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1a2rLD2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1a2rLD2_tSNV_post_pre_cors = cor(log2(VHLx1a2rLD2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1a2rLD2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1a2rLD2_cSNV_rna_lib_cors = cor(log2(VHLx1a2rLD2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1a2rLD2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1a2rLD2_tSNV_rna_lib_cors = cor(log2(VHLx1a2rLD2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1a2rLD2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1a2rLD2_cSNV_rna_pre_cors = cor(log2(VHLx1a2rLD2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1a2rLD2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1a2rLD2_tSNV_rna_pre_cors = cor(log2(VHLx1a2rLD2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1a2rLD2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1a2rLD2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1a2rLD2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1a2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1a2rLD2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1a2rLD2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1a2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1a2rLD2_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1a2rLD2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1a2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1a2rLD2_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1a2rLD2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1a2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1a2rLD2_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1a2rLD2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1a2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1a2rLD2_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1a2rLD2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1a2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1a2rLD2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1a2rLD2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1a2rLD2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1a2rLD2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1a2rLD2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1a2rLD2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1a2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')

VHLx1a2rLD2_cors <- c("VHLx1a2rLD2",VHLx1a2rLD2_cSNV_pre_lib_cors,VHLx1a2rLD2_tSNV_pre_lib_cors,VHLx1a2rLD2_cSNV_post_lib_cors,VHLx1a2rLD2_tSNV_post_lib_cors,VHLx1a2rLD2_cSNV_post_pre_cors,VHLx1a2rLD2_tSNV_post_pre_cors,VHLx1a2rLD2_cSNV_rna_lib_cors,VHLx1a2rLD2_tSNV_rna_lib_cors,VHLx1a2rLD2_cSNV_rna_pre_cors,VHLx1a2rLD2_tSNV_rna_pre_cors,VHLx1a2rLD1rLD2_cSNV_pre_cors,VHLx1a2rLD1rLD2_tSNV_pre_cors,VHLx1a2rLD1rLD2_cSNV_pre_lib_ratio_cors,VHLx1a2rLD1rLD2_tSNV_pre_lib_ratio_cors,VHLx1a2rLD1rLD2_cSNV_post_cors,VHLx1a2rLD1rLD2_tSNV_post_cors,VHLx1a2rLD1rLD2_cSNV_post_lib_ratio_cors,VHLx1a2rLD1rLD2_tSNV_post_lib_ratio_cors,VHLx1a2rLD1rLD2_cSNV_post_pre_ratio_cors,VHLx1a2rLD1rLD2_tSNV_post_pre_ratio_cors,VHLx1a2rLD1rLD2_cSNV_rna_cors,VHLx1a2rLD1rLD2_tSNV_rna_cors,VHLx1a2rLD1rLD2_tSNV_rna_pre_ratio_cors,VHLx1a2rLD2_cSNV_pre_lib_ratio_cadd_cors,VHLx1a2rLD2_tSNV_pre_lib_ratio_cadd_cors,VHLx1a2rLD2_cSNV_post_lib_ratio_cadd_cors,VHLx1a2rLD2_tSNV_post_lib_ratio_cadd_cors,VHLx1a2rLD2_cSNV_post_pre_ratio_cadd_cors,VHLx1a2rLD2_tSNV_post_pre_ratio_cadd_cors,VHLx1a2rLD2_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1a2rLD2_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1a2rLD2_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1a2rLD2_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1a2rLD2_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1a2rLD2_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1a2rLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors,VHLx1a2rLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors,VHLx1a2rLD1rLD2a_cSNV_post_lib_ratio_cadd_cors,VHLx1a2rLD1rLD2a_tSNV_post_lib_ratio_cadd_cors,VHLx1a2rLD1rLD2a_cSNV_post_pre_ratio_cadd_cors,VHLx1a2rLD1rLD2a_tSNV_post_pre_ratio_cadd_cors,VHLx1a2rLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1a2rLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1a2rLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1a2rLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1a2rLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1a2rLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1a2rLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors,VHLx1a2rLD1rLD2w_cSNV_post_lib_ratio_cadd_cors,VHLx1a2rLD1rLD2w_cSNV_post_pre_ratio_cadd_cors,VHLx1a2rLD1rLD2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx1a2rLD1)
rm(VHLx1a2rLD2)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx1a2rLD1
VHLx1a2_posrange <- range(as.numeric(as.character(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$pos)))
VHLx1a2_posseq <- seq(from=VHLx1a2_posrange[1], to=VHLx1a2_posrange[2])
VHLx1a2rLD1_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1a2rLD1_tHDR_pre_lib_pred <- predict(VHLx1a2rLD1_tHDR_pre_lib_ratio.lo, newdata = VHLx1a2_posseq, se=TRUE)
VHLx1a2rLD1_tHDR_pre_lib_pos_effects <- VHLx1a2rLD1_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1a2rLD1_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1a2rLD1_tHDR_pre_lib_pos_effects)
VHLx1a2rLD1_tHDR_pre_lib_pos_effects_ci <- VHLx1a2rLD1_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1a2rLD1_tHDR_pre_lib_pred$df)
VHLx1a2rLD1_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1a2rLD1_tHDR_pre_lib_pos_effects - VHLx1a2rLD1_tHDR_pre_lib_pos_effects_ci
VHLx1a2rLD1_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1a2rLD1_tHDR_pre_lib_pos_effects + VHLx1a2rLD1_tHDR_pre_lib_pos_effects_ci
VHLx1a2rLD1_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1a2_posseq, VHLx1a2rLD1_tHDR_pre_lib_pos_effects, VHLx1a2rLD1_tHDR_pre_lib_pos_effects.x, VHLx1a2rLD1_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1a2rLD1_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1a2rLD1_tHDR_pre_lib_pred_se = VHLx1a2rLD1_tHDR_pre_lib_pred$se.fit)
#VHLx1a2rLD2
VHLx1a2rLD2_tHDR_pre_lib_ratio.lo <- loess(log2(rLD2_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1a2rLD2_tHDR_pre_lib_pred <- predict(VHLx1a2rLD2_tHDR_pre_lib_ratio.lo, newdata = VHLx1a2_posseq, se=TRUE)
VHLx1a2rLD2_tHDR_pre_lib_pos_effects <- VHLx1a2rLD2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1a2rLD2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1a2rLD2_tHDR_pre_lib_pos_effects)
VHLx1a2rLD2_tHDR_pre_lib_pos_effects_ci <- VHLx1a2rLD2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1a2rLD2_tHDR_pre_lib_pred$df)
VHLx1a2rLD2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1a2rLD2_tHDR_pre_lib_pos_effects - VHLx1a2rLD2_tHDR_pre_lib_pos_effects_ci
VHLx1a2rLD2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1a2rLD2_tHDR_pre_lib_pos_effects + VHLx1a2rLD2_tHDR_pre_lib_pos_effects_ci
VHLx1a2rLD2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1a2_posseq, VHLx1a2rLD2_tHDR_pre_lib_pos_effects, VHLx1a2rLD2_tHDR_pre_lib_pos_effects.x, VHLx1a2rLD2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1a2rLD2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1a2rLD2_tHDR_pre_lib_pred_se = VHLx1a2rLD2_tHDR_pre_lib_pred$se.fit)

#VHLx1a2rLD1rLD2
VHLx1a2rLD1rLD2_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm > 0.7 & VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm > 0.3 & VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1a2rLD1rLD2_tHDR_pre_lib_pred <- predict(VHLx1a2rLD1rLD2_tHDR_pre_lib_ratio.lo, newdata = VHLx1a2_posseq, se=TRUE)
VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects <- VHLx1a2rLD1rLD2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects)
VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects_ci <- VHLx1a2rLD1rLD2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1a2rLD1rLD2_tHDR_pre_lib_pred$df)
VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects - VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects_ci
VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects + VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects_ci
VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1a2_posseq, VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects, VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects.x, VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1a2rLD1rLD2_tHDR_pre_lib_pred_se = VHLx1a2rLD1rLD2_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rLD1, rLD2, rLD1rLD2)
VHLx1a2rLD_tHDR_pos_merge_df <- VHLx1a2rLD1_prog_map_thresh5_df_rLD2_int_ord_df 
VHLx1a2rLD_tHDR_pos_merge_df <- merge(VHLx1a2rLD_tHDR_pos_merge_df, VHLx1a2rLD1_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx1a2rLD1_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1a2rLD_tHDR_pos_merge_df <- merge(VHLx1a2rLD_tHDR_pos_merge_df, VHLx1a2rLD2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1a2rLD2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1a2rLD_tHDR_pos_merge_df <- merge(VHLx1a2rLD_tHDR_pos_merge_df, VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx1a2rLD_tHDR_pos_merge_df <- VHLx1a2rLD_tHDR_pos_merge_df %>% 
  rename(
    rLD1_tHDR_pre_lib_pos_effects.x = VHLx1a2rLD1_tHDR_pre_lib_pos_effects.x,
    rLD2_tHDR_pre_lib_pos_effects.x = VHLx1a2rLD2_tHDR_pre_lib_pos_effects.x,
    rLD1rLD2_tHDR_pre_lib_pos_effects.x = VHLx1a2rLD1rLD2_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rLD1 vs. rLD1_fit and vs. mean_fit)
VHLx1a2rLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1 <- log2(VHLx1a2rLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1a2rLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_pos_effects.x
VHLx1a2rLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx1a2rLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1a2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1a2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2 <- log2(VHLx1a2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_ratio_synnorm) - VHLx1a2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_pos_effects.x
VHLx1a2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx1a2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_ratio_synnorm) - VHLx1a2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1a2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx1a2rLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm) - VHLx1a2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx1a2rLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_loess_rLD1 <- log2(VHLx1a2rLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1a2rLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_pos_effects.x
VHLx1a2rLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx1a2rLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1a2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1a2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_loess_rLD2 <- log2(VHLx1a2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_ratio_synnorm) - VHLx1a2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_pos_effects.x
VHLx1a2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx1a2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_ratio_synnorm) - VHLx1a2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1a2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx1a2rLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm) - VHLx1a2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rLD1 and rLD2 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx1a2rLD_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1a2rLD_tHDR_post_lib_loess_median_syn_rLD1 <- median(VHLx1a2rLD_tHDR_pos_merge_df[which(VHLx1a2rLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLD1_tHDR_post_lib_loess_rLD1')])
  VHLx1a2rLD_tHDR_post_lib_loess_median_syn_rLD2 <- median(VHLx1a2rLD_tHDR_pos_merge_df[which(VHLx1a2rLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLD2_tHDR_post_lib_loess_rLD2')])
  } else {
  VHLx1a2rLD_tHDR_post_lib_loess_median_syn_rLD1 <- median(VHLx1a2rLD_tHDR_pos_merge_df[which(VHLx1a2rLD_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLD1_tHDR_post_lib_loess_rLD1')])
  VHLx1a2rLD_tHDR_post_lib_loess_median_syn_rLD2 <- median(VHLx1a2rLD_tHDR_pos_merge_df[which(VHLx1a2rLD_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLD2_tHDR_post_lib_loess_rLD2')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rLD1 'e.sns' = exon syn/ns norm.
VHLx1a2rLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1_e.sns <- (VHLx1a2rLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1-VHLx1a2rLD_tHDR_post_lib_loess_median_syn_rLD1)
#calculate new b values for rLD2 'e.sns' = exon syn/ns norm.
VHLx1a2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2_e.sns <- (VHLx1a2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2-VHLx1a2rLD_tHDR_post_lib_loess_median_syn_rLD2)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx1a2rLD_tHDR_pos_merge_df$rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean <- (VHLx1a2rLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1_e.sns+VHLx1a2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx1a2rLD_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1a2rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_syn_median <- median(VHLx1a2rLD_tHDR_pos_merge_df[which(VHLx1a2rLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('VHLx1a2rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean')])
  } else {
  VHLx1a2rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_syn_median <- median(VHLx1a2rLD_tHDR_pos_merge_df[which(VHLx1a2rLD_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('VHLx1a2rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean')])
}

#RNA analysis
VHLx1a2rLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s <- cor(log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1a2rLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1_tHDR_rna2_rna_ratio <- VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_pseudo_freq/VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pseudo_freq
VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_rna_ratio <- VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_pseudo_freq/VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pseudo_freq
VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1rLD2_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1_tHDR_rna2_rna_ratio)+log2(VHLx1a2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_rna_ratio))/2

```
```{r}
VHLx1c2rLD1_file <- paste(experiment_dir_220822,'VHLx1c2rL41','_annotated.txt',sep='')
VHLx1c2rLD2_file <- paste(experiment_dir_220822,'VHLx1c2rL42','_annotated.txt',sep='')
VHLx1c2rLD1 <- read.table(VHLx1c2rLD1_file, header=TRUE, sep="\t")
VHLx1c2rLD2 <- read.table(VHLx1c2rLD2_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx1c2rLD1 <- VHLx1c2rLD1 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )
VHLx1c2rLD2 <- VHLx1c2rLD2 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx1c2 <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx1c2'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx1c2_HDR_5_SNV = as.character(VHL_editing_info_VHLx1c2$HDR_5_SNV)
VHLx1c2_HDR_3_SNV = as.character(VHL_editing_info_VHLx1c2$HDR_3_SNV)
#VHLx1c2_cut_pos = as.character(VHL_editing_info_VHLx1c2$cut_pos)
VHLx1c2_cut_end = as.character(VHL_editing_info_VHLx1c2$cut_end)
VHLx1c2_mut_start = as.character(VHL_editing_info_VHLx1c2$mut_start)
VHLx1c2_mut_end = as.character(VHL_editing_info_VHLx1c2$mut_end)

### Replicate 1
VHLx1c2rLD1_cSNV_all <- which(VHLx1c2rLD1[,'c_hdr_snv']=='True')
VHLx1c2rLD1_cSNV_all_df = VHLx1c2rLD1[VHLx1c2rLD1_cSNV_all,]
VHLx1c2rLD1_prog_var_all <- which(VHLx1c2rLD1[,'all_hdr_variant']=='True' & VHLx1c2rLD1[,'edit_string']!='-WT')
VHLx1c2rLD1_prog_var_all_df = VHLx1c2rLD1[VHLx1c2rLD1_prog_var_all,]
VHLx1c2rLD1_prog_map_all = which(VHLx1c2rLD1_prog_var_all_df[,'pos']!='REF')
VHLx1c2rLD1_prog_map_all_df = VHLx1c2rLD1_prog_var_all_df[VHLx1c2rLD1_prog_map_all,]
VHLx1c2rLD1_prog_map_exon_all = which(VHLx1c2rLD1_prog_map_all_df[,'cDNApos']!='REF' & VHLx1c2rLD1_prog_map_all_df[,'cDNApos']!='NA')
VHLx1c2rLD1_prog_map_exon_all_df = VHLx1c2rLD1_prog_map_all_df[VHLx1c2rLD1_prog_map_exon_all,]
VHLx1c2rLD1_prog_map_CADD = which(VHLx1c2rLD1_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1c2rLD1_prog_map_CADD_df = VHLx1c2rLD1_prog_map_all_df[VHLx1c2rLD1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5' -- modified for x1c here to be 1 in 1e6 due to low cHDR rate in experiment
VHLx1c2rLD1_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1c2rLD1_prog_var_all_df[,'pre_freq']))>=0.000001)
VHLx1c2rLD1_prog_var_thresh5_df = VHLx1c2rLD1_prog_var_all_df[VHLx1c2rLD1_prog_var_thresh5,]
VHLx1c2rLD1_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1c2rLD1_prog_map_all_df[,'pre_freq']))>=0.000001)
VHLx1c2rLD1_prog_map_thresh5_df = VHLx1c2rLD1_prog_map_all_df[VHLx1c2rLD1_prog_map_thresh5,]
VHLx1c2rLD1_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1c2rLD1_prog_map_exon_all_df[,'pre_freq']))>=0.000001)
VHLx1c2rLD1_prog_map_exon_thresh5_df = VHLx1c2rLD1_prog_map_exon_all_df[VHLx1c2rLD1_prog_map_exon_thresh5,]
VHLx1c2rLD1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_df[,'pre_freq']))>=0.000001)
VHLx1c2rLD1_prog_map_CADD_thresh5_df = VHLx1c2rLD1_prog_map_CADD_df[VHLx1c2rLD1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1c2rLD1_prog_var_all_lib_count = length(VHLx1c2rLD1_prog_var_all_df$lib)
VHLx1c2rLD1_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx1c2rLD1_prog_var_all_min_lib_counts = min(VHLx1c2rLD1_prog_var_all_df$lib)
VHLx1c2rLD1_prog_var_all_min_lib_counts
VHLx1c2rLD1_prog_var_all_max_lib_counts = max(VHLx1c2rLD1_prog_var_all_df$lib)
VHLx1c2rLD1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1c2rLD1_prog_map_all_lib_count = length(VHLx1c2rLD1_prog_map_all_df$lib)
VHLx1c2rLD1_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx1c2rLD1_prog_map_all_min_lib_counts = min(VHLx1c2rLD1_prog_map_all_df$lib)
VHLx1c2rLD1_prog_map_all_min_lib_counts
VHLx1c2rLD1_prog_map_all_max_lib_counts = max(VHLx1c2rLD1_prog_map_all_df$lib)
VHLx1c2rLD1_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx1c2rLD1_prog_var_all_pre_count = length(VHLx1c2rLD1_prog_var_all_df$pre)
VHLx1c2rLD1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx1c2rLD1_prog_var_all_min_pre_counts = min(VHLx1c2rLD1_prog_var_all_df$pre)
VHLx1c2rLD1_prog_var_all_min_pre_counts
VHLx1c2rLD1_prog_var_all_max_pre_counts = max(VHLx1c2rLD1_prog_var_all_df$pre)
VHLx1c2rLD1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1c2rLD1_prog_map_all_pre_count = length(VHLx1c2rLD1_prog_map_all_df$pre)
VHLx1c2rLD1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx1c2rLD1_prog_map_all_min_pre_counts = min(VHLx1c2rLD1_prog_map_all_df$pre)
VHLx1c2rLD1_prog_map_all_min_pre_counts
VHLx1c2rLD1_prog_map_all_max_pre_counts = max(VHLx1c2rLD1_prog_map_all_df$pre)
VHLx1c2rLD1_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx1c2rLD1_prog_map_all_post_count = length(VHLx1c2rLD1_prog_map_all_df$post)
VHLx1c2rLD1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx1c2rLD1_prog_map_all_min_post_counts = min(VHLx1c2rLD1_prog_map_all_df$post)
VHLx1c2rLD1_prog_map_all_min_post_counts
VHLx1c2rLD1_prog_map_all_max_post_counts = max(VHLx1c2rLD1_prog_map_all_df$post)
VHLx1c2rLD1_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx1c2rLD1_prog_map_all_syn_df <- VHLx1c2rLD1_prog_map_all_df[which(VHLx1c2rLD1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1c2rLD1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1c2rLD1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1c2rLD1_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1c2rLD1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1c2rLD1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1c2rLD1_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1c2rLD1_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1c2rLD1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx1c2rLD1_prog_map_all_min_rna_counts = min(VHLx1c2rLD1_prog_map_exon_all_df$tHDR_rna)
VHLx1c2rLD1_prog_map_all_min_rna_counts
VHLx1c2rLD1_prog_map_all_max_rna_counts = max(VHLx1c2rLD1_prog_map_exon_all_df$tHDR_rna)
VHLx1c2rLD1_prog_map_all_max_rna_counts
VHLx1c2rLD1_prog_map_all_min_rna_pseudo_freq = min(VHLx1c2rLD1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1c2rLD1_prog_map_all_min_rna_pseudo_freq
VHLx1c2rLD1_prog_map_all_max_rna_pseudo_freq = max(VHLx1c2rLD1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1c2rLD1_prog_map_all_max_rna_pseudo_freq
VHLx1c2rLD1_prog_map_all_min_rna_pre_ratio = min(VHLx1c2rLD1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1c2rLD1_prog_map_all_min_rna_pre_ratio
VHLx1c2rLD1_prog_map_all_max_rna_pre_ratio = max(VHLx1c2rLD1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1c2rLD1_prog_map_all_max_rna_pre_ratio
VHLx1c2rLD1_prog_map_all_min_rna_post_ratio = min(VHLx1c2rLD1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1c2rLD1_prog_map_all_min_rna_post_ratio
VHLx1c2rLD1_prog_map_all_max_rna_post_ratio = max(VHLx1c2rLD1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1c2rLD1_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1c2rLD1_cSNV_all_corr_pre_count = length(VHLx1c2rLD1_cSNV_all_df$corr_pre)
VHLx1c2rLD1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx1c2rLD1_cSNV_all_min_corr_pre_counts = min(VHLx1c2rLD1_cSNV_all_df$corr_pre)
VHLx1c2rLD1_cSNV_all_min_corr_pre_counts
VHLx1c2rLD1_cSNV_all_max_corr_pre_counts = max(VHLx1c2rLD1_cSNV_all_df$corr_pre)
VHLx1c2rLD1_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx1c2 less than SGE region length x 3 due to PAM edits
VHLx1c2rLD1_cSNV_all_corr_post_count = length(VHLx1c2rLD1_cSNV_all_df$corr_post)
VHLx1c2rLD1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx1c2rLD1_cSNV_all_min_corr_post_counts = min(VHLx1c2rLD1_cSNV_all_df$corr_post)
VHLx1c2rLD1_cSNV_all_min_corr_post_counts
VHLx1c2rLD1_cSNV_all_max_corr_post_counts = max(VHLx1c2rLD1_cSNV_all_df$corr_post)
VHLx1c2rLD1_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx1c2_p_hdr_snv = paste('p_hdr_',VHLx1c2_cut_end,'_snv',sep='')
VHLx1c2rLD1_pSNV_all <- which(VHLx1c2rLD1[,VHLx1c2_p_hdr_snv]=='True')
VHLx1c2rLD1_pSNV_all_df = VHLx1c2rLD1[VHLx1c2rLD1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx1c2 less than SGE region length x 3 due to PAM edits
VHLx1c2rLD1_pSNV_all_lib_count = length(VHLx1c2rLD1_pSNV_all_df$lib)
VHLx1c2rLD1_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx1c2rLD1_pSNV_all_min_lib_counts = min(VHLx1c2rLD1_pSNV_all_df$lib)
VHLx1c2rLD1_pSNV_all_min_lib_counts
VHLx1c2rLD1_pSNV_all_max_lib_counts = max(VHLx1c2rLD1_pSNV_all_df$lib)
VHLx1c2rLD1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx1c2rLD1_pSNV_all_pre_count = length(VHLx1c2rLD1_pSNV_all_df$pre)
VHLx1c2rLD1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx1c2rLD1_pSNV_all_min_pre_counts = min(VHLx1c2rLD1_pSNV_all_df$pre)
VHLx1c2rLD1_pSNV_all_min_pre_counts
VHLx1c2rLD1_pSNV_all_max_pre_counts = max(VHLx1c2rLD1_pSNV_all_df$pre)
VHLx1c2rLD1_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx1c2 less than SGE region length x 3 due to PAM edits
VHLx1c2rLD1_pSNV_all_post_count = length(VHLx1c2rLD1_pSNV_all_df$post)
VHLx1c2rLD1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx1c2rLD1_pSNV_all_min_post_counts = min(VHLx1c2rLD1_pSNV_all_df$post)
VHLx1c2rLD1_pSNV_all_min_post_counts
VHLx1c2rLD1_pSNV_all_max_post_counts = max(VHLx1c2rLD1_pSNV_all_df$post)
VHLx1c2rLD1_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx1c2 less than SGE region length x 3 due to PAM edits
VHLx1c2rLD1_prog_map_thresh5_lib_count = length(VHLx1c2rLD1_prog_map_thresh5_df$lib)
VHLx1c2rLD1_prog_map_thresh5_lib_count
VHLx1c2rLD1_prog_map_thresh5_min_lib_counts = min(VHLx1c2rLD1_prog_map_thresh5_df$lib)
VHLx1c2rLD1_prog_map_thresh5_min_lib_counts
VHLx1c2rLD1_prog_map_thresh5_max_lib_counts = max(VHLx1c2rLD1_prog_map_thresh5_df$lib)
VHLx1c2rLD1_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx1c2 less than SGE region length x 3 due to PAM edits
VHLx1c2rLD1_prog_map_thresh5_pre_count = length(VHLx1c2rLD1_prog_map_thresh5_df$pre)
VHLx1c2rLD1_prog_map_thresh5_pre_count
VHLx1c2rLD1_prog_map_thresh5_min_pre_counts = min(VHLx1c2rLD1_prog_map_thresh5_df$pre)
VHLx1c2rLD1_prog_map_thresh5_min_pre_counts
VHLx1c2rLD1_prog_map_thresh5_max_pre_counts = max(VHLx1c2rLD1_prog_map_thresh5_df$pre)
VHLx1c2rLD1_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1c2rLD1_prog_map_thresh5_post_count = length(VHLx1c2rLD1_prog_map_thresh5_df$post)
VHLx1c2rLD1_prog_map_thresh5_post_count
VHLx1c2rLD1_prog_map_thresh5_min_post_counts = min(VHLx1c2rLD1_prog_map_thresh5_df$post)
VHLx1c2rLD1_prog_map_thresh5_min_post_counts
VHLx1c2rLD1_prog_map_thresh5_max_post_counts = max(VHLx1c2rLD1_prog_map_thresh5_df$post)
VHLx1c2rLD1_prog_map_thresh5_max_post_counts
VHLx1c2rLD1_prog_map_thresh5_corr_post_count = length(VHLx1c2rLD1_cSNV_all_df$corr_post)
VHLx1c2rLD1_prog_map_thresh5_corr_post_count
VHLx1c2rLD1_prog_map_thresh5_min_corr_post_counts = min(VHLx1c2rLD1_cSNV_all_df$corr_post)
VHLx1c2rLD1_prog_map_thresh5_min_corr_post_counts
VHLx1c2rLD1_prog_map_thresh5_max_corr_post_counts = max(VHLx1c2rLD1_cSNV_all_df$corr_post)
VHLx1c2rLD1_prog_map_thresh5_max_corr_post_counts

VHLx1c2rLD1_pSNV_thresh5 <- which(VHLx1c2rLD1[,VHLx1c2_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1c2rLD1[,'pre_freq']))>=0.000001)
VHLx1c2rLD1_pSNV_thresh5_df = VHLx1c2rLD1[VHLx1c2rLD1_pSNV_thresh5,]
VHLx1c2rLD1_pSNV_thresh5_lib_count = length(VHLx1c2rLD1_pSNV_thresh5_df$lib)
VHLx1c2rLD1_pSNV_thresh5_lib_count
VHLx1c2rLD1_pSNV_thresh5_min_lib_counts = min(VHLx1c2rLD1_pSNV_thresh5_df$lib)
VHLx1c2rLD1_pSNV_thresh5_min_lib_counts
VHLx1c2rLD1_pSNV_thresh5_max_lib_counts = max(VHLx1c2rLD1_pSNV_thresh5_df$lib)
VHLx1c2rLD1_pSNV_thresh5_max_lib_counts
VHLx1c2rLD1_pSNV_thresh5_pre_count = length(VHLx1c2rLD1_pSNV_thresh5_df$pre)
VHLx1c2rLD1_pSNV_thresh5_pre_count
VHLx1c2rLD1_pSNV_thresh5_min_pre_counts = min(VHLx1c2rLD1_pSNV_thresh5_df$pre)
VHLx1c2rLD1_pSNV_thresh5_min_pre_counts
VHLx1c2rLD1_pSNV_thresh5_max_pre_counts = max(VHLx1c2rLD1_pSNV_thresh5_df$pre)
VHLx1c2rLD1_pSNV_thresh5_max_pre_counts
VHLx1c2rLD1_pSNV_thresh5_post_count = length(VHLx1c2rLD1_pSNV_thresh5_df$post)
VHLx1c2rLD1_pSNV_thresh5_post_count
VHLx1c2rLD1_pSNV_thresh5_min_post_counts = min(VHLx1c2rLD1_pSNV_thresh5_df$post)
VHLx1c2rLD1_pSNV_thresh5_min_post_counts
VHLx1c2rLD1_pSNV_thresh5_max_post_counts = max(VHLx1c2rLD1_pSNV_thresh5_df$post)
VHLx1c2rLD1_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx1c2rLD2_cSNV_all <- which(VHLx1c2rLD2[,'c_hdr_snv']=='True')
VHLx1c2rLD2_cSNV_all_df = VHLx1c2rLD2[VHLx1c2rLD2_cSNV_all,]
VHLx1c2rLD2_prog_var_all <- which(VHLx1c2rLD2[,'all_hdr_variant']=='True' & VHLx1c2rLD2[,'edit_string']!='-WT')
VHLx1c2rLD2_prog_var_all_df = VHLx1c2rLD2[VHLx1c2rLD2_prog_var_all,]
VHLx1c2rLD2_prog_map_all = which(VHLx1c2rLD2_prog_var_all_df[,'pos']!='REF')
VHLx1c2rLD2_prog_map_all_df = VHLx1c2rLD2_prog_var_all_df[VHLx1c2rLD2_prog_map_all,]
VHLx1c2rLD2_prog_map_exon_all = which(VHLx1c2rLD2_prog_map_all_df[,'cDNApos']!='REF' & VHLx1c2rLD2_prog_map_all_df[,'cDNApos']!='NA')
VHLx1c2rLD2_prog_map_exon_all_df = VHLx1c2rLD2_prog_map_all_df[VHLx1c2rLD2_prog_map_exon_all,]
VHLx1c2rLD2_prog_map_CADD = which(VHLx1c2rLD2_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1c2rLD2_prog_map_CADD_df = VHLx1c2rLD2_prog_map_all_df[VHLx1c2rLD2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx1c2rLD2_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1c2rLD2_prog_var_all_df[,'pre_freq']))>=0.000001)
VHLx1c2rLD2_prog_var_thresh5_df = VHLx1c2rLD2_prog_var_all_df[VHLx1c2rLD2_prog_var_thresh5,]
VHLx1c2rLD2_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1c2rLD2_prog_map_all_df[,'pre_freq']))>=0.000001)
VHLx1c2rLD2_prog_map_thresh5_df = VHLx1c2rLD2_prog_map_all_df[VHLx1c2rLD2_prog_map_thresh5,]
VHLx1c2rLD2_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1c2rLD2_prog_map_exon_all_df[,'pre_freq']))>=0.000001)
VHLx1c2rLD2_prog_map_exon_thresh5_df = VHLx1c2rLD2_prog_map_exon_all_df[VHLx1c2rLD2_prog_map_exon_thresh5,]
VHLx1c2rLD2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1c2rLD2_prog_map_CADD_df[,'pre_freq']))>=0.000001)
VHLx1c2rLD2_prog_map_CADD_thresh5_df = VHLx1c2rLD2_prog_map_CADD_df[VHLx1c2rLD2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1c2rLD2_prog_var_all_lib_count = length(VHLx1c2rLD2_prog_var_all_df$lib)
VHLx1c2rLD2_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx1c2rLD2_prog_var_all_min_lib_counts = min(VHLx1c2rLD2_prog_var_all_df$lib)
VHLx1c2rLD2_prog_var_all_min_lib_counts
VHLx1c2rLD2_prog_var_all_max_lib_counts = max(VHLx1c2rLD2_prog_var_all_df$lib)
VHLx1c2rLD2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1c2rLD2_prog_map_all_lib_count = length(VHLx1c2rLD2_prog_map_all_df$lib)
VHLx1c2rLD2_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx1c2rLD2_prog_map_all_min_lib_counts = min(VHLx1c2rLD2_prog_map_all_df$lib)
VHLx1c2rLD2_prog_map_all_min_lib_counts
VHLx1c2rLD2_prog_map_all_max_lib_counts = max(VHLx1c2rLD2_prog_map_all_df$lib)
VHLx1c2rLD2_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx1c2rLD2_prog_var_all_pre_count = length(VHLx1c2rLD2_prog_var_all_df$pre)
VHLx1c2rLD2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx1c2rLD2_prog_var_all_min_pre_counts = min(VHLx1c2rLD2_prog_var_all_df$pre)
VHLx1c2rLD2_prog_var_all_min_pre_counts
VHLx1c2rLD2_prog_var_all_max_pre_counts = max(VHLx1c2rLD2_prog_var_all_df$pre)
VHLx1c2rLD2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1c2rLD2_prog_map_all_pre_count = length(VHLx1c2rLD2_prog_map_all_df$pre)
VHLx1c2rLD2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx1c2rLD2_prog_map_all_min_pre_counts = min(VHLx1c2rLD2_prog_map_all_df$pre)
VHLx1c2rLD2_prog_map_all_min_pre_counts
VHLx1c2rLD2_prog_map_all_max_pre_counts = max(VHLx1c2rLD2_prog_map_all_df$pre)
VHLx1c2rLD2_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx1c2rLD2_prog_map_all_post_count = length(VHLx1c2rLD2_prog_map_all_df$post)
VHLx1c2rLD2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx1c2rLD2_prog_map_all_min_post_counts = min(VHLx1c2rLD2_prog_map_all_df$post)
VHLx1c2rLD2_prog_map_all_min_post_counts
VHLx1c2rLD2_prog_map_all_max_post_counts = max(VHLx1c2rLD2_prog_map_all_df$post)
VHLx1c2rLD2_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx1c2rLD2_prog_map_all_syn_df <- VHLx1c2rLD2_prog_map_all_df[which(VHLx1c2rLD2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1c2rLD2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1c2rLD2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1c2rLD2_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1c2rLD2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1c2rLD2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1c2rLD2_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1c2rLD2_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1c2rLD2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx1c2rLD2_prog_map_all_min_rna_counts = min(VHLx1c2rLD2_prog_map_exon_all_df$tHDR_rna)
VHLx1c2rLD2_prog_map_all_min_rna_counts
VHLx1c2rLD2_prog_map_all_max_rna_counts = max(VHLx1c2rLD2_prog_map_exon_all_df$tHDR_rna)
VHLx1c2rLD2_prog_map_all_max_rna_counts
VHLx1c2rLD2_prog_map_all_min_rna_pseudo_freq = min(VHLx1c2rLD2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1c2rLD2_prog_map_all_min_rna_pseudo_freq
VHLx1c2rLD2_prog_map_all_max_rna_pseudo_freq = max(VHLx1c2rLD2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1c2rLD2_prog_map_all_max_rna_pseudo_freq
VHLx1c2rLD2_prog_map_all_min_rna_pre_ratio = min(VHLx1c2rLD2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1c2rLD2_prog_map_all_min_rna_pre_ratio
VHLx1c2rLD2_prog_map_all_max_rna_pre_ratio = max(VHLx1c2rLD2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1c2rLD2_prog_map_all_max_rna_pre_ratio
VHLx1c2rLD2_prog_map_all_min_rna_post_ratio = min(VHLx1c2rLD2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1c2rLD2_prog_map_all_min_rna_post_ratio
VHLx1c2rLD2_prog_map_all_max_rna_post_ratio = max(VHLx1c2rLD2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1c2rLD2_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1c2rLD2_cSNV_all_corr_pre_count = length(VHLx1c2rLD2_cSNV_all_df$corr_pre)
VHLx1c2rLD2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx1c2rLD2_cSNV_all_min_corr_pre_counts = min(VHLx1c2rLD2_cSNV_all_df$corr_pre)
VHLx1c2rLD2_cSNV_all_min_corr_pre_counts
VHLx1c2rLD2_cSNV_all_max_corr_pre_counts = max(VHLx1c2rLD2_cSNV_all_df$corr_pre)
VHLx1c2rLD2_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx1c2 less than SGE region length x 3 due to PAM edits
VHLx1c2rLD2_cSNV_all_corr_post_count = length(VHLx1c2rLD2_cSNV_all_df$corr_post)
VHLx1c2rLD2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx1c2rLD2_cSNV_all_min_corr_post_counts = min(VHLx1c2rLD2_cSNV_all_df$corr_post)
VHLx1c2rLD2_cSNV_all_min_corr_post_counts
VHLx1c2rLD2_cSNV_all_max_corr_post_counts = max(VHLx1c2rLD2_cSNV_all_df$corr_post)
VHLx1c2rLD2_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx1c2_p_hdr_snv = paste('p_hdr_',VHLx1c2_cut_end,'_snv',sep='')
VHLx1c2rLD2_pSNV_all <- which(VHLx1c2rLD2[,VHLx1c2_p_hdr_snv]=='True')
VHLx1c2rLD2_pSNV_all_df = VHLx1c2rLD2[VHLx1c2rLD2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx1c2 less than SGE region length x 3 due to PAM edits
VHLx1c2rLD2_pSNV_all_lib_count = length(VHLx1c2rLD2_pSNV_all_df$lib)
VHLx1c2rLD2_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx1c2rLD2_pSNV_all_min_lib_counts = min(VHLx1c2rLD2_pSNV_all_df$lib)
VHLx1c2rLD2_pSNV_all_min_lib_counts
VHLx1c2rLD2_pSNV_all_max_lib_counts = max(VHLx1c2rLD2_pSNV_all_df$lib)
VHLx1c2rLD2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx1c2rLD2_pSNV_all_pre_count = length(VHLx1c2rLD2_pSNV_all_df$pre)
VHLx1c2rLD2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx1c2rLD2_pSNV_all_min_pre_counts = min(VHLx1c2rLD2_pSNV_all_df$pre)
VHLx1c2rLD2_pSNV_all_min_pre_counts
VHLx1c2rLD2_pSNV_all_max_pre_counts = max(VHLx1c2rLD2_pSNV_all_df$pre)
VHLx1c2rLD2_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx1c2 less than SGE region length x 3 due to PAM edits
VHLx1c2rLD2_pSNV_all_post_count = length(VHLx1c2rLD2_pSNV_all_df$post)
VHLx1c2rLD2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx1c2rLD2_pSNV_all_min_post_counts = min(VHLx1c2rLD2_pSNV_all_df$post)
VHLx1c2rLD2_pSNV_all_min_post_counts
VHLx1c2rLD2_pSNV_all_max_post_counts = max(VHLx1c2rLD2_pSNV_all_df$post)
VHLx1c2rLD2_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx1c2 less than SGE region length x 3 due to PAM edits
VHLx1c2rLD2_prog_map_thresh5_lib_count = length(VHLx1c2rLD2_prog_map_thresh5_df$lib)
VHLx1c2rLD2_prog_map_thresh5_lib_count
VHLx1c2rLD2_prog_map_thresh5_min_lib_counts = min(VHLx1c2rLD2_prog_map_thresh5_df$lib)
VHLx1c2rLD2_prog_map_thresh5_min_lib_counts
VHLx1c2rLD2_prog_map_thresh5_max_lib_counts = max(VHLx1c2rLD2_prog_map_thresh5_df$lib)
VHLx1c2rLD2_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx1c2 less than SGE region length x 3 due to PAM edits
VHLx1c2rLD2_prog_map_thresh5_pre_count = length(VHLx1c2rLD2_prog_map_thresh5_df$pre)
VHLx1c2rLD2_prog_map_thresh5_pre_count
VHLx1c2rLD2_prog_map_thresh5_min_pre_counts = min(VHLx1c2rLD2_prog_map_thresh5_df$pre)
VHLx1c2rLD2_prog_map_thresh5_min_pre_counts
VHLx1c2rLD2_prog_map_thresh5_max_pre_counts = max(VHLx1c2rLD2_prog_map_thresh5_df$pre)
VHLx1c2rLD2_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1c2rLD2_prog_map_thresh5_post_count = length(VHLx1c2rLD2_prog_map_thresh5_df$post)
VHLx1c2rLD2_prog_map_thresh5_post_count
VHLx1c2rLD2_prog_map_thresh5_min_post_counts = min(VHLx1c2rLD2_prog_map_thresh5_df$post)
VHLx1c2rLD2_prog_map_thresh5_min_post_counts
VHLx1c2rLD2_prog_map_thresh5_max_post_counts = max(VHLx1c2rLD2_prog_map_thresh5_df$post)
VHLx1c2rLD2_prog_map_thresh5_max_post_counts
VHLx1c2rLD2_prog_map_thresh5_corr_post_count = length(VHLx1c2rLD2_cSNV_all_df$corr_post)
VHLx1c2rLD2_prog_map_thresh5_corr_post_count
VHLx1c2rLD2_prog_map_thresh5_min_corr_post_counts = min(VHLx1c2rLD2_cSNV_all_df$corr_post)
VHLx1c2rLD2_prog_map_thresh5_min_corr_post_counts
VHLx1c2rLD2_prog_map_thresh5_max_corr_post_counts = max(VHLx1c2rLD2_cSNV_all_df$corr_post)
VHLx1c2rLD2_prog_map_thresh5_max_corr_post_counts

VHLx1c2rLD2_pSNV_thresh5 <- which(VHLx1c2rLD2[,VHLx1c2_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1c2rLD2[,'pre_freq']))>=0.000001)
VHLx1c2rLD2_pSNV_thresh5_df = VHLx1c2rLD2[VHLx1c2rLD2_pSNV_thresh5,]
VHLx1c2rLD2_pSNV_thresh5_lib_count = length(VHLx1c2rLD2_pSNV_thresh5_df$lib)
VHLx1c2rLD2_pSNV_thresh5_lib_count
VHLx1c2rLD2_pSNV_thresh5_min_lib_counts = min(VHLx1c2rLD2_pSNV_thresh5_df$lib)
VHLx1c2rLD2_pSNV_thresh5_min_lib_counts
VHLx1c2rLD2_pSNV_thresh5_max_lib_counts = max(VHLx1c2rLD2_pSNV_thresh5_df$lib)
VHLx1c2rLD2_pSNV_thresh5_max_lib_counts
VHLx1c2rLD2_pSNV_thresh5_pre_count = length(VHLx1c2rLD2_pSNV_thresh5_df$pre)
VHLx1c2rLD2_pSNV_thresh5_pre_count
VHLx1c2rLD2_pSNV_thresh5_min_pre_counts = min(VHLx1c2rLD2_pSNV_thresh5_df$pre)
VHLx1c2rLD2_pSNV_thresh5_min_pre_counts
VHLx1c2rLD2_pSNV_thresh5_max_pre_counts = max(VHLx1c2rLD2_pSNV_thresh5_df$pre)
VHLx1c2rLD2_pSNV_thresh5_max_pre_counts
VHLx1c2rLD2_pSNV_thresh5_post_count = length(VHLx1c2rLD2_pSNV_thresh5_df$post)
VHLx1c2rLD2_pSNV_thresh5_post_count
VHLx1c2rLD2_pSNV_thresh5_min_post_counts = min(VHLx1c2rLD2_pSNV_thresh5_df$post)
VHLx1c2rLD2_pSNV_thresh5_min_post_counts
VHLx1c2rLD2_pSNV_thresh5_max_post_counts = max(VHLx1c2rLD2_pSNV_thresh5_df$post)
VHLx1c2rLD2_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx1c2rLD1_prog_var_thresh5_df:
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int <- VHLx1c2rLD1_prog_var_thresh5_df[which(VHLx1c2rLD1_prog_var_thresh5_df$variant %in% VHLx1c2rLD2_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx1c2rLD2_prog_var_thresh5_df:
VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int <- VHLx1c2rLD2_prog_var_thresh5_df[which(VHLx1c2rLD2_prog_var_thresh5_df$variant %in% VHLx1c2rLD1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int[order(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int$variant),]
VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int[order(VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int$variant),]
dim(VHLx1c2rLD1_prog_var_thresh5_df)[1] #Number of prog_vars in rLD1
VHLx1c2rLD1rLD2int_prog_var_thresh5_pre_count <- dim(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int)[1] 
VHLx1c2rLD1rLD2int_prog_var_thresh5_pre_count #Number of prog_vars in rLD1 also in rLD2
dim(VHLx1c2rLD2_prog_var_thresh5_df)[1] #Number of prog_vars in rLD2
dim(VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int)[1] #Number of prog_vars in rLD2 also in rLD1

#Add the following columns from the from rLD2 df to the rLD1 df:
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_lib <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$lib
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2 <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post2
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3 <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post3
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2 <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna2
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre_pseudo
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_pseudo
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pseudo <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pseudo
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pseudo <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pseudo
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pseudo <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pseudo
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_pseudo <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_pseudo
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post2_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post3_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre_pseudo_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_pseudo_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pseudo_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pseudo_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pseudo_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pseudo_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pseudo_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pseudo_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_pseudo_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_pseudo_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre_lib_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_pre_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_lib_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pre_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pre_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_post_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna_post_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pre_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pre_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pre_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_post_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_snv_error_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$pre_snv_error_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_snv_error_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$post_snv_error_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_exp_snv_error_reads_pre <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$exp_snv_error_reads_pre
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_exp_snv_error_reads_post <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$exp_snv_error_reads_post
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pre <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pre
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_post <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$corr_post
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pre_pseudo <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pre_pseudo
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_post_pseudo <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$corr_post_pseudo
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pseudo_post_pre_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pseudo_post_pre_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_lib <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_lib
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2 <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3 <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2 <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre_pseudo_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pseudo_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_pseudo_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pseudo_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_pseudo_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pseudo_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2_pseudo_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pseudo_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3_pseudo_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_pseudo_freq <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2_pseudo_freq
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre_lib_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_pre_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_lib_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_pre_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_post_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2_pre_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pre_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3_pre_ratio
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio <- VHLx1c2rLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio) + log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio))/2)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio) + log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio))/2)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio) + log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio))/2)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio) + log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio))/2)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post3_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post3_pre_ratio) + log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pre_ratio))/2)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rna2_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rna2_post_ratio) + log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio))/2)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio) + log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio))/2)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio) + log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio))/2)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio) + log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio))/2)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio) + log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio))/2)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio) + log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio))/2)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio) + log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio))/2)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post3_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post3_pre_ratio) + log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pre_ratio))/2)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio) + log2(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_pre_weighted <- ((VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq*VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq/(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq))+(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq*VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq/(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)))/VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq
#rLD1 pre-freq weighting coefficient (rLD1_pre-freq / (rLD1 + rLD2 pre-freq's))
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq/(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq/(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)
#this will be weighted by denominator:  (rLD1_pof/rLD1_prf)(rLD1_prwc)+(rLD2_pof/rLD2_prf)*(rLD2_prwc)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted <- (VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pseudo_freq/VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq)*(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight)+(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq/VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)*(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight)
#this will be weighted by denominator:  (rLD1_pof/lif')*(rLD1_prwc)+(rLD2_pof/lif)*(rLD2_prwc)
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_pre_weighted <- (VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pseudo_freq/VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq)*(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight)+(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq/VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq)*(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight)
#rLD1 tHDR_pre-freq weighting coefficient (rLD1_tHDR_pre-freq / (rLD1 + rLD2 pre-freq's))
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_weight <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq/(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq+VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)
#rLD2 tHDR_pre-freq weighting coefficient
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_weight <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq/(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq+VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rLD1_pof/rLD1_prf)(rLD1_prwc)+(rLD2_pof/rLD2_prf)*(rLD2_prwc)
#tHDR_post_pre_ratio_rLD1rLD2_pre_weighted
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted <- (VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pseudo_freq/VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq)*(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_weight)+(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pseudo_freq/VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)*(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq)) >= 10) {
    VHLx1c2rLD1_cSNV_pre_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx1c2rLD1_cSNV_post_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx1c2rLD1_cSNV_post2_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx1c2rLD1_cSNV_post_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx1c2rLD1_tSNV_pre_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx1c2rLD1_tSNV_post_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx1c2rLD1_tSNV_post_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx1c2rLD1_tSNV_rna_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx1c2rLD1_tSNV_rna_post_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx1c2rLD1_tSNV_rna2_post_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx1c2rLD2_cSNV_pre_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_pre_lib_ratio)
VHLx1c2rLD2_cSNV_post_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post_pre_ratio)
VHLx1c2rLD2_cSNV_post2_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post2_pre_ratio)

VHLx1c2rLD2_cSNV_post_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post_lib_ratio)
VHLx1c2rLD2_tSNV_pre_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_pre_lib_ratio)
VHLx1c2rLD2_tSNV_post_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post_pre_ratio)
VHLx1c2rLD2_tSNV_post2_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post2_pre_ratio)
VHLx1c2rLD2_tSNV_post_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post_lib_ratio)
VHLx1c2rLD2_tSNV_rna_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna_pre_ratio)
VHLx1c2rLD2_tSNV_rna_post_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna_post_ratio)
VHLx1c2rLD2_tSNV_rna2_post_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna2_post_ratio)
VHLx1c2rLD1rLD2a_cSNV_pre_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_cSNV_post_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_cSNV_post2_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_cSNV_post_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_tSNV_pre_lib_med <- 
  median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_tSNV_post_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_tSNV_post2_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_tSNV_post_lib_med <-
  median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_tSNV_rna_pre_med <-
  median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_tSNV_rna_post_med <-
  median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_tSNV_rna2_post_med <-
  median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2pw_tSNV_post_pre_med  <-
  median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted)
VHLx1c2rLD1rLD2pw_cSNV_post_pre_med  <-
  median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLD1rLD2_pre_weighted)
  } else {
  VHLx1c2rLD1_cSNV_pre_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio)
VHLx1c2rLD1_cSNV_post_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio)
VHLx1c2rLD1_cSNV_post2_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio)
VHLx1c2rLD1_cSNV_post_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio)
VHLx1c2rLD1_tSNV_pre_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio)
VHLx1c2rLD1_tSNV_post_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio)
VHLx1c2rLD1_tSNV_post_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio)
VHLx1c2rLD1_tSNV_rna_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio)
VHLx1c2rLD1_tSNV_rna_post_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio)
VHLx1c2rLD1_tSNV_rna2_post_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio)
VHLx1c2rLD2_cSNV_pre_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio)
VHLx1c2rLD2_cSNV_post_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio)
VHLx1c2rLD2_cSNV_post2_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio)

VHLx1c2rLD2_cSNV_post_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio)
VHLx1c2rLD2_tSNV_pre_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio)
VHLx1c2rLD2_tSNV_post_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio)
VHLx1c2rLD2_tSNV_post2_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio)
VHLx1c2rLD2_tSNV_post_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio)
VHLx1c2rLD2_tSNV_rna_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio)
VHLx1c2rLD2_tSNV_rna_post_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio)
VHLx1c2rLD2_tSNV_rna2_post_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio)
VHLx1c2rLD1rLD2a_cSNV_pre_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_cSNV_post_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_cSNV_post2_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_cSNV_post_lib_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_tSNV_pre_lib_med <- 
  median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_tSNV_post_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_tSNV_post2_pre_med <- median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_tSNV_post_lib_med <-
  median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_tSNV_rna_pre_med <-
  median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_tSNV_rna_post_med <-
  median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2a_tSNV_rna2_post_med <-
  median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean)
VHLx1c2rLD1rLD2pw_tSNV_post_pre_med  <-
  median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted)
VHLx1c2rLD1rLD2pw_cSNV_post_pre_med  <-
  median(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted)
}

VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio/VHLx1c2rLD1_cSNV_pre_lib_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio/VHLx1c2rLD1_cSNV_post_pre_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio/VHLx1c2rLD1_cSNV_post_lib_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio/VHLx1c2rLD1_cSNV_post2_pre_med

VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio/VHLx1c2rLD1_tSNV_pre_lib_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio/VHLx1c2rLD1_tSNV_post_pre_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio/VHLx1c2rLD1_tSNV_post_lib_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio/VHLx1c2rLD1_tSNV_rna_pre_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio/VHLx1c2rLD1_tSNV_rna_post_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio/VHLx1c2rLD2_tSNV_post2_pre_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio/VHLx1c2rLD1_tSNV_rna2_post_med

VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio/VHLx1c2rLD2_cSNV_pre_lib_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio/VHLx1c2rLD2_cSNV_post_pre_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio/VHLx1c2rLD2_cSNV_post_lib_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio/VHLx1c2rLD1rLD2a_cSNV_post2_pre_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio/VHLx1c2rLD2_tSNV_rna2_post_med


VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio/VHLx1c2rLD2_tSNV_pre_lib_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio/VHLx1c2rLD2_tSNV_post_pre_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio/VHLx1c2rLD2_tSNV_post2_pre_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio/VHLx1c2rLD2_tSNV_post_lib_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio/VHLx1c2rLD2_tSNV_rna_pre_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio/VHLx1c2rLD2_tSNV_rna_post_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio/VHLx1c2rLD2_tSNV_rna2_post_med

###normalize the means
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean/VHLx1c2rLD1rLD2a_cSNV_pre_lib_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean/VHLx1c2rLD1rLD2a_cSNV_post_pre_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean/VHLx1c2rLD1rLD2a_cSNV_post_lib_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean/VHLx1c2rLD1rLD2a_tSNV_pre_lib_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean/VHLx1c2rLD1rLD2a_tSNV_post_pre_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean/VHLx1c2rLD1rLD2a_tSNV_post2_pre_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean/VHLx1c2rLD1rLD2a_tSNV_post_lib_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean/VHLx1c2rLD1rLD2a_tSNV_rna_pre_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean/VHLx1c2rLD1rLD2a_tSNV_rna_post_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean/VHLx1c2rLD1rLD2a_tSNV_rna2_post_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted/VHLx1c2rLD1rLD2pw_tSNV_post_pre_med
VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm <- VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted/VHLx1c2rLD1rLD2pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord
VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord = which(VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[,'pos']!='REF')
VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df = VHLx1c2rLD1_prog_var_thresh5_df_rLD2_int_ord[VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord,]
VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord = which(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'cDNApos']!='REF' & VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'cDNApos']!='NA')
VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df = VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df[VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord,]
VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord = which(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'CADD.phred']!='NA')
VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df = VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df[VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord,]
VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense <- VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df[which(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx1c2rLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s
VHLx1c2rLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_p <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='pearson')
VHLx1c2rLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_p
VHLx1c2rLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s
VHLx1c2rLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_p <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='pearson')
VHLx1c2rLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_p
VHLx1c2rLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post2_pre_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s
VHLx1c2rLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_p <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post2_pre_ratio_synnorm),method='pearson')
VHLx1c2rLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_p
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_s <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_s
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_p <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_p
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_s <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_s
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_p <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_p
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_s <- cor(log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_s
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_p <- cor(log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_p
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_s <- cor(log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_s
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_p <- cor(log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx1c2rLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_p
VHLx1c2rLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_s <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_freq),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_freq),method='spearman')
VHLx1c2rLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_s
VHLx1c2rLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_p <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pseudo_freq),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pseudo_freq),method='pearson')
VHLx1c2rLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_p
VHLx1c2rLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_s <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_s
VHLx1c2rLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_p <-cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio_synnorm),method='pearson')
VHLx1c2rLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_p
VHLx1c2rLD1rLD2_tSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_tSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s
VHLx1c2rLD1rLD2_tSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_tSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s
VHLx1c2rLD1rLD2_tSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_tSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s
VHLx1c2rLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s
VHLx1c2rLD1rLD2_tSNV_rLD1_rna2_post_by_rLD2_rna2_post_cor_s <- cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_tSNV_rLD1_rna2_post_by_rLD2_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx1c2rLD1_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1_cSNV_post_pre_by_cadd_cor_s
VHLx1c2rLD2_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD2_cSNV_post_pre_by_cadd_cor_s
VHLx1c2rLD1_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1_cSNV_post_lib_by_cadd_cor_s
VHLx1c2rLD2_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD2_cSNV_post_lib_by_cadd_cor_s
VHLx1c2rLD1_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1_tSNV_post_pre_by_cadd_cor_s
VHLx1c2rLD2_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD2_tSNV_post_pre_by_cadd_cor_s
VHLx1c2rLD1_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1_tSNV_post_lib_by_cadd_cor_s
VHLx1c2rLD2_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx1c2rLD1rLD2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2a_cSNV_pre_lib_by_cadd_cor_s
VHLx1c2rLD1rLD2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2w_cSNV_pre_lib_by_cadd_cor_s
VHLx1c2rLD1rLD2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2a_cSNV_post_pre_by_cadd_cor_s
VHLx1c2rLD1rLD2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2w_cSNV_post_pre_by_cadd_cor_s
VHLx1c2rLD1rLD2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2a_cSNV_post_lib_by_cadd_cor_s
VHLx1c2rLD1rLD2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2w_cSNV_post_lib_by_cadd_cor_s
VHLx1c2rLD1rLD2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2a_tSNV_pre_lib_by_cadd_cor_s
VHLx1c2rLD1rLD2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2a_tSNV_post_pre_by_cadd_cor_s
VHLx1c2rLD1rLD2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2w_tSNV_post_pre_by_cadd_cor_s
VHLx1c2rLD1rLD2a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post2_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2a_tSNV_post2_pre_by_cadd_cor_s
VHLx1c2rLD1rLD2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx1c2rLD1_cSNV_pre_lib_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1c2rLD1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1c2rLD1_tSNV_pre_lib_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1c2rLD1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1c2rLD1_cSNV_post_lib_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1c2rLD1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1c2rLD1_tSNV_post_lib_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1c2rLD1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1c2rLD1_cSNV_post_pre_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1c2rLD1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1c2rLD1_tSNV_post_pre_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1c2rLD1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1c2rLD1_cSNV_rna_lib_cors = cor(log2(VHLx1c2rLD1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1c2rLD1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1c2rLD1_tSNV_rna_lib_cors = cor(log2(VHLx1c2rLD1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1c2rLD1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1c2rLD1_cSNV_rna_pre_cors = cor(log2(VHLx1c2rLD1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1c2rLD1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1c2rLD1_tSNV_rna_pre_cors = cor(log2(VHLx1c2rLD1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1c2rLD1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1c2rLD1rLD2_cSNV_pre_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_freq),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_freq),method='spearman')
VHLx1c2rLD1rLD2_tSNV_pre_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_pseudo_freq),method='spearman')
VHLx1c2rLD1rLD2_cSNV_pre_lib_ratio_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio),method='spearman')
VHLx1c2rLD1rLD2_tSNV_pre_lib_ratio_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio),method='spearman')
VHLx1c2rLD1rLD2_cSNV_post_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_freq),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_freq),method='spearman')
VHLx1c2rLD1rLD2_tSNV_post_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pseudo_freq),method='spearman')
VHLx1c2rLD1rLD2_cSNV_post_lib_ratio_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_tSNV_post_lib_ratio_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_cSNV_post_pre_ratio_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_tSNV_post_pre_ratio_cors = cor(log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_cSNV_rna_cors = cor(log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rna_freq),log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_rna_freq),method='spearman')
VHLx1c2rLD1rLD2_tSNV_rna_cors = cor(log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pseudo_freq),method='spearman')
VHLx1c2rLD1rLD2_tSNV_rna_pre_ratio_cors = cor(log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1c2rLD1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1c2rLD1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1c2rLD1_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1c2rLD1_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1c2rLD1_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1c2rLD1_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1c2rLD1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1c2rLD1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1c2rLD1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1c2rLD1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1c2rLD1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1c2rLD1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1c2rLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1c2rLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1c2rLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1c2rLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1c2rLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1c2rLD1rLD2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')

VHLx1c2rLD1_cors <- c("VHLx1c2rLD1",VHLx1c2rLD1_cSNV_pre_lib_cors,VHLx1c2rLD1_tSNV_pre_lib_cors,VHLx1c2rLD1_cSNV_post_lib_cors,VHLx1c2rLD1_tSNV_post_lib_cors,VHLx1c2rLD1_cSNV_post_pre_cors,VHLx1c2rLD1_tSNV_post_pre_cors,VHLx1c2rLD1_cSNV_rna_lib_cors,VHLx1c2rLD1_tSNV_rna_lib_cors,VHLx1c2rLD1_cSNV_rna_pre_cors,VHLx1c2rLD1_tSNV_rna_pre_cors,VHLx1c2rLD1rLD2_cSNV_pre_cors,VHLx1c2rLD1rLD2_tSNV_pre_cors,VHLx1c2rLD1rLD2_cSNV_pre_lib_ratio_cors,VHLx1c2rLD1rLD2_tSNV_pre_lib_ratio_cors,VHLx1c2rLD1rLD2_cSNV_post_cors,VHLx1c2rLD1rLD2_tSNV_post_cors,VHLx1c2rLD1rLD2_cSNV_post_lib_ratio_cors,VHLx1c2rLD1rLD2_tSNV_post_lib_ratio_cors,VHLx1c2rLD1rLD2_cSNV_post_pre_ratio_cors,VHLx1c2rLD1rLD2_tSNV_post_pre_ratio_cors,VHLx1c2rLD1rLD2_cSNV_rna_cors,VHLx1c2rLD1rLD2_tSNV_rna_cors,VHLx1c2rLD1rLD2_tSNV_rna_pre_ratio_cors,VHLx1c2rLD1_cSNV_pre_lib_ratio_cadd_cors,VHLx1c2rLD1_tSNV_pre_lib_ratio_cadd_cors,VHLx1c2rLD1_cSNV_post_lib_ratio_cadd_cors,VHLx1c2rLD1_tSNV_post_lib_ratio_cadd_cors,VHLx1c2rLD1_cSNV_post_pre_ratio_cadd_cors,VHLx1c2rLD1_tSNV_post_pre_ratio_cadd_cors,VHLx1c2rLD1_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1c2rLD1_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1c2rLD1_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1c2rLD1_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1c2rLD1_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1c2rLD1_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1c2rLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors,VHLx1c2rLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors,VHLx1c2rLD1rLD2a_cSNV_post_lib_ratio_cadd_cors,VHLx1c2rLD1rLD2a_tSNV_post_lib_ratio_cadd_cors,VHLx1c2rLD1rLD2a_cSNV_post_pre_ratio_cadd_cors,VHLx1c2rLD1rLD2a_tSNV_post_pre_ratio_cadd_cors,VHLx1c2rLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1c2rLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1c2rLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1c2rLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1c2rLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1c2rLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1c2rLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors,VHLx1c2rLD1rLD2w_cSNV_post_lib_ratio_cadd_cors,VHLx1c2rLD1rLD2w_cSNV_post_pre_ratio_cadd_cors,VHLx1c2rLD1rLD2w_tSNV_post_pre_ratio_cadd_cors)

VHLx1c2rLD2_cSNV_pre_lib_cors = cor(log2(VHLx1c2rLD2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1c2rLD2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1c2rLD2_tSNV_pre_lib_cors = cor(log2(VHLx1c2rLD2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1c2rLD2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1c2rLD2_cSNV_post_lib_cors = cor(log2(VHLx1c2rLD2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1c2rLD2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1c2rLD2_tSNV_post_lib_cors = cor(log2(VHLx1c2rLD2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1c2rLD2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1c2rLD2_cSNV_post_pre_cors = cor(log2(VHLx1c2rLD2_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1c2rLD2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1c2rLD2_tSNV_post_pre_cors = cor(log2(VHLx1c2rLD2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1c2rLD2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1c2rLD2_cSNV_rna_lib_cors = cor(log2(VHLx1c2rLD2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1c2rLD2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1c2rLD2_tSNV_rna_lib_cors = cor(log2(VHLx1c2rLD2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1c2rLD2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1c2rLD2_cSNV_rna_pre_cors = cor(log2(VHLx1c2rLD2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1c2rLD2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1c2rLD2_tSNV_rna_pre_cors = cor(log2(VHLx1c2rLD2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1c2rLD2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1c2rLD2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1c2rLD2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1c2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1c2rLD2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1c2rLD2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1c2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1c2rLD2_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1c2rLD2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1c2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1c2rLD2_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1c2rLD2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1c2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1c2rLD2_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1c2rLD2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1c2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1c2rLD2_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1c2rLD2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1c2rLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1c2rLD2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1c2rLD2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1c2rLD2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1c2rLD2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1c2rLD2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1c2rLD2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1c2rLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')

VHLx1c2rLD2_cors <- c("VHLx1c2rLD2",VHLx1c2rLD2_cSNV_pre_lib_cors,VHLx1c2rLD2_tSNV_pre_lib_cors,VHLx1c2rLD2_cSNV_post_lib_cors,VHLx1c2rLD2_tSNV_post_lib_cors,VHLx1c2rLD2_cSNV_post_pre_cors,VHLx1c2rLD2_tSNV_post_pre_cors,VHLx1c2rLD2_cSNV_rna_lib_cors,VHLx1c2rLD2_tSNV_rna_lib_cors,VHLx1c2rLD2_cSNV_rna_pre_cors,VHLx1c2rLD2_tSNV_rna_pre_cors,VHLx1c2rLD1rLD2_cSNV_pre_cors,VHLx1c2rLD1rLD2_tSNV_pre_cors,VHLx1c2rLD1rLD2_cSNV_pre_lib_ratio_cors,VHLx1c2rLD1rLD2_tSNV_pre_lib_ratio_cors,VHLx1c2rLD1rLD2_cSNV_post_cors,VHLx1c2rLD1rLD2_tSNV_post_cors,VHLx1c2rLD1rLD2_cSNV_post_lib_ratio_cors,VHLx1c2rLD1rLD2_tSNV_post_lib_ratio_cors,VHLx1c2rLD1rLD2_cSNV_post_pre_ratio_cors,VHLx1c2rLD1rLD2_tSNV_post_pre_ratio_cors,VHLx1c2rLD1rLD2_cSNV_rna_cors,VHLx1c2rLD1rLD2_tSNV_rna_cors,VHLx1c2rLD1rLD2_tSNV_rna_pre_ratio_cors,VHLx1c2rLD2_cSNV_pre_lib_ratio_cadd_cors,VHLx1c2rLD2_tSNV_pre_lib_ratio_cadd_cors,VHLx1c2rLD2_cSNV_post_lib_ratio_cadd_cors,VHLx1c2rLD2_tSNV_post_lib_ratio_cadd_cors,VHLx1c2rLD2_cSNV_post_pre_ratio_cadd_cors,VHLx1c2rLD2_tSNV_post_pre_ratio_cadd_cors,VHLx1c2rLD2_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1c2rLD2_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1c2rLD2_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1c2rLD2_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1c2rLD2_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1c2rLD2_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1c2rLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors,VHLx1c2rLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors,VHLx1c2rLD1rLD2a_cSNV_post_lib_ratio_cadd_cors,VHLx1c2rLD1rLD2a_tSNV_post_lib_ratio_cadd_cors,VHLx1c2rLD1rLD2a_cSNV_post_pre_ratio_cadd_cors,VHLx1c2rLD1rLD2a_tSNV_post_pre_ratio_cadd_cors,VHLx1c2rLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1c2rLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1c2rLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1c2rLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1c2rLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1c2rLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1c2rLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors,VHLx1c2rLD1rLD2w_cSNV_post_lib_ratio_cadd_cors,VHLx1c2rLD1rLD2w_cSNV_post_pre_ratio_cadd_cors,VHLx1c2rLD1rLD2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx1c2rLD1)
rm(VHLx1c2rLD2)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx1c2rLD1
VHLx1c2_posrange <- range(as.numeric(as.character(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$pos)))
VHLx1c2_posseq <- seq(from=VHLx1c2_posrange[1], to=VHLx1c2_posrange[2])
VHLx1c2rLD1_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1c2rLD1_tHDR_pre_lib_pred <- predict(VHLx1c2rLD1_tHDR_pre_lib_ratio.lo, newdata = VHLx1c2_posseq, se=TRUE)
VHLx1c2rLD1_tHDR_pre_lib_pos_effects <- VHLx1c2rLD1_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1c2rLD1_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1c2rLD1_tHDR_pre_lib_pos_effects)
VHLx1c2rLD1_tHDR_pre_lib_pos_effects_ci <- VHLx1c2rLD1_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1c2rLD1_tHDR_pre_lib_pred$df)
VHLx1c2rLD1_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1c2rLD1_tHDR_pre_lib_pos_effects - VHLx1c2rLD1_tHDR_pre_lib_pos_effects_ci
VHLx1c2rLD1_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1c2rLD1_tHDR_pre_lib_pos_effects + VHLx1c2rLD1_tHDR_pre_lib_pos_effects_ci
VHLx1c2rLD1_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1c2_posseq, VHLx1c2rLD1_tHDR_pre_lib_pos_effects, VHLx1c2rLD1_tHDR_pre_lib_pos_effects.x, VHLx1c2rLD1_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1c2rLD1_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1c2rLD1_tHDR_pre_lib_pred_se = VHLx1c2rLD1_tHDR_pre_lib_pred$se.fit)
#VHLx1c2rLD2
VHLx1c2rLD2_tHDR_pre_lib_ratio.lo <- loess(log2(rLD2_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1c2rLD2_tHDR_pre_lib_pred <- predict(VHLx1c2rLD2_tHDR_pre_lib_ratio.lo, newdata = VHLx1c2_posseq, se=TRUE)
VHLx1c2rLD2_tHDR_pre_lib_pos_effects <- VHLx1c2rLD2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1c2rLD2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1c2rLD2_tHDR_pre_lib_pos_effects)
VHLx1c2rLD2_tHDR_pre_lib_pos_effects_ci <- VHLx1c2rLD2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1c2rLD2_tHDR_pre_lib_pred$df)
VHLx1c2rLD2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1c2rLD2_tHDR_pre_lib_pos_effects - VHLx1c2rLD2_tHDR_pre_lib_pos_effects_ci
VHLx1c2rLD2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1c2rLD2_tHDR_pre_lib_pos_effects + VHLx1c2rLD2_tHDR_pre_lib_pos_effects_ci
VHLx1c2rLD2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1c2_posseq, VHLx1c2rLD2_tHDR_pre_lib_pos_effects, VHLx1c2rLD2_tHDR_pre_lib_pos_effects.x, VHLx1c2rLD2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1c2rLD2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1c2rLD2_tHDR_pre_lib_pred_se = VHLx1c2rLD2_tHDR_pre_lib_pred$se.fit)

#VHLx1c2rLD1rLD2
VHLx1c2rLD1rLD2_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm > 0.7 & VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm > 0.3 & VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1c2rLD1rLD2_tHDR_pre_lib_pred <- predict(VHLx1c2rLD1rLD2_tHDR_pre_lib_ratio.lo, newdata = VHLx1c2_posseq, se=TRUE)
VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects <- VHLx1c2rLD1rLD2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects)
VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects_ci <- VHLx1c2rLD1rLD2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1c2rLD1rLD2_tHDR_pre_lib_pred$df)
VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects - VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects_ci
VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects + VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects_ci
VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1c2_posseq, VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects, VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects.x, VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1c2rLD1rLD2_tHDR_pre_lib_pred_se = VHLx1c2rLD1rLD2_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rLD1, rLD2, rLD1rLD2)
VHLx1c2rLD_tHDR_pos_merge_df <- VHLx1c2rLD1_prog_map_thresh5_df_rLD2_int_ord_df 
VHLx1c2rLD_tHDR_pos_merge_df <- merge(VHLx1c2rLD_tHDR_pos_merge_df, VHLx1c2rLD1_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx1c2rLD1_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1c2rLD_tHDR_pos_merge_df <- merge(VHLx1c2rLD_tHDR_pos_merge_df, VHLx1c2rLD2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1c2rLD2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1c2rLD_tHDR_pos_merge_df <- merge(VHLx1c2rLD_tHDR_pos_merge_df, VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx1c2rLD_tHDR_pos_merge_df <- VHLx1c2rLD_tHDR_pos_merge_df %>% 
  rename(
    rLD1_tHDR_pre_lib_pos_effects.x = VHLx1c2rLD1_tHDR_pre_lib_pos_effects.x,
    rLD2_tHDR_pre_lib_pos_effects.x = VHLx1c2rLD2_tHDR_pre_lib_pos_effects.x,
    rLD1rLD2_tHDR_pre_lib_pos_effects.x = VHLx1c2rLD1rLD2_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rLD1 vs. rLD1_fit and vs. mean_fit)
VHLx1c2rLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1 <- log2(VHLx1c2rLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1c2rLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_pos_effects.x
VHLx1c2rLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx1c2rLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1c2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1c2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2 <- log2(VHLx1c2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_ratio_synnorm) - VHLx1c2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_pos_effects.x
VHLx1c2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx1c2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_ratio_synnorm) - VHLx1c2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1c2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx1c2rLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm) - VHLx1c2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx1c2rLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_loess_rLD1 <- log2(VHLx1c2rLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1c2rLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_pos_effects.x
VHLx1c2rLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx1c2rLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1c2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1c2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_loess_rLD2 <- log2(VHLx1c2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_ratio_synnorm) - VHLx1c2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_pos_effects.x
VHLx1c2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx1c2rLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_ratio_synnorm) - VHLx1c2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1c2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx1c2rLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm) - VHLx1c2rLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rLD1 and rLD2 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx1c2rLD_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1c2rLD_tHDR_post_lib_loess_median_syn_rLD1 <- median(VHLx1c2rLD_tHDR_pos_merge_df[which(VHLx1c2rLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLD1_tHDR_post_lib_loess_rLD1')])
  VHLx1c2rLD_tHDR_post_lib_loess_median_syn_rLD2 <- median(VHLx1c2rLD_tHDR_pos_merge_df[which(VHLx1c2rLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLD2_tHDR_post_lib_loess_rLD2')])
  } else {
  VHLx1c2rLD_tHDR_post_lib_loess_median_syn_rLD1 <- median(VHLx1c2rLD_tHDR_pos_merge_df[which(VHLx1c2rLD_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLD1_tHDR_post_lib_loess_rLD1')])
  VHLx1c2rLD_tHDR_post_lib_loess_median_syn_rLD2 <- median(VHLx1c2rLD_tHDR_pos_merge_df[which(VHLx1c2rLD_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLD2_tHDR_post_lib_loess_rLD2')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rLD1 'e.sns' = exon syn/ns norm.
VHLx1c2rLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1_e.sns <- (VHLx1c2rLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1-VHLx1c2rLD_tHDR_post_lib_loess_median_syn_rLD1)
#calculate new b values for rLD2 'e.sns' = exon syn/ns norm.
VHLx1c2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2_e.sns <- (VHLx1c2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2-VHLx1c2rLD_tHDR_post_lib_loess_median_syn_rLD2)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx1c2rLD_tHDR_pos_merge_df$rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean <- (VHLx1c2rLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1_e.sns+VHLx1c2rLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx1c2rLD_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1c2rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_syn_median <- median(VHLx1c2rLD_tHDR_pos_merge_df[which(VHLx1c2rLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('VHLx1c2rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean')])
  } else {
  VHLx1c2rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_syn_median <- median(VHLx1c2rLD_tHDR_pos_merge_df[which(VHLx1c2rLD_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('VHLx1c2rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean')])
}

#RNA analysis
VHLx1c2rLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s <- cor(log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1c2rLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1_tHDR_rna2_rna_ratio <- VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_pseudo_freq/VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pseudo_freq
VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_rna_ratio <- VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_pseudo_freq/VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pseudo_freq
VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1rLD2_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1_tHDR_rna2_rna_ratio)+log2(VHLx1c2rLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_rna_ratio))/2

```

```{r}
#VHLx1prLD
VHLx1prLD1_file <- paste(experiment_dir_221102,'VHLx1prL41','_annotated.txt',sep='')
VHLx1prLD2_file <- paste(experiment_dir_221102,'VHLx1prL42','_annotated.txt',sep='')
VHLx1prLD1 <- read.table(VHLx1prLD1_file, header=TRUE, sep="\t")
VHLx1prLD2 <- read.table(VHLx1prLD2_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx1prLD1 <- VHLx1prLD1 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

VHLx1prLD2 <- VHLx1prLD2 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx1p <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx1p'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx1p_HDR_5_SNV = as.character(VHL_editing_info_VHLx1p$HDR_5_SNV)
VHLx1p_HDR_3_SNV = as.character(VHL_editing_info_VHLx1p$HDR_3_SNV)
#VHLx1p_cut_pos = as.character(VHL_editing_info_VHLx1p$cut_pos)
VHLx1p_cut_end = as.character(VHL_editing_info_VHLx1p$cut_end)
VHLx1p_mut_start = as.character(VHL_editing_info_VHLx1p$mut_start)
VHLx1p_mut_end = as.character(VHL_editing_info_VHLx1p$mut_end)

### Replicate 1
VHLx1prLD1_cSNV_all <- which(VHLx1prLD1[,'c_hdr_snv']=='True')
VHLx1prLD1_cSNV_all_df = VHLx1prLD1[VHLx1prLD1_cSNV_all,]
VHLx1prLD1_prog_var_all <- which(VHLx1prLD1[,'all_hdr_variant']=='True' & VHLx1prLD1[,'edit_string']!='-WT')
VHLx1prLD1_prog_var_all_df = VHLx1prLD1[VHLx1prLD1_prog_var_all,]
VHLx1prLD1_prog_map_all = which(VHLx1prLD1_prog_var_all_df[,'pos']!='REF')
VHLx1prLD1_prog_map_all_df = VHLx1prLD1_prog_var_all_df[VHLx1prLD1_prog_map_all,]
VHLx1prLD1_prog_map_exon_all = which(VHLx1prLD1_prog_map_all_df[,'cDNApos']!='REF' & VHLx1prLD1_prog_map_all_df[,'cDNApos']!='NA')
VHLx1prLD1_prog_map_exon_all_df = VHLx1prLD1_prog_map_all_df[VHLx1prLD1_prog_map_exon_all,]
VHLx1prLD1_prog_map_CADD = which(VHLx1prLD1_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1prLD1_prog_map_CADD_df = VHLx1prLD1_prog_map_all_df[VHLx1prLD1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx1prLD1_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1prLD1_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx1prLD1_prog_var_thresh5_df = VHLx1prLD1_prog_var_all_df[VHLx1prLD1_prog_var_thresh5,]
VHLx1prLD1_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1prLD1_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx1prLD1_prog_map_thresh5_df = VHLx1prLD1_prog_map_all_df[VHLx1prLD1_prog_map_thresh5,]
VHLx1prLD1_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1prLD1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx1prLD1_prog_map_exon_thresh5_df = VHLx1prLD1_prog_map_exon_all_df[VHLx1prLD1_prog_map_exon_thresh5,]
VHLx1prLD1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1prLD1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx1prLD1_prog_map_CADD_thresh5_df = VHLx1prLD1_prog_map_CADD_df[VHLx1prLD1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1prLD1_prog_var_all_lib_count = length(VHLx1prLD1_prog_var_all_df$lib)
VHLx1prLD1_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx1prLD1_prog_var_all_min_lib_counts = min(VHLx1prLD1_prog_var_all_df$lib)
VHLx1prLD1_prog_var_all_min_lib_counts
VHLx1prLD1_prog_var_all_max_lib_counts = max(VHLx1prLD1_prog_var_all_df$lib)
VHLx1prLD1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1prLD1_prog_map_all_lib_count = length(VHLx1prLD1_prog_map_all_df$lib)
VHLx1prLD1_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx1prLD1_prog_map_all_min_lib_counts = min(VHLx1prLD1_prog_map_all_df$lib)
VHLx1prLD1_prog_map_all_min_lib_counts
VHLx1prLD1_prog_map_all_max_lib_counts = max(VHLx1prLD1_prog_map_all_df$lib)
VHLx1prLD1_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx1prLD1_prog_var_all_pre_count = length(VHLx1prLD1_prog_var_all_df$pre)
VHLx1prLD1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx1prLD1_prog_var_all_min_pre_counts = min(VHLx1prLD1_prog_var_all_df$pre)
VHLx1prLD1_prog_var_all_min_pre_counts
VHLx1prLD1_prog_var_all_max_pre_counts = max(VHLx1prLD1_prog_var_all_df$pre)
VHLx1prLD1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1prLD1_prog_map_all_pre_count = length(VHLx1prLD1_prog_map_all_df$pre)
VHLx1prLD1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx1prLD1_prog_map_all_min_pre_counts = min(VHLx1prLD1_prog_map_all_df$pre)
VHLx1prLD1_prog_map_all_min_pre_counts
VHLx1prLD1_prog_map_all_max_pre_counts = max(VHLx1prLD1_prog_map_all_df$pre)
VHLx1prLD1_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx1prLD1_prog_map_all_post_count = length(VHLx1prLD1_prog_map_all_df$post)
VHLx1prLD1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx1prLD1_prog_map_all_min_post_counts = min(VHLx1prLD1_prog_map_all_df$post)
VHLx1prLD1_prog_map_all_min_post_counts
VHLx1prLD1_prog_map_all_max_post_counts = max(VHLx1prLD1_prog_map_all_df$post)
VHLx1prLD1_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx1prLD1_prog_map_all_syn_df <- VHLx1prLD1_prog_map_all_df[which(VHLx1prLD1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1prLD1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1prLD1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1prLD1_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1prLD1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1prLD1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1prLD1_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1prLD1_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1prLD1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx1prLD1_prog_map_all_min_rna_counts = min(VHLx1prLD1_prog_map_exon_all_df$tHDR_rna)
VHLx1prLD1_prog_map_all_min_rna_counts
VHLx1prLD1_prog_map_all_max_rna_counts = max(VHLx1prLD1_prog_map_exon_all_df$tHDR_rna)
VHLx1prLD1_prog_map_all_max_rna_counts
VHLx1prLD1_prog_map_all_min_rna_pseudo_freq = min(VHLx1prLD1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1prLD1_prog_map_all_min_rna_pseudo_freq
VHLx1prLD1_prog_map_all_max_rna_pseudo_freq = max(VHLx1prLD1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1prLD1_prog_map_all_max_rna_pseudo_freq
VHLx1prLD1_prog_map_all_min_rna_pre_ratio = min(VHLx1prLD1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1prLD1_prog_map_all_min_rna_pre_ratio
VHLx1prLD1_prog_map_all_max_rna_pre_ratio = max(VHLx1prLD1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1prLD1_prog_map_all_max_rna_pre_ratio
VHLx1prLD1_prog_map_all_min_rna_post_ratio = min(VHLx1prLD1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1prLD1_prog_map_all_min_rna_post_ratio
VHLx1prLD1_prog_map_all_max_rna_post_ratio = max(VHLx1prLD1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1prLD1_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1prLD1_cSNV_all_corr_pre_count = length(VHLx1prLD1_cSNV_all_df$corr_pre)
VHLx1prLD1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx1prLD1_cSNV_all_min_corr_pre_counts = min(VHLx1prLD1_cSNV_all_df$corr_pre)
VHLx1prLD1_cSNV_all_min_corr_pre_counts
VHLx1prLD1_cSNV_all_max_corr_pre_counts = max(VHLx1prLD1_cSNV_all_df$corr_pre)
VHLx1prLD1_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prLD1_cSNV_all_corr_post_count = length(VHLx1prLD1_cSNV_all_df$corr_post)
VHLx1prLD1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx1prLD1_cSNV_all_min_corr_post_counts = min(VHLx1prLD1_cSNV_all_df$corr_post)
VHLx1prLD1_cSNV_all_min_corr_post_counts
VHLx1prLD1_cSNV_all_max_corr_post_counts = max(VHLx1prLD1_cSNV_all_df$corr_post)
VHLx1prLD1_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx1p_p_hdr_snv = paste('p_hdr_',VHLx1p_cut_end,'_snv',sep='')
VHLx1prLD1_pSNV_all <- which(VHLx1prLD1[,VHLx1p_p_hdr_snv]=='True')
VHLx1prLD1_pSNV_all_df = VHLx1prLD1[VHLx1prLD1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prLD1_pSNV_all_lib_count = length(VHLx1prLD1_pSNV_all_df$lib)
VHLx1prLD1_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx1prLD1_pSNV_all_min_lib_counts = min(VHLx1prLD1_pSNV_all_df$lib)
VHLx1prLD1_pSNV_all_min_lib_counts
VHLx1prLD1_pSNV_all_max_lib_counts = max(VHLx1prLD1_pSNV_all_df$lib)
VHLx1prLD1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx1prLD1_pSNV_all_pre_count = length(VHLx1prLD1_pSNV_all_df$pre)
VHLx1prLD1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx1prLD1_pSNV_all_min_pre_counts = min(VHLx1prLD1_pSNV_all_df$pre)
VHLx1prLD1_pSNV_all_min_pre_counts
VHLx1prLD1_pSNV_all_max_pre_counts = max(VHLx1prLD1_pSNV_all_df$pre)
VHLx1prLD1_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prLD1_pSNV_all_post_count = length(VHLx1prLD1_pSNV_all_df$post)
VHLx1prLD1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx1prLD1_pSNV_all_min_post_counts = min(VHLx1prLD1_pSNV_all_df$post)
VHLx1prLD1_pSNV_all_min_post_counts
VHLx1prLD1_pSNV_all_max_post_counts = max(VHLx1prLD1_pSNV_all_df$post)
VHLx1prLD1_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prLD1_prog_map_thresh5_lib_count = length(VHLx1prLD1_prog_map_thresh5_df$lib)
VHLx1prLD1_prog_map_thresh5_lib_count
VHLx1prLD1_prog_map_thresh5_min_lib_counts = min(VHLx1prLD1_prog_map_thresh5_df$lib)
VHLx1prLD1_prog_map_thresh5_min_lib_counts
VHLx1prLD1_prog_map_thresh5_max_lib_counts = max(VHLx1prLD1_prog_map_thresh5_df$lib)
VHLx1prLD1_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prLD1_prog_map_thresh5_pre_count = length(VHLx1prLD1_prog_map_thresh5_df$pre)
VHLx1prLD1_prog_map_thresh5_pre_count
VHLx1prLD1_prog_map_thresh5_min_pre_counts = min(VHLx1prLD1_prog_map_thresh5_df$pre)
VHLx1prLD1_prog_map_thresh5_min_pre_counts
VHLx1prLD1_prog_map_thresh5_max_pre_counts = max(VHLx1prLD1_prog_map_thresh5_df$pre)
VHLx1prLD1_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1prLD1_prog_map_thresh5_post_count = length(VHLx1prLD1_prog_map_thresh5_df$post)
VHLx1prLD1_prog_map_thresh5_post_count
VHLx1prLD1_prog_map_thresh5_min_post_counts = min(VHLx1prLD1_prog_map_thresh5_df$post)
VHLx1prLD1_prog_map_thresh5_min_post_counts
VHLx1prLD1_prog_map_thresh5_max_post_counts = max(VHLx1prLD1_prog_map_thresh5_df$post)
VHLx1prLD1_prog_map_thresh5_max_post_counts
VHLx1prLD1_prog_map_thresh5_corr_post_count = length(VHLx1prLD1_cSNV_all_df$corr_post)
VHLx1prLD1_prog_map_thresh5_corr_post_count
VHLx1prLD1_prog_map_thresh5_min_corr_post_counts = min(VHLx1prLD1_cSNV_all_df$corr_post)
VHLx1prLD1_prog_map_thresh5_min_corr_post_counts
VHLx1prLD1_prog_map_thresh5_max_corr_post_counts = max(VHLx1prLD1_cSNV_all_df$corr_post)
VHLx1prLD1_prog_map_thresh5_max_corr_post_counts

VHLx1prLD1_pSNV_thresh5 <- which(VHLx1prLD1[,VHLx1p_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1prLD1[,'pre_freq']))>=0.00001)
VHLx1prLD1_pSNV_thresh5_df = VHLx1prLD1[VHLx1prLD1_pSNV_thresh5,]
VHLx1prLD1_pSNV_thresh5_lib_count = length(VHLx1prLD1_pSNV_thresh5_df$lib)
VHLx1prLD1_pSNV_thresh5_lib_count
VHLx1prLD1_pSNV_thresh5_min_lib_counts = min(VHLx1prLD1_pSNV_thresh5_df$lib)
VHLx1prLD1_pSNV_thresh5_min_lib_counts
VHLx1prLD1_pSNV_thresh5_max_lib_counts = max(VHLx1prLD1_pSNV_thresh5_df$lib)
VHLx1prLD1_pSNV_thresh5_max_lib_counts
VHLx1prLD1_pSNV_thresh5_pre_count = length(VHLx1prLD1_pSNV_thresh5_df$pre)
VHLx1prLD1_pSNV_thresh5_pre_count
VHLx1prLD1_pSNV_thresh5_min_pre_counts = min(VHLx1prLD1_pSNV_thresh5_df$pre)
VHLx1prLD1_pSNV_thresh5_min_pre_counts
VHLx1prLD1_pSNV_thresh5_max_pre_counts = max(VHLx1prLD1_pSNV_thresh5_df$pre)
VHLx1prLD1_pSNV_thresh5_max_pre_counts
VHLx1prLD1_pSNV_thresh5_post_count = length(VHLx1prLD1_pSNV_thresh5_df$post)
VHLx1prLD1_pSNV_thresh5_post_count
VHLx1prLD1_pSNV_thresh5_min_post_counts = min(VHLx1prLD1_pSNV_thresh5_df$post)
VHLx1prLD1_pSNV_thresh5_min_post_counts
VHLx1prLD1_pSNV_thresh5_max_post_counts = max(VHLx1prLD1_pSNV_thresh5_df$post)
VHLx1prLD1_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx1prLD2_cSNV_all <- which(VHLx1prLD2[,'c_hdr_snv']=='True')
VHLx1prLD2_cSNV_all_df = VHLx1prLD2[VHLx1prLD2_cSNV_all,]
VHLx1prLD2_prog_var_all <- which(VHLx1prLD2[,'all_hdr_variant']=='True' & VHLx1prLD2[,'edit_string']!='-WT')
VHLx1prLD2_prog_var_all_df = VHLx1prLD2[VHLx1prLD2_prog_var_all,]
VHLx1prLD2_prog_map_all = which(VHLx1prLD2_prog_var_all_df[,'pos']!='REF')
VHLx1prLD2_prog_map_all_df = VHLx1prLD2_prog_var_all_df[VHLx1prLD2_prog_map_all,]
VHLx1prLD2_prog_map_exon_all = which(VHLx1prLD2_prog_map_all_df[,'cDNApos']!='REF' & VHLx1prLD2_prog_map_all_df[,'cDNApos']!='NA')
VHLx1prLD2_prog_map_exon_all_df = VHLx1prLD2_prog_map_all_df[VHLx1prLD2_prog_map_exon_all,]
VHLx1prLD2_prog_map_CADD = which(VHLx1prLD2_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1prLD2_prog_map_CADD_df = VHLx1prLD2_prog_map_all_df[VHLx1prLD2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx1prLD2_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1prLD2_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx1prLD2_prog_var_thresh5_df = VHLx1prLD2_prog_var_all_df[VHLx1prLD2_prog_var_thresh5,]
VHLx1prLD2_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1prLD2_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx1prLD2_prog_map_thresh5_df = VHLx1prLD2_prog_map_all_df[VHLx1prLD2_prog_map_thresh5,]
VHLx1prLD2_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1prLD2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx1prLD2_prog_map_exon_thresh5_df = VHLx1prLD2_prog_map_exon_all_df[VHLx1prLD2_prog_map_exon_thresh5,]
VHLx1prLD2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1prLD2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx1prLD2_prog_map_CADD_thresh5_df = VHLx1prLD2_prog_map_CADD_df[VHLx1prLD2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1prLD2_prog_var_all_lib_count = length(VHLx1prLD2_prog_var_all_df$lib)
VHLx1prLD2_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx1prLD2_prog_var_all_min_lib_counts = min(VHLx1prLD2_prog_var_all_df$lib)
VHLx1prLD2_prog_var_all_min_lib_counts
VHLx1prLD2_prog_var_all_max_lib_counts = max(VHLx1prLD2_prog_var_all_df$lib)
VHLx1prLD2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1prLD2_prog_map_all_lib_count = length(VHLx1prLD2_prog_map_all_df$lib)
VHLx1prLD2_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx1prLD2_prog_map_all_min_lib_counts = min(VHLx1prLD2_prog_map_all_df$lib)
VHLx1prLD2_prog_map_all_min_lib_counts
VHLx1prLD2_prog_map_all_max_lib_counts = max(VHLx1prLD2_prog_map_all_df$lib)
VHLx1prLD2_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx1prLD2_prog_var_all_pre_count = length(VHLx1prLD2_prog_var_all_df$pre)
VHLx1prLD2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx1prLD2_prog_var_all_min_pre_counts = min(VHLx1prLD2_prog_var_all_df$pre)
VHLx1prLD2_prog_var_all_min_pre_counts
VHLx1prLD2_prog_var_all_max_pre_counts = max(VHLx1prLD2_prog_var_all_df$pre)
VHLx1prLD2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1prLD2_prog_map_all_pre_count = length(VHLx1prLD2_prog_map_all_df$pre)
VHLx1prLD2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx1prLD2_prog_map_all_min_pre_counts = min(VHLx1prLD2_prog_map_all_df$pre)
VHLx1prLD2_prog_map_all_min_pre_counts
VHLx1prLD2_prog_map_all_max_pre_counts = max(VHLx1prLD2_prog_map_all_df$pre)
VHLx1prLD2_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx1prLD2_prog_map_all_post_count = length(VHLx1prLD2_prog_map_all_df$post)
VHLx1prLD2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx1prLD2_prog_map_all_min_post_counts = min(VHLx1prLD2_prog_map_all_df$post)
VHLx1prLD2_prog_map_all_min_post_counts
VHLx1prLD2_prog_map_all_max_post_counts = max(VHLx1prLD2_prog_map_all_df$post)
VHLx1prLD2_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx1prLD2_prog_map_all_syn_df <- VHLx1prLD2_prog_map_all_df[which(VHLx1prLD2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1prLD2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1prLD2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1prLD2_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1prLD2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1prLD2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1prLD2_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1prLD2_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1prLD2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx1prLD2_prog_map_all_min_rna_counts = min(VHLx1prLD2_prog_map_exon_all_df$tHDR_rna)
VHLx1prLD2_prog_map_all_min_rna_counts
VHLx1prLD2_prog_map_all_max_rna_counts = max(VHLx1prLD2_prog_map_exon_all_df$tHDR_rna)
VHLx1prLD2_prog_map_all_max_rna_counts
VHLx1prLD2_prog_map_all_min_rna_pseudo_freq = min(VHLx1prLD2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1prLD2_prog_map_all_min_rna_pseudo_freq
VHLx1prLD2_prog_map_all_max_rna_pseudo_freq = max(VHLx1prLD2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1prLD2_prog_map_all_max_rna_pseudo_freq
VHLx1prLD2_prog_map_all_min_rna_pre_ratio = min(VHLx1prLD2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1prLD2_prog_map_all_min_rna_pre_ratio
VHLx1prLD2_prog_map_all_max_rna_pre_ratio = max(VHLx1prLD2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1prLD2_prog_map_all_max_rna_pre_ratio
VHLx1prLD2_prog_map_all_min_rna_post_ratio = min(VHLx1prLD2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1prLD2_prog_map_all_min_rna_post_ratio
VHLx1prLD2_prog_map_all_max_rna_post_ratio = max(VHLx1prLD2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1prLD2_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1prLD2_cSNV_all_corr_pre_count = length(VHLx1prLD2_cSNV_all_df$corr_pre)
VHLx1prLD2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx1prLD2_cSNV_all_min_corr_pre_counts = min(VHLx1prLD2_cSNV_all_df$corr_pre)
VHLx1prLD2_cSNV_all_min_corr_pre_counts
VHLx1prLD2_cSNV_all_max_corr_pre_counts = max(VHLx1prLD2_cSNV_all_df$corr_pre)
VHLx1prLD2_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prLD2_cSNV_all_corr_post_count = length(VHLx1prLD2_cSNV_all_df$corr_post)
VHLx1prLD2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx1prLD2_cSNV_all_min_corr_post_counts = min(VHLx1prLD2_cSNV_all_df$corr_post)
VHLx1prLD2_cSNV_all_min_corr_post_counts
VHLx1prLD2_cSNV_all_max_corr_post_counts = max(VHLx1prLD2_cSNV_all_df$corr_post)
VHLx1prLD2_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx1p_p_hdr_snv = paste('p_hdr_',VHLx1p_cut_end,'_snv',sep='')
VHLx1prLD2_pSNV_all <- which(VHLx1prLD2[,VHLx1p_p_hdr_snv]=='True')
VHLx1prLD2_pSNV_all_df = VHLx1prLD2[VHLx1prLD2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prLD2_pSNV_all_lib_count = length(VHLx1prLD2_pSNV_all_df$lib)
VHLx1prLD2_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx1prLD2_pSNV_all_min_lib_counts = min(VHLx1prLD2_pSNV_all_df$lib)
VHLx1prLD2_pSNV_all_min_lib_counts
VHLx1prLD2_pSNV_all_max_lib_counts = max(VHLx1prLD2_pSNV_all_df$lib)
VHLx1prLD2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx1prLD2_pSNV_all_pre_count = length(VHLx1prLD2_pSNV_all_df$pre)
VHLx1prLD2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx1prLD2_pSNV_all_min_pre_counts = min(VHLx1prLD2_pSNV_all_df$pre)
VHLx1prLD2_pSNV_all_min_pre_counts
VHLx1prLD2_pSNV_all_max_pre_counts = max(VHLx1prLD2_pSNV_all_df$pre)
VHLx1prLD2_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prLD2_pSNV_all_post_count = length(VHLx1prLD2_pSNV_all_df$post)
VHLx1prLD2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx1prLD2_pSNV_all_min_post_counts = min(VHLx1prLD2_pSNV_all_df$post)
VHLx1prLD2_pSNV_all_min_post_counts
VHLx1prLD2_pSNV_all_max_post_counts = max(VHLx1prLD2_pSNV_all_df$post)
VHLx1prLD2_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prLD2_prog_map_thresh5_lib_count = length(VHLx1prLD2_prog_map_thresh5_df$lib)
VHLx1prLD2_prog_map_thresh5_lib_count
VHLx1prLD2_prog_map_thresh5_min_lib_counts = min(VHLx1prLD2_prog_map_thresh5_df$lib)
VHLx1prLD2_prog_map_thresh5_min_lib_counts
VHLx1prLD2_prog_map_thresh5_max_lib_counts = max(VHLx1prLD2_prog_map_thresh5_df$lib)
VHLx1prLD2_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prLD2_prog_map_thresh5_pre_count = length(VHLx1prLD2_prog_map_thresh5_df$pre)
VHLx1prLD2_prog_map_thresh5_pre_count
VHLx1prLD2_prog_map_thresh5_min_pre_counts = min(VHLx1prLD2_prog_map_thresh5_df$pre)
VHLx1prLD2_prog_map_thresh5_min_pre_counts
VHLx1prLD2_prog_map_thresh5_max_pre_counts = max(VHLx1prLD2_prog_map_thresh5_df$pre)
VHLx1prLD2_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1prLD2_prog_map_thresh5_post_count = length(VHLx1prLD2_prog_map_thresh5_df$post)
VHLx1prLD2_prog_map_thresh5_post_count
VHLx1prLD2_prog_map_thresh5_min_post_counts = min(VHLx1prLD2_prog_map_thresh5_df$post)
VHLx1prLD2_prog_map_thresh5_min_post_counts
VHLx1prLD2_prog_map_thresh5_max_post_counts = max(VHLx1prLD2_prog_map_thresh5_df$post)
VHLx1prLD2_prog_map_thresh5_max_post_counts
VHLx1prLD2_prog_map_thresh5_corr_post_count = length(VHLx1prLD2_cSNV_all_df$corr_post)
VHLx1prLD2_prog_map_thresh5_corr_post_count
VHLx1prLD2_prog_map_thresh5_min_corr_post_counts = min(VHLx1prLD2_cSNV_all_df$corr_post)
VHLx1prLD2_prog_map_thresh5_min_corr_post_counts
VHLx1prLD2_prog_map_thresh5_max_corr_post_counts = max(VHLx1prLD2_cSNV_all_df$corr_post)
VHLx1prLD2_prog_map_thresh5_max_corr_post_counts

VHLx1prLD2_pSNV_thresh5 <- which(VHLx1prLD2[,VHLx1p_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1prLD2[,'pre_freq']))>=0.00001)
VHLx1prLD2_pSNV_thresh5_df = VHLx1prLD2[VHLx1prLD2_pSNV_thresh5,]
VHLx1prLD2_pSNV_thresh5_lib_count = length(VHLx1prLD2_pSNV_thresh5_df$lib)
VHLx1prLD2_pSNV_thresh5_lib_count
VHLx1prLD2_pSNV_thresh5_min_lib_counts = min(VHLx1prLD2_pSNV_thresh5_df$lib)
VHLx1prLD2_pSNV_thresh5_min_lib_counts
VHLx1prLD2_pSNV_thresh5_max_lib_counts = max(VHLx1prLD2_pSNV_thresh5_df$lib)
VHLx1prLD2_pSNV_thresh5_max_lib_counts
VHLx1prLD2_pSNV_thresh5_pre_count = length(VHLx1prLD2_pSNV_thresh5_df$pre)
VHLx1prLD2_pSNV_thresh5_pre_count
VHLx1prLD2_pSNV_thresh5_min_pre_counts = min(VHLx1prLD2_pSNV_thresh5_df$pre)
VHLx1prLD2_pSNV_thresh5_min_pre_counts
VHLx1prLD2_pSNV_thresh5_max_pre_counts = max(VHLx1prLD2_pSNV_thresh5_df$pre)
VHLx1prLD2_pSNV_thresh5_max_pre_counts
VHLx1prLD2_pSNV_thresh5_post_count = length(VHLx1prLD2_pSNV_thresh5_df$post)
VHLx1prLD2_pSNV_thresh5_post_count
VHLx1prLD2_pSNV_thresh5_min_post_counts = min(VHLx1prLD2_pSNV_thresh5_df$post)
VHLx1prLD2_pSNV_thresh5_min_post_counts
VHLx1prLD2_pSNV_thresh5_max_post_counts = max(VHLx1prLD2_pSNV_thresh5_df$post)
VHLx1prLD2_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx1prLD1_prog_var_thresh5_df:
VHLx1prLD1_prog_var_thresh5_df_rLD2_int <- VHLx1prLD1_prog_var_thresh5_df[which(VHLx1prLD1_prog_var_thresh5_df$variant %in% VHLx1prLD2_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx1prLD2_prog_var_thresh5_df:
VHLx1prLD2_prog_var_thresh5_df_rLD1_int <- VHLx1prLD2_prog_var_thresh5_df[which(VHLx1prLD2_prog_var_thresh5_df$variant %in% VHLx1prLD1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int[order(VHLx1prLD1_prog_var_thresh5_df_rLD2_int$variant),]
VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int[order(VHLx1prLD2_prog_var_thresh5_df_rLD1_int$variant),]
dim(VHLx1prLD1_prog_var_thresh5_df)[1] #Number of prog_vars in rLD1
VHLx1prLD1rLD2int_prog_var_thresh5_pre_count <- dim(VHLx1prLD1_prog_var_thresh5_df_rLD2_int)[1] 
VHLx1prLD1rLD2int_prog_var_thresh5_pre_count #Number of prog_vars in rLD1 also in rLD2
dim(VHLx1prLD2_prog_var_thresh5_df)[1] #Number of prog_vars in rLD2
dim(VHLx1prLD2_prog_var_thresh5_df_rLD1_int)[1] #Number of prog_vars in rLD2 also in rLD1

#Add the following columns from the from rLD2 df to the rLD1 df:
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$pre
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_lib <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$lib
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$rna
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2 <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post2
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3 <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post3
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2 <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$rna2
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$pre_pseudo
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post_pseudo
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pseudo <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pseudo
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pseudo <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pseudo
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pseudo <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pseudo
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_pseudo <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_pseudo
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$pre_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$rna_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post2_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post3_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$pre_pseudo_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post_pseudo_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pseudo_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pseudo_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pseudo_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pseudo_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pseudo_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pseudo_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_pseudo_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_pseudo_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$pre_lib_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post_pre_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post_lib_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_pre_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$rna_pre_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna_post_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$rna_post_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post2_pre_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pre_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post3_pre_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$rna2_post_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_snv_error_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$pre_snv_error_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_snv_error_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$post_snv_error_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_exp_snv_error_reads_pre <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$exp_snv_error_reads_pre
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_exp_snv_error_reads_post <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$exp_snv_error_reads_post
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pre <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pre
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_post <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$corr_post
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pre_pseudo <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pre_pseudo
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_post_pseudo <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$corr_post_pseudo
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_corr_pseudo_post_pre_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$corr_pseudo_post_pre_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_lib <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_lib
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2 <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3 <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2 <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre_pseudo_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pseudo_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_pseudo_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pseudo_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_pseudo_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pseudo_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2_pseudo_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pseudo_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3_pseudo_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_pseudo_freq <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2_pseudo_freq
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_pre_lib_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_pre_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post_lib_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_pre_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna_post_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post2_pre_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pre_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_post3_pre_ratio
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio <- VHLx1prLD2_prog_var_thresh5_df_rLD1_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio) + log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio))/2)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio) + log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio))/2)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio) + log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio))/2)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio) + log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio))/2)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post3_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post3_pre_ratio) + log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post3_pre_ratio))/2)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rna2_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rna2_post_ratio) + log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio))/2)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio) + log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio))/2)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio) + log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio))/2)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio) + log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio))/2)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio) + log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio))/2)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio) + log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio))/2)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio) + log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio))/2)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post3_pre_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post3_pre_ratio) + log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post3_pre_ratio))/2)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean <- 2^((log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio) + log2(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_pre_weighted <- ((VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq*VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq/(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq))+(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq*VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq/(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)))/VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq
#rLD1 pre-freq weighting coefficient (rLD1_pre-freq / (rLD1 + rLD2 pre-freq's))
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq/(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq/(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq+VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)
#this will be weighted by denominator:  (rLD1_pof/rLD1_prf)(rLD1_prwc)+(rLD2_pof/rLD2_prf)*(rLD2_prwc)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted <- (VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_pseudo_freq/VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_pseudo_freq)*(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight)+(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq/VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_pseudo_freq)*(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight)
#this will be weighted by denominator:  (rLD1_pof/lif')*(rLD1_prwc)+(rLD2_pof/lif)*(rLD2_prwc)
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_pre_weighted <- (VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_pseudo_freq/VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq)*(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_weight)+(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pseudo_freq/VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$lib_pseudo_freq)*(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_weight)
#rLD1 tHDR_pre-freq weighting coefficient (rLD1_tHDR_pre-freq / (rLD1 + rLD2 pre-freq's))
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_weight <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq/(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq+VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)
#rLD2 tHDR_pre-freq weighting coefficient
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_weight <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq/(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq+VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rLD1_pof/rLD1_prf)(rLD1_prwc)+(rLD2_pof/rLD2_prf)*(rLD2_prwc)
#tHDR_post_pre_ratio_rLD1rLD2_pre_weighted
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted <- (VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pseudo_freq/VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_pseudo_freq)*(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_weight)+(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pseudo_freq/VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_pseudo_freq)*(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq)) >= 10) {
    VHLx1prLD1_cSNV_pre_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx1prLD1_cSNV_post_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx1prLD1_cSNV_post2_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx1prLD1_cSNV_post_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx1prLD1_tSNV_pre_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx1prLD1_tSNV_post_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx1prLD1_tSNV_post_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx1prLD1_tSNV_rna_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx1prLD1_tSNV_rna_post_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx1prLD1_tSNV_rna2_post_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx1prLD2_cSNV_pre_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_pre_lib_ratio)
VHLx1prLD2_cSNV_post_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post_pre_ratio)
VHLx1prLD2_cSNV_post2_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post2_pre_ratio)

VHLx1prLD2_cSNV_post_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_post_lib_ratio)
VHLx1prLD2_tSNV_pre_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_pre_lib_ratio)
VHLx1prLD2_tSNV_post_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post_pre_ratio)
VHLx1prLD2_tSNV_post2_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post2_pre_ratio)
VHLx1prLD2_tSNV_post_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_post_lib_ratio)
VHLx1prLD2_tSNV_rna_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna_pre_ratio)
VHLx1prLD2_tSNV_rna_post_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna_post_ratio)
VHLx1prLD2_tSNV_rna2_post_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$rLD2_tHDR_rna2_post_ratio)
VHLx1prLD1rLD2a_cSNV_pre_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_cSNV_post_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_cSNV_post2_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_cSNV_post_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_tSNV_pre_lib_med <- 
  median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_tSNV_post_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_tSNV_post2_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_tSNV_post_lib_med <-
  median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_tSNV_rna_pre_med <-
  median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_tSNV_rna_post_med <-
  median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_tSNV_rna2_post_med <-
  median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2pw_tSNV_post_pre_med  <-
  median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted)
VHLx1prLD1rLD2pw_cSNV_post_pre_med  <-
  median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLD1rLD2_pre_weighted)
  } else {
  VHLx1prLD1_cSNV_pre_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio)
VHLx1prLD1_cSNV_post_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio)
VHLx1prLD1_cSNV_post2_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio)
VHLx1prLD1_cSNV_post_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio)
VHLx1prLD1_tSNV_pre_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio)
VHLx1prLD1_tSNV_post_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio)
VHLx1prLD1_tSNV_post_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio)
VHLx1prLD1_tSNV_rna_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio)
VHLx1prLD1_tSNV_rna_post_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio)
VHLx1prLD1_tSNV_rna2_post_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio)
VHLx1prLD2_cSNV_pre_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio)
VHLx1prLD2_cSNV_post_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio)
VHLx1prLD2_cSNV_post2_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio)

VHLx1prLD2_cSNV_post_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio)
VHLx1prLD2_tSNV_pre_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio)
VHLx1prLD2_tSNV_post_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio)
VHLx1prLD2_tSNV_post2_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio)
VHLx1prLD2_tSNV_post_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio)
VHLx1prLD2_tSNV_rna_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio)
VHLx1prLD2_tSNV_rna_post_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio)
VHLx1prLD2_tSNV_rna2_post_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio)
VHLx1prLD1rLD2a_cSNV_pre_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_cSNV_post_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_cSNV_post2_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_cSNV_post_lib_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_tSNV_pre_lib_med <- 
  median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_tSNV_post_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_tSNV_post2_pre_med <- median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_tSNV_post_lib_med <-
  median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_tSNV_rna_pre_med <-
  median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_tSNV_rna_post_med <-
  median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2a_tSNV_rna2_post_med <-
  median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean)
VHLx1prLD1rLD2pw_tSNV_post_pre_med  <-
  median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted)
VHLx1prLD1rLD2pw_cSNV_post_pre_med  <-
  median(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted)
}

VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio/VHLx1prLD1_cSNV_pre_lib_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio/VHLx1prLD1_cSNV_post_pre_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio/VHLx1prLD1_cSNV_post_lib_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post2_pre_ratio/VHLx1prLD1_cSNV_post2_pre_med

VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio/VHLx1prLD1_tSNV_pre_lib_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio/VHLx1prLD1_tSNV_post_pre_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio/VHLx1prLD1_tSNV_post_lib_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio/VHLx1prLD1_tSNV_rna_pre_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio/VHLx1prLD1_tSNV_rna_post_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio/VHLx1prLD2_tSNV_post2_pre_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio/VHLx1prLD1_tSNV_rna2_post_med

VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_pre_lib_ratio/VHLx1prLD2_cSNV_pre_lib_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_pre_ratio/VHLx1prLD2_cSNV_post_pre_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post_lib_ratio/VHLx1prLD2_cSNV_post_lib_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_post2_pre_ratio/VHLx1prLD1rLD2a_cSNV_post2_pre_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_rna2_post_ratio/VHLx1prLD2_tSNV_rna2_post_med


VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_pre_lib_ratio/VHLx1prLD2_tSNV_pre_lib_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_pre_ratio/VHLx1prLD2_tSNV_post_pre_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post2_pre_ratio/VHLx1prLD2_tSNV_post2_pre_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_post_lib_ratio/VHLx1prLD2_tSNV_post_lib_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_pre_ratio/VHLx1prLD2_tSNV_rna_pre_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna_post_ratio/VHLx1prLD2_tSNV_rna_post_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$rLD2_tHDR_rna2_post_ratio/VHLx1prLD2_tSNV_rna2_post_med

###normalize the means
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$pre_lib_ratio_rLD1rLD2_mean/VHLx1prLD1rLD2a_cSNV_pre_lib_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_mean/VHLx1prLD1rLD2a_cSNV_post_pre_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_lib_ratio_rLD1rLD2_mean/VHLx1prLD1rLD2a_cSNV_post_lib_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_pre_lib_ratio_rLD1rLD2_mean/VHLx1prLD1rLD2a_tSNV_pre_lib_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_mean/VHLx1prLD1rLD2a_tSNV_post_pre_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post2_pre_ratio_rLD1rLD2_mean/VHLx1prLD1rLD2a_tSNV_post2_pre_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_lib_ratio_rLD1rLD2_mean/VHLx1prLD1rLD2a_tSNV_post_lib_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_pre_ratio_rLD1rLD2_mean/VHLx1prLD1rLD2a_tSNV_rna_pre_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna_post_ratio_rLD1rLD2_mean/VHLx1prLD1rLD2a_tSNV_rna_post_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_rna2_post_ratio_rLD1rLD2_mean/VHLx1prLD1rLD2a_tSNV_rna2_post_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted/VHLx1prLD1rLD2pw_tSNV_post_pre_med
VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm <- VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord$post_pre_ratio_rLD1rLD2_pre_weighted/VHLx1prLD1rLD2pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord
VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord = which(VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[,'pos']!='REF')
VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df = VHLx1prLD1_prog_var_thresh5_df_rLD2_int_ord[VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord,]
VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord = which(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'cDNApos']!='REF' & VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'cDNApos']!='NA')
VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df = VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df[VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord,]
VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord = which(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df[,'CADD.phred']!='NA')
VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df = VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df[VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord,]
VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense <- VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df[which(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx1prLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s
VHLx1prLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_p <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='pearson')
VHLx1prLD1rLD2_cSNV_rLD1_post_pre_by_rLD2_post_pre_cor_p
VHLx1prLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s
VHLx1prLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_p <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='pearson')
VHLx1prLD1rLD2_cSNV_rLD1_post_lib_by_rLD2_post_lib_cor_p
VHLx1prLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post2_pre_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s
VHLx1prLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_p <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post2_pre_ratio_synnorm),method='pearson')
VHLx1prLD1rLD2_cSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_p
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_s <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_s
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_p <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_post_pre_by_rLD2_tHDR_post_pre_cor_p
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_s <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_s
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_p <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_post_lib_by_rLD2_tHDR_post_lib_cor_p
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_s <- cor(log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_s
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_p <- cor(log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_rna_pre_by_rLD2_tHDR_rna_pre_cor_p
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_s <- cor(log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_s
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_p <- cor(log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx1prLD1rLD2_tSNV_rLD1_tHDR_rna2_post_by_rLD2_tHDR_rna2_post_cor_p
VHLx1prLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_s <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_freq),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_freq),method='spearman')
VHLx1prLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_s
VHLx1prLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_p <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pseudo_freq),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pseudo_freq),method='pearson')
VHLx1prLD1rLD2_cSNV_rLD1_post_by_rLD2_post_cor_p
VHLx1prLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_s <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_s
VHLx1prLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_p <-cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio_synnorm),method='pearson')
VHLx1prLD1rLD2_cSNV_rLD1_pre_lib_by_rLD2_pre_lib_cor_p
VHLx1prLD1rLD2_tSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_tSNV_rLD1_post2_pre_by_rLD2_post2_pre_cor_s
VHLx1prLD1rLD2_tSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_tSNV_rLD1_post_lib_by_rLD2_post_lib_cor_s
VHLx1prLD1rLD2_tSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_tSNV_rLD1_post_pre_by_rLD2_post_pre_cor_s
VHLx1prLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s
VHLx1prLD1rLD2_tSNV_rLD1_rna2_post_by_rLD2_rna2_post_cor_s <- cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_tSNV_rLD1_rna2_post_by_rLD2_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx1prLD1_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1_cSNV_post_pre_by_cadd_cor_s
VHLx1prLD2_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD2_cSNV_post_pre_by_cadd_cor_s
VHLx1prLD1_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1_cSNV_post_lib_by_cadd_cor_s
VHLx1prLD2_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD2_cSNV_post_lib_by_cadd_cor_s
VHLx1prLD1_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1_tSNV_post_pre_by_cadd_cor_s
VHLx1prLD2_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD2_tSNV_post_pre_by_cadd_cor_s
VHLx1prLD1_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1_tSNV_post_lib_by_cadd_cor_s
VHLx1prLD2_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx1prLD1rLD2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2a_cSNV_pre_lib_by_cadd_cor_s
VHLx1prLD1rLD2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2w_cSNV_pre_lib_by_cadd_cor_s
VHLx1prLD1rLD2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2a_cSNV_post_pre_by_cadd_cor_s
VHLx1prLD1rLD2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2w_cSNV_post_pre_by_cadd_cor_s
VHLx1prLD1rLD2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2a_cSNV_post_lib_by_cadd_cor_s
VHLx1prLD1rLD2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2w_cSNV_post_lib_by_cadd_cor_s
VHLx1prLD1rLD2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2a_tSNV_pre_lib_by_cadd_cor_s
VHLx1prLD1rLD2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2a_tSNV_post_pre_by_cadd_cor_s
VHLx1prLD1rLD2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2w_tSNV_post_pre_by_cadd_cor_s
VHLx1prLD1rLD2a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post2_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2a_tSNV_post2_pre_by_cadd_cor_s
VHLx1prLD1rLD2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx1prLD1_cSNV_pre_lib_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1prLD1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1prLD1_tSNV_pre_lib_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1prLD1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1prLD1_cSNV_post_lib_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1prLD1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1prLD1_tSNV_post_lib_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1prLD1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1prLD1_cSNV_post_pre_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1prLD1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1prLD1_tSNV_post_pre_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1prLD1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1prLD1_cSNV_rna_lib_cors = cor(log2(VHLx1prLD1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1prLD1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1prLD1_tSNV_rna_lib_cors = cor(log2(VHLx1prLD1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1prLD1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1prLD1_cSNV_rna_pre_cors = cor(log2(VHLx1prLD1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1prLD1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1prLD1_tSNV_rna_pre_cors = cor(log2(VHLx1prLD1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1prLD1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1prLD1rLD2_cSNV_pre_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_freq),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_freq),method='spearman')
VHLx1prLD1rLD2_tSNV_pre_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_pseudo_freq),method='spearman')
VHLx1prLD1rLD2_cSNV_pre_lib_ratio_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$pre_lib_ratio),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_pre_lib_ratio),method='spearman')
VHLx1prLD1rLD2_tSNV_pre_lib_ratio_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio),method='spearman')
VHLx1prLD1rLD2_cSNV_post_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_freq),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_freq),method='spearman')
VHLx1prLD1rLD2_tSNV_post_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pseudo_freq),method='spearman')
VHLx1prLD1rLD2_cSNV_post_lib_ratio_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_lib_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_tSNV_post_lib_ratio_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_cSNV_post_pre_ratio_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_post_pre_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_tSNV_post_pre_ratio_cors = cor(log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_cSNV_rna_cors = cor(log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rna_freq),log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_rna_freq),method='spearman')
VHLx1prLD1rLD2_tSNV_rna_cors = cor(log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pseudo_freq),method='spearman')
VHLx1prLD1rLD2_tSNV_rna_pre_ratio_cors = cor(log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1prLD1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prLD1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prLD1_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prLD1_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prLD1_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prLD1_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prLD1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1prLD1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1prLD1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1prLD1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1prLD1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1prLD1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1prLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1prLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1prLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1prLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1prLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1prLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1prLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$pre_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_lib_ratio_rLD1rLD2_pre_weighted),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')
VHLx1prLD1rLD2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_pre_weighted_synnorm),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df$CADD.phred)),method='spearman')

VHLx1prLD1_cors <- c("VHLx1prLD1",VHLx1prLD1_cSNV_pre_lib_cors,VHLx1prLD1_tSNV_pre_lib_cors,VHLx1prLD1_cSNV_post_lib_cors,VHLx1prLD1_tSNV_post_lib_cors,VHLx1prLD1_cSNV_post_pre_cors,VHLx1prLD1_tSNV_post_pre_cors,VHLx1prLD1_cSNV_rna_lib_cors,VHLx1prLD1_tSNV_rna_lib_cors,VHLx1prLD1_cSNV_rna_pre_cors,VHLx1prLD1_tSNV_rna_pre_cors,VHLx1prLD1rLD2_cSNV_pre_cors,VHLx1prLD1rLD2_tSNV_pre_cors,VHLx1prLD1rLD2_cSNV_pre_lib_ratio_cors,VHLx1prLD1rLD2_tSNV_pre_lib_ratio_cors,VHLx1prLD1rLD2_cSNV_post_cors,VHLx1prLD1rLD2_tSNV_post_cors,VHLx1prLD1rLD2_cSNV_post_lib_ratio_cors,VHLx1prLD1rLD2_tSNV_post_lib_ratio_cors,VHLx1prLD1rLD2_cSNV_post_pre_ratio_cors,VHLx1prLD1rLD2_tSNV_post_pre_ratio_cors,VHLx1prLD1rLD2_cSNV_rna_cors,VHLx1prLD1rLD2_tSNV_rna_cors,VHLx1prLD1rLD2_tSNV_rna_pre_ratio_cors,VHLx1prLD1_cSNV_pre_lib_ratio_cadd_cors,VHLx1prLD1_tSNV_pre_lib_ratio_cadd_cors,VHLx1prLD1_cSNV_post_lib_ratio_cadd_cors,VHLx1prLD1_tSNV_post_lib_ratio_cadd_cors,VHLx1prLD1_cSNV_post_pre_ratio_cadd_cors,VHLx1prLD1_tSNV_post_pre_ratio_cadd_cors,VHLx1prLD1_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1prLD1_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1prLD1_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prLD1_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prLD1_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1prLD1_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1prLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors,VHLx1prLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors,VHLx1prLD1rLD2a_cSNV_post_lib_ratio_cadd_cors,VHLx1prLD1rLD2a_tSNV_post_lib_ratio_cadd_cors,VHLx1prLD1rLD2a_cSNV_post_pre_ratio_cadd_cors,VHLx1prLD1rLD2a_tSNV_post_pre_ratio_cadd_cors,VHLx1prLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1prLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1prLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1prLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1prLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors,VHLx1prLD1rLD2w_cSNV_post_lib_ratio_cadd_cors,VHLx1prLD1rLD2w_cSNV_post_pre_ratio_cadd_cors,VHLx1prLD1rLD2w_tSNV_post_pre_ratio_cadd_cors)

VHLx1prLD2_cSNV_pre_lib_cors = cor(log2(VHLx1prLD2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1prLD2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1prLD2_tSNV_pre_lib_cors = cor(log2(VHLx1prLD2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1prLD2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1prLD2_cSNV_post_lib_cors = cor(log2(VHLx1prLD2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1prLD2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1prLD2_tSNV_post_lib_cors = cor(log2(VHLx1prLD2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1prLD2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1prLD2_cSNV_post_pre_cors = cor(log2(VHLx1prLD2_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1prLD2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1prLD2_tSNV_post_pre_cors = cor(log2(VHLx1prLD2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1prLD2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1prLD2_cSNV_rna_lib_cors = cor(log2(VHLx1prLD2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1prLD2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1prLD2_tSNV_rna_lib_cors = cor(log2(VHLx1prLD2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1prLD2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1prLD2_cSNV_rna_pre_cors = cor(log2(VHLx1prLD2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1prLD2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1prLD2_tSNV_rna_pre_cors = cor(log2(VHLx1prLD2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1prLD2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1prLD2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1prLD2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1prLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prLD2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1prLD2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1prLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prLD2_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1prLD2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1prLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prLD2_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1prLD2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1prLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prLD2_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prLD2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1prLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prLD2_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prLD2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prLD2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prLD2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1prLD2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1prLD2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1prLD2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1prLD2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_post_pre_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')
VHLx1prLD2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$rLD2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prLD1_prog_map_CADD_thresh5_df_rLD2_int_ord_df_missense$Grantham)),method='spearman')

VHLx1prLD2_cors <- c("VHLx1prLD2",VHLx1prLD2_cSNV_pre_lib_cors,VHLx1prLD2_tSNV_pre_lib_cors,VHLx1prLD2_cSNV_post_lib_cors,VHLx1prLD2_tSNV_post_lib_cors,VHLx1prLD2_cSNV_post_pre_cors,VHLx1prLD2_tSNV_post_pre_cors,VHLx1prLD2_cSNV_rna_lib_cors,VHLx1prLD2_tSNV_rna_lib_cors,VHLx1prLD2_cSNV_rna_pre_cors,VHLx1prLD2_tSNV_rna_pre_cors,VHLx1prLD1rLD2_cSNV_pre_cors,VHLx1prLD1rLD2_tSNV_pre_cors,VHLx1prLD1rLD2_cSNV_pre_lib_ratio_cors,VHLx1prLD1rLD2_tSNV_pre_lib_ratio_cors,VHLx1prLD1rLD2_cSNV_post_cors,VHLx1prLD1rLD2_tSNV_post_cors,VHLx1prLD1rLD2_cSNV_post_lib_ratio_cors,VHLx1prLD1rLD2_tSNV_post_lib_ratio_cors,VHLx1prLD1rLD2_cSNV_post_pre_ratio_cors,VHLx1prLD1rLD2_tSNV_post_pre_ratio_cors,VHLx1prLD1rLD2_cSNV_rna_cors,VHLx1prLD1rLD2_tSNV_rna_cors,VHLx1prLD1rLD2_tSNV_rna_pre_ratio_cors,VHLx1prLD2_cSNV_pre_lib_ratio_cadd_cors,VHLx1prLD2_tSNV_pre_lib_ratio_cadd_cors,VHLx1prLD2_cSNV_post_lib_ratio_cadd_cors,VHLx1prLD2_tSNV_post_lib_ratio_cadd_cors,VHLx1prLD2_cSNV_post_pre_ratio_cadd_cors,VHLx1prLD2_tSNV_post_pre_ratio_cadd_cors,VHLx1prLD2_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1prLD2_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1prLD2_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prLD2_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prLD2_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1prLD2_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1prLD1rLD2a_cSNV_pre_lib_ratio_cadd_cors,VHLx1prLD1rLD2a_tSNV_pre_lib_ratio_cadd_cors,VHLx1prLD1rLD2a_cSNV_post_lib_ratio_cadd_cors,VHLx1prLD1rLD2a_tSNV_post_lib_ratio_cadd_cors,VHLx1prLD1rLD2a_cSNV_post_pre_ratio_cadd_cors,VHLx1prLD1rLD2a_tSNV_post_pre_ratio_cadd_cors,VHLx1prLD1rLD2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1prLD1rLD2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1prLD1rLD2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prLD1rLD2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prLD1rLD2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1prLD1rLD2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1prLD1rLD2w_cSNV_pre_lib_ratio_cadd_cors,VHLx1prLD1rLD2w_cSNV_post_lib_ratio_cadd_cors,VHLx1prLD1rLD2w_cSNV_post_pre_ratio_cadd_cors,VHLx1prLD1rLD2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx1prLD1)
rm(VHLx1prLD2)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx1prLD1
VHLx1p_posrange <- range(as.numeric(as.character(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$pos)))
VHLx1p_posseq <- seq(from=VHLx1p_posrange[1], to=VHLx1p_posrange[2])
VHLx1prLD1_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1prLD1_tHDR_pre_lib_pred <- predict(VHLx1prLD1_tHDR_pre_lib_ratio.lo, newdata = VHLx1p_posseq, se=TRUE)
VHLx1prLD1_tHDR_pre_lib_pos_effects <- VHLx1prLD1_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1prLD1_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1prLD1_tHDR_pre_lib_pos_effects)
VHLx1prLD1_tHDR_pre_lib_pos_effects_ci <- VHLx1prLD1_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1prLD1_tHDR_pre_lib_pred$df)
VHLx1prLD1_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1prLD1_tHDR_pre_lib_pos_effects - VHLx1prLD1_tHDR_pre_lib_pos_effects_ci
VHLx1prLD1_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1prLD1_tHDR_pre_lib_pos_effects + VHLx1prLD1_tHDR_pre_lib_pos_effects_ci
VHLx1prLD1_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1p_posseq, VHLx1prLD1_tHDR_pre_lib_pos_effects, VHLx1prLD1_tHDR_pre_lib_pos_effects.x, VHLx1prLD1_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1prLD1_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1prLD1_tHDR_pre_lib_pred_se = VHLx1prLD1_tHDR_pre_lib_pred$se.fit)
#VHLx1prLD2
VHLx1prLD2_tHDR_pre_lib_ratio.lo <- loess(log2(rLD2_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1prLD2_tHDR_pre_lib_pred <- predict(VHLx1prLD2_tHDR_pre_lib_ratio.lo, newdata = VHLx1p_posseq, se=TRUE)
VHLx1prLD2_tHDR_pre_lib_pos_effects <- VHLx1prLD2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1prLD2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1prLD2_tHDR_pre_lib_pos_effects)
VHLx1prLD2_tHDR_pre_lib_pos_effects_ci <- VHLx1prLD2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1prLD2_tHDR_pre_lib_pred$df)
VHLx1prLD2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1prLD2_tHDR_pre_lib_pos_effects - VHLx1prLD2_tHDR_pre_lib_pos_effects_ci
VHLx1prLD2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1prLD2_tHDR_pre_lib_pos_effects + VHLx1prLD2_tHDR_pre_lib_pos_effects_ci
VHLx1prLD2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1p_posseq, VHLx1prLD2_tHDR_pre_lib_pos_effects, VHLx1prLD2_tHDR_pre_lib_pos_effects.x, VHLx1prLD2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1prLD2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1prLD2_tHDR_pre_lib_pred_se = VHLx1prLD2_tHDR_pre_lib_pred$se.fit)

#VHLx1prLD1rLD2
VHLx1prLD1rLD2_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df, subset = which(VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_post_pre_ratio_rLD1rLD2_mean_synnorm > 0.7 & VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm > 0.3 & VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1prLD1rLD2_tHDR_pre_lib_pred <- predict(VHLx1prLD1rLD2_tHDR_pre_lib_ratio.lo, newdata = VHLx1p_posseq, se=TRUE)
VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects <- VHLx1prLD1rLD2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects)
VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects_ci <- VHLx1prLD1rLD2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1prLD1rLD2_tHDR_pre_lib_pred$df)
VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects - VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects_ci
VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects + VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects_ci
VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1p_posseq, VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects, VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects.x, VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1prLD1rLD2_tHDR_pre_lib_pred_se = VHLx1prLD1rLD2_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rLD1, rLD2, rLD1rLD2)
VHLx1prLD_tHDR_pos_merge_df <- VHLx1prLD1_prog_map_thresh5_df_rLD2_int_ord_df 
VHLx1prLD_tHDR_pos_merge_df <- merge(VHLx1prLD_tHDR_pos_merge_df, VHLx1prLD1_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx1prLD1_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1prLD_tHDR_pos_merge_df <- merge(VHLx1prLD_tHDR_pos_merge_df, VHLx1prLD2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1prLD2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1prLD_tHDR_pos_merge_df <- merge(VHLx1prLD_tHDR_pos_merge_df, VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx1prLD_tHDR_pos_merge_df <- VHLx1prLD_tHDR_pos_merge_df %>% 
  rename(
    rLD1_tHDR_pre_lib_pos_effects.x = VHLx1prLD1_tHDR_pre_lib_pos_effects.x,
    rLD2_tHDR_pre_lib_pos_effects.x = VHLx1prLD2_tHDR_pre_lib_pos_effects.x,
    rLD1rLD2_tHDR_pre_lib_pos_effects.x = VHLx1prLD1rLD2_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rLD1 vs. rLD1_fit and vs. mean_fit)
VHLx1prLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1 <- log2(VHLx1prLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1prLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_pos_effects.x
VHLx1prLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx1prLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1prLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1prLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2 <- log2(VHLx1prLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_ratio_synnorm) - VHLx1prLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_pos_effects.x
VHLx1prLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx1prLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_ratio_synnorm) - VHLx1prLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1prLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_post_lib_loess_rLD1rLD2 <- log2(VHLx1prLD_tHDR_pos_merge_df$tHDR_post_lib_ratio_rLD1rLD2_mean_synnorm) - VHLx1prLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx1prLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_loess_rLD1 <- log2(VHLx1prLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1prLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_pos_effects.x
VHLx1prLD_tHDR_pos_merge_df$rLD1_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx1prLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1prLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1prLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_loess_rLD2 <- log2(VHLx1prLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_ratio_synnorm) - VHLx1prLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_pos_effects.x
VHLx1prLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx1prLD_tHDR_pos_merge_df$rLD2_tHDR_pre_lib_ratio_synnorm) - VHLx1prLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x
VHLx1prLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_loess_rLD1rLD2 <- log2(VHLx1prLD_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rLD1rLD2_mean_synnorm) - VHLx1prLD_tHDR_pos_merge_df$rLD1rLD2_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rLD1 and rLD2 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx1prLD_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1prLD_tHDR_post_lib_loess_median_syn_rLD1 <- median(VHLx1prLD_tHDR_pos_merge_df[which(VHLx1prLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLD1_tHDR_post_lib_loess_rLD1')])
  VHLx1prLD_tHDR_post_lib_loess_median_syn_rLD2 <- median(VHLx1prLD_tHDR_pos_merge_df[which(VHLx1prLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLD2_tHDR_post_lib_loess_rLD2')])
  } else {
  VHLx1prLD_tHDR_post_lib_loess_median_syn_rLD1 <- median(VHLx1prLD_tHDR_pos_merge_df[which(VHLx1prLD_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLD1_tHDR_post_lib_loess_rLD1')])
  VHLx1prLD_tHDR_post_lib_loess_median_syn_rLD2 <- median(VHLx1prLD_tHDR_pos_merge_df[which(VHLx1prLD_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLD2_tHDR_post_lib_loess_rLD2')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rLD1 'e.sns' = exon syn/ns norm.
VHLx1prLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1_e.sns <- (VHLx1prLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1-VHLx1prLD_tHDR_post_lib_loess_median_syn_rLD1)
#calculate new b values for rLD2 'e.sns' = exon syn/ns norm.
VHLx1prLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2_e.sns <- (VHLx1prLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2-VHLx1prLD_tHDR_post_lib_loess_median_syn_rLD2)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx1prLD_tHDR_pos_merge_df$rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean <- (VHLx1prLD_tHDR_pos_merge_df$rLD1_tHDR_post_lib_loess_rLD1_e.sns+VHLx1prLD_tHDR_pos_merge_df$rLD2_tHDR_post_lib_loess_rLD2_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx1prLD_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1prLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_syn_median <- median(VHLx1prLD_tHDR_pos_merge_df[which(VHLx1prLD_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean')])
  } else {
  VHLx1prLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_syn_median <- median(VHLx1prLD_tHDR_pos_merge_df[which(VHLx1prLD_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('rLD_tHDR_post_lib_loess_e.sns_rLD1rLD2_mean')])
}

#RNA analysis
VHLx1prLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s <- cor(log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1prLD1rLD2_tSNV_rLD1_rna_pre_by_rLD2_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1_tHDR_rna2_rna_ratio <- VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna2_pseudo_freq/VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$tHDR_rna_pseudo_freq
VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_rna_ratio <- VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_pseudo_freq/VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna_pseudo_freq
VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1rLD2_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD1_tHDR_rna2_rna_ratio)+log2(VHLx1prLD1_prog_map_exon_thresh5_df_rLD2_int_ord_df$rLD2_tHDR_rna2_rna_ratio))/2

```

rL4 section, experiments performed without DAB

```{r}
#VHLx2rL4
VHLx2rL41_file <- paste(experiment_dir_210729,'VHLx2rL41','_annotated.txt',sep='')
VHLx2rL42_file <- paste(experiment_dir_210729,'VHLx2rL42','_annotated.txt',sep='')
VHLx2rL41 <- read.table(VHLx2rL41_file, header=TRUE, sep="\t")
VHLx2rL42 <- read.table(VHLx2rL42_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx2rL41 <- VHLx2rL41 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

VHLx2rL42 <- VHLx2rL42 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx2 <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx2'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx2_HDR_5_SNV = as.character(VHL_editing_info_VHLx2$HDR_5_SNV)
VHLx2_HDR_3_SNV = as.character(VHL_editing_info_VHLx2$HDR_3_SNV)
#VHLx2_cut_pos = as.character(VHL_editing_info_VHLx2$cut_pos)
VHLx2_cut_end = as.character(VHL_editing_info_VHLx2$cut_end)
VHLx2_mut_start = as.character(VHL_editing_info_VHLx2$mut_start)
VHLx2_mut_end = as.character(VHL_editing_info_VHLx2$mut_end)

### Replicate 1
VHLx2rL41_cSNV_all <- which(VHLx2rL41[,'c_hdr_snv']=='True')
VHLx2rL41_cSNV_all_df = VHLx2rL41[VHLx2rL41_cSNV_all,]
VHLx2rL41_prog_var_all <- which(VHLx2rL41[,'all_hdr_variant']=='True' & VHLx2rL41[,'edit_string']!='-WT')
VHLx2rL41_prog_var_all_df = VHLx2rL41[VHLx2rL41_prog_var_all,]
VHLx2rL41_prog_map_all = which(VHLx2rL41_prog_var_all_df[,'pos']!='REF')
VHLx2rL41_prog_map_all_df = VHLx2rL41_prog_var_all_df[VHLx2rL41_prog_map_all,]
VHLx2rL41_prog_map_exon_all = which(VHLx2rL41_prog_map_all_df[,'cDNApos']!='REF' & VHLx2rL41_prog_map_all_df[,'cDNApos']!='NA')
VHLx2rL41_prog_map_exon_all_df = VHLx2rL41_prog_map_all_df[VHLx2rL41_prog_map_exon_all,]
VHLx2rL41_prog_map_CADD = which(VHLx2rL41_prog_map_all_df[,'CADD.phred']!='NA')
VHLx2rL41_prog_map_CADD_df = VHLx2rL41_prog_map_all_df[VHLx2rL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx2rL41_prog_var_thresh5 <- which(as.numeric(as.character(VHLx2rL41_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx2rL41_prog_var_thresh5_df = VHLx2rL41_prog_var_all_df[VHLx2rL41_prog_var_thresh5,]
VHLx2rL41_prog_map_thresh5 <- which(as.numeric(as.character(VHLx2rL41_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx2rL41_prog_map_thresh5_df = VHLx2rL41_prog_map_all_df[VHLx2rL41_prog_map_thresh5,]
VHLx2rL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx2rL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx2rL41_prog_map_exon_thresh5_df = VHLx2rL41_prog_map_exon_all_df[VHLx2rL41_prog_map_exon_thresh5,]
VHLx2rL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx2rL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx2rL41_prog_map_CADD_thresh5_df = VHLx2rL41_prog_map_CADD_df[VHLx2rL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx2rL41_prog_var_all_lib_count = length(VHLx2rL41_prog_var_all_df$lib)
VHLx2rL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx2rL41_prog_var_all_min_lib_counts = min(VHLx2rL41_prog_var_all_df$lib)
VHLx2rL41_prog_var_all_min_lib_counts
VHLx2rL41_prog_var_all_max_lib_counts = max(VHLx2rL41_prog_var_all_df$lib)
VHLx2rL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx2rL41_prog_map_all_lib_count = length(VHLx2rL41_prog_map_all_df$lib)
VHLx2rL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx2rL41_prog_map_all_min_lib_counts = min(VHLx2rL41_prog_map_all_df$lib)
VHLx2rL41_prog_map_all_min_lib_counts
VHLx2rL41_prog_map_all_max_lib_counts = max(VHLx2rL41_prog_map_all_df$lib)
VHLx2rL41_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx2rL41_prog_var_all_pre_count = length(VHLx2rL41_prog_var_all_df$pre)
VHLx2rL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx2rL41_prog_var_all_min_pre_counts = min(VHLx2rL41_prog_var_all_df$pre)
VHLx2rL41_prog_var_all_min_pre_counts
VHLx2rL41_prog_var_all_max_pre_counts = max(VHLx2rL41_prog_var_all_df$pre)
VHLx2rL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx2rL41_prog_map_all_pre_count = length(VHLx2rL41_prog_map_all_df$pre)
VHLx2rL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx2rL41_prog_map_all_min_pre_counts = min(VHLx2rL41_prog_map_all_df$pre)
VHLx2rL41_prog_map_all_min_pre_counts
VHLx2rL41_prog_map_all_max_pre_counts = max(VHLx2rL41_prog_map_all_df$pre)
VHLx2rL41_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx2rL41_prog_map_all_post_count = length(VHLx2rL41_prog_map_all_df$post)
VHLx2rL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx2rL41_prog_map_all_min_post_counts = min(VHLx2rL41_prog_map_all_df$post)
VHLx2rL41_prog_map_all_min_post_counts
VHLx2rL41_prog_map_all_max_post_counts = max(VHLx2rL41_prog_map_all_df$post)
VHLx2rL41_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx2rL41_prog_map_all_syn_df <- VHLx2rL41_prog_map_all_df[which(VHLx2rL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx2rL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx2rL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx2rL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx2rL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx2rL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx2rL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx2rL41_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx2rL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx2rL41_prog_map_all_min_rna_counts = min(VHLx2rL41_prog_map_exon_all_df$tHDR_rna)
VHLx2rL41_prog_map_all_min_rna_counts
VHLx2rL41_prog_map_all_max_rna_counts = max(VHLx2rL41_prog_map_exon_all_df$tHDR_rna)
VHLx2rL41_prog_map_all_max_rna_counts
VHLx2rL41_prog_map_all_min_rna_pseudo_freq = min(VHLx2rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx2rL41_prog_map_all_min_rna_pseudo_freq
VHLx2rL41_prog_map_all_max_rna_pseudo_freq = max(VHLx2rL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx2rL41_prog_map_all_max_rna_pseudo_freq
VHLx2rL41_prog_map_all_min_rna_pre_ratio = min(VHLx2rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx2rL41_prog_map_all_min_rna_pre_ratio
VHLx2rL41_prog_map_all_max_rna_pre_ratio = max(VHLx2rL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx2rL41_prog_map_all_max_rna_pre_ratio
VHLx2rL41_prog_map_all_min_rna_post_ratio = min(VHLx2rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx2rL41_prog_map_all_min_rna_post_ratio
VHLx2rL41_prog_map_all_max_rna_post_ratio = max(VHLx2rL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx2rL41_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx2rL41_cSNV_all_corr_pre_count = length(VHLx2rL41_cSNV_all_df$corr_pre)
VHLx2rL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx2rL41_cSNV_all_min_corr_pre_counts = min(VHLx2rL41_cSNV_all_df$corr_pre)
VHLx2rL41_cSNV_all_min_corr_pre_counts
VHLx2rL41_cSNV_all_max_corr_pre_counts = max(VHLx2rL41_cSNV_all_df$corr_pre)
VHLx2rL41_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rL41_cSNV_all_corr_post_count = length(VHLx2rL41_cSNV_all_df$corr_post)
VHLx2rL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx2rL41_cSNV_all_min_corr_post_counts = min(VHLx2rL41_cSNV_all_df$corr_post)
VHLx2rL41_cSNV_all_min_corr_post_counts
VHLx2rL41_cSNV_all_max_corr_post_counts = max(VHLx2rL41_cSNV_all_df$corr_post)
VHLx2rL41_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx2_p_hdr_snv = paste('p_hdr_',VHLx2_cut_end,'_snv',sep='')
VHLx2rL41_pSNV_all <- which(VHLx2rL41[,VHLx2_p_hdr_snv]=='True')
VHLx2rL41_pSNV_all_df = VHLx2rL41[VHLx2rL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rL41_pSNV_all_lib_count = length(VHLx2rL41_pSNV_all_df$lib)
VHLx2rL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx2rL41_pSNV_all_min_lib_counts = min(VHLx2rL41_pSNV_all_df$lib)
VHLx2rL41_pSNV_all_min_lib_counts
VHLx2rL41_pSNV_all_max_lib_counts = max(VHLx2rL41_pSNV_all_df$lib)
VHLx2rL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx2rL41_pSNV_all_pre_count = length(VHLx2rL41_pSNV_all_df$pre)
VHLx2rL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx2rL41_pSNV_all_min_pre_counts = min(VHLx2rL41_pSNV_all_df$pre)
VHLx2rL41_pSNV_all_min_pre_counts
VHLx2rL41_pSNV_all_max_pre_counts = max(VHLx2rL41_pSNV_all_df$pre)
VHLx2rL41_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rL41_pSNV_all_post_count = length(VHLx2rL41_pSNV_all_df$post)
VHLx2rL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx2rL41_pSNV_all_min_post_counts = min(VHLx2rL41_pSNV_all_df$post)
VHLx2rL41_pSNV_all_min_post_counts
VHLx2rL41_pSNV_all_max_post_counts = max(VHLx2rL41_pSNV_all_df$post)
VHLx2rL41_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rL41_prog_map_thresh5_lib_count = length(VHLx2rL41_prog_map_thresh5_df$lib)
VHLx2rL41_prog_map_thresh5_lib_count
VHLx2rL41_prog_map_thresh5_min_lib_counts = min(VHLx2rL41_prog_map_thresh5_df$lib)
VHLx2rL41_prog_map_thresh5_min_lib_counts
VHLx2rL41_prog_map_thresh5_max_lib_counts = max(VHLx2rL41_prog_map_thresh5_df$lib)
VHLx2rL41_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rL41_prog_map_thresh5_pre_count = length(VHLx2rL41_prog_map_thresh5_df$pre)
VHLx2rL41_prog_map_thresh5_pre_count
VHLx2rL41_prog_map_thresh5_min_pre_counts = min(VHLx2rL41_prog_map_thresh5_df$pre)
VHLx2rL41_prog_map_thresh5_min_pre_counts
VHLx2rL41_prog_map_thresh5_max_pre_counts = max(VHLx2rL41_prog_map_thresh5_df$pre)
VHLx2rL41_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx2rL41_prog_map_thresh5_post_count = length(VHLx2rL41_prog_map_thresh5_df$post)
VHLx2rL41_prog_map_thresh5_post_count
VHLx2rL41_prog_map_thresh5_min_post_counts = min(VHLx2rL41_prog_map_thresh5_df$post)
VHLx2rL41_prog_map_thresh5_min_post_counts
VHLx2rL41_prog_map_thresh5_max_post_counts = max(VHLx2rL41_prog_map_thresh5_df$post)
VHLx2rL41_prog_map_thresh5_max_post_counts
VHLx2rL41_prog_map_thresh5_corr_post_count = length(VHLx2rL41_cSNV_all_df$corr_post)
VHLx2rL41_prog_map_thresh5_corr_post_count
VHLx2rL41_prog_map_thresh5_min_corr_post_counts = min(VHLx2rL41_cSNV_all_df$corr_post)
VHLx2rL41_prog_map_thresh5_min_corr_post_counts
VHLx2rL41_prog_map_thresh5_max_corr_post_counts = max(VHLx2rL41_cSNV_all_df$corr_post)
VHLx2rL41_prog_map_thresh5_max_corr_post_counts

VHLx2rL41_pSNV_thresh5 <- which(VHLx2rL41[,VHLx2_p_hdr_snv]=='True' & as.numeric(as.character(VHLx2rL41[,'pre_freq']))>=0.00001)
VHLx2rL41_pSNV_thresh5_df = VHLx2rL41[VHLx2rL41_pSNV_thresh5,]
VHLx2rL41_pSNV_thresh5_lib_count = length(VHLx2rL41_pSNV_thresh5_df$lib)
VHLx2rL41_pSNV_thresh5_lib_count
VHLx2rL41_pSNV_thresh5_min_lib_counts = min(VHLx2rL41_pSNV_thresh5_df$lib)
VHLx2rL41_pSNV_thresh5_min_lib_counts
VHLx2rL41_pSNV_thresh5_max_lib_counts = max(VHLx2rL41_pSNV_thresh5_df$lib)
VHLx2rL41_pSNV_thresh5_max_lib_counts
VHLx2rL41_pSNV_thresh5_pre_count = length(VHLx2rL41_pSNV_thresh5_df$pre)
VHLx2rL41_pSNV_thresh5_pre_count
VHLx2rL41_pSNV_thresh5_min_pre_counts = min(VHLx2rL41_pSNV_thresh5_df$pre)
VHLx2rL41_pSNV_thresh5_min_pre_counts
VHLx2rL41_pSNV_thresh5_max_pre_counts = max(VHLx2rL41_pSNV_thresh5_df$pre)
VHLx2rL41_pSNV_thresh5_max_pre_counts
VHLx2rL41_pSNV_thresh5_post_count = length(VHLx2rL41_pSNV_thresh5_df$post)
VHLx2rL41_pSNV_thresh5_post_count
VHLx2rL41_pSNV_thresh5_min_post_counts = min(VHLx2rL41_pSNV_thresh5_df$post)
VHLx2rL41_pSNV_thresh5_min_post_counts
VHLx2rL41_pSNV_thresh5_max_post_counts = max(VHLx2rL41_pSNV_thresh5_df$post)
VHLx2rL41_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx2rL42_cSNV_all <- which(VHLx2rL42[,'c_hdr_snv']=='True')
VHLx2rL42_cSNV_all_df = VHLx2rL42[VHLx2rL42_cSNV_all,]
VHLx2rL42_prog_var_all <- which(VHLx2rL42[,'all_hdr_variant']=='True' & VHLx2rL42[,'edit_string']!='-WT')
VHLx2rL42_prog_var_all_df = VHLx2rL42[VHLx2rL42_prog_var_all,]
VHLx2rL42_prog_map_all = which(VHLx2rL42_prog_var_all_df[,'pos']!='REF')
VHLx2rL42_prog_map_all_df = VHLx2rL42_prog_var_all_df[VHLx2rL42_prog_map_all,]
VHLx2rL42_prog_map_exon_all = which(VHLx2rL42_prog_map_all_df[,'cDNApos']!='REF' & VHLx2rL42_prog_map_all_df[,'cDNApos']!='NA')
VHLx2rL42_prog_map_exon_all_df = VHLx2rL42_prog_map_all_df[VHLx2rL42_prog_map_exon_all,]
VHLx2rL42_prog_map_CADD = which(VHLx2rL42_prog_map_all_df[,'CADD.phred']!='NA')
VHLx2rL42_prog_map_CADD_df = VHLx2rL42_prog_map_all_df[VHLx2rL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx2rL42_prog_var_thresh5 <- which(as.numeric(as.character(VHLx2rL42_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx2rL42_prog_var_thresh5_df = VHLx2rL42_prog_var_all_df[VHLx2rL42_prog_var_thresh5,]
VHLx2rL42_prog_map_thresh5 <- which(as.numeric(as.character(VHLx2rL42_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx2rL42_prog_map_thresh5_df = VHLx2rL42_prog_map_all_df[VHLx2rL42_prog_map_thresh5,]
VHLx2rL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx2rL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx2rL42_prog_map_exon_thresh5_df = VHLx2rL42_prog_map_exon_all_df[VHLx2rL42_prog_map_exon_thresh5,]
VHLx2rL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx2rL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx2rL42_prog_map_CADD_thresh5_df = VHLx2rL42_prog_map_CADD_df[VHLx2rL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx2rL42_prog_var_all_lib_count = length(VHLx2rL42_prog_var_all_df$lib)
VHLx2rL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx2rL42_prog_var_all_min_lib_counts = min(VHLx2rL42_prog_var_all_df$lib)
VHLx2rL42_prog_var_all_min_lib_counts
VHLx2rL42_prog_var_all_max_lib_counts = max(VHLx2rL42_prog_var_all_df$lib)
VHLx2rL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx2rL42_prog_map_all_lib_count = length(VHLx2rL42_prog_map_all_df$lib)
VHLx2rL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx2rL42_prog_map_all_min_lib_counts = min(VHLx2rL42_prog_map_all_df$lib)
VHLx2rL42_prog_map_all_min_lib_counts
VHLx2rL42_prog_map_all_max_lib_counts = max(VHLx2rL42_prog_map_all_df$lib)
VHLx2rL42_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx2rL42_prog_var_all_pre_count = length(VHLx2rL42_prog_var_all_df$pre)
VHLx2rL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx2rL42_prog_var_all_min_pre_counts = min(VHLx2rL42_prog_var_all_df$pre)
VHLx2rL42_prog_var_all_min_pre_counts
VHLx2rL42_prog_var_all_max_pre_counts = max(VHLx2rL42_prog_var_all_df$pre)
VHLx2rL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx2rL42_prog_map_all_pre_count = length(VHLx2rL42_prog_map_all_df$pre)
VHLx2rL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx2rL42_prog_map_all_min_pre_counts = min(VHLx2rL42_prog_map_all_df$pre)
VHLx2rL42_prog_map_all_min_pre_counts
VHLx2rL42_prog_map_all_max_pre_counts = max(VHLx2rL42_prog_map_all_df$pre)
VHLx2rL42_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx2rL42_prog_map_all_post_count = length(VHLx2rL42_prog_map_all_df$post)
VHLx2rL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx2rL42_prog_map_all_min_post_counts = min(VHLx2rL42_prog_map_all_df$post)
VHLx2rL42_prog_map_all_min_post_counts
VHLx2rL42_prog_map_all_max_post_counts = max(VHLx2rL42_prog_map_all_df$post)
VHLx2rL42_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx2rL42_prog_map_all_syn_df <- VHLx2rL42_prog_map_all_df[which(VHLx2rL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx2rL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx2rL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx2rL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx2rL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx2rL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx2rL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx2rL42_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx2rL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx2rL42_prog_map_all_min_rna_counts = min(VHLx2rL42_prog_map_exon_all_df$tHDR_rna)
VHLx2rL42_prog_map_all_min_rna_counts
VHLx2rL42_prog_map_all_max_rna_counts = max(VHLx2rL42_prog_map_exon_all_df$tHDR_rna)
VHLx2rL42_prog_map_all_max_rna_counts
VHLx2rL42_prog_map_all_min_rna_pseudo_freq = min(VHLx2rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx2rL42_prog_map_all_min_rna_pseudo_freq
VHLx2rL42_prog_map_all_max_rna_pseudo_freq = max(VHLx2rL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx2rL42_prog_map_all_max_rna_pseudo_freq
VHLx2rL42_prog_map_all_min_rna_pre_ratio = min(VHLx2rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx2rL42_prog_map_all_min_rna_pre_ratio
VHLx2rL42_prog_map_all_max_rna_pre_ratio = max(VHLx2rL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx2rL42_prog_map_all_max_rna_pre_ratio
VHLx2rL42_prog_map_all_min_rna_post_ratio = min(VHLx2rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx2rL42_prog_map_all_min_rna_post_ratio
VHLx2rL42_prog_map_all_max_rna_post_ratio = max(VHLx2rL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx2rL42_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx2rL42_cSNV_all_corr_pre_count = length(VHLx2rL42_cSNV_all_df$corr_pre)
VHLx2rL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx2rL42_cSNV_all_min_corr_pre_counts = min(VHLx2rL42_cSNV_all_df$corr_pre)
VHLx2rL42_cSNV_all_min_corr_pre_counts
VHLx2rL42_cSNV_all_max_corr_pre_counts = max(VHLx2rL42_cSNV_all_df$corr_pre)
VHLx2rL42_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rL42_cSNV_all_corr_post_count = length(VHLx2rL42_cSNV_all_df$corr_post)
VHLx2rL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx2rL42_cSNV_all_min_corr_post_counts = min(VHLx2rL42_cSNV_all_df$corr_post)
VHLx2rL42_cSNV_all_min_corr_post_counts
VHLx2rL42_cSNV_all_max_corr_post_counts = max(VHLx2rL42_cSNV_all_df$corr_post)
VHLx2rL42_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx2_p_hdr_snv = paste('p_hdr_',VHLx2_cut_end,'_snv',sep='')
VHLx2rL42_pSNV_all <- which(VHLx2rL42[,VHLx2_p_hdr_snv]=='True')
VHLx2rL42_pSNV_all_df = VHLx2rL42[VHLx2rL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rL42_pSNV_all_lib_count = length(VHLx2rL42_pSNV_all_df$lib)
VHLx2rL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx2rL42_pSNV_all_min_lib_counts = min(VHLx2rL42_pSNV_all_df$lib)
VHLx2rL42_pSNV_all_min_lib_counts
VHLx2rL42_pSNV_all_max_lib_counts = max(VHLx2rL42_pSNV_all_df$lib)
VHLx2rL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx2rL42_pSNV_all_pre_count = length(VHLx2rL42_pSNV_all_df$pre)
VHLx2rL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx2rL42_pSNV_all_min_pre_counts = min(VHLx2rL42_pSNV_all_df$pre)
VHLx2rL42_pSNV_all_min_pre_counts
VHLx2rL42_pSNV_all_max_pre_counts = max(VHLx2rL42_pSNV_all_df$pre)
VHLx2rL42_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rL42_pSNV_all_post_count = length(VHLx2rL42_pSNV_all_df$post)
VHLx2rL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx2rL42_pSNV_all_min_post_counts = min(VHLx2rL42_pSNV_all_df$post)
VHLx2rL42_pSNV_all_min_post_counts
VHLx2rL42_pSNV_all_max_post_counts = max(VHLx2rL42_pSNV_all_df$post)
VHLx2rL42_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rL42_prog_map_thresh5_lib_count = length(VHLx2rL42_prog_map_thresh5_df$lib)
VHLx2rL42_prog_map_thresh5_lib_count
VHLx2rL42_prog_map_thresh5_min_lib_counts = min(VHLx2rL42_prog_map_thresh5_df$lib)
VHLx2rL42_prog_map_thresh5_min_lib_counts
VHLx2rL42_prog_map_thresh5_max_lib_counts = max(VHLx2rL42_prog_map_thresh5_df$lib)
VHLx2rL42_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rL42_prog_map_thresh5_pre_count = length(VHLx2rL42_prog_map_thresh5_df$pre)
VHLx2rL42_prog_map_thresh5_pre_count
VHLx2rL42_prog_map_thresh5_min_pre_counts = min(VHLx2rL42_prog_map_thresh5_df$pre)
VHLx2rL42_prog_map_thresh5_min_pre_counts
VHLx2rL42_prog_map_thresh5_max_pre_counts = max(VHLx2rL42_prog_map_thresh5_df$pre)
VHLx2rL42_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx2rL42_prog_map_thresh5_post_count = length(VHLx2rL42_prog_map_thresh5_df$post)
VHLx2rL42_prog_map_thresh5_post_count
VHLx2rL42_prog_map_thresh5_min_post_counts = min(VHLx2rL42_prog_map_thresh5_df$post)
VHLx2rL42_prog_map_thresh5_min_post_counts
VHLx2rL42_prog_map_thresh5_max_post_counts = max(VHLx2rL42_prog_map_thresh5_df$post)
VHLx2rL42_prog_map_thresh5_max_post_counts
VHLx2rL42_prog_map_thresh5_corr_post_count = length(VHLx2rL42_cSNV_all_df$corr_post)
VHLx2rL42_prog_map_thresh5_corr_post_count
VHLx2rL42_prog_map_thresh5_min_corr_post_counts = min(VHLx2rL42_cSNV_all_df$corr_post)
VHLx2rL42_prog_map_thresh5_min_corr_post_counts
VHLx2rL42_prog_map_thresh5_max_corr_post_counts = max(VHLx2rL42_cSNV_all_df$corr_post)
VHLx2rL42_prog_map_thresh5_max_corr_post_counts

VHLx2rL42_pSNV_thresh5 <- which(VHLx2rL42[,VHLx2_p_hdr_snv]=='True' & as.numeric(as.character(VHLx2rL42[,'pre_freq']))>=0.00001)
VHLx2rL42_pSNV_thresh5_df = VHLx2rL42[VHLx2rL42_pSNV_thresh5,]
VHLx2rL42_pSNV_thresh5_lib_count = length(VHLx2rL42_pSNV_thresh5_df$lib)
VHLx2rL42_pSNV_thresh5_lib_count
VHLx2rL42_pSNV_thresh5_min_lib_counts = min(VHLx2rL42_pSNV_thresh5_df$lib)
VHLx2rL42_pSNV_thresh5_min_lib_counts
VHLx2rL42_pSNV_thresh5_max_lib_counts = max(VHLx2rL42_pSNV_thresh5_df$lib)
VHLx2rL42_pSNV_thresh5_max_lib_counts
VHLx2rL42_pSNV_thresh5_pre_count = length(VHLx2rL42_pSNV_thresh5_df$pre)
VHLx2rL42_pSNV_thresh5_pre_count
VHLx2rL42_pSNV_thresh5_min_pre_counts = min(VHLx2rL42_pSNV_thresh5_df$pre)
VHLx2rL42_pSNV_thresh5_min_pre_counts
VHLx2rL42_pSNV_thresh5_max_pre_counts = max(VHLx2rL42_pSNV_thresh5_df$pre)
VHLx2rL42_pSNV_thresh5_max_pre_counts
VHLx2rL42_pSNV_thresh5_post_count = length(VHLx2rL42_pSNV_thresh5_df$post)
VHLx2rL42_pSNV_thresh5_post_count
VHLx2rL42_pSNV_thresh5_min_post_counts = min(VHLx2rL42_pSNV_thresh5_df$post)
VHLx2rL42_pSNV_thresh5_min_post_counts
VHLx2rL42_pSNV_thresh5_max_post_counts = max(VHLx2rL42_pSNV_thresh5_df$post)
VHLx2rL42_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx2rL41_prog_var_thresh5_df:
VHLx2rL41_prog_var_thresh5_df_rL42_int <- VHLx2rL41_prog_var_thresh5_df[which(VHLx2rL41_prog_var_thresh5_df$variant %in% VHLx2rL42_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx2rL42_prog_var_thresh5_df:
VHLx2rL42_prog_var_thresh5_df_rL41_int <- VHLx2rL42_prog_var_thresh5_df[which(VHLx2rL42_prog_var_thresh5_df$variant %in% VHLx2rL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord <- VHLx2rL41_prog_var_thresh5_df_rL42_int[order(VHLx2rL41_prog_var_thresh5_df_rL42_int$variant),]
VHLx2rL42_prog_var_thresh5_df_rL41_int_ord <- VHLx2rL42_prog_var_thresh5_df_rL41_int[order(VHLx2rL42_prog_var_thresh5_df_rL41_int$variant),]
dim(VHLx2rL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
VHLx2rL41rL42int_prog_var_thresh5_pre_count <- dim(VHLx2rL41_prog_var_thresh5_df_rL42_int)[1] 
VHLx2rL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(VHLx2rL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(VHLx2rL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41

#Add the following columns from the from rL42 df to the rL41 df:
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$pre
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$lib
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$rna
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2 <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post2
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3 <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post3
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2 <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$rna2
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pseudo <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post2_pseudo
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pseudo <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post3_pseudo
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_pseudo <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$rna2_pseudo
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post2_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post3_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$rna2_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pseudo_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post2_pseudo_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pseudo_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post3_pseudo_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_pseudo_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$rna2_pseudo_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post2_pre_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pre_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post3_pre_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$rna2_post_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$corr_post
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2 <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3 <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2 <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pseudo_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2_pseudo_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pseudo_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3_pseudo_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_pseudo_freq <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2_pseudo_freq
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2_pre_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pre_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3_pre_ratio
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio <- VHLx2rL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio) + log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio))/2)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio) + log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio))/2)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio) + log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio))/2)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio) + log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio))/2)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post3_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post3_pre_ratio) + log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pre_ratio))/2)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rna2_post_ratio_rL41rL42_mean <- 2^((log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rna2_post_ratio) + log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio))/2)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio) + log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio))/2)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio) + log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio))/2)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio) + log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio))/2)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio) + log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio))/2)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- 2^((log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio) + log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio))/2)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio) + log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio))/2)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post3_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post3_pre_ratio) + log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pre_ratio))/2)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean <- 2^((log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio) + log2(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq)) >= 10) {
    VHLx2rL41_cSNV_pre_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx2rL41_cSNV_post_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx2rL41_cSNV_post2_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx2rL41_cSNV_post_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx2rL41_tSNV_pre_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx2rL41_tSNV_post_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx2rL41_tSNV_post_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx2rL41_tSNV_rna_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx2rL41_tSNV_rna_post_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx2rL41_tSNV_rna2_post_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx2rL42_cSNV_pre_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_pre_lib_ratio)
VHLx2rL42_cSNV_post_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post_pre_ratio)
VHLx2rL42_cSNV_post2_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post2_pre_ratio)

VHLx2rL42_cSNV_post_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post_lib_ratio)
VHLx2rL42_tSNV_pre_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_pre_lib_ratio)
VHLx2rL42_tSNV_post_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post_pre_ratio)
VHLx2rL42_tSNV_post2_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post2_pre_ratio)
VHLx2rL42_tSNV_post_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post_lib_ratio)
VHLx2rL42_tSNV_rna_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna_pre_ratio)
VHLx2rL42_tSNV_rna_post_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna_post_ratio)
VHLx2rL42_tSNV_rna2_post_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna2_post_ratio)
VHLx2rL41rL42a_cSNV_pre_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rL41rL42_mean)
VHLx2rL41rL42a_cSNV_post_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rL41rL42_mean)
VHLx2rL41rL42a_cSNV_post2_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rL41rL42_mean)
VHLx2rL41rL42a_cSNV_post_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rL41rL42_mean)
VHLx2rL41rL42a_tSNV_pre_lib_med <- 
  median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rL41rL42_mean)
VHLx2rL41rL42a_tSNV_post_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rL41rL42_mean)
VHLx2rL41rL42a_tSNV_post2_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rL41rL42_mean)
VHLx2rL41rL42a_tSNV_post_lib_med <-
  median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rL41rL42_mean)
VHLx2rL41rL42a_tSNV_rna_pre_med <-
  median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rL41rL42_mean)
VHLx2rL41rL42a_tSNV_rna_post_med <-
  median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rL41rL42_mean)
VHLx2rL41rL42a_tSNV_rna2_post_med <-
  median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rL41rL42_mean)
VHLx2rL41rL42pw_tSNV_post_pre_med  <-
  median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
VHLx2rL41rL42pw_cSNV_post_pre_med  <-
  median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rL41rL42_pre_weighted)
  } else {
  VHLx2rL41_cSNV_pre_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio)
VHLx2rL41_cSNV_post_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio)
VHLx2rL41_cSNV_post2_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio)
VHLx2rL41_cSNV_post_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio)
VHLx2rL41_tSNV_pre_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio)
VHLx2rL41_tSNV_post_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio)
VHLx2rL41_tSNV_post_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio)
VHLx2rL41_tSNV_rna_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio)
VHLx2rL41_tSNV_rna_post_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio)
VHLx2rL41_tSNV_rna2_post_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio)
VHLx2rL42_cSNV_pre_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)
VHLx2rL42_cSNV_post_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)
VHLx2rL42_cSNV_post2_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio)

VHLx2rL42_cSNV_post_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)
VHLx2rL42_tSNV_pre_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)
VHLx2rL42_tSNV_post_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)
VHLx2rL42_tSNV_post2_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio)
VHLx2rL42_tSNV_post_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)
VHLx2rL42_tSNV_rna_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)
VHLx2rL42_tSNV_rna_post_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)
VHLx2rL42_tSNV_rna2_post_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio)
VHLx2rL41rL42a_cSNV_pre_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean)
VHLx2rL41rL42a_cSNV_post_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean)
VHLx2rL41rL42a_cSNV_post2_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_rL41rL42_mean)
VHLx2rL41rL42a_cSNV_post_lib_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean)
VHLx2rL41rL42a_tSNV_pre_lib_med <- 
  median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean)
VHLx2rL41rL42a_tSNV_post_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean)
VHLx2rL41rL42a_tSNV_post2_pre_med <- median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean)
VHLx2rL41rL42a_tSNV_post_lib_med <-
  median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean)
VHLx2rL41rL42a_tSNV_rna_pre_med <-
  median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean)
VHLx2rL41rL42a_tSNV_rna_post_med <-
  median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean)
VHLx2rL41rL42a_tSNV_rna2_post_med <-
  median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean)
VHLx2rL41rL42pw_tSNV_post_pre_med  <-
  median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
VHLx2rL41rL42pw_cSNV_post_pre_med  <-
  median(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted)
}

VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/VHLx2rL41_cSNV_pre_lib_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/VHLx2rL41_cSNV_post_pre_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/VHLx2rL41_cSNV_post_lib_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio/VHLx2rL41_cSNV_post2_pre_med

VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/VHLx2rL41_tSNV_pre_lib_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/VHLx2rL41_tSNV_post_pre_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/VHLx2rL41_tSNV_post_lib_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/VHLx2rL41_tSNV_rna_pre_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/VHLx2rL41_tSNV_rna_post_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio/VHLx2rL42_tSNV_post2_pre_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio/VHLx2rL41_tSNV_rna2_post_med

VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/VHLx2rL42_cSNV_pre_lib_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/VHLx2rL42_cSNV_post_pre_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/VHLx2rL42_cSNV_post_lib_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio/VHLx2rL41rL42a_cSNV_post2_pre_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio/VHLx2rL42_tSNV_rna2_post_med


VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/VHLx2rL42_tSNV_pre_lib_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/VHLx2rL42_tSNV_post_pre_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio/VHLx2rL42_tSNV_post2_pre_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/VHLx2rL42_tSNV_post_lib_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/VHLx2rL42_tSNV_rna_pre_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/VHLx2rL42_tSNV_rna_post_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio/VHLx2rL42_tSNV_rna2_post_med

###normalize the means
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/VHLx2rL41rL42a_cSNV_pre_lib_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/VHLx2rL41rL42a_cSNV_post_pre_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/VHLx2rL41rL42a_cSNV_post_lib_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/VHLx2rL41rL42a_tSNV_pre_lib_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/VHLx2rL41rL42a_tSNV_post_pre_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean/VHLx2rL41rL42a_tSNV_post2_pre_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/VHLx2rL41rL42a_tSNV_post_lib_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/VHLx2rL41rL42a_tSNV_rna_pre_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/VHLx2rL41rL42a_tSNV_rna_post_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean/VHLx2rL41rL42a_tSNV_rna2_post_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/VHLx2rL41rL42pw_tSNV_post_pre_med
VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- VHLx2rL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/VHLx2rL41rL42pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx2rL41_prog_var_thresh5_df_rL42_int_ord
VHLx2rL41_prog_map_thresh5_df_rL42_int_ord = which(VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df = VHLx2rL41_prog_var_thresh5_df_rL42_int_ord[VHLx2rL41_prog_map_thresh5_df_rL42_int_ord,]
VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord = which(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df = VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df[VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord,]
VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df[VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord,]
VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx2rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
VHLx2rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
VHLx2rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
VHLx2rL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p
VHLx2rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
VHLx2rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
VHLx2rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
VHLx2rL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p
VHLx2rL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post2_pre_ratio_synnorm),method='spearman')
VHLx2rL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s
VHLx2rL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_p <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post2_pre_ratio_synnorm),method='pearson')
VHLx2rL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_p
VHLx2rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx2rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
VHLx2rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx2rL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p
VHLx2rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx2rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
VHLx2rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx2rL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p
VHLx2rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx2rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
VHLx2rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx2rL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p
VHLx2rL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_s <- cor(log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx2rL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_s
VHLx2rL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_p <- cor(log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx2rL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_p
VHLx2rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
VHLx2rL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
VHLx2rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pseudo_freq),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pseudo_freq),method='pearson')
VHLx2rL41rL42_cSNV_rL41_post_by_rL42_post_cor_p
VHLx2rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
VHLx2rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
VHLx2rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
VHLx2rL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p
VHLx2rL41rL42_tSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx2rL41rL42_tSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s
VHLx2rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx2rL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
VHLx2rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx2rL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
VHLx2rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx2rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s
VHLx2rL41rL42_tSNV_rL41_rna2_post_by_rL42_rna2_post_cor_s <- cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx2rL41rL42_tSNV_rL41_rna2_post_by_rL42_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx2rL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41_cSNV_post_pre_by_cadd_cor_s
VHLx2rL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL42_cSNV_post_pre_by_cadd_cor_s
VHLx2rL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41_cSNV_post_lib_by_cadd_cor_s
VHLx2rL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL42_cSNV_post_lib_by_cadd_cor_s
VHLx2rL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41_tSNV_post_pre_by_cadd_cor_s
VHLx2rL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL42_tSNV_post_pre_by_cadd_cor_s
VHLx2rL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41_tSNV_post_lib_by_cadd_cor_s
VHLx2rL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx2rL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42a_cSNV_pre_lib_by_cadd_cor_s
VHLx2rL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42w_cSNV_pre_lib_by_cadd_cor_s
VHLx2rL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42a_cSNV_post_pre_by_cadd_cor_s
VHLx2rL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42w_cSNV_post_pre_by_cadd_cor_s
VHLx2rL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42a_cSNV_post_lib_by_cadd_cor_s
VHLx2rL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42w_cSNV_post_lib_by_cadd_cor_s
VHLx2rL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42a_tSNV_pre_lib_by_cadd_cor_s
VHLx2rL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42a_tSNV_post_pre_by_cadd_cor_s
VHLx2rL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42w_tSNV_post_pre_by_cadd_cor_s
VHLx2rL41rL42a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post2_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42a_tSNV_post2_pre_by_cadd_cor_s
VHLx2rL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx2rL41_cSNV_pre_lib_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx2rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx2rL41_tSNV_pre_lib_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rL41_cSNV_post_lib_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx2rL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx2rL41_tSNV_post_lib_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx2rL41_cSNV_post_pre_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx2rL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx2rL41_tSNV_post_pre_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx2rL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rL41_cSNV_rna_lib_cors = cor(log2(VHLx2rL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx2rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx2rL41_tSNV_rna_lib_cors = cor(log2(VHLx2rL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx2rL41_cSNV_rna_pre_cors = cor(log2(VHLx2rL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx2rL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx2rL41_tSNV_rna_pre_cors = cor(log2(VHLx2rL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx2rL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rL41rL42_cSNV_pre_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
VHLx2rL41rL42_tSNV_pre_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
VHLx2rL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
VHLx2rL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
VHLx2rL41rL42_cSNV_post_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
VHLx2rL41rL42_tSNV_post_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
VHLx2rL41rL42_cSNV_post_lib_ratio_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
VHLx2rL41rL42_tSNV_post_lib_ratio_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx2rL41rL42_cSNV_post_pre_ratio_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
VHLx2rL41rL42_tSNV_post_pre_ratio_cors = cor(log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx2rL41rL42_cSNV_rna_cors = cor(log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
VHLx2rL41rL42_tSNV_rna_cors = cor(log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
VHLx2rL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx2rL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx2rL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx2rL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx2rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx2rL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx2rL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

VHLx2rL41_cors <- c("VHLx2rL41",VHLx2rL41_cSNV_pre_lib_cors,VHLx2rL41_tSNV_pre_lib_cors,VHLx2rL41_cSNV_post_lib_cors,VHLx2rL41_tSNV_post_lib_cors,VHLx2rL41_cSNV_post_pre_cors,VHLx2rL41_tSNV_post_pre_cors,VHLx2rL41_cSNV_rna_lib_cors,VHLx2rL41_tSNV_rna_lib_cors,VHLx2rL41_cSNV_rna_pre_cors,VHLx2rL41_tSNV_rna_pre_cors,VHLx2rL41rL42_cSNV_pre_cors,VHLx2rL41rL42_tSNV_pre_cors,VHLx2rL41rL42_cSNV_pre_lib_ratio_cors,VHLx2rL41rL42_tSNV_pre_lib_ratio_cors,VHLx2rL41rL42_cSNV_post_cors,VHLx2rL41rL42_tSNV_post_cors,VHLx2rL41rL42_cSNV_post_lib_ratio_cors,VHLx2rL41rL42_tSNV_post_lib_ratio_cors,VHLx2rL41rL42_cSNV_post_pre_ratio_cors,VHLx2rL41rL42_tSNV_post_pre_ratio_cors,VHLx2rL41rL42_cSNV_rna_cors,VHLx2rL41rL42_tSNV_rna_cors,VHLx2rL41rL42_tSNV_rna_pre_ratio_cors,VHLx2rL41_cSNV_pre_lib_ratio_cadd_cors,VHLx2rL41_tSNV_pre_lib_ratio_cadd_cors,VHLx2rL41_cSNV_post_lib_ratio_cadd_cors,VHLx2rL41_tSNV_post_lib_ratio_cadd_cors,VHLx2rL41_cSNV_post_pre_ratio_cadd_cors,VHLx2rL41_tSNV_post_pre_ratio_cadd_cors,VHLx2rL41_cSNV_post_pre_ratio_cadd_missense_cors,VHLx2rL41_tSNV_post_pre_ratio_cadd_missense_cors,VHLx2rL41_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rL41_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rL41_cSNV_post_pre_ratio_grantham_missense_cors,VHLx2rL41_tSNV_post_pre_ratio_grantham_missense_cors,VHLx2rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,VHLx2rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,VHLx2rL41rL42a_cSNV_post_lib_ratio_cadd_cors,VHLx2rL41rL42a_tSNV_post_lib_ratio_cadd_cors,VHLx2rL41rL42a_cSNV_post_pre_ratio_cadd_cors,VHLx2rL41rL42a_tSNV_post_pre_ratio_cadd_cors,VHLx2rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx2rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx2rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx2rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx2rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,VHLx2rL41rL42w_cSNV_post_lib_ratio_cadd_cors,VHLx2rL41rL42w_cSNV_post_pre_ratio_cadd_cors,VHLx2rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

VHLx2rL42_cSNV_pre_lib_cors = cor(log2(VHLx2rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx2rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx2rL42_tSNV_pre_lib_cors = cor(log2(VHLx2rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rL42_cSNV_post_lib_cors = cor(log2(VHLx2rL42_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx2rL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx2rL42_tSNV_post_lib_cors = cor(log2(VHLx2rL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx2rL42_cSNV_post_pre_cors = cor(log2(VHLx2rL42_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx2rL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx2rL42_tSNV_post_pre_cors = cor(log2(VHLx2rL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx2rL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rL42_cSNV_rna_lib_cors = cor(log2(VHLx2rL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx2rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx2rL42_tSNV_rna_lib_cors = cor(log2(VHLx2rL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx2rL42_cSNV_rna_pre_cors = cor(log2(VHLx2rL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx2rL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx2rL42_tSNV_rna_pre_cors = cor(log2(VHLx2rL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx2rL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx2rL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

VHLx2rL42_cors <- c("VHLx2rL42",VHLx2rL42_cSNV_pre_lib_cors,VHLx2rL42_tSNV_pre_lib_cors,VHLx2rL42_cSNV_post_lib_cors,VHLx2rL42_tSNV_post_lib_cors,VHLx2rL42_cSNV_post_pre_cors,VHLx2rL42_tSNV_post_pre_cors,VHLx2rL42_cSNV_rna_lib_cors,VHLx2rL42_tSNV_rna_lib_cors,VHLx2rL42_cSNV_rna_pre_cors,VHLx2rL42_tSNV_rna_pre_cors,VHLx2rL41rL42_cSNV_pre_cors,VHLx2rL41rL42_tSNV_pre_cors,VHLx2rL41rL42_cSNV_pre_lib_ratio_cors,VHLx2rL41rL42_tSNV_pre_lib_ratio_cors,VHLx2rL41rL42_cSNV_post_cors,VHLx2rL41rL42_tSNV_post_cors,VHLx2rL41rL42_cSNV_post_lib_ratio_cors,VHLx2rL41rL42_tSNV_post_lib_ratio_cors,VHLx2rL41rL42_cSNV_post_pre_ratio_cors,VHLx2rL41rL42_tSNV_post_pre_ratio_cors,VHLx2rL41rL42_cSNV_rna_cors,VHLx2rL41rL42_tSNV_rna_cors,VHLx2rL41rL42_tSNV_rna_pre_ratio_cors,VHLx2rL42_cSNV_pre_lib_ratio_cadd_cors,VHLx2rL42_tSNV_pre_lib_ratio_cadd_cors,VHLx2rL42_cSNV_post_lib_ratio_cadd_cors,VHLx2rL42_tSNV_post_lib_ratio_cadd_cors,VHLx2rL42_cSNV_post_pre_ratio_cadd_cors,VHLx2rL42_tSNV_post_pre_ratio_cadd_cors,VHLx2rL42_cSNV_post_pre_ratio_cadd_missense_cors,VHLx2rL42_tSNV_post_pre_ratio_cadd_missense_cors,VHLx2rL42_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rL42_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rL42_cSNV_post_pre_ratio_grantham_missense_cors,VHLx2rL42_tSNV_post_pre_ratio_grantham_missense_cors,VHLx2rL41rL42a_cSNV_pre_lib_ratio_cadd_cors,VHLx2rL41rL42a_tSNV_pre_lib_ratio_cadd_cors,VHLx2rL41rL42a_cSNV_post_lib_ratio_cadd_cors,VHLx2rL41rL42a_tSNV_post_lib_ratio_cadd_cors,VHLx2rL41rL42a_cSNV_post_pre_ratio_cadd_cors,VHLx2rL41rL42a_tSNV_post_pre_ratio_cadd_cors,VHLx2rL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx2rL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx2rL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx2rL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx2rL41rL42w_cSNV_pre_lib_ratio_cadd_cors,VHLx2rL41rL42w_cSNV_post_lib_ratio_cadd_cors,VHLx2rL41rL42w_cSNV_post_pre_ratio_cadd_cors,VHLx2rL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx2rL41)
rm(VHLx2rL42)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx2rL41
VHLx2_posrange <- range(as.numeric(as.character(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$pos)))
VHLx2_posseq <- seq(from=VHLx2_posrange[1], to=VHLx2_posrange[2])
VHLx2rL41_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx2rL41_tHDR_pre_lib_pred <- predict(VHLx2rL41_tHDR_pre_lib_ratio.lo, newdata = VHLx2_posseq, se=TRUE)
VHLx2rL41_tHDR_pre_lib_pos_effects <- VHLx2rL41_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx2rL41_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx2rL41_tHDR_pre_lib_pos_effects)
VHLx2rL41_tHDR_pre_lib_pos_effects_ci <- VHLx2rL41_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx2rL41_tHDR_pre_lib_pred$df)
VHLx2rL41_tHDR_pre_lib_pos_effects_ci_ymin = VHLx2rL41_tHDR_pre_lib_pos_effects - VHLx2rL41_tHDR_pre_lib_pos_effects_ci
VHLx2rL41_tHDR_pre_lib_pos_effects_ci_ymax = VHLx2rL41_tHDR_pre_lib_pos_effects + VHLx2rL41_tHDR_pre_lib_pos_effects_ci
VHLx2rL41_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx2_posseq, VHLx2rL41_tHDR_pre_lib_pos_effects, VHLx2rL41_tHDR_pre_lib_pos_effects.x, VHLx2rL41_tHDR_pre_lib_pos_effects_ci_ymin, VHLx2rL41_tHDR_pre_lib_pos_effects_ci_ymax, VHLx2rL41_tHDR_pre_lib_pred_se = VHLx2rL41_tHDR_pre_lib_pred$se.fit)
#VHLx2rL42
VHLx2rL42_tHDR_pre_lib_ratio.lo <- loess(log2(rL42_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx2rL42_tHDR_pre_lib_pred <- predict(VHLx2rL42_tHDR_pre_lib_ratio.lo, newdata = VHLx2_posseq, se=TRUE)
VHLx2rL42_tHDR_pre_lib_pos_effects <- VHLx2rL42_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx2rL42_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx2rL42_tHDR_pre_lib_pos_effects)
VHLx2rL42_tHDR_pre_lib_pos_effects_ci <- VHLx2rL42_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx2rL42_tHDR_pre_lib_pred$df)
VHLx2rL42_tHDR_pre_lib_pos_effects_ci_ymin = VHLx2rL42_tHDR_pre_lib_pos_effects - VHLx2rL42_tHDR_pre_lib_pos_effects_ci
VHLx2rL42_tHDR_pre_lib_pos_effects_ci_ymax = VHLx2rL42_tHDR_pre_lib_pos_effects + VHLx2rL42_tHDR_pre_lib_pos_effects_ci
VHLx2rL42_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx2_posseq, VHLx2rL42_tHDR_pre_lib_pos_effects, VHLx2rL42_tHDR_pre_lib_pos_effects.x, VHLx2rL42_tHDR_pre_lib_pos_effects_ci_ymin, VHLx2rL42_tHDR_pre_lib_pos_effects_ci_ymax, VHLx2rL42_tHDR_pre_lib_pred_se = VHLx2rL42_tHDR_pre_lib_pred$se.fit)

#VHLx2rL41rL42
VHLx2rL41rL42_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rL41rL42_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm > 0.7 & VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm > 0.3 & VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx2rL41rL42_tHDR_pre_lib_pred <- predict(VHLx2rL41rL42_tHDR_pre_lib_ratio.lo, newdata = VHLx2_posseq, se=TRUE)
VHLx2rL41rL42_tHDR_pre_lib_pos_effects <- VHLx2rL41rL42_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx2rL41rL42_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx2rL41rL42_tHDR_pre_lib_pos_effects)
VHLx2rL41rL42_tHDR_pre_lib_pos_effects_ci <- VHLx2rL41rL42_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx2rL41rL42_tHDR_pre_lib_pred$df)
VHLx2rL41rL42_tHDR_pre_lib_pos_effects_ci_ymin = VHLx2rL41rL42_tHDR_pre_lib_pos_effects - VHLx2rL41rL42_tHDR_pre_lib_pos_effects_ci
VHLx2rL41rL42_tHDR_pre_lib_pos_effects_ci_ymax = VHLx2rL41rL42_tHDR_pre_lib_pos_effects + VHLx2rL41rL42_tHDR_pre_lib_pos_effects_ci
VHLx2rL41rL42_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx2_posseq, VHLx2rL41rL42_tHDR_pre_lib_pos_effects, VHLx2rL41rL42_tHDR_pre_lib_pos_effects.x, VHLx2rL41rL42_tHDR_pre_lib_pos_effects_ci_ymin, VHLx2rL41rL42_tHDR_pre_lib_pos_effects_ci_ymax, VHLx2rL41rL42_tHDR_pre_lib_pred_se = VHLx2rL41rL42_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rL41, rL42, rL41rL42)
VHLx2rL4_tHDR_pos_merge_df <- VHLx2rL41_prog_map_thresh5_df_rL42_int_ord_df 
VHLx2rL4_tHDR_pos_merge_df <- merge(VHLx2rL4_tHDR_pos_merge_df, VHLx2rL41_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx2rL41_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx2rL4_tHDR_pos_merge_df <- merge(VHLx2rL4_tHDR_pos_merge_df, VHLx2rL42_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx2rL42_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx2rL4_tHDR_pos_merge_df <- merge(VHLx2rL4_tHDR_pos_merge_df, VHLx2rL41rL42_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx2rL41rL42_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx2rL4_tHDR_pos_merge_df <- VHLx2rL4_tHDR_pos_merge_df %>% 
  rename(
    rL41_tHDR_pre_lib_pos_effects.x = VHLx2rL41_tHDR_pre_lib_pos_effects.x,
    rL42_tHDR_pre_lib_pos_effects.x = VHLx2rL42_tHDR_pre_lib_pos_effects.x,
    rL41rL42_tHDR_pre_lib_pos_effects.x = VHLx2rL41rL42_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rL41 vs. rL41_fit and vs. mean_fit)
VHLx2rL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41 <- log2(VHLx2rL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx2rL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_pos_effects.x
VHLx2rL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx2rL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx2rL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx2rL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42 <- log2(VHLx2rL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_ratio_synnorm) - VHLx2rL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_pos_effects.x
VHLx2rL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx2rL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_ratio_synnorm) - VHLx2rL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx2rL4_tHDR_pos_merge_df$rL41rL42_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx2rL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm) - VHLx2rL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx2rL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_loess_rL41 <- log2(VHLx2rL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx2rL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_pos_effects.x
VHLx2rL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx2rL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx2rL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx2rL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_loess_rL42 <- log2(VHLx2rL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_ratio_synnorm) - VHLx2rL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_pos_effects.x
VHLx2rL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx2rL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_ratio_synnorm) - VHLx2rL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx2rL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx2rL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm) - VHLx2rL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rL41 and rL42 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx2rL4_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx2rL4_tHDR_post_lib_loess_median_syn_rL41 <- median(VHLx2rL4_tHDR_pos_merge_df[which(VHLx2rL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rL41_tHDR_post_lib_loess_rL41')])
  VHLx2rL4_tHDR_post_lib_loess_median_syn_rL42 <- median(VHLx2rL4_tHDR_pos_merge_df[which(VHLx2rL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rL42_tHDR_post_lib_loess_rL42')])
  } else {
  VHLx2rL4_tHDR_post_lib_loess_median_syn_rL41 <- median(VHLx2rL4_tHDR_pos_merge_df[which(VHLx2rL4_tHDR_pos_merge_df$conseq != 'could be anything'),c('rL41_tHDR_post_lib_loess_rL41')])
  VHLx2rL4_tHDR_post_lib_loess_median_syn_rL42 <- median(VHLx2rL4_tHDR_pos_merge_df[which(VHLx2rL4_tHDR_pos_merge_df$conseq != 'could be anything'),c('rL42_tHDR_post_lib_loess_rL42')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rL41 'e.sns' = exon syn/ns norm.
VHLx2rL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41_e.sns <- (VHLx2rL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41-VHLx2rL4_tHDR_post_lib_loess_median_syn_rL41)
#calculate new b values for rL42 'e.sns' = exon syn/ns norm.
VHLx2rL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42_e.sns <- (VHLx2rL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42-VHLx2rL4_tHDR_post_lib_loess_median_syn_rL42)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx2rL4_tHDR_pos_merge_df$rL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean <- (VHLx2rL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41_e.sns+VHLx2rL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx2rL4_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx2rL4_tHDR_post_lib_loess_e.sns_rL41rL42_syn_median <- median(VHLx2rL4_tHDR_pos_merge_df[which(VHLx2rL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('VHLx2rL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean')])
  } else {
  VHLx2rL4_tHDR_post_lib_loess_e.sns_rL41rL42_syn_median <- median(VHLx2rL4_tHDR_pos_merge_df[which(VHLx2rL4_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('VHLx2rL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean')])
}

#RNA analysis
VHLx2rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx2rL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41_tHDR_rna2_rna_ratio <- VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_pseudo_freq/VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq
VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_rna_ratio <- VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_pseudo_freq/VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq
VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41rL42_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41_tHDR_rna2_rna_ratio)+log2(VHLx2rL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_rna_ratio))/2

```

```{r}
#VHLx1brL4
VHLx1brL41_file <- paste(experiment_dir_210729,'VHLx1brL41','_annotated.txt',sep='')
VHLx1brL42_file <- paste(experiment_dir_210729,'VHLx1brL42','_annotated.txt',sep='')
VHLx1brL41 <- read.table(VHLx1brL41_file, header=TRUE, sep="\t")
VHLx1brL42 <- read.table(VHLx1brL42_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx1brL41 <- VHLx1brL41 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

VHLx1brL42 <- VHLx1brL42 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx1b <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx1b'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx1b_HDR_5_SNV = as.character(VHL_editing_info_VHLx1b$HDR_5_SNV)
VHLx1b_HDR_3_SNV = as.character(VHL_editing_info_VHLx1b$HDR_3_SNV)
#VHLx1b_cut_pos = as.character(VHL_editing_info_VHLx1b$cut_pos)
VHLx1b_cut_end = as.character(VHL_editing_info_VHLx1b$cut_end)
VHLx1b_mut_start = as.character(VHL_editing_info_VHLx1b$mut_start)
VHLx1b_mut_end = as.character(VHL_editing_info_VHLx1b$mut_end)

### Replicate 1
VHLx1brL41_cSNV_all <- which(VHLx1brL41[,'c_hdr_snv']=='True')
VHLx1brL41_cSNV_all_df = VHLx1brL41[VHLx1brL41_cSNV_all,]
VHLx1brL41_prog_var_all <- which(VHLx1brL41[,'all_hdr_variant']=='True' & VHLx1brL41[,'edit_string']!='-WT')
VHLx1brL41_prog_var_all_df = VHLx1brL41[VHLx1brL41_prog_var_all,]
VHLx1brL41_prog_map_all = which(VHLx1brL41_prog_var_all_df[,'pos']!='REF')
VHLx1brL41_prog_map_all_df = VHLx1brL41_prog_var_all_df[VHLx1brL41_prog_map_all,]
VHLx1brL41_prog_map_exon_all = which(VHLx1brL41_prog_map_all_df[,'cDNApos']!='REF' & VHLx1brL41_prog_map_all_df[,'cDNApos']!='NA')
VHLx1brL41_prog_map_exon_all_df = VHLx1brL41_prog_map_all_df[VHLx1brL41_prog_map_exon_all,]
VHLx1brL41_prog_map_CADD = which(VHLx1brL41_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1brL41_prog_map_CADD_df = VHLx1brL41_prog_map_all_df[VHLx1brL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx1brL41_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1brL41_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx1brL41_prog_var_thresh5_df = VHLx1brL41_prog_var_all_df[VHLx1brL41_prog_var_thresh5,]
VHLx1brL41_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1brL41_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx1brL41_prog_map_thresh5_df = VHLx1brL41_prog_map_all_df[VHLx1brL41_prog_map_thresh5,]
VHLx1brL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1brL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx1brL41_prog_map_exon_thresh5_df = VHLx1brL41_prog_map_exon_all_df[VHLx1brL41_prog_map_exon_thresh5,]
VHLx1brL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1brL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx1brL41_prog_map_CADD_thresh5_df = VHLx1brL41_prog_map_CADD_df[VHLx1brL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1brL41_prog_var_all_lib_count = length(VHLx1brL41_prog_var_all_df$lib)
VHLx1brL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx1brL41_prog_var_all_min_lib_counts = min(VHLx1brL41_prog_var_all_df$lib)
VHLx1brL41_prog_var_all_min_lib_counts
VHLx1brL41_prog_var_all_max_lib_counts = max(VHLx1brL41_prog_var_all_df$lib)
VHLx1brL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1brL41_prog_map_all_lib_count = length(VHLx1brL41_prog_map_all_df$lib)
VHLx1brL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx1brL41_prog_map_all_min_lib_counts = min(VHLx1brL41_prog_map_all_df$lib)
VHLx1brL41_prog_map_all_min_lib_counts
VHLx1brL41_prog_map_all_max_lib_counts = max(VHLx1brL41_prog_map_all_df$lib)
VHLx1brL41_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx1brL41_prog_var_all_pre_count = length(VHLx1brL41_prog_var_all_df$pre)
VHLx1brL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx1brL41_prog_var_all_min_pre_counts = min(VHLx1brL41_prog_var_all_df$pre)
VHLx1brL41_prog_var_all_min_pre_counts
VHLx1brL41_prog_var_all_max_pre_counts = max(VHLx1brL41_prog_var_all_df$pre)
VHLx1brL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1brL41_prog_map_all_pre_count = length(VHLx1brL41_prog_map_all_df$pre)
VHLx1brL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx1brL41_prog_map_all_min_pre_counts = min(VHLx1brL41_prog_map_all_df$pre)
VHLx1brL41_prog_map_all_min_pre_counts
VHLx1brL41_prog_map_all_max_pre_counts = max(VHLx1brL41_prog_map_all_df$pre)
VHLx1brL41_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx1brL41_prog_map_all_post_count = length(VHLx1brL41_prog_map_all_df$post)
VHLx1brL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx1brL41_prog_map_all_min_post_counts = min(VHLx1brL41_prog_map_all_df$post)
VHLx1brL41_prog_map_all_min_post_counts
VHLx1brL41_prog_map_all_max_post_counts = max(VHLx1brL41_prog_map_all_df$post)
VHLx1brL41_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx1brL41_prog_map_all_syn_df <- VHLx1brL41_prog_map_all_df[which(VHLx1brL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1brL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1brL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1brL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1brL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1brL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1brL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1brL41_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1brL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx1brL41_prog_map_all_min_rna_counts = min(VHLx1brL41_prog_map_exon_all_df$tHDR_rna)
VHLx1brL41_prog_map_all_min_rna_counts
VHLx1brL41_prog_map_all_max_rna_counts = max(VHLx1brL41_prog_map_exon_all_df$tHDR_rna)
VHLx1brL41_prog_map_all_max_rna_counts
VHLx1brL41_prog_map_all_min_rna_pseudo_freq = min(VHLx1brL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1brL41_prog_map_all_min_rna_pseudo_freq
VHLx1brL41_prog_map_all_max_rna_pseudo_freq = max(VHLx1brL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1brL41_prog_map_all_max_rna_pseudo_freq
VHLx1brL41_prog_map_all_min_rna_pre_ratio = min(VHLx1brL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1brL41_prog_map_all_min_rna_pre_ratio
VHLx1brL41_prog_map_all_max_rna_pre_ratio = max(VHLx1brL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1brL41_prog_map_all_max_rna_pre_ratio
VHLx1brL41_prog_map_all_min_rna_post_ratio = min(VHLx1brL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1brL41_prog_map_all_min_rna_post_ratio
VHLx1brL41_prog_map_all_max_rna_post_ratio = max(VHLx1brL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1brL41_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1brL41_cSNV_all_corr_pre_count = length(VHLx1brL41_cSNV_all_df$corr_pre)
VHLx1brL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx1brL41_cSNV_all_min_corr_pre_counts = min(VHLx1brL41_cSNV_all_df$corr_pre)
VHLx1brL41_cSNV_all_min_corr_pre_counts
VHLx1brL41_cSNV_all_max_corr_pre_counts = max(VHLx1brL41_cSNV_all_df$corr_pre)
VHLx1brL41_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brL41_cSNV_all_corr_post_count = length(VHLx1brL41_cSNV_all_df$corr_post)
VHLx1brL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx1brL41_cSNV_all_min_corr_post_counts = min(VHLx1brL41_cSNV_all_df$corr_post)
VHLx1brL41_cSNV_all_min_corr_post_counts
VHLx1brL41_cSNV_all_max_corr_post_counts = max(VHLx1brL41_cSNV_all_df$corr_post)
VHLx1brL41_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx1b_p_hdr_snv = paste('p_hdr_',VHLx1b_cut_end,'_snv',sep='')
VHLx1brL41_pSNV_all <- which(VHLx1brL41[,VHLx1b_p_hdr_snv]=='True')
VHLx1brL41_pSNV_all_df = VHLx1brL41[VHLx1brL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brL41_pSNV_all_lib_count = length(VHLx1brL41_pSNV_all_df$lib)
VHLx1brL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx1brL41_pSNV_all_min_lib_counts = min(VHLx1brL41_pSNV_all_df$lib)
VHLx1brL41_pSNV_all_min_lib_counts
VHLx1brL41_pSNV_all_max_lib_counts = max(VHLx1brL41_pSNV_all_df$lib)
VHLx1brL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx1brL41_pSNV_all_pre_count = length(VHLx1brL41_pSNV_all_df$pre)
VHLx1brL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx1brL41_pSNV_all_min_pre_counts = min(VHLx1brL41_pSNV_all_df$pre)
VHLx1brL41_pSNV_all_min_pre_counts
VHLx1brL41_pSNV_all_max_pre_counts = max(VHLx1brL41_pSNV_all_df$pre)
VHLx1brL41_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brL41_pSNV_all_post_count = length(VHLx1brL41_pSNV_all_df$post)
VHLx1brL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx1brL41_pSNV_all_min_post_counts = min(VHLx1brL41_pSNV_all_df$post)
VHLx1brL41_pSNV_all_min_post_counts
VHLx1brL41_pSNV_all_max_post_counts = max(VHLx1brL41_pSNV_all_df$post)
VHLx1brL41_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brL41_prog_map_thresh5_lib_count = length(VHLx1brL41_prog_map_thresh5_df$lib)
VHLx1brL41_prog_map_thresh5_lib_count
VHLx1brL41_prog_map_thresh5_min_lib_counts = min(VHLx1brL41_prog_map_thresh5_df$lib)
VHLx1brL41_prog_map_thresh5_min_lib_counts
VHLx1brL41_prog_map_thresh5_max_lib_counts = max(VHLx1brL41_prog_map_thresh5_df$lib)
VHLx1brL41_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brL41_prog_map_thresh5_pre_count = length(VHLx1brL41_prog_map_thresh5_df$pre)
VHLx1brL41_prog_map_thresh5_pre_count
VHLx1brL41_prog_map_thresh5_min_pre_counts = min(VHLx1brL41_prog_map_thresh5_df$pre)
VHLx1brL41_prog_map_thresh5_min_pre_counts
VHLx1brL41_prog_map_thresh5_max_pre_counts = max(VHLx1brL41_prog_map_thresh5_df$pre)
VHLx1brL41_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1brL41_prog_map_thresh5_post_count = length(VHLx1brL41_prog_map_thresh5_df$post)
VHLx1brL41_prog_map_thresh5_post_count
VHLx1brL41_prog_map_thresh5_min_post_counts = min(VHLx1brL41_prog_map_thresh5_df$post)
VHLx1brL41_prog_map_thresh5_min_post_counts
VHLx1brL41_prog_map_thresh5_max_post_counts = max(VHLx1brL41_prog_map_thresh5_df$post)
VHLx1brL41_prog_map_thresh5_max_post_counts
VHLx1brL41_prog_map_thresh5_corr_post_count = length(VHLx1brL41_cSNV_all_df$corr_post)
VHLx1brL41_prog_map_thresh5_corr_post_count
VHLx1brL41_prog_map_thresh5_min_corr_post_counts = min(VHLx1brL41_cSNV_all_df$corr_post)
VHLx1brL41_prog_map_thresh5_min_corr_post_counts
VHLx1brL41_prog_map_thresh5_max_corr_post_counts = max(VHLx1brL41_cSNV_all_df$corr_post)
VHLx1brL41_prog_map_thresh5_max_corr_post_counts

VHLx1brL41_pSNV_thresh5 <- which(VHLx1brL41[,VHLx1b_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1brL41[,'pre_freq']))>=0.00001)
VHLx1brL41_pSNV_thresh5_df = VHLx1brL41[VHLx1brL41_pSNV_thresh5,]
VHLx1brL41_pSNV_thresh5_lib_count = length(VHLx1brL41_pSNV_thresh5_df$lib)
VHLx1brL41_pSNV_thresh5_lib_count
VHLx1brL41_pSNV_thresh5_min_lib_counts = min(VHLx1brL41_pSNV_thresh5_df$lib)
VHLx1brL41_pSNV_thresh5_min_lib_counts
VHLx1brL41_pSNV_thresh5_max_lib_counts = max(VHLx1brL41_pSNV_thresh5_df$lib)
VHLx1brL41_pSNV_thresh5_max_lib_counts
VHLx1brL41_pSNV_thresh5_pre_count = length(VHLx1brL41_pSNV_thresh5_df$pre)
VHLx1brL41_pSNV_thresh5_pre_count
VHLx1brL41_pSNV_thresh5_min_pre_counts = min(VHLx1brL41_pSNV_thresh5_df$pre)
VHLx1brL41_pSNV_thresh5_min_pre_counts
VHLx1brL41_pSNV_thresh5_max_pre_counts = max(VHLx1brL41_pSNV_thresh5_df$pre)
VHLx1brL41_pSNV_thresh5_max_pre_counts
VHLx1brL41_pSNV_thresh5_post_count = length(VHLx1brL41_pSNV_thresh5_df$post)
VHLx1brL41_pSNV_thresh5_post_count
VHLx1brL41_pSNV_thresh5_min_post_counts = min(VHLx1brL41_pSNV_thresh5_df$post)
VHLx1brL41_pSNV_thresh5_min_post_counts
VHLx1brL41_pSNV_thresh5_max_post_counts = max(VHLx1brL41_pSNV_thresh5_df$post)
VHLx1brL41_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx1brL42_cSNV_all <- which(VHLx1brL42[,'c_hdr_snv']=='True')
VHLx1brL42_cSNV_all_df = VHLx1brL42[VHLx1brL42_cSNV_all,]
VHLx1brL42_prog_var_all <- which(VHLx1brL42[,'all_hdr_variant']=='True' & VHLx1brL42[,'edit_string']!='-WT')
VHLx1brL42_prog_var_all_df = VHLx1brL42[VHLx1brL42_prog_var_all,]
VHLx1brL42_prog_map_all = which(VHLx1brL42_prog_var_all_df[,'pos']!='REF')
VHLx1brL42_prog_map_all_df = VHLx1brL42_prog_var_all_df[VHLx1brL42_prog_map_all,]
VHLx1brL42_prog_map_exon_all = which(VHLx1brL42_prog_map_all_df[,'cDNApos']!='REF' & VHLx1brL42_prog_map_all_df[,'cDNApos']!='NA')
VHLx1brL42_prog_map_exon_all_df = VHLx1brL42_prog_map_all_df[VHLx1brL42_prog_map_exon_all,]
VHLx1brL42_prog_map_CADD = which(VHLx1brL42_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1brL42_prog_map_CADD_df = VHLx1brL42_prog_map_all_df[VHLx1brL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx1brL42_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1brL42_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx1brL42_prog_var_thresh5_df = VHLx1brL42_prog_var_all_df[VHLx1brL42_prog_var_thresh5,]
VHLx1brL42_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1brL42_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx1brL42_prog_map_thresh5_df = VHLx1brL42_prog_map_all_df[VHLx1brL42_prog_map_thresh5,]
VHLx1brL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1brL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx1brL42_prog_map_exon_thresh5_df = VHLx1brL42_prog_map_exon_all_df[VHLx1brL42_prog_map_exon_thresh5,]
VHLx1brL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1brL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx1brL42_prog_map_CADD_thresh5_df = VHLx1brL42_prog_map_CADD_df[VHLx1brL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1brL42_prog_var_all_lib_count = length(VHLx1brL42_prog_var_all_df$lib)
VHLx1brL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx1brL42_prog_var_all_min_lib_counts = min(VHLx1brL42_prog_var_all_df$lib)
VHLx1brL42_prog_var_all_min_lib_counts
VHLx1brL42_prog_var_all_max_lib_counts = max(VHLx1brL42_prog_var_all_df$lib)
VHLx1brL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1brL42_prog_map_all_lib_count = length(VHLx1brL42_prog_map_all_df$lib)
VHLx1brL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx1brL42_prog_map_all_min_lib_counts = min(VHLx1brL42_prog_map_all_df$lib)
VHLx1brL42_prog_map_all_min_lib_counts
VHLx1brL42_prog_map_all_max_lib_counts = max(VHLx1brL42_prog_map_all_df$lib)
VHLx1brL42_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx1brL42_prog_var_all_pre_count = length(VHLx1brL42_prog_var_all_df$pre)
VHLx1brL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx1brL42_prog_var_all_min_pre_counts = min(VHLx1brL42_prog_var_all_df$pre)
VHLx1brL42_prog_var_all_min_pre_counts
VHLx1brL42_prog_var_all_max_pre_counts = max(VHLx1brL42_prog_var_all_df$pre)
VHLx1brL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1brL42_prog_map_all_pre_count = length(VHLx1brL42_prog_map_all_df$pre)
VHLx1brL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx1brL42_prog_map_all_min_pre_counts = min(VHLx1brL42_prog_map_all_df$pre)
VHLx1brL42_prog_map_all_min_pre_counts
VHLx1brL42_prog_map_all_max_pre_counts = max(VHLx1brL42_prog_map_all_df$pre)
VHLx1brL42_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx1brL42_prog_map_all_post_count = length(VHLx1brL42_prog_map_all_df$post)
VHLx1brL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx1brL42_prog_map_all_min_post_counts = min(VHLx1brL42_prog_map_all_df$post)
VHLx1brL42_prog_map_all_min_post_counts
VHLx1brL42_prog_map_all_max_post_counts = max(VHLx1brL42_prog_map_all_df$post)
VHLx1brL42_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx1brL42_prog_map_all_syn_df <- VHLx1brL42_prog_map_all_df[which(VHLx1brL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1brL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1brL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1brL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1brL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1brL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1brL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1brL42_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1brL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx1brL42_prog_map_all_min_rna_counts = min(VHLx1brL42_prog_map_exon_all_df$tHDR_rna)
VHLx1brL42_prog_map_all_min_rna_counts
VHLx1brL42_prog_map_all_max_rna_counts = max(VHLx1brL42_prog_map_exon_all_df$tHDR_rna)
VHLx1brL42_prog_map_all_max_rna_counts
VHLx1brL42_prog_map_all_min_rna_pseudo_freq = min(VHLx1brL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1brL42_prog_map_all_min_rna_pseudo_freq
VHLx1brL42_prog_map_all_max_rna_pseudo_freq = max(VHLx1brL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1brL42_prog_map_all_max_rna_pseudo_freq
VHLx1brL42_prog_map_all_min_rna_pre_ratio = min(VHLx1brL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1brL42_prog_map_all_min_rna_pre_ratio
VHLx1brL42_prog_map_all_max_rna_pre_ratio = max(VHLx1brL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1brL42_prog_map_all_max_rna_pre_ratio
VHLx1brL42_prog_map_all_min_rna_post_ratio = min(VHLx1brL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1brL42_prog_map_all_min_rna_post_ratio
VHLx1brL42_prog_map_all_max_rna_post_ratio = max(VHLx1brL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1brL42_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1brL42_cSNV_all_corr_pre_count = length(VHLx1brL42_cSNV_all_df$corr_pre)
VHLx1brL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx1brL42_cSNV_all_min_corr_pre_counts = min(VHLx1brL42_cSNV_all_df$corr_pre)
VHLx1brL42_cSNV_all_min_corr_pre_counts
VHLx1brL42_cSNV_all_max_corr_pre_counts = max(VHLx1brL42_cSNV_all_df$corr_pre)
VHLx1brL42_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brL42_cSNV_all_corr_post_count = length(VHLx1brL42_cSNV_all_df$corr_post)
VHLx1brL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx1brL42_cSNV_all_min_corr_post_counts = min(VHLx1brL42_cSNV_all_df$corr_post)
VHLx1brL42_cSNV_all_min_corr_post_counts
VHLx1brL42_cSNV_all_max_corr_post_counts = max(VHLx1brL42_cSNV_all_df$corr_post)
VHLx1brL42_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx1b_p_hdr_snv = paste('p_hdr_',VHLx1b_cut_end,'_snv',sep='')
VHLx1brL42_pSNV_all <- which(VHLx1brL42[,VHLx1b_p_hdr_snv]=='True')
VHLx1brL42_pSNV_all_df = VHLx1brL42[VHLx1brL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brL42_pSNV_all_lib_count = length(VHLx1brL42_pSNV_all_df$lib)
VHLx1brL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx1brL42_pSNV_all_min_lib_counts = min(VHLx1brL42_pSNV_all_df$lib)
VHLx1brL42_pSNV_all_min_lib_counts
VHLx1brL42_pSNV_all_max_lib_counts = max(VHLx1brL42_pSNV_all_df$lib)
VHLx1brL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx1brL42_pSNV_all_pre_count = length(VHLx1brL42_pSNV_all_df$pre)
VHLx1brL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx1brL42_pSNV_all_min_pre_counts = min(VHLx1brL42_pSNV_all_df$pre)
VHLx1brL42_pSNV_all_min_pre_counts
VHLx1brL42_pSNV_all_max_pre_counts = max(VHLx1brL42_pSNV_all_df$pre)
VHLx1brL42_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brL42_pSNV_all_post_count = length(VHLx1brL42_pSNV_all_df$post)
VHLx1brL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx1brL42_pSNV_all_min_post_counts = min(VHLx1brL42_pSNV_all_df$post)
VHLx1brL42_pSNV_all_min_post_counts
VHLx1brL42_pSNV_all_max_post_counts = max(VHLx1brL42_pSNV_all_df$post)
VHLx1brL42_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brL42_prog_map_thresh5_lib_count = length(VHLx1brL42_prog_map_thresh5_df$lib)
VHLx1brL42_prog_map_thresh5_lib_count
VHLx1brL42_prog_map_thresh5_min_lib_counts = min(VHLx1brL42_prog_map_thresh5_df$lib)
VHLx1brL42_prog_map_thresh5_min_lib_counts
VHLx1brL42_prog_map_thresh5_max_lib_counts = max(VHLx1brL42_prog_map_thresh5_df$lib)
VHLx1brL42_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx1b less than SGE region length x 3 due to PAM edits
VHLx1brL42_prog_map_thresh5_pre_count = length(VHLx1brL42_prog_map_thresh5_df$pre)
VHLx1brL42_prog_map_thresh5_pre_count
VHLx1brL42_prog_map_thresh5_min_pre_counts = min(VHLx1brL42_prog_map_thresh5_df$pre)
VHLx1brL42_prog_map_thresh5_min_pre_counts
VHLx1brL42_prog_map_thresh5_max_pre_counts = max(VHLx1brL42_prog_map_thresh5_df$pre)
VHLx1brL42_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1brL42_prog_map_thresh5_post_count = length(VHLx1brL42_prog_map_thresh5_df$post)
VHLx1brL42_prog_map_thresh5_post_count
VHLx1brL42_prog_map_thresh5_min_post_counts = min(VHLx1brL42_prog_map_thresh5_df$post)
VHLx1brL42_prog_map_thresh5_min_post_counts
VHLx1brL42_prog_map_thresh5_max_post_counts = max(VHLx1brL42_prog_map_thresh5_df$post)
VHLx1brL42_prog_map_thresh5_max_post_counts
VHLx1brL42_prog_map_thresh5_corr_post_count = length(VHLx1brL42_cSNV_all_df$corr_post)
VHLx1brL42_prog_map_thresh5_corr_post_count
VHLx1brL42_prog_map_thresh5_min_corr_post_counts = min(VHLx1brL42_cSNV_all_df$corr_post)
VHLx1brL42_prog_map_thresh5_min_corr_post_counts
VHLx1brL42_prog_map_thresh5_max_corr_post_counts = max(VHLx1brL42_cSNV_all_df$corr_post)
VHLx1brL42_prog_map_thresh5_max_corr_post_counts

VHLx1brL42_pSNV_thresh5 <- which(VHLx1brL42[,VHLx1b_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1brL42[,'pre_freq']))>=0.00001)
VHLx1brL42_pSNV_thresh5_df = VHLx1brL42[VHLx1brL42_pSNV_thresh5,]
VHLx1brL42_pSNV_thresh5_lib_count = length(VHLx1brL42_pSNV_thresh5_df$lib)
VHLx1brL42_pSNV_thresh5_lib_count
VHLx1brL42_pSNV_thresh5_min_lib_counts = min(VHLx1brL42_pSNV_thresh5_df$lib)
VHLx1brL42_pSNV_thresh5_min_lib_counts
VHLx1brL42_pSNV_thresh5_max_lib_counts = max(VHLx1brL42_pSNV_thresh5_df$lib)
VHLx1brL42_pSNV_thresh5_max_lib_counts
VHLx1brL42_pSNV_thresh5_pre_count = length(VHLx1brL42_pSNV_thresh5_df$pre)
VHLx1brL42_pSNV_thresh5_pre_count
VHLx1brL42_pSNV_thresh5_min_pre_counts = min(VHLx1brL42_pSNV_thresh5_df$pre)
VHLx1brL42_pSNV_thresh5_min_pre_counts
VHLx1brL42_pSNV_thresh5_max_pre_counts = max(VHLx1brL42_pSNV_thresh5_df$pre)
VHLx1brL42_pSNV_thresh5_max_pre_counts
VHLx1brL42_pSNV_thresh5_post_count = length(VHLx1brL42_pSNV_thresh5_df$post)
VHLx1brL42_pSNV_thresh5_post_count
VHLx1brL42_pSNV_thresh5_min_post_counts = min(VHLx1brL42_pSNV_thresh5_df$post)
VHLx1brL42_pSNV_thresh5_min_post_counts
VHLx1brL42_pSNV_thresh5_max_post_counts = max(VHLx1brL42_pSNV_thresh5_df$post)
VHLx1brL42_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx1brL41_prog_var_thresh5_df:
VHLx1brL41_prog_var_thresh5_df_rL42_int <- VHLx1brL41_prog_var_thresh5_df[which(VHLx1brL41_prog_var_thresh5_df$variant %in% VHLx1brL42_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx1brL42_prog_var_thresh5_df:
VHLx1brL42_prog_var_thresh5_df_rL41_int <- VHLx1brL42_prog_var_thresh5_df[which(VHLx1brL42_prog_var_thresh5_df$variant %in% VHLx1brL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord <- VHLx1brL41_prog_var_thresh5_df_rL42_int[order(VHLx1brL41_prog_var_thresh5_df_rL42_int$variant),]
VHLx1brL42_prog_var_thresh5_df_rL41_int_ord <- VHLx1brL42_prog_var_thresh5_df_rL41_int[order(VHLx1brL42_prog_var_thresh5_df_rL41_int$variant),]
dim(VHLx1brL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
VHLx1brL41rL42int_prog_var_thresh5_pre_count <- dim(VHLx1brL41_prog_var_thresh5_df_rL42_int)[1] 
VHLx1brL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(VHLx1brL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(VHLx1brL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41

#Add the following columns from the from rL42 df to the rL41 df:
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$pre
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$lib
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$rna
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2 <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post2
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3 <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post3
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2 <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$rna2
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pseudo <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post2_pseudo
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pseudo <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post3_pseudo
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_pseudo <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$rna2_pseudo
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post2_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post3_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$rna2_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pseudo_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post2_pseudo_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pseudo_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post3_pseudo_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_pseudo_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$rna2_pseudo_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post2_pre_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pre_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post3_pre_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$rna2_post_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$corr_post
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2 <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3 <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2 <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pseudo_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2_pseudo_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pseudo_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3_pseudo_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_pseudo_freq <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2_pseudo_freq
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2_pre_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pre_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3_pre_ratio
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio <- VHLx1brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio) + log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio))/2)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio) + log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio))/2)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio) + log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio))/2)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio) + log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio))/2)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post3_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post3_pre_ratio) + log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pre_ratio))/2)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rna2_post_ratio_rL41rL42_mean <- 2^((log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rna2_post_ratio) + log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio))/2)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio) + log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio))/2)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio) + log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio))/2)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio) + log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio))/2)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio) + log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio))/2)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- 2^((log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio) + log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio))/2)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio) + log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio))/2)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post3_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post3_pre_ratio) + log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pre_ratio))/2)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean <- 2^((log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio) + log2(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq)) >= 10) {
    VHLx1brL41_cSNV_pre_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx1brL41_cSNV_post_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx1brL41_cSNV_post2_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx1brL41_cSNV_post_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx1brL41_tSNV_pre_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx1brL41_tSNV_post_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx1brL41_tSNV_post_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx1brL41_tSNV_rna_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx1brL41_tSNV_rna_post_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx1brL41_tSNV_rna2_post_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx1brL42_cSNV_pre_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_pre_lib_ratio)
VHLx1brL42_cSNV_post_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post_pre_ratio)
VHLx1brL42_cSNV_post2_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post2_pre_ratio)

VHLx1brL42_cSNV_post_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post_lib_ratio)
VHLx1brL42_tSNV_pre_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_pre_lib_ratio)
VHLx1brL42_tSNV_post_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post_pre_ratio)
VHLx1brL42_tSNV_post2_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post2_pre_ratio)
VHLx1brL42_tSNV_post_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post_lib_ratio)
VHLx1brL42_tSNV_rna_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna_pre_ratio)
VHLx1brL42_tSNV_rna_post_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna_post_ratio)
VHLx1brL42_tSNV_rna2_post_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna2_post_ratio)
VHLx1brL41rL42a_cSNV_pre_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rL41rL42_mean)
VHLx1brL41rL42a_cSNV_post_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rL41rL42_mean)
VHLx1brL41rL42a_cSNV_post2_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rL41rL42_mean)
VHLx1brL41rL42a_cSNV_post_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rL41rL42_mean)
VHLx1brL41rL42a_tSNV_pre_lib_med <- 
  median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rL41rL42_mean)
VHLx1brL41rL42a_tSNV_post_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rL41rL42_mean)
VHLx1brL41rL42a_tSNV_post2_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rL41rL42_mean)
VHLx1brL41rL42a_tSNV_post_lib_med <-
  median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rL41rL42_mean)
VHLx1brL41rL42a_tSNV_rna_pre_med <-
  median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rL41rL42_mean)
VHLx1brL41rL42a_tSNV_rna_post_med <-
  median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rL41rL42_mean)
VHLx1brL41rL42a_tSNV_rna2_post_med <-
  median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rL41rL42_mean)
VHLx1brL41rL42pw_tSNV_post_pre_med  <-
  median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
VHLx1brL41rL42pw_cSNV_post_pre_med  <-
  median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rL41rL42_pre_weighted)
  } else {
  VHLx1brL41_cSNV_pre_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio)
VHLx1brL41_cSNV_post_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio)
VHLx1brL41_cSNV_post2_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio)
VHLx1brL41_cSNV_post_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio)
VHLx1brL41_tSNV_pre_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio)
VHLx1brL41_tSNV_post_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio)
VHLx1brL41_tSNV_post_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio)
VHLx1brL41_tSNV_rna_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio)
VHLx1brL41_tSNV_rna_post_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio)
VHLx1brL41_tSNV_rna2_post_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio)
VHLx1brL42_cSNV_pre_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)
VHLx1brL42_cSNV_post_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)
VHLx1brL42_cSNV_post2_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio)

VHLx1brL42_cSNV_post_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)
VHLx1brL42_tSNV_pre_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)
VHLx1brL42_tSNV_post_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)
VHLx1brL42_tSNV_post2_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio)
VHLx1brL42_tSNV_post_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)
VHLx1brL42_tSNV_rna_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)
VHLx1brL42_tSNV_rna_post_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)
VHLx1brL42_tSNV_rna2_post_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio)
VHLx1brL41rL42a_cSNV_pre_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean)
VHLx1brL41rL42a_cSNV_post_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean)
VHLx1brL41rL42a_cSNV_post2_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_rL41rL42_mean)
VHLx1brL41rL42a_cSNV_post_lib_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean)
VHLx1brL41rL42a_tSNV_pre_lib_med <- 
  median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean)
VHLx1brL41rL42a_tSNV_post_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean)
VHLx1brL41rL42a_tSNV_post2_pre_med <- median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean)
VHLx1brL41rL42a_tSNV_post_lib_med <-
  median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean)
VHLx1brL41rL42a_tSNV_rna_pre_med <-
  median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean)
VHLx1brL41rL42a_tSNV_rna_post_med <-
  median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean)
VHLx1brL41rL42a_tSNV_rna2_post_med <-
  median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean)
VHLx1brL41rL42pw_tSNV_post_pre_med  <-
  median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
VHLx1brL41rL42pw_cSNV_post_pre_med  <-
  median(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted)
}

VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/VHLx1brL41_cSNV_pre_lib_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/VHLx1brL41_cSNV_post_pre_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/VHLx1brL41_cSNV_post_lib_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio/VHLx1brL41_cSNV_post2_pre_med

VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/VHLx1brL41_tSNV_pre_lib_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/VHLx1brL41_tSNV_post_pre_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/VHLx1brL41_tSNV_post_lib_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/VHLx1brL41_tSNV_rna_pre_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/VHLx1brL41_tSNV_rna_post_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio/VHLx1brL42_tSNV_post2_pre_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio/VHLx1brL41_tSNV_rna2_post_med

VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/VHLx1brL42_cSNV_pre_lib_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/VHLx1brL42_cSNV_post_pre_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/VHLx1brL42_cSNV_post_lib_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio/VHLx1brL41rL42a_cSNV_post2_pre_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio/VHLx1brL42_tSNV_rna2_post_med


VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/VHLx1brL42_tSNV_pre_lib_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/VHLx1brL42_tSNV_post_pre_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio/VHLx1brL42_tSNV_post2_pre_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/VHLx1brL42_tSNV_post_lib_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/VHLx1brL42_tSNV_rna_pre_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/VHLx1brL42_tSNV_rna_post_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio/VHLx1brL42_tSNV_rna2_post_med

###normalize the means
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/VHLx1brL41rL42a_cSNV_pre_lib_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/VHLx1brL41rL42a_cSNV_post_pre_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/VHLx1brL41rL42a_cSNV_post_lib_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/VHLx1brL41rL42a_tSNV_pre_lib_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/VHLx1brL41rL42a_tSNV_post_pre_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean/VHLx1brL41rL42a_tSNV_post2_pre_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/VHLx1brL41rL42a_tSNV_post_lib_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/VHLx1brL41rL42a_tSNV_rna_pre_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/VHLx1brL41rL42a_tSNV_rna_post_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean/VHLx1brL41rL42a_tSNV_rna2_post_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/VHLx1brL41rL42pw_tSNV_post_pre_med
VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- VHLx1brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/VHLx1brL41rL42pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx1brL41_prog_var_thresh5_df_rL42_int_ord
VHLx1brL41_prog_map_thresh5_df_rL42_int_ord = which(VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df = VHLx1brL41_prog_var_thresh5_df_rL42_int_ord[VHLx1brL41_prog_map_thresh5_df_rL42_int_ord,]
VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord = which(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df = VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df[VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord,]
VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df[VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord,]
VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx1brL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
VHLx1brL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
VHLx1brL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
VHLx1brL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p
VHLx1brL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
VHLx1brL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
VHLx1brL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
VHLx1brL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p
VHLx1brL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post2_pre_ratio_synnorm),method='spearman')
VHLx1brL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s
VHLx1brL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_p <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post2_pre_ratio_synnorm),method='pearson')
VHLx1brL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_p
VHLx1brL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1brL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
VHLx1brL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx1brL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p
VHLx1brL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1brL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
VHLx1brL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx1brL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p
VHLx1brL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1brL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
VHLx1brL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx1brL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p
VHLx1brL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_s <- cor(log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1brL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_s
VHLx1brL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_p <- cor(log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx1brL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_p
VHLx1brL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
VHLx1brL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
VHLx1brL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$post_pseudo_freq),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pseudo_freq),method='pearson')
VHLx1brL41rL42_cSNV_rL41_post_by_rL42_post_cor_p
VHLx1brL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
VHLx1brL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
VHLx1brL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
VHLx1brL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p
VHLx1brL41rL42_tSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx1brL41rL42_tSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s
VHLx1brL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1brL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
VHLx1brL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1brL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
VHLx1brL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1brL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s
VHLx1brL41rL42_tSNV_rL41_rna2_post_by_rL42_rna2_post_cor_s <- cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1brL41rL42_tSNV_rL41_rna2_post_by_rL42_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx1brL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41_cSNV_post_pre_by_cadd_cor_s
VHLx1brL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL42_cSNV_post_pre_by_cadd_cor_s
VHLx1brL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41_cSNV_post_lib_by_cadd_cor_s
VHLx1brL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL42_cSNV_post_lib_by_cadd_cor_s
VHLx1brL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41_tSNV_post_pre_by_cadd_cor_s
VHLx1brL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL42_tSNV_post_pre_by_cadd_cor_s
VHLx1brL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41_tSNV_post_lib_by_cadd_cor_s
VHLx1brL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx1brL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42a_cSNV_pre_lib_by_cadd_cor_s
VHLx1brL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42w_cSNV_pre_lib_by_cadd_cor_s
VHLx1brL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42a_cSNV_post_pre_by_cadd_cor_s
VHLx1brL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42w_cSNV_post_pre_by_cadd_cor_s
VHLx1brL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42a_cSNV_post_lib_by_cadd_cor_s
VHLx1brL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42w_cSNV_post_lib_by_cadd_cor_s
VHLx1brL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42a_tSNV_pre_lib_by_cadd_cor_s
VHLx1brL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42a_tSNV_post_pre_by_cadd_cor_s
VHLx1brL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42w_tSNV_post_pre_by_cadd_cor_s
VHLx1brL41rL42a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post2_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42a_tSNV_post2_pre_by_cadd_cor_s
VHLx1brL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx1brL41_cSNV_pre_lib_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1brL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1brL41_tSNV_pre_lib_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1brL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1brL41_cSNV_post_lib_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1brL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1brL41_tSNV_post_lib_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1brL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1brL41_cSNV_post_pre_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1brL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1brL41_tSNV_post_pre_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1brL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1brL41_cSNV_rna_lib_cors = cor(log2(VHLx1brL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1brL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1brL41_tSNV_rna_lib_cors = cor(log2(VHLx1brL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1brL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1brL41_cSNV_rna_pre_cors = cor(log2(VHLx1brL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1brL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1brL41_tSNV_rna_pre_cors = cor(log2(VHLx1brL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1brL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1brL41rL42_cSNV_pre_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
VHLx1brL41rL42_tSNV_pre_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
VHLx1brL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
VHLx1brL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
VHLx1brL41rL42_cSNV_post_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
VHLx1brL41rL42_tSNV_post_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
VHLx1brL41rL42_cSNV_post_lib_ratio_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
VHLx1brL41rL42_tSNV_post_lib_ratio_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1brL41rL42_cSNV_post_pre_ratio_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
VHLx1brL41rL42_tSNV_post_pre_ratio_cors = cor(log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1brL41rL42_cSNV_rna_cors = cor(log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
VHLx1brL41rL42_tSNV_rna_cors = cor(log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
VHLx1brL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1brL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1brL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1brL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1brL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1brL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1brL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1brL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1brL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1brL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1brL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1brL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1brL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1brL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1brL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

VHLx1brL41_cors <- c("VHLx1brL41",VHLx1brL41_cSNV_pre_lib_cors,VHLx1brL41_tSNV_pre_lib_cors,VHLx1brL41_cSNV_post_lib_cors,VHLx1brL41_tSNV_post_lib_cors,VHLx1brL41_cSNV_post_pre_cors,VHLx1brL41_tSNV_post_pre_cors,VHLx1brL41_cSNV_rna_lib_cors,VHLx1brL41_tSNV_rna_lib_cors,VHLx1brL41_cSNV_rna_pre_cors,VHLx1brL41_tSNV_rna_pre_cors,VHLx1brL41rL42_cSNV_pre_cors,VHLx1brL41rL42_tSNV_pre_cors,VHLx1brL41rL42_cSNV_pre_lib_ratio_cors,VHLx1brL41rL42_tSNV_pre_lib_ratio_cors,VHLx1brL41rL42_cSNV_post_cors,VHLx1brL41rL42_tSNV_post_cors,VHLx1brL41rL42_cSNV_post_lib_ratio_cors,VHLx1brL41rL42_tSNV_post_lib_ratio_cors,VHLx1brL41rL42_cSNV_post_pre_ratio_cors,VHLx1brL41rL42_tSNV_post_pre_ratio_cors,VHLx1brL41rL42_cSNV_rna_cors,VHLx1brL41rL42_tSNV_rna_cors,VHLx1brL41rL42_tSNV_rna_pre_ratio_cors,VHLx1brL41_cSNV_pre_lib_ratio_cadd_cors,VHLx1brL41_tSNV_pre_lib_ratio_cadd_cors,VHLx1brL41_cSNV_post_lib_ratio_cadd_cors,VHLx1brL41_tSNV_post_lib_ratio_cadd_cors,VHLx1brL41_cSNV_post_pre_ratio_cadd_cors,VHLx1brL41_tSNV_post_pre_ratio_cadd_cors,VHLx1brL41_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1brL41_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1brL41_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brL41_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brL41_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1brL41_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1brL41rL42a_cSNV_pre_lib_ratio_cadd_cors,VHLx1brL41rL42a_tSNV_pre_lib_ratio_cadd_cors,VHLx1brL41rL42a_cSNV_post_lib_ratio_cadd_cors,VHLx1brL41rL42a_tSNV_post_lib_ratio_cadd_cors,VHLx1brL41rL42a_cSNV_post_pre_ratio_cadd_cors,VHLx1brL41rL42a_tSNV_post_pre_ratio_cadd_cors,VHLx1brL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1brL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1brL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1brL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1brL41rL42w_cSNV_pre_lib_ratio_cadd_cors,VHLx1brL41rL42w_cSNV_post_lib_ratio_cadd_cors,VHLx1brL41rL42w_cSNV_post_pre_ratio_cadd_cors,VHLx1brL41rL42w_tSNV_post_pre_ratio_cadd_cors)

VHLx1brL42_cSNV_pre_lib_cors = cor(log2(VHLx1brL42_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1brL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1brL42_tSNV_pre_lib_cors = cor(log2(VHLx1brL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1brL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1brL42_cSNV_post_lib_cors = cor(log2(VHLx1brL42_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1brL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1brL42_tSNV_post_lib_cors = cor(log2(VHLx1brL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1brL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1brL42_cSNV_post_pre_cors = cor(log2(VHLx1brL42_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1brL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1brL42_tSNV_post_pre_cors = cor(log2(VHLx1brL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1brL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1brL42_cSNV_rna_lib_cors = cor(log2(VHLx1brL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1brL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1brL42_tSNV_rna_lib_cors = cor(log2(VHLx1brL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1brL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1brL42_cSNV_rna_pre_cors = cor(log2(VHLx1brL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1brL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1brL42_tSNV_rna_pre_cors = cor(log2(VHLx1brL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1brL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1brL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1brL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1brL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1brL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1brL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1brL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1brL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1brL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1brL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1brL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1brL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1brL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1brL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1brL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1brL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1brL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1brL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

VHLx1brL42_cors <- c("VHLx1brL42",VHLx1brL42_cSNV_pre_lib_cors,VHLx1brL42_tSNV_pre_lib_cors,VHLx1brL42_cSNV_post_lib_cors,VHLx1brL42_tSNV_post_lib_cors,VHLx1brL42_cSNV_post_pre_cors,VHLx1brL42_tSNV_post_pre_cors,VHLx1brL42_cSNV_rna_lib_cors,VHLx1brL42_tSNV_rna_lib_cors,VHLx1brL42_cSNV_rna_pre_cors,VHLx1brL42_tSNV_rna_pre_cors,VHLx1brL41rL42_cSNV_pre_cors,VHLx1brL41rL42_tSNV_pre_cors,VHLx1brL41rL42_cSNV_pre_lib_ratio_cors,VHLx1brL41rL42_tSNV_pre_lib_ratio_cors,VHLx1brL41rL42_cSNV_post_cors,VHLx1brL41rL42_tSNV_post_cors,VHLx1brL41rL42_cSNV_post_lib_ratio_cors,VHLx1brL41rL42_tSNV_post_lib_ratio_cors,VHLx1brL41rL42_cSNV_post_pre_ratio_cors,VHLx1brL41rL42_tSNV_post_pre_ratio_cors,VHLx1brL41rL42_cSNV_rna_cors,VHLx1brL41rL42_tSNV_rna_cors,VHLx1brL41rL42_tSNV_rna_pre_ratio_cors,VHLx1brL42_cSNV_pre_lib_ratio_cadd_cors,VHLx1brL42_tSNV_pre_lib_ratio_cadd_cors,VHLx1brL42_cSNV_post_lib_ratio_cadd_cors,VHLx1brL42_tSNV_post_lib_ratio_cadd_cors,VHLx1brL42_cSNV_post_pre_ratio_cadd_cors,VHLx1brL42_tSNV_post_pre_ratio_cadd_cors,VHLx1brL42_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1brL42_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1brL42_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brL42_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brL42_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1brL42_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1brL41rL42a_cSNV_pre_lib_ratio_cadd_cors,VHLx1brL41rL42a_tSNV_pre_lib_ratio_cadd_cors,VHLx1brL41rL42a_cSNV_post_lib_ratio_cadd_cors,VHLx1brL41rL42a_tSNV_post_lib_ratio_cadd_cors,VHLx1brL41rL42a_cSNV_post_pre_ratio_cadd_cors,VHLx1brL41rL42a_tSNV_post_pre_ratio_cadd_cors,VHLx1brL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1brL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1brL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1brL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1brL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1brL41rL42w_cSNV_pre_lib_ratio_cadd_cors,VHLx1brL41rL42w_cSNV_post_lib_ratio_cadd_cors,VHLx1brL41rL42w_cSNV_post_pre_ratio_cadd_cors,VHLx1brL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx1brL41)
rm(VHLx1brL42)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx1brL41
VHLx1b_posrange <- range(as.numeric(as.character(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$pos)))
VHLx1b_posseq <- seq(from=VHLx1b_posrange[1], to=VHLx1b_posrange[2])
VHLx1brL41_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1brL41_tHDR_pre_lib_pred <- predict(VHLx1brL41_tHDR_pre_lib_ratio.lo, newdata = VHLx1b_posseq, se=TRUE)
VHLx1brL41_tHDR_pre_lib_pos_effects <- VHLx1brL41_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1brL41_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1brL41_tHDR_pre_lib_pos_effects)
VHLx1brL41_tHDR_pre_lib_pos_effects_ci <- VHLx1brL41_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1brL41_tHDR_pre_lib_pred$df)
VHLx1brL41_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1brL41_tHDR_pre_lib_pos_effects - VHLx1brL41_tHDR_pre_lib_pos_effects_ci
VHLx1brL41_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1brL41_tHDR_pre_lib_pos_effects + VHLx1brL41_tHDR_pre_lib_pos_effects_ci
VHLx1brL41_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1b_posseq, VHLx1brL41_tHDR_pre_lib_pos_effects, VHLx1brL41_tHDR_pre_lib_pos_effects.x, VHLx1brL41_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1brL41_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1brL41_tHDR_pre_lib_pred_se = VHLx1brL41_tHDR_pre_lib_pred$se.fit)
#VHLx1brL42
VHLx1brL42_tHDR_pre_lib_ratio.lo <- loess(log2(rL42_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1brL42_tHDR_pre_lib_pred <- predict(VHLx1brL42_tHDR_pre_lib_ratio.lo, newdata = VHLx1b_posseq, se=TRUE)
VHLx1brL42_tHDR_pre_lib_pos_effects <- VHLx1brL42_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1brL42_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1brL42_tHDR_pre_lib_pos_effects)
VHLx1brL42_tHDR_pre_lib_pos_effects_ci <- VHLx1brL42_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1brL42_tHDR_pre_lib_pred$df)
VHLx1brL42_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1brL42_tHDR_pre_lib_pos_effects - VHLx1brL42_tHDR_pre_lib_pos_effects_ci
VHLx1brL42_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1brL42_tHDR_pre_lib_pos_effects + VHLx1brL42_tHDR_pre_lib_pos_effects_ci
VHLx1brL42_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1b_posseq, VHLx1brL42_tHDR_pre_lib_pos_effects, VHLx1brL42_tHDR_pre_lib_pos_effects.x, VHLx1brL42_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1brL42_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1brL42_tHDR_pre_lib_pred_se = VHLx1brL42_tHDR_pre_lib_pred$se.fit)

#VHLx1brL41rL42
VHLx1brL41rL42_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rL41rL42_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm > 0.7 & VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm > 0.3 & VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1brL41rL42_tHDR_pre_lib_pred <- predict(VHLx1brL41rL42_tHDR_pre_lib_ratio.lo, newdata = VHLx1b_posseq, se=TRUE)
VHLx1brL41rL42_tHDR_pre_lib_pos_effects <- VHLx1brL41rL42_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1brL41rL42_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1brL41rL42_tHDR_pre_lib_pos_effects)
VHLx1brL41rL42_tHDR_pre_lib_pos_effects_ci <- VHLx1brL41rL42_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1brL41rL42_tHDR_pre_lib_pred$df)
VHLx1brL41rL42_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1brL41rL42_tHDR_pre_lib_pos_effects - VHLx1brL41rL42_tHDR_pre_lib_pos_effects_ci
VHLx1brL41rL42_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1brL41rL42_tHDR_pre_lib_pos_effects + VHLx1brL41rL42_tHDR_pre_lib_pos_effects_ci
VHLx1brL41rL42_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1b_posseq, VHLx1brL41rL42_tHDR_pre_lib_pos_effects, VHLx1brL41rL42_tHDR_pre_lib_pos_effects.x, VHLx1brL41rL42_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1brL41rL42_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1brL41rL42_tHDR_pre_lib_pred_se = VHLx1brL41rL42_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rL41, rL42, rL41rL42)
VHLx1brL4_tHDR_pos_merge_df <- VHLx1brL41_prog_map_thresh5_df_rL42_int_ord_df 
VHLx1brL4_tHDR_pos_merge_df <- merge(VHLx1brL4_tHDR_pos_merge_df, VHLx1brL41_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx1brL41_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1brL4_tHDR_pos_merge_df <- merge(VHLx1brL4_tHDR_pos_merge_df, VHLx1brL42_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1brL42_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1brL4_tHDR_pos_merge_df <- merge(VHLx1brL4_tHDR_pos_merge_df, VHLx1brL41rL42_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1brL41rL42_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx1brL4_tHDR_pos_merge_df <- VHLx1brL4_tHDR_pos_merge_df %>% 
  rename(
    rL41_tHDR_pre_lib_pos_effects.x = VHLx1brL41_tHDR_pre_lib_pos_effects.x,
    rL42_tHDR_pre_lib_pos_effects.x = VHLx1brL42_tHDR_pre_lib_pos_effects.x,
    rL41rL42_tHDR_pre_lib_pos_effects.x = VHLx1brL41rL42_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rL41 vs. rL41_fit and vs. mean_fit)
VHLx1brL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41 <- log2(VHLx1brL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1brL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_pos_effects.x
VHLx1brL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx1brL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1brL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1brL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42 <- log2(VHLx1brL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_ratio_synnorm) - VHLx1brL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_pos_effects.x
VHLx1brL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx1brL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_ratio_synnorm) - VHLx1brL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1brL4_tHDR_pos_merge_df$rL41rL42_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx1brL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm) - VHLx1brL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx1brL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_loess_rL41 <- log2(VHLx1brL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1brL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_pos_effects.x
VHLx1brL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx1brL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1brL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1brL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_loess_rL42 <- log2(VHLx1brL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_ratio_synnorm) - VHLx1brL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_pos_effects.x
VHLx1brL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx1brL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_ratio_synnorm) - VHLx1brL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1brL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx1brL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm) - VHLx1brL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rL41 and rL42 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx1brL4_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1brL4_tHDR_post_lib_loess_median_syn_rL41 <- median(VHLx1brL4_tHDR_pos_merge_df[which(VHLx1brL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rL41_tHDR_post_lib_loess_rL41')])
  VHLx1brL4_tHDR_post_lib_loess_median_syn_rL42 <- median(VHLx1brL4_tHDR_pos_merge_df[which(VHLx1brL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rL42_tHDR_post_lib_loess_rL42')])
  } else {
  VHLx1brL4_tHDR_post_lib_loess_median_syn_rL41 <- median(VHLx1brL4_tHDR_pos_merge_df[which(VHLx1brL4_tHDR_pos_merge_df$conseq != 'could be anything'),c('rL41_tHDR_post_lib_loess_rL41')])
  VHLx1brL4_tHDR_post_lib_loess_median_syn_rL42 <- median(VHLx1brL4_tHDR_pos_merge_df[which(VHLx1brL4_tHDR_pos_merge_df$conseq != 'could be anything'),c('rL42_tHDR_post_lib_loess_rL42')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rL41 'e.sns' = exon syn/ns norm.
VHLx1brL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41_e.sns <- (VHLx1brL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41-VHLx1brL4_tHDR_post_lib_loess_median_syn_rL41)
#calculate new b values for rL42 'e.sns' = exon syn/ns norm.
VHLx1brL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42_e.sns <- (VHLx1brL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42-VHLx1brL4_tHDR_post_lib_loess_median_syn_rL42)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx1brL4_tHDR_pos_merge_df$rL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean <- (VHLx1brL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41_e.sns+VHLx1brL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx1brL4_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1brL4_tHDR_post_lib_loess_e.sns_rL41rL42_syn_median <- median(VHLx1brL4_tHDR_pos_merge_df[which(VHLx1brL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('VHLx1brL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean')])
  } else {
  VHLx1brL4_tHDR_post_lib_loess_e.sns_rL41rL42_syn_median <- median(VHLx1brL4_tHDR_pos_merge_df[which(VHLx1brL4_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('VHLx1brL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean')])
}

#RNA analysis
VHLx1brL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1brL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41_tHDR_rna2_rna_ratio <- VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_pseudo_freq/VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq
VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_rna_ratio <- VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_pseudo_freq/VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq
VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41rL42_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41_tHDR_rna2_rna_ratio)+log2(VHLx1brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_rna_ratio))/2

```

```{r}
#VHLx1prL4
VHLx1prL41_file <- paste(experiment_dir_210729,'VHLx1prL41','_annotated.txt',sep='')
VHLx1prL42_file <- paste(experiment_dir_210729,'VHLx1prL42','_annotated.txt',sep='')
VHLx1prL41 <- read.table(VHLx1prL41_file, header=TRUE, sep="\t")
VHLx1prL42 <- read.table(VHLx1prL42_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx1prL41 <- VHLx1prL41 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

VHLx1prL42 <- VHLx1prL42 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx1p <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx1p'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx1p_HDR_5_SNV = as.character(VHL_editing_info_VHLx1p$HDR_5_SNV)
VHLx1p_HDR_3_SNV = as.character(VHL_editing_info_VHLx1p$HDR_3_SNV)
#VHLx1p_cut_pos = as.character(VHL_editing_info_VHLx1p$cut_pos)
VHLx1p_cut_end = as.character(VHL_editing_info_VHLx1p$cut_end)
VHLx1p_mut_start = as.character(VHL_editing_info_VHLx1p$mut_start)
VHLx1p_mut_end = as.character(VHL_editing_info_VHLx1p$mut_end)

### Replicate 1
VHLx1prL41_cSNV_all <- which(VHLx1prL41[,'c_hdr_snv']=='True')
VHLx1prL41_cSNV_all_df = VHLx1prL41[VHLx1prL41_cSNV_all,]
VHLx1prL41_prog_var_all <- which(VHLx1prL41[,'all_hdr_variant']=='True' & VHLx1prL41[,'edit_string']!='-WT')
VHLx1prL41_prog_var_all_df = VHLx1prL41[VHLx1prL41_prog_var_all,]
VHLx1prL41_prog_map_all = which(VHLx1prL41_prog_var_all_df[,'pos']!='REF')
VHLx1prL41_prog_map_all_df = VHLx1prL41_prog_var_all_df[VHLx1prL41_prog_map_all,]
VHLx1prL41_prog_map_exon_all = which(VHLx1prL41_prog_map_all_df[,'cDNApos']!='REF' & VHLx1prL41_prog_map_all_df[,'cDNApos']!='NA')
VHLx1prL41_prog_map_exon_all_df = VHLx1prL41_prog_map_all_df[VHLx1prL41_prog_map_exon_all,]
VHLx1prL41_prog_map_CADD = which(VHLx1prL41_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1prL41_prog_map_CADD_df = VHLx1prL41_prog_map_all_df[VHLx1prL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx1prL41_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1prL41_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx1prL41_prog_var_thresh5_df = VHLx1prL41_prog_var_all_df[VHLx1prL41_prog_var_thresh5,]
VHLx1prL41_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1prL41_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx1prL41_prog_map_thresh5_df = VHLx1prL41_prog_map_all_df[VHLx1prL41_prog_map_thresh5,]
VHLx1prL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1prL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx1prL41_prog_map_exon_thresh5_df = VHLx1prL41_prog_map_exon_all_df[VHLx1prL41_prog_map_exon_thresh5,]
VHLx1prL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1prL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx1prL41_prog_map_CADD_thresh5_df = VHLx1prL41_prog_map_CADD_df[VHLx1prL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1prL41_prog_var_all_lib_count = length(VHLx1prL41_prog_var_all_df$lib)
VHLx1prL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx1prL41_prog_var_all_min_lib_counts = min(VHLx1prL41_prog_var_all_df$lib)
VHLx1prL41_prog_var_all_min_lib_counts
VHLx1prL41_prog_var_all_max_lib_counts = max(VHLx1prL41_prog_var_all_df$lib)
VHLx1prL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1prL41_prog_map_all_lib_count = length(VHLx1prL41_prog_map_all_df$lib)
VHLx1prL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx1prL41_prog_map_all_min_lib_counts = min(VHLx1prL41_prog_map_all_df$lib)
VHLx1prL41_prog_map_all_min_lib_counts
VHLx1prL41_prog_map_all_max_lib_counts = max(VHLx1prL41_prog_map_all_df$lib)
VHLx1prL41_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx1prL41_prog_var_all_pre_count = length(VHLx1prL41_prog_var_all_df$pre)
VHLx1prL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx1prL41_prog_var_all_min_pre_counts = min(VHLx1prL41_prog_var_all_df$pre)
VHLx1prL41_prog_var_all_min_pre_counts
VHLx1prL41_prog_var_all_max_pre_counts = max(VHLx1prL41_prog_var_all_df$pre)
VHLx1prL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1prL41_prog_map_all_pre_count = length(VHLx1prL41_prog_map_all_df$pre)
VHLx1prL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx1prL41_prog_map_all_min_pre_counts = min(VHLx1prL41_prog_map_all_df$pre)
VHLx1prL41_prog_map_all_min_pre_counts
VHLx1prL41_prog_map_all_max_pre_counts = max(VHLx1prL41_prog_map_all_df$pre)
VHLx1prL41_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx1prL41_prog_map_all_post_count = length(VHLx1prL41_prog_map_all_df$post)
VHLx1prL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx1prL41_prog_map_all_min_post_counts = min(VHLx1prL41_prog_map_all_df$post)
VHLx1prL41_prog_map_all_min_post_counts
VHLx1prL41_prog_map_all_max_post_counts = max(VHLx1prL41_prog_map_all_df$post)
VHLx1prL41_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx1prL41_prog_map_all_syn_df <- VHLx1prL41_prog_map_all_df[which(VHLx1prL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1prL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1prL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1prL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1prL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1prL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1prL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1prL41_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1prL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx1prL41_prog_map_all_min_rna_counts = min(VHLx1prL41_prog_map_exon_all_df$tHDR_rna)
VHLx1prL41_prog_map_all_min_rna_counts
VHLx1prL41_prog_map_all_max_rna_counts = max(VHLx1prL41_prog_map_exon_all_df$tHDR_rna)
VHLx1prL41_prog_map_all_max_rna_counts
VHLx1prL41_prog_map_all_min_rna_pseudo_freq = min(VHLx1prL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1prL41_prog_map_all_min_rna_pseudo_freq
VHLx1prL41_prog_map_all_max_rna_pseudo_freq = max(VHLx1prL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1prL41_prog_map_all_max_rna_pseudo_freq
VHLx1prL41_prog_map_all_min_rna_pre_ratio = min(VHLx1prL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1prL41_prog_map_all_min_rna_pre_ratio
VHLx1prL41_prog_map_all_max_rna_pre_ratio = max(VHLx1prL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1prL41_prog_map_all_max_rna_pre_ratio
VHLx1prL41_prog_map_all_min_rna_post_ratio = min(VHLx1prL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1prL41_prog_map_all_min_rna_post_ratio
VHLx1prL41_prog_map_all_max_rna_post_ratio = max(VHLx1prL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1prL41_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1prL41_cSNV_all_corr_pre_count = length(VHLx1prL41_cSNV_all_df$corr_pre)
VHLx1prL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx1prL41_cSNV_all_min_corr_pre_counts = min(VHLx1prL41_cSNV_all_df$corr_pre)
VHLx1prL41_cSNV_all_min_corr_pre_counts
VHLx1prL41_cSNV_all_max_corr_pre_counts = max(VHLx1prL41_cSNV_all_df$corr_pre)
VHLx1prL41_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prL41_cSNV_all_corr_post_count = length(VHLx1prL41_cSNV_all_df$corr_post)
VHLx1prL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx1prL41_cSNV_all_min_corr_post_counts = min(VHLx1prL41_cSNV_all_df$corr_post)
VHLx1prL41_cSNV_all_min_corr_post_counts
VHLx1prL41_cSNV_all_max_corr_post_counts = max(VHLx1prL41_cSNV_all_df$corr_post)
VHLx1prL41_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx1p_p_hdr_snv = paste('p_hdr_',VHLx1p_cut_end,'_snv',sep='')
VHLx1prL41_pSNV_all <- which(VHLx1prL41[,VHLx1p_p_hdr_snv]=='True')
VHLx1prL41_pSNV_all_df = VHLx1prL41[VHLx1prL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prL41_pSNV_all_lib_count = length(VHLx1prL41_pSNV_all_df$lib)
VHLx1prL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx1prL41_pSNV_all_min_lib_counts = min(VHLx1prL41_pSNV_all_df$lib)
VHLx1prL41_pSNV_all_min_lib_counts
VHLx1prL41_pSNV_all_max_lib_counts = max(VHLx1prL41_pSNV_all_df$lib)
VHLx1prL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx1prL41_pSNV_all_pre_count = length(VHLx1prL41_pSNV_all_df$pre)
VHLx1prL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx1prL41_pSNV_all_min_pre_counts = min(VHLx1prL41_pSNV_all_df$pre)
VHLx1prL41_pSNV_all_min_pre_counts
VHLx1prL41_pSNV_all_max_pre_counts = max(VHLx1prL41_pSNV_all_df$pre)
VHLx1prL41_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prL41_pSNV_all_post_count = length(VHLx1prL41_pSNV_all_df$post)
VHLx1prL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx1prL41_pSNV_all_min_post_counts = min(VHLx1prL41_pSNV_all_df$post)
VHLx1prL41_pSNV_all_min_post_counts
VHLx1prL41_pSNV_all_max_post_counts = max(VHLx1prL41_pSNV_all_df$post)
VHLx1prL41_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prL41_prog_map_thresh5_lib_count = length(VHLx1prL41_prog_map_thresh5_df$lib)
VHLx1prL41_prog_map_thresh5_lib_count
VHLx1prL41_prog_map_thresh5_min_lib_counts = min(VHLx1prL41_prog_map_thresh5_df$lib)
VHLx1prL41_prog_map_thresh5_min_lib_counts
VHLx1prL41_prog_map_thresh5_max_lib_counts = max(VHLx1prL41_prog_map_thresh5_df$lib)
VHLx1prL41_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prL41_prog_map_thresh5_pre_count = length(VHLx1prL41_prog_map_thresh5_df$pre)
VHLx1prL41_prog_map_thresh5_pre_count
VHLx1prL41_prog_map_thresh5_min_pre_counts = min(VHLx1prL41_prog_map_thresh5_df$pre)
VHLx1prL41_prog_map_thresh5_min_pre_counts
VHLx1prL41_prog_map_thresh5_max_pre_counts = max(VHLx1prL41_prog_map_thresh5_df$pre)
VHLx1prL41_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1prL41_prog_map_thresh5_post_count = length(VHLx1prL41_prog_map_thresh5_df$post)
VHLx1prL41_prog_map_thresh5_post_count
VHLx1prL41_prog_map_thresh5_min_post_counts = min(VHLx1prL41_prog_map_thresh5_df$post)
VHLx1prL41_prog_map_thresh5_min_post_counts
VHLx1prL41_prog_map_thresh5_max_post_counts = max(VHLx1prL41_prog_map_thresh5_df$post)
VHLx1prL41_prog_map_thresh5_max_post_counts
VHLx1prL41_prog_map_thresh5_corr_post_count = length(VHLx1prL41_cSNV_all_df$corr_post)
VHLx1prL41_prog_map_thresh5_corr_post_count
VHLx1prL41_prog_map_thresh5_min_corr_post_counts = min(VHLx1prL41_cSNV_all_df$corr_post)
VHLx1prL41_prog_map_thresh5_min_corr_post_counts
VHLx1prL41_prog_map_thresh5_max_corr_post_counts = max(VHLx1prL41_cSNV_all_df$corr_post)
VHLx1prL41_prog_map_thresh5_max_corr_post_counts

VHLx1prL41_pSNV_thresh5 <- which(VHLx1prL41[,VHLx1p_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1prL41[,'pre_freq']))>=0.00001)
VHLx1prL41_pSNV_thresh5_df = VHLx1prL41[VHLx1prL41_pSNV_thresh5,]
VHLx1prL41_pSNV_thresh5_lib_count = length(VHLx1prL41_pSNV_thresh5_df$lib)
VHLx1prL41_pSNV_thresh5_lib_count
VHLx1prL41_pSNV_thresh5_min_lib_counts = min(VHLx1prL41_pSNV_thresh5_df$lib)
VHLx1prL41_pSNV_thresh5_min_lib_counts
VHLx1prL41_pSNV_thresh5_max_lib_counts = max(VHLx1prL41_pSNV_thresh5_df$lib)
VHLx1prL41_pSNV_thresh5_max_lib_counts
VHLx1prL41_pSNV_thresh5_pre_count = length(VHLx1prL41_pSNV_thresh5_df$pre)
VHLx1prL41_pSNV_thresh5_pre_count
VHLx1prL41_pSNV_thresh5_min_pre_counts = min(VHLx1prL41_pSNV_thresh5_df$pre)
VHLx1prL41_pSNV_thresh5_min_pre_counts
VHLx1prL41_pSNV_thresh5_max_pre_counts = max(VHLx1prL41_pSNV_thresh5_df$pre)
VHLx1prL41_pSNV_thresh5_max_pre_counts
VHLx1prL41_pSNV_thresh5_post_count = length(VHLx1prL41_pSNV_thresh5_df$post)
VHLx1prL41_pSNV_thresh5_post_count
VHLx1prL41_pSNV_thresh5_min_post_counts = min(VHLx1prL41_pSNV_thresh5_df$post)
VHLx1prL41_pSNV_thresh5_min_post_counts
VHLx1prL41_pSNV_thresh5_max_post_counts = max(VHLx1prL41_pSNV_thresh5_df$post)
VHLx1prL41_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx1prL42_cSNV_all <- which(VHLx1prL42[,'c_hdr_snv']=='True')
VHLx1prL42_cSNV_all_df = VHLx1prL42[VHLx1prL42_cSNV_all,]
VHLx1prL42_prog_var_all <- which(VHLx1prL42[,'all_hdr_variant']=='True' & VHLx1prL42[,'edit_string']!='-WT')
VHLx1prL42_prog_var_all_df = VHLx1prL42[VHLx1prL42_prog_var_all,]
VHLx1prL42_prog_map_all = which(VHLx1prL42_prog_var_all_df[,'pos']!='REF')
VHLx1prL42_prog_map_all_df = VHLx1prL42_prog_var_all_df[VHLx1prL42_prog_map_all,]
VHLx1prL42_prog_map_exon_all = which(VHLx1prL42_prog_map_all_df[,'cDNApos']!='REF' & VHLx1prL42_prog_map_all_df[,'cDNApos']!='NA')
VHLx1prL42_prog_map_exon_all_df = VHLx1prL42_prog_map_all_df[VHLx1prL42_prog_map_exon_all,]
VHLx1prL42_prog_map_CADD = which(VHLx1prL42_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1prL42_prog_map_CADD_df = VHLx1prL42_prog_map_all_df[VHLx1prL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx1prL42_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1prL42_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx1prL42_prog_var_thresh5_df = VHLx1prL42_prog_var_all_df[VHLx1prL42_prog_var_thresh5,]
VHLx1prL42_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1prL42_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx1prL42_prog_map_thresh5_df = VHLx1prL42_prog_map_all_df[VHLx1prL42_prog_map_thresh5,]
VHLx1prL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1prL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx1prL42_prog_map_exon_thresh5_df = VHLx1prL42_prog_map_exon_all_df[VHLx1prL42_prog_map_exon_thresh5,]
VHLx1prL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1prL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx1prL42_prog_map_CADD_thresh5_df = VHLx1prL42_prog_map_CADD_df[VHLx1prL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1prL42_prog_var_all_lib_count = length(VHLx1prL42_prog_var_all_df$lib)
VHLx1prL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx1prL42_prog_var_all_min_lib_counts = min(VHLx1prL42_prog_var_all_df$lib)
VHLx1prL42_prog_var_all_min_lib_counts
VHLx1prL42_prog_var_all_max_lib_counts = max(VHLx1prL42_prog_var_all_df$lib)
VHLx1prL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1prL42_prog_map_all_lib_count = length(VHLx1prL42_prog_map_all_df$lib)
VHLx1prL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx1prL42_prog_map_all_min_lib_counts = min(VHLx1prL42_prog_map_all_df$lib)
VHLx1prL42_prog_map_all_min_lib_counts
VHLx1prL42_prog_map_all_max_lib_counts = max(VHLx1prL42_prog_map_all_df$lib)
VHLx1prL42_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx1prL42_prog_var_all_pre_count = length(VHLx1prL42_prog_var_all_df$pre)
VHLx1prL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx1prL42_prog_var_all_min_pre_counts = min(VHLx1prL42_prog_var_all_df$pre)
VHLx1prL42_prog_var_all_min_pre_counts
VHLx1prL42_prog_var_all_max_pre_counts = max(VHLx1prL42_prog_var_all_df$pre)
VHLx1prL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1prL42_prog_map_all_pre_count = length(VHLx1prL42_prog_map_all_df$pre)
VHLx1prL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx1prL42_prog_map_all_min_pre_counts = min(VHLx1prL42_prog_map_all_df$pre)
VHLx1prL42_prog_map_all_min_pre_counts
VHLx1prL42_prog_map_all_max_pre_counts = max(VHLx1prL42_prog_map_all_df$pre)
VHLx1prL42_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx1prL42_prog_map_all_post_count = length(VHLx1prL42_prog_map_all_df$post)
VHLx1prL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx1prL42_prog_map_all_min_post_counts = min(VHLx1prL42_prog_map_all_df$post)
VHLx1prL42_prog_map_all_min_post_counts
VHLx1prL42_prog_map_all_max_post_counts = max(VHLx1prL42_prog_map_all_df$post)
VHLx1prL42_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx1prL42_prog_map_all_syn_df <- VHLx1prL42_prog_map_all_df[which(VHLx1prL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1prL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1prL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1prL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1prL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1prL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1prL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1prL42_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1prL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx1prL42_prog_map_all_min_rna_counts = min(VHLx1prL42_prog_map_exon_all_df$tHDR_rna)
VHLx1prL42_prog_map_all_min_rna_counts
VHLx1prL42_prog_map_all_max_rna_counts = max(VHLx1prL42_prog_map_exon_all_df$tHDR_rna)
VHLx1prL42_prog_map_all_max_rna_counts
VHLx1prL42_prog_map_all_min_rna_pseudo_freq = min(VHLx1prL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1prL42_prog_map_all_min_rna_pseudo_freq
VHLx1prL42_prog_map_all_max_rna_pseudo_freq = max(VHLx1prL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1prL42_prog_map_all_max_rna_pseudo_freq
VHLx1prL42_prog_map_all_min_rna_pre_ratio = min(VHLx1prL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1prL42_prog_map_all_min_rna_pre_ratio
VHLx1prL42_prog_map_all_max_rna_pre_ratio = max(VHLx1prL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1prL42_prog_map_all_max_rna_pre_ratio
VHLx1prL42_prog_map_all_min_rna_post_ratio = min(VHLx1prL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1prL42_prog_map_all_min_rna_post_ratio
VHLx1prL42_prog_map_all_max_rna_post_ratio = max(VHLx1prL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1prL42_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1prL42_cSNV_all_corr_pre_count = length(VHLx1prL42_cSNV_all_df$corr_pre)
VHLx1prL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx1prL42_cSNV_all_min_corr_pre_counts = min(VHLx1prL42_cSNV_all_df$corr_pre)
VHLx1prL42_cSNV_all_min_corr_pre_counts
VHLx1prL42_cSNV_all_max_corr_pre_counts = max(VHLx1prL42_cSNV_all_df$corr_pre)
VHLx1prL42_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prL42_cSNV_all_corr_post_count = length(VHLx1prL42_cSNV_all_df$corr_post)
VHLx1prL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx1prL42_cSNV_all_min_corr_post_counts = min(VHLx1prL42_cSNV_all_df$corr_post)
VHLx1prL42_cSNV_all_min_corr_post_counts
VHLx1prL42_cSNV_all_max_corr_post_counts = max(VHLx1prL42_cSNV_all_df$corr_post)
VHLx1prL42_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx1p_p_hdr_snv = paste('p_hdr_',VHLx1p_cut_end,'_snv',sep='')
VHLx1prL42_pSNV_all <- which(VHLx1prL42[,VHLx1p_p_hdr_snv]=='True')
VHLx1prL42_pSNV_all_df = VHLx1prL42[VHLx1prL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prL42_pSNV_all_lib_count = length(VHLx1prL42_pSNV_all_df$lib)
VHLx1prL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx1prL42_pSNV_all_min_lib_counts = min(VHLx1prL42_pSNV_all_df$lib)
VHLx1prL42_pSNV_all_min_lib_counts
VHLx1prL42_pSNV_all_max_lib_counts = max(VHLx1prL42_pSNV_all_df$lib)
VHLx1prL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx1prL42_pSNV_all_pre_count = length(VHLx1prL42_pSNV_all_df$pre)
VHLx1prL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx1prL42_pSNV_all_min_pre_counts = min(VHLx1prL42_pSNV_all_df$pre)
VHLx1prL42_pSNV_all_min_pre_counts
VHLx1prL42_pSNV_all_max_pre_counts = max(VHLx1prL42_pSNV_all_df$pre)
VHLx1prL42_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prL42_pSNV_all_post_count = length(VHLx1prL42_pSNV_all_df$post)
VHLx1prL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx1prL42_pSNV_all_min_post_counts = min(VHLx1prL42_pSNV_all_df$post)
VHLx1prL42_pSNV_all_min_post_counts
VHLx1prL42_pSNV_all_max_post_counts = max(VHLx1prL42_pSNV_all_df$post)
VHLx1prL42_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prL42_prog_map_thresh5_lib_count = length(VHLx1prL42_prog_map_thresh5_df$lib)
VHLx1prL42_prog_map_thresh5_lib_count
VHLx1prL42_prog_map_thresh5_min_lib_counts = min(VHLx1prL42_prog_map_thresh5_df$lib)
VHLx1prL42_prog_map_thresh5_min_lib_counts
VHLx1prL42_prog_map_thresh5_max_lib_counts = max(VHLx1prL42_prog_map_thresh5_df$lib)
VHLx1prL42_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx1p less than SGE region length x 3 due to PAM edits
VHLx1prL42_prog_map_thresh5_pre_count = length(VHLx1prL42_prog_map_thresh5_df$pre)
VHLx1prL42_prog_map_thresh5_pre_count
VHLx1prL42_prog_map_thresh5_min_pre_counts = min(VHLx1prL42_prog_map_thresh5_df$pre)
VHLx1prL42_prog_map_thresh5_min_pre_counts
VHLx1prL42_prog_map_thresh5_max_pre_counts = max(VHLx1prL42_prog_map_thresh5_df$pre)
VHLx1prL42_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1prL42_prog_map_thresh5_post_count = length(VHLx1prL42_prog_map_thresh5_df$post)
VHLx1prL42_prog_map_thresh5_post_count
VHLx1prL42_prog_map_thresh5_min_post_counts = min(VHLx1prL42_prog_map_thresh5_df$post)
VHLx1prL42_prog_map_thresh5_min_post_counts
VHLx1prL42_prog_map_thresh5_max_post_counts = max(VHLx1prL42_prog_map_thresh5_df$post)
VHLx1prL42_prog_map_thresh5_max_post_counts
VHLx1prL42_prog_map_thresh5_corr_post_count = length(VHLx1prL42_cSNV_all_df$corr_post)
VHLx1prL42_prog_map_thresh5_corr_post_count
VHLx1prL42_prog_map_thresh5_min_corr_post_counts = min(VHLx1prL42_cSNV_all_df$corr_post)
VHLx1prL42_prog_map_thresh5_min_corr_post_counts
VHLx1prL42_prog_map_thresh5_max_corr_post_counts = max(VHLx1prL42_cSNV_all_df$corr_post)
VHLx1prL42_prog_map_thresh5_max_corr_post_counts

VHLx1prL42_pSNV_thresh5 <- which(VHLx1prL42[,VHLx1p_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1prL42[,'pre_freq']))>=0.00001)
VHLx1prL42_pSNV_thresh5_df = VHLx1prL42[VHLx1prL42_pSNV_thresh5,]
VHLx1prL42_pSNV_thresh5_lib_count = length(VHLx1prL42_pSNV_thresh5_df$lib)
VHLx1prL42_pSNV_thresh5_lib_count
VHLx1prL42_pSNV_thresh5_min_lib_counts = min(VHLx1prL42_pSNV_thresh5_df$lib)
VHLx1prL42_pSNV_thresh5_min_lib_counts
VHLx1prL42_pSNV_thresh5_max_lib_counts = max(VHLx1prL42_pSNV_thresh5_df$lib)
VHLx1prL42_pSNV_thresh5_max_lib_counts
VHLx1prL42_pSNV_thresh5_pre_count = length(VHLx1prL42_pSNV_thresh5_df$pre)
VHLx1prL42_pSNV_thresh5_pre_count
VHLx1prL42_pSNV_thresh5_min_pre_counts = min(VHLx1prL42_pSNV_thresh5_df$pre)
VHLx1prL42_pSNV_thresh5_min_pre_counts
VHLx1prL42_pSNV_thresh5_max_pre_counts = max(VHLx1prL42_pSNV_thresh5_df$pre)
VHLx1prL42_pSNV_thresh5_max_pre_counts
VHLx1prL42_pSNV_thresh5_post_count = length(VHLx1prL42_pSNV_thresh5_df$post)
VHLx1prL42_pSNV_thresh5_post_count
VHLx1prL42_pSNV_thresh5_min_post_counts = min(VHLx1prL42_pSNV_thresh5_df$post)
VHLx1prL42_pSNV_thresh5_min_post_counts
VHLx1prL42_pSNV_thresh5_max_post_counts = max(VHLx1prL42_pSNV_thresh5_df$post)
VHLx1prL42_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx1prL41_prog_var_thresh5_df:
VHLx1prL41_prog_var_thresh5_df_rL42_int <- VHLx1prL41_prog_var_thresh5_df[which(VHLx1prL41_prog_var_thresh5_df$variant %in% VHLx1prL42_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx1prL42_prog_var_thresh5_df:
VHLx1prL42_prog_var_thresh5_df_rL41_int <- VHLx1prL42_prog_var_thresh5_df[which(VHLx1prL42_prog_var_thresh5_df$variant %in% VHLx1prL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord <- VHLx1prL41_prog_var_thresh5_df_rL42_int[order(VHLx1prL41_prog_var_thresh5_df_rL42_int$variant),]
VHLx1prL42_prog_var_thresh5_df_rL41_int_ord <- VHLx1prL42_prog_var_thresh5_df_rL41_int[order(VHLx1prL42_prog_var_thresh5_df_rL41_int$variant),]
dim(VHLx1prL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
VHLx1prL41rL42int_prog_var_thresh5_pre_count <- dim(VHLx1prL41_prog_var_thresh5_df_rL42_int)[1] 
VHLx1prL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(VHLx1prL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(VHLx1prL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41

#Add the following columns from the from rL42 df to the rL41 df:
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$pre
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$lib
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$rna
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2 <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post2
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3 <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post3
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2 <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$rna2
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pseudo <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post2_pseudo
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pseudo <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post3_pseudo
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_pseudo <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$rna2_pseudo
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post2_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post3_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$rna2_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pseudo_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post2_pseudo_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pseudo_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post3_pseudo_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_pseudo_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$rna2_pseudo_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post2_pre_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pre_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post3_pre_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$rna2_post_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$corr_post
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2 <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3 <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2 <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pseudo_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2_pseudo_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pseudo_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3_pseudo_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_pseudo_freq <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2_pseudo_freq
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2_pre_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pre_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3_pre_ratio
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio <- VHLx1prL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio) + log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio))/2)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio) + log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio))/2)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio) + log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio))/2)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio) + log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio))/2)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post3_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post3_pre_ratio) + log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pre_ratio))/2)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rna2_post_ratio_rL41rL42_mean <- 2^((log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rna2_post_ratio) + log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio))/2)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio) + log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio))/2)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio) + log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio))/2)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio) + log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio))/2)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio) + log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio))/2)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- 2^((log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio) + log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio))/2)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio) + log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio))/2)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post3_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post3_pre_ratio) + log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pre_ratio))/2)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean <- 2^((log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio) + log2(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq)) >= 10) {
    VHLx1prL41_cSNV_pre_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx1prL41_cSNV_post_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx1prL41_cSNV_post2_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx1prL41_cSNV_post_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx1prL41_tSNV_pre_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx1prL41_tSNV_post_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx1prL41_tSNV_post_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx1prL41_tSNV_rna_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx1prL41_tSNV_rna_post_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx1prL41_tSNV_rna2_post_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx1prL42_cSNV_pre_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_pre_lib_ratio)
VHLx1prL42_cSNV_post_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post_pre_ratio)
VHLx1prL42_cSNV_post2_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post2_pre_ratio)

VHLx1prL42_cSNV_post_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post_lib_ratio)
VHLx1prL42_tSNV_pre_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_pre_lib_ratio)
VHLx1prL42_tSNV_post_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post_pre_ratio)
VHLx1prL42_tSNV_post2_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post2_pre_ratio)
VHLx1prL42_tSNV_post_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post_lib_ratio)
VHLx1prL42_tSNV_rna_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna_pre_ratio)
VHLx1prL42_tSNV_rna_post_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna_post_ratio)
VHLx1prL42_tSNV_rna2_post_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna2_post_ratio)
VHLx1prL41rL42a_cSNV_pre_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rL41rL42_mean)
VHLx1prL41rL42a_cSNV_post_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rL41rL42_mean)
VHLx1prL41rL42a_cSNV_post2_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rL41rL42_mean)
VHLx1prL41rL42a_cSNV_post_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rL41rL42_mean)
VHLx1prL41rL42a_tSNV_pre_lib_med <- 
  median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rL41rL42_mean)
VHLx1prL41rL42a_tSNV_post_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rL41rL42_mean)
VHLx1prL41rL42a_tSNV_post2_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rL41rL42_mean)
VHLx1prL41rL42a_tSNV_post_lib_med <-
  median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rL41rL42_mean)
VHLx1prL41rL42a_tSNV_rna_pre_med <-
  median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rL41rL42_mean)
VHLx1prL41rL42a_tSNV_rna_post_med <-
  median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rL41rL42_mean)
VHLx1prL41rL42a_tSNV_rna2_post_med <-
  median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rL41rL42_mean)
VHLx1prL41rL42pw_tSNV_post_pre_med  <-
  median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
VHLx1prL41rL42pw_cSNV_post_pre_med  <-
  median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rL41rL42_pre_weighted)
  } else {
  VHLx1prL41_cSNV_pre_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio)
VHLx1prL41_cSNV_post_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio)
VHLx1prL41_cSNV_post2_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio)
VHLx1prL41_cSNV_post_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio)
VHLx1prL41_tSNV_pre_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio)
VHLx1prL41_tSNV_post_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio)
VHLx1prL41_tSNV_post_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio)
VHLx1prL41_tSNV_rna_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio)
VHLx1prL41_tSNV_rna_post_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio)
VHLx1prL41_tSNV_rna2_post_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio)
VHLx1prL42_cSNV_pre_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)
VHLx1prL42_cSNV_post_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)
VHLx1prL42_cSNV_post2_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio)

VHLx1prL42_cSNV_post_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)
VHLx1prL42_tSNV_pre_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)
VHLx1prL42_tSNV_post_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)
VHLx1prL42_tSNV_post2_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio)
VHLx1prL42_tSNV_post_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)
VHLx1prL42_tSNV_rna_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)
VHLx1prL42_tSNV_rna_post_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)
VHLx1prL42_tSNV_rna2_post_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio)
VHLx1prL41rL42a_cSNV_pre_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean)
VHLx1prL41rL42a_cSNV_post_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean)
VHLx1prL41rL42a_cSNV_post2_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_rL41rL42_mean)
VHLx1prL41rL42a_cSNV_post_lib_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean)
VHLx1prL41rL42a_tSNV_pre_lib_med <- 
  median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean)
VHLx1prL41rL42a_tSNV_post_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean)
VHLx1prL41rL42a_tSNV_post2_pre_med <- median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean)
VHLx1prL41rL42a_tSNV_post_lib_med <-
  median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean)
VHLx1prL41rL42a_tSNV_rna_pre_med <-
  median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean)
VHLx1prL41rL42a_tSNV_rna_post_med <-
  median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean)
VHLx1prL41rL42a_tSNV_rna2_post_med <-
  median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean)
VHLx1prL41rL42pw_tSNV_post_pre_med  <-
  median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
VHLx1prL41rL42pw_cSNV_post_pre_med  <-
  median(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted)
}

VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/VHLx1prL41_cSNV_pre_lib_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/VHLx1prL41_cSNV_post_pre_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/VHLx1prL41_cSNV_post_lib_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio/VHLx1prL41_cSNV_post2_pre_med

VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/VHLx1prL41_tSNV_pre_lib_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/VHLx1prL41_tSNV_post_pre_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/VHLx1prL41_tSNV_post_lib_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/VHLx1prL41_tSNV_rna_pre_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/VHLx1prL41_tSNV_rna_post_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio/VHLx1prL42_tSNV_post2_pre_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio/VHLx1prL41_tSNV_rna2_post_med

VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/VHLx1prL42_cSNV_pre_lib_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/VHLx1prL42_cSNV_post_pre_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/VHLx1prL42_cSNV_post_lib_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio/VHLx1prL41rL42a_cSNV_post2_pre_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio/VHLx1prL42_tSNV_rna2_post_med


VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/VHLx1prL42_tSNV_pre_lib_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/VHLx1prL42_tSNV_post_pre_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio/VHLx1prL42_tSNV_post2_pre_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/VHLx1prL42_tSNV_post_lib_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/VHLx1prL42_tSNV_rna_pre_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/VHLx1prL42_tSNV_rna_post_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio/VHLx1prL42_tSNV_rna2_post_med

###normalize the means
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/VHLx1prL41rL42a_cSNV_pre_lib_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/VHLx1prL41rL42a_cSNV_post_pre_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/VHLx1prL41rL42a_cSNV_post_lib_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/VHLx1prL41rL42a_tSNV_pre_lib_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/VHLx1prL41rL42a_tSNV_post_pre_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean/VHLx1prL41rL42a_tSNV_post2_pre_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/VHLx1prL41rL42a_tSNV_post_lib_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/VHLx1prL41rL42a_tSNV_rna_pre_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/VHLx1prL41rL42a_tSNV_rna_post_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean/VHLx1prL41rL42a_tSNV_rna2_post_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/VHLx1prL41rL42pw_tSNV_post_pre_med
VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- VHLx1prL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/VHLx1prL41rL42pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx1prL41_prog_var_thresh5_df_rL42_int_ord
VHLx1prL41_prog_map_thresh5_df_rL42_int_ord = which(VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df = VHLx1prL41_prog_var_thresh5_df_rL42_int_ord[VHLx1prL41_prog_map_thresh5_df_rL42_int_ord,]
VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord = which(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df = VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df[VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord,]
VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df[VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord,]
VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx1prL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
VHLx1prL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
VHLx1prL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
VHLx1prL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p
VHLx1prL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
VHLx1prL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
VHLx1prL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
VHLx1prL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p
VHLx1prL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post2_pre_ratio_synnorm),method='spearman')
VHLx1prL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s
VHLx1prL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_p <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post2_pre_ratio_synnorm),method='pearson')
VHLx1prL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_p
VHLx1prL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1prL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
VHLx1prL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx1prL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p
VHLx1prL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1prL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
VHLx1prL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx1prL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p
VHLx1prL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1prL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
VHLx1prL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx1prL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p
VHLx1prL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_s <- cor(log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1prL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_s
VHLx1prL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_p <- cor(log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx1prL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_p
VHLx1prL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
VHLx1prL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
VHLx1prL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$post_pseudo_freq),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pseudo_freq),method='pearson')
VHLx1prL41rL42_cSNV_rL41_post_by_rL42_post_cor_p
VHLx1prL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
VHLx1prL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
VHLx1prL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
VHLx1prL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p
VHLx1prL41rL42_tSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx1prL41rL42_tSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s
VHLx1prL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1prL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
VHLx1prL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1prL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
VHLx1prL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1prL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s
VHLx1prL41rL42_tSNV_rL41_rna2_post_by_rL42_rna2_post_cor_s <- cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1prL41rL42_tSNV_rL41_rna2_post_by_rL42_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx1prL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41_cSNV_post_pre_by_cadd_cor_s
VHLx1prL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL42_cSNV_post_pre_by_cadd_cor_s
VHLx1prL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41_cSNV_post_lib_by_cadd_cor_s
VHLx1prL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL42_cSNV_post_lib_by_cadd_cor_s
VHLx1prL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41_tSNV_post_pre_by_cadd_cor_s
VHLx1prL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL42_tSNV_post_pre_by_cadd_cor_s
VHLx1prL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41_tSNV_post_lib_by_cadd_cor_s
VHLx1prL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx1prL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42a_cSNV_pre_lib_by_cadd_cor_s
VHLx1prL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42w_cSNV_pre_lib_by_cadd_cor_s
VHLx1prL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42a_cSNV_post_pre_by_cadd_cor_s
VHLx1prL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42w_cSNV_post_pre_by_cadd_cor_s
VHLx1prL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42a_cSNV_post_lib_by_cadd_cor_s
VHLx1prL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42w_cSNV_post_lib_by_cadd_cor_s
VHLx1prL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42a_tSNV_pre_lib_by_cadd_cor_s
VHLx1prL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42a_tSNV_post_pre_by_cadd_cor_s
VHLx1prL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42w_tSNV_post_pre_by_cadd_cor_s
VHLx1prL41rL42a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post2_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42a_tSNV_post2_pre_by_cadd_cor_s
VHLx1prL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx1prL41_cSNV_pre_lib_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1prL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1prL41_tSNV_pre_lib_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1prL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1prL41_cSNV_post_lib_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1prL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1prL41_tSNV_post_lib_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1prL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1prL41_cSNV_post_pre_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1prL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1prL41_tSNV_post_pre_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1prL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1prL41_cSNV_rna_lib_cors = cor(log2(VHLx1prL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1prL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1prL41_tSNV_rna_lib_cors = cor(log2(VHLx1prL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1prL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1prL41_cSNV_rna_pre_cors = cor(log2(VHLx1prL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1prL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1prL41_tSNV_rna_pre_cors = cor(log2(VHLx1prL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1prL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1prL41rL42_cSNV_pre_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
VHLx1prL41rL42_tSNV_pre_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
VHLx1prL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
VHLx1prL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
VHLx1prL41rL42_cSNV_post_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
VHLx1prL41rL42_tSNV_post_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
VHLx1prL41rL42_cSNV_post_lib_ratio_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
VHLx1prL41rL42_tSNV_post_lib_ratio_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1prL41rL42_cSNV_post_pre_ratio_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
VHLx1prL41rL42_tSNV_post_pre_ratio_cors = cor(log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1prL41rL42_cSNV_rna_cors = cor(log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
VHLx1prL41rL42_tSNV_rna_cors = cor(log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
VHLx1prL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1prL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1prL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1prL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1prL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1prL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1prL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1prL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1prL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1prL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1prL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1prL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1prL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1prL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1prL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

VHLx1prL41_cors <- c("VHLx1prL41",VHLx1prL41_cSNV_pre_lib_cors,VHLx1prL41_tSNV_pre_lib_cors,VHLx1prL41_cSNV_post_lib_cors,VHLx1prL41_tSNV_post_lib_cors,VHLx1prL41_cSNV_post_pre_cors,VHLx1prL41_tSNV_post_pre_cors,VHLx1prL41_cSNV_rna_lib_cors,VHLx1prL41_tSNV_rna_lib_cors,VHLx1prL41_cSNV_rna_pre_cors,VHLx1prL41_tSNV_rna_pre_cors,VHLx1prL41rL42_cSNV_pre_cors,VHLx1prL41rL42_tSNV_pre_cors,VHLx1prL41rL42_cSNV_pre_lib_ratio_cors,VHLx1prL41rL42_tSNV_pre_lib_ratio_cors,VHLx1prL41rL42_cSNV_post_cors,VHLx1prL41rL42_tSNV_post_cors,VHLx1prL41rL42_cSNV_post_lib_ratio_cors,VHLx1prL41rL42_tSNV_post_lib_ratio_cors,VHLx1prL41rL42_cSNV_post_pre_ratio_cors,VHLx1prL41rL42_tSNV_post_pre_ratio_cors,VHLx1prL41rL42_cSNV_rna_cors,VHLx1prL41rL42_tSNV_rna_cors,VHLx1prL41rL42_tSNV_rna_pre_ratio_cors,VHLx1prL41_cSNV_pre_lib_ratio_cadd_cors,VHLx1prL41_tSNV_pre_lib_ratio_cadd_cors,VHLx1prL41_cSNV_post_lib_ratio_cadd_cors,VHLx1prL41_tSNV_post_lib_ratio_cadd_cors,VHLx1prL41_cSNV_post_pre_ratio_cadd_cors,VHLx1prL41_tSNV_post_pre_ratio_cadd_cors,VHLx1prL41_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1prL41_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1prL41_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prL41_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prL41_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1prL41_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1prL41rL42a_cSNV_pre_lib_ratio_cadd_cors,VHLx1prL41rL42a_tSNV_pre_lib_ratio_cadd_cors,VHLx1prL41rL42a_cSNV_post_lib_ratio_cadd_cors,VHLx1prL41rL42a_tSNV_post_lib_ratio_cadd_cors,VHLx1prL41rL42a_cSNV_post_pre_ratio_cadd_cors,VHLx1prL41rL42a_tSNV_post_pre_ratio_cadd_cors,VHLx1prL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1prL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1prL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1prL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1prL41rL42w_cSNV_pre_lib_ratio_cadd_cors,VHLx1prL41rL42w_cSNV_post_lib_ratio_cadd_cors,VHLx1prL41rL42w_cSNV_post_pre_ratio_cadd_cors,VHLx1prL41rL42w_tSNV_post_pre_ratio_cadd_cors)

VHLx1prL42_cSNV_pre_lib_cors = cor(log2(VHLx1prL42_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1prL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1prL42_tSNV_pre_lib_cors = cor(log2(VHLx1prL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1prL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1prL42_cSNV_post_lib_cors = cor(log2(VHLx1prL42_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1prL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1prL42_tSNV_post_lib_cors = cor(log2(VHLx1prL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1prL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1prL42_cSNV_post_pre_cors = cor(log2(VHLx1prL42_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1prL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1prL42_tSNV_post_pre_cors = cor(log2(VHLx1prL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1prL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1prL42_cSNV_rna_lib_cors = cor(log2(VHLx1prL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1prL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1prL42_tSNV_rna_lib_cors = cor(log2(VHLx1prL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1prL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1prL42_cSNV_rna_pre_cors = cor(log2(VHLx1prL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1prL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1prL42_tSNV_rna_pre_cors = cor(log2(VHLx1prL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1prL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1prL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1prL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1prL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1prL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1prL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1prL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1prL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1prL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1prL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1prL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1prL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1prL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1prL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1prL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1prL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1prL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1prL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1prL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

VHLx1prL42_cors <- c("VHLx1prL42",VHLx1prL42_cSNV_pre_lib_cors,VHLx1prL42_tSNV_pre_lib_cors,VHLx1prL42_cSNV_post_lib_cors,VHLx1prL42_tSNV_post_lib_cors,VHLx1prL42_cSNV_post_pre_cors,VHLx1prL42_tSNV_post_pre_cors,VHLx1prL42_cSNV_rna_lib_cors,VHLx1prL42_tSNV_rna_lib_cors,VHLx1prL42_cSNV_rna_pre_cors,VHLx1prL42_tSNV_rna_pre_cors,VHLx1prL41rL42_cSNV_pre_cors,VHLx1prL41rL42_tSNV_pre_cors,VHLx1prL41rL42_cSNV_pre_lib_ratio_cors,VHLx1prL41rL42_tSNV_pre_lib_ratio_cors,VHLx1prL41rL42_cSNV_post_cors,VHLx1prL41rL42_tSNV_post_cors,VHLx1prL41rL42_cSNV_post_lib_ratio_cors,VHLx1prL41rL42_tSNV_post_lib_ratio_cors,VHLx1prL41rL42_cSNV_post_pre_ratio_cors,VHLx1prL41rL42_tSNV_post_pre_ratio_cors,VHLx1prL41rL42_cSNV_rna_cors,VHLx1prL41rL42_tSNV_rna_cors,VHLx1prL41rL42_tSNV_rna_pre_ratio_cors,VHLx1prL42_cSNV_pre_lib_ratio_cadd_cors,VHLx1prL42_tSNV_pre_lib_ratio_cadd_cors,VHLx1prL42_cSNV_post_lib_ratio_cadd_cors,VHLx1prL42_tSNV_post_lib_ratio_cadd_cors,VHLx1prL42_cSNV_post_pre_ratio_cadd_cors,VHLx1prL42_tSNV_post_pre_ratio_cadd_cors,VHLx1prL42_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1prL42_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1prL42_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prL42_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prL42_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1prL42_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1prL41rL42a_cSNV_pre_lib_ratio_cadd_cors,VHLx1prL41rL42a_tSNV_pre_lib_ratio_cadd_cors,VHLx1prL41rL42a_cSNV_post_lib_ratio_cadd_cors,VHLx1prL41rL42a_tSNV_post_lib_ratio_cadd_cors,VHLx1prL41rL42a_cSNV_post_pre_ratio_cadd_cors,VHLx1prL41rL42a_tSNV_post_pre_ratio_cadd_cors,VHLx1prL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1prL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1prL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1prL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1prL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1prL41rL42w_cSNV_pre_lib_ratio_cadd_cors,VHLx1prL41rL42w_cSNV_post_lib_ratio_cadd_cors,VHLx1prL41rL42w_cSNV_post_pre_ratio_cadd_cors,VHLx1prL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx1prL41)
rm(VHLx1prL42)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx1prL41
VHLx1p_posrange <- range(as.numeric(as.character(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$pos)))
VHLx1p_posseq <- seq(from=VHLx1p_posrange[1], to=VHLx1p_posrange[2])
VHLx1prL41_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1prL41_tHDR_pre_lib_pred <- predict(VHLx1prL41_tHDR_pre_lib_ratio.lo, newdata = VHLx1p_posseq, se=TRUE)
VHLx1prL41_tHDR_pre_lib_pos_effects <- VHLx1prL41_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1prL41_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1prL41_tHDR_pre_lib_pos_effects)
VHLx1prL41_tHDR_pre_lib_pos_effects_ci <- VHLx1prL41_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1prL41_tHDR_pre_lib_pred$df)
VHLx1prL41_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1prL41_tHDR_pre_lib_pos_effects - VHLx1prL41_tHDR_pre_lib_pos_effects_ci
VHLx1prL41_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1prL41_tHDR_pre_lib_pos_effects + VHLx1prL41_tHDR_pre_lib_pos_effects_ci
VHLx1prL41_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1p_posseq, VHLx1prL41_tHDR_pre_lib_pos_effects, VHLx1prL41_tHDR_pre_lib_pos_effects.x, VHLx1prL41_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1prL41_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1prL41_tHDR_pre_lib_pred_se = VHLx1prL41_tHDR_pre_lib_pred$se.fit)
#VHLx1prL42
VHLx1prL42_tHDR_pre_lib_ratio.lo <- loess(log2(rL42_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1prL42_tHDR_pre_lib_pred <- predict(VHLx1prL42_tHDR_pre_lib_ratio.lo, newdata = VHLx1p_posseq, se=TRUE)
VHLx1prL42_tHDR_pre_lib_pos_effects <- VHLx1prL42_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1prL42_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1prL42_tHDR_pre_lib_pos_effects)
VHLx1prL42_tHDR_pre_lib_pos_effects_ci <- VHLx1prL42_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1prL42_tHDR_pre_lib_pred$df)
VHLx1prL42_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1prL42_tHDR_pre_lib_pos_effects - VHLx1prL42_tHDR_pre_lib_pos_effects_ci
VHLx1prL42_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1prL42_tHDR_pre_lib_pos_effects + VHLx1prL42_tHDR_pre_lib_pos_effects_ci
VHLx1prL42_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1p_posseq, VHLx1prL42_tHDR_pre_lib_pos_effects, VHLx1prL42_tHDR_pre_lib_pos_effects.x, VHLx1prL42_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1prL42_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1prL42_tHDR_pre_lib_pred_se = VHLx1prL42_tHDR_pre_lib_pred$se.fit)

#VHLx1prL41rL42
VHLx1prL41rL42_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rL41rL42_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm > 0.7 & VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm > 0.3 & VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1prL41rL42_tHDR_pre_lib_pred <- predict(VHLx1prL41rL42_tHDR_pre_lib_ratio.lo, newdata = VHLx1p_posseq, se=TRUE)
VHLx1prL41rL42_tHDR_pre_lib_pos_effects <- VHLx1prL41rL42_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1prL41rL42_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1prL41rL42_tHDR_pre_lib_pos_effects)
VHLx1prL41rL42_tHDR_pre_lib_pos_effects_ci <- VHLx1prL41rL42_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1prL41rL42_tHDR_pre_lib_pred$df)
VHLx1prL41rL42_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1prL41rL42_tHDR_pre_lib_pos_effects - VHLx1prL41rL42_tHDR_pre_lib_pos_effects_ci
VHLx1prL41rL42_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1prL41rL42_tHDR_pre_lib_pos_effects + VHLx1prL41rL42_tHDR_pre_lib_pos_effects_ci
VHLx1prL41rL42_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1p_posseq, VHLx1prL41rL42_tHDR_pre_lib_pos_effects, VHLx1prL41rL42_tHDR_pre_lib_pos_effects.x, VHLx1prL41rL42_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1prL41rL42_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1prL41rL42_tHDR_pre_lib_pred_se = VHLx1prL41rL42_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rL41, rL42, rL41rL42)
VHLx1prL4_tHDR_pos_merge_df <- VHLx1prL41_prog_map_thresh5_df_rL42_int_ord_df 
VHLx1prL4_tHDR_pos_merge_df <- merge(VHLx1prL4_tHDR_pos_merge_df, VHLx1prL41_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx1prL41_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1prL4_tHDR_pos_merge_df <- merge(VHLx1prL4_tHDR_pos_merge_df, VHLx1prL42_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1prL42_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1prL4_tHDR_pos_merge_df <- merge(VHLx1prL4_tHDR_pos_merge_df, VHLx1prL41rL42_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1prL41rL42_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx1prL4_tHDR_pos_merge_df <- VHLx1prL4_tHDR_pos_merge_df %>% 
  rename(
    rL41_tHDR_pre_lib_pos_effects.x = VHLx1prL41_tHDR_pre_lib_pos_effects.x,
    rL42_tHDR_pre_lib_pos_effects.x = VHLx1prL42_tHDR_pre_lib_pos_effects.x,
    rL41rL42_tHDR_pre_lib_pos_effects.x = VHLx1prL41rL42_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rL41 vs. rL41_fit and vs. mean_fit)
VHLx1prL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41 <- log2(VHLx1prL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1prL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_pos_effects.x
VHLx1prL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx1prL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1prL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1prL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42 <- log2(VHLx1prL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_ratio_synnorm) - VHLx1prL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_pos_effects.x
VHLx1prL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx1prL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_ratio_synnorm) - VHLx1prL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1prL4_tHDR_pos_merge_df$rL41rL42_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx1prL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm) - VHLx1prL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx1prL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_loess_rL41 <- log2(VHLx1prL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1prL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_pos_effects.x
VHLx1prL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx1prL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1prL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1prL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_loess_rL42 <- log2(VHLx1prL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_ratio_synnorm) - VHLx1prL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_pos_effects.x
VHLx1prL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx1prL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_ratio_synnorm) - VHLx1prL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1prL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx1prL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm) - VHLx1prL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rL41 and rL42 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx1prL4_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1prL4_tHDR_post_lib_loess_median_syn_rL41 <- median(VHLx1prL4_tHDR_pos_merge_df[which(VHLx1prL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rL41_tHDR_post_lib_loess_rL41')])
  VHLx1prL4_tHDR_post_lib_loess_median_syn_rL42 <- median(VHLx1prL4_tHDR_pos_merge_df[which(VHLx1prL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rL42_tHDR_post_lib_loess_rL42')])
  } else {
  VHLx1prL4_tHDR_post_lib_loess_median_syn_rL41 <- median(VHLx1prL4_tHDR_pos_merge_df[which(VHLx1prL4_tHDR_pos_merge_df$conseq != 'could be anything'),c('rL41_tHDR_post_lib_loess_rL41')])
  VHLx1prL4_tHDR_post_lib_loess_median_syn_rL42 <- median(VHLx1prL4_tHDR_pos_merge_df[which(VHLx1prL4_tHDR_pos_merge_df$conseq != 'could be anything'),c('rL42_tHDR_post_lib_loess_rL42')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rL41 'e.sns' = exon syn/ns norm.
VHLx1prL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41_e.sns <- (VHLx1prL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41-VHLx1prL4_tHDR_post_lib_loess_median_syn_rL41)
#calculate new b values for rL42 'e.sns' = exon syn/ns norm.
VHLx1prL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42_e.sns <- (VHLx1prL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42-VHLx1prL4_tHDR_post_lib_loess_median_syn_rL42)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx1prL4_tHDR_pos_merge_df$rL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean <- (VHLx1prL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41_e.sns+VHLx1prL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx1prL4_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1prL4_tHDR_post_lib_loess_e.sns_rL41rL42_syn_median <- median(VHLx1prL4_tHDR_pos_merge_df[which(VHLx1prL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('VHLx1prL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean')])
  } else {
  VHLx1prL4_tHDR_post_lib_loess_e.sns_rL41rL42_syn_median <- median(VHLx1prL4_tHDR_pos_merge_df[which(VHLx1prL4_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('VHLx1prL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean')])
}

#RNA analysis
VHLx1prL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1prL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41_tHDR_rna2_rna_ratio <- VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_pseudo_freq/VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq
VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_rna_ratio <- VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_pseudo_freq/VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq
VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41rL42_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41_tHDR_rna2_rna_ratio)+log2(VHLx1prL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_rna_ratio))/2

```

```{r}
#VHLx1arL4
VHLx1arL41_file <- paste(experiment_dir_210729,'VHLx1arL41','_annotated.txt',sep='')
VHLx1arL42_file <- paste(experiment_dir_210729,'VHLx1arL42','_annotated.txt',sep='')
VHLx1arL41 <- read.table(VHLx1arL41_file, header=TRUE, sep="\t")
VHLx1arL42 <- read.table(VHLx1arL42_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx1arL41 <- VHLx1arL41 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

VHLx1arL42 <- VHLx1arL42 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx1a <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx1a'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx1a_HDR_5_SNV = as.character(VHL_editing_info_VHLx1a$HDR_5_SNV)
VHLx1a_HDR_3_SNV = as.character(VHL_editing_info_VHLx1a$HDR_3_SNV)
#VHLx1a_cut_pos = as.character(VHL_editing_info_VHLx1a$cut_pos)
VHLx1a_cut_end = as.character(VHL_editing_info_VHLx1a$cut_end)
VHLx1a_mut_start = as.character(VHL_editing_info_VHLx1a$mut_start)
VHLx1a_mut_end = as.character(VHL_editing_info_VHLx1a$mut_end)

### Replicate 1
VHLx1arL41_cSNV_all <- which(VHLx1arL41[,'c_hdr_snv']=='True')
VHLx1arL41_cSNV_all_df = VHLx1arL41[VHLx1arL41_cSNV_all,]
VHLx1arL41_prog_var_all <- which(VHLx1arL41[,'all_hdr_variant']=='True' & VHLx1arL41[,'edit_string']!='-WT')
VHLx1arL41_prog_var_all_df = VHLx1arL41[VHLx1arL41_prog_var_all,]
VHLx1arL41_prog_map_all = which(VHLx1arL41_prog_var_all_df[,'pos']!='REF')
VHLx1arL41_prog_map_all_df = VHLx1arL41_prog_var_all_df[VHLx1arL41_prog_map_all,]
VHLx1arL41_prog_map_exon_all = which(VHLx1arL41_prog_map_all_df[,'cDNApos']!='REF' & VHLx1arL41_prog_map_all_df[,'cDNApos']!='NA')
VHLx1arL41_prog_map_exon_all_df = VHLx1arL41_prog_map_all_df[VHLx1arL41_prog_map_exon_all,]
VHLx1arL41_prog_map_CADD = which(VHLx1arL41_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1arL41_prog_map_CADD_df = VHLx1arL41_prog_map_all_df[VHLx1arL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx1arL41_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1arL41_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx1arL41_prog_var_thresh5_df = VHLx1arL41_prog_var_all_df[VHLx1arL41_prog_var_thresh5,]
VHLx1arL41_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1arL41_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx1arL41_prog_map_thresh5_df = VHLx1arL41_prog_map_all_df[VHLx1arL41_prog_map_thresh5,]
VHLx1arL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1arL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx1arL41_prog_map_exon_thresh5_df = VHLx1arL41_prog_map_exon_all_df[VHLx1arL41_prog_map_exon_thresh5,]
VHLx1arL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1arL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx1arL41_prog_map_CADD_thresh5_df = VHLx1arL41_prog_map_CADD_df[VHLx1arL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1arL41_prog_var_all_lib_count = length(VHLx1arL41_prog_var_all_df$lib)
VHLx1arL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx1arL41_prog_var_all_min_lib_counts = min(VHLx1arL41_prog_var_all_df$lib)
VHLx1arL41_prog_var_all_min_lib_counts
VHLx1arL41_prog_var_all_max_lib_counts = max(VHLx1arL41_prog_var_all_df$lib)
VHLx1arL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1arL41_prog_map_all_lib_count = length(VHLx1arL41_prog_map_all_df$lib)
VHLx1arL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx1arL41_prog_map_all_min_lib_counts = min(VHLx1arL41_prog_map_all_df$lib)
VHLx1arL41_prog_map_all_min_lib_counts
VHLx1arL41_prog_map_all_max_lib_counts = max(VHLx1arL41_prog_map_all_df$lib)
VHLx1arL41_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx1arL41_prog_var_all_pre_count = length(VHLx1arL41_prog_var_all_df$pre)
VHLx1arL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx1arL41_prog_var_all_min_pre_counts = min(VHLx1arL41_prog_var_all_df$pre)
VHLx1arL41_prog_var_all_min_pre_counts
VHLx1arL41_prog_var_all_max_pre_counts = max(VHLx1arL41_prog_var_all_df$pre)
VHLx1arL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1arL41_prog_map_all_pre_count = length(VHLx1arL41_prog_map_all_df$pre)
VHLx1arL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx1arL41_prog_map_all_min_pre_counts = min(VHLx1arL41_prog_map_all_df$pre)
VHLx1arL41_prog_map_all_min_pre_counts
VHLx1arL41_prog_map_all_max_pre_counts = max(VHLx1arL41_prog_map_all_df$pre)
VHLx1arL41_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx1arL41_prog_map_all_post_count = length(VHLx1arL41_prog_map_all_df$post)
VHLx1arL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx1arL41_prog_map_all_min_post_counts = min(VHLx1arL41_prog_map_all_df$post)
VHLx1arL41_prog_map_all_min_post_counts
VHLx1arL41_prog_map_all_max_post_counts = max(VHLx1arL41_prog_map_all_df$post)
VHLx1arL41_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx1arL41_prog_map_all_syn_df <- VHLx1arL41_prog_map_all_df[which(VHLx1arL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1arL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1arL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1arL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1arL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1arL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1arL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1arL41_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1arL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx1arL41_prog_map_all_min_rna_counts = min(VHLx1arL41_prog_map_exon_all_df$tHDR_rna)
VHLx1arL41_prog_map_all_min_rna_counts
VHLx1arL41_prog_map_all_max_rna_counts = max(VHLx1arL41_prog_map_exon_all_df$tHDR_rna)
VHLx1arL41_prog_map_all_max_rna_counts
VHLx1arL41_prog_map_all_min_rna_pseudo_freq = min(VHLx1arL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1arL41_prog_map_all_min_rna_pseudo_freq
VHLx1arL41_prog_map_all_max_rna_pseudo_freq = max(VHLx1arL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1arL41_prog_map_all_max_rna_pseudo_freq
VHLx1arL41_prog_map_all_min_rna_pre_ratio = min(VHLx1arL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1arL41_prog_map_all_min_rna_pre_ratio
VHLx1arL41_prog_map_all_max_rna_pre_ratio = max(VHLx1arL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1arL41_prog_map_all_max_rna_pre_ratio
VHLx1arL41_prog_map_all_min_rna_post_ratio = min(VHLx1arL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1arL41_prog_map_all_min_rna_post_ratio
VHLx1arL41_prog_map_all_max_rna_post_ratio = max(VHLx1arL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1arL41_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1arL41_cSNV_all_corr_pre_count = length(VHLx1arL41_cSNV_all_df$corr_pre)
VHLx1arL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx1arL41_cSNV_all_min_corr_pre_counts = min(VHLx1arL41_cSNV_all_df$corr_pre)
VHLx1arL41_cSNV_all_min_corr_pre_counts
VHLx1arL41_cSNV_all_max_corr_pre_counts = max(VHLx1arL41_cSNV_all_df$corr_pre)
VHLx1arL41_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx1a less than SGE region length x 3 due to PAM edits
VHLx1arL41_cSNV_all_corr_post_count = length(VHLx1arL41_cSNV_all_df$corr_post)
VHLx1arL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx1arL41_cSNV_all_min_corr_post_counts = min(VHLx1arL41_cSNV_all_df$corr_post)
VHLx1arL41_cSNV_all_min_corr_post_counts
VHLx1arL41_cSNV_all_max_corr_post_counts = max(VHLx1arL41_cSNV_all_df$corr_post)
VHLx1arL41_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx1a_p_hdr_snv = paste('p_hdr_',VHLx1a_cut_end,'_snv',sep='')
VHLx1arL41_pSNV_all <- which(VHLx1arL41[,VHLx1a_p_hdr_snv]=='True')
VHLx1arL41_pSNV_all_df = VHLx1arL41[VHLx1arL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx1a less than SGE region length x 3 due to PAM edits
VHLx1arL41_pSNV_all_lib_count = length(VHLx1arL41_pSNV_all_df$lib)
VHLx1arL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx1arL41_pSNV_all_min_lib_counts = min(VHLx1arL41_pSNV_all_df$lib)
VHLx1arL41_pSNV_all_min_lib_counts
VHLx1arL41_pSNV_all_max_lib_counts = max(VHLx1arL41_pSNV_all_df$lib)
VHLx1arL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx1arL41_pSNV_all_pre_count = length(VHLx1arL41_pSNV_all_df$pre)
VHLx1arL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx1arL41_pSNV_all_min_pre_counts = min(VHLx1arL41_pSNV_all_df$pre)
VHLx1arL41_pSNV_all_min_pre_counts
VHLx1arL41_pSNV_all_max_pre_counts = max(VHLx1arL41_pSNV_all_df$pre)
VHLx1arL41_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx1a less than SGE region length x 3 due to PAM edits
VHLx1arL41_pSNV_all_post_count = length(VHLx1arL41_pSNV_all_df$post)
VHLx1arL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx1arL41_pSNV_all_min_post_counts = min(VHLx1arL41_pSNV_all_df$post)
VHLx1arL41_pSNV_all_min_post_counts
VHLx1arL41_pSNV_all_max_post_counts = max(VHLx1arL41_pSNV_all_df$post)
VHLx1arL41_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx1a less than SGE region length x 3 due to PAM edits
VHLx1arL41_prog_map_thresh5_lib_count = length(VHLx1arL41_prog_map_thresh5_df$lib)
VHLx1arL41_prog_map_thresh5_lib_count
VHLx1arL41_prog_map_thresh5_min_lib_counts = min(VHLx1arL41_prog_map_thresh5_df$lib)
VHLx1arL41_prog_map_thresh5_min_lib_counts
VHLx1arL41_prog_map_thresh5_max_lib_counts = max(VHLx1arL41_prog_map_thresh5_df$lib)
VHLx1arL41_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx1a less than SGE region length x 3 due to PAM edits
VHLx1arL41_prog_map_thresh5_pre_count = length(VHLx1arL41_prog_map_thresh5_df$pre)
VHLx1arL41_prog_map_thresh5_pre_count
VHLx1arL41_prog_map_thresh5_min_pre_counts = min(VHLx1arL41_prog_map_thresh5_df$pre)
VHLx1arL41_prog_map_thresh5_min_pre_counts
VHLx1arL41_prog_map_thresh5_max_pre_counts = max(VHLx1arL41_prog_map_thresh5_df$pre)
VHLx1arL41_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1arL41_prog_map_thresh5_post_count = length(VHLx1arL41_prog_map_thresh5_df$post)
VHLx1arL41_prog_map_thresh5_post_count
VHLx1arL41_prog_map_thresh5_min_post_counts = min(VHLx1arL41_prog_map_thresh5_df$post)
VHLx1arL41_prog_map_thresh5_min_post_counts
VHLx1arL41_prog_map_thresh5_max_post_counts = max(VHLx1arL41_prog_map_thresh5_df$post)
VHLx1arL41_prog_map_thresh5_max_post_counts
VHLx1arL41_prog_map_thresh5_corr_post_count = length(VHLx1arL41_cSNV_all_df$corr_post)
VHLx1arL41_prog_map_thresh5_corr_post_count
VHLx1arL41_prog_map_thresh5_min_corr_post_counts = min(VHLx1arL41_cSNV_all_df$corr_post)
VHLx1arL41_prog_map_thresh5_min_corr_post_counts
VHLx1arL41_prog_map_thresh5_max_corr_post_counts = max(VHLx1arL41_cSNV_all_df$corr_post)
VHLx1arL41_prog_map_thresh5_max_corr_post_counts

VHLx1arL41_pSNV_thresh5 <- which(VHLx1arL41[,VHLx1a_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1arL41[,'pre_freq']))>=0.00001)
VHLx1arL41_pSNV_thresh5_df = VHLx1arL41[VHLx1arL41_pSNV_thresh5,]
VHLx1arL41_pSNV_thresh5_lib_count = length(VHLx1arL41_pSNV_thresh5_df$lib)
VHLx1arL41_pSNV_thresh5_lib_count
VHLx1arL41_pSNV_thresh5_min_lib_counts = min(VHLx1arL41_pSNV_thresh5_df$lib)
VHLx1arL41_pSNV_thresh5_min_lib_counts
VHLx1arL41_pSNV_thresh5_max_lib_counts = max(VHLx1arL41_pSNV_thresh5_df$lib)
VHLx1arL41_pSNV_thresh5_max_lib_counts
VHLx1arL41_pSNV_thresh5_pre_count = length(VHLx1arL41_pSNV_thresh5_df$pre)
VHLx1arL41_pSNV_thresh5_pre_count
VHLx1arL41_pSNV_thresh5_min_pre_counts = min(VHLx1arL41_pSNV_thresh5_df$pre)
VHLx1arL41_pSNV_thresh5_min_pre_counts
VHLx1arL41_pSNV_thresh5_max_pre_counts = max(VHLx1arL41_pSNV_thresh5_df$pre)
VHLx1arL41_pSNV_thresh5_max_pre_counts
VHLx1arL41_pSNV_thresh5_post_count = length(VHLx1arL41_pSNV_thresh5_df$post)
VHLx1arL41_pSNV_thresh5_post_count
VHLx1arL41_pSNV_thresh5_min_post_counts = min(VHLx1arL41_pSNV_thresh5_df$post)
VHLx1arL41_pSNV_thresh5_min_post_counts
VHLx1arL41_pSNV_thresh5_max_post_counts = max(VHLx1arL41_pSNV_thresh5_df$post)
VHLx1arL41_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx1arL42_cSNV_all <- which(VHLx1arL42[,'c_hdr_snv']=='True')
VHLx1arL42_cSNV_all_df = VHLx1arL42[VHLx1arL42_cSNV_all,]
VHLx1arL42_prog_var_all <- which(VHLx1arL42[,'all_hdr_variant']=='True' & VHLx1arL42[,'edit_string']!='-WT')
VHLx1arL42_prog_var_all_df = VHLx1arL42[VHLx1arL42_prog_var_all,]
VHLx1arL42_prog_map_all = which(VHLx1arL42_prog_var_all_df[,'pos']!='REF')
VHLx1arL42_prog_map_all_df = VHLx1arL42_prog_var_all_df[VHLx1arL42_prog_map_all,]
VHLx1arL42_prog_map_exon_all = which(VHLx1arL42_prog_map_all_df[,'cDNApos']!='REF' & VHLx1arL42_prog_map_all_df[,'cDNApos']!='NA')
VHLx1arL42_prog_map_exon_all_df = VHLx1arL42_prog_map_all_df[VHLx1arL42_prog_map_exon_all,]
VHLx1arL42_prog_map_CADD = which(VHLx1arL42_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1arL42_prog_map_CADD_df = VHLx1arL42_prog_map_all_df[VHLx1arL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx1arL42_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1arL42_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx1arL42_prog_var_thresh5_df = VHLx1arL42_prog_var_all_df[VHLx1arL42_prog_var_thresh5,]
VHLx1arL42_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1arL42_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx1arL42_prog_map_thresh5_df = VHLx1arL42_prog_map_all_df[VHLx1arL42_prog_map_thresh5,]
VHLx1arL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1arL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx1arL42_prog_map_exon_thresh5_df = VHLx1arL42_prog_map_exon_all_df[VHLx1arL42_prog_map_exon_thresh5,]
VHLx1arL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1arL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx1arL42_prog_map_CADD_thresh5_df = VHLx1arL42_prog_map_CADD_df[VHLx1arL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1arL42_prog_var_all_lib_count = length(VHLx1arL42_prog_var_all_df$lib)
VHLx1arL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx1arL42_prog_var_all_min_lib_counts = min(VHLx1arL42_prog_var_all_df$lib)
VHLx1arL42_prog_var_all_min_lib_counts
VHLx1arL42_prog_var_all_max_lib_counts = max(VHLx1arL42_prog_var_all_df$lib)
VHLx1arL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1arL42_prog_map_all_lib_count = length(VHLx1arL42_prog_map_all_df$lib)
VHLx1arL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx1arL42_prog_map_all_min_lib_counts = min(VHLx1arL42_prog_map_all_df$lib)
VHLx1arL42_prog_map_all_min_lib_counts
VHLx1arL42_prog_map_all_max_lib_counts = max(VHLx1arL42_prog_map_all_df$lib)
VHLx1arL42_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx1arL42_prog_var_all_pre_count = length(VHLx1arL42_prog_var_all_df$pre)
VHLx1arL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx1arL42_prog_var_all_min_pre_counts = min(VHLx1arL42_prog_var_all_df$pre)
VHLx1arL42_prog_var_all_min_pre_counts
VHLx1arL42_prog_var_all_max_pre_counts = max(VHLx1arL42_prog_var_all_df$pre)
VHLx1arL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1arL42_prog_map_all_pre_count = length(VHLx1arL42_prog_map_all_df$pre)
VHLx1arL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx1arL42_prog_map_all_min_pre_counts = min(VHLx1arL42_prog_map_all_df$pre)
VHLx1arL42_prog_map_all_min_pre_counts
VHLx1arL42_prog_map_all_max_pre_counts = max(VHLx1arL42_prog_map_all_df$pre)
VHLx1arL42_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx1arL42_prog_map_all_post_count = length(VHLx1arL42_prog_map_all_df$post)
VHLx1arL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx1arL42_prog_map_all_min_post_counts = min(VHLx1arL42_prog_map_all_df$post)
VHLx1arL42_prog_map_all_min_post_counts
VHLx1arL42_prog_map_all_max_post_counts = max(VHLx1arL42_prog_map_all_df$post)
VHLx1arL42_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx1arL42_prog_map_all_syn_df <- VHLx1arL42_prog_map_all_df[which(VHLx1arL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1arL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1arL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1arL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1arL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1arL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1arL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1arL42_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1arL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx1arL42_prog_map_all_min_rna_counts = min(VHLx1arL42_prog_map_exon_all_df$tHDR_rna)
VHLx1arL42_prog_map_all_min_rna_counts
VHLx1arL42_prog_map_all_max_rna_counts = max(VHLx1arL42_prog_map_exon_all_df$tHDR_rna)
VHLx1arL42_prog_map_all_max_rna_counts
VHLx1arL42_prog_map_all_min_rna_pseudo_freq = min(VHLx1arL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1arL42_prog_map_all_min_rna_pseudo_freq
VHLx1arL42_prog_map_all_max_rna_pseudo_freq = max(VHLx1arL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1arL42_prog_map_all_max_rna_pseudo_freq
VHLx1arL42_prog_map_all_min_rna_pre_ratio = min(VHLx1arL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1arL42_prog_map_all_min_rna_pre_ratio
VHLx1arL42_prog_map_all_max_rna_pre_ratio = max(VHLx1arL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1arL42_prog_map_all_max_rna_pre_ratio
VHLx1arL42_prog_map_all_min_rna_post_ratio = min(VHLx1arL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1arL42_prog_map_all_min_rna_post_ratio
VHLx1arL42_prog_map_all_max_rna_post_ratio = max(VHLx1arL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1arL42_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1arL42_cSNV_all_corr_pre_count = length(VHLx1arL42_cSNV_all_df$corr_pre)
VHLx1arL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx1arL42_cSNV_all_min_corr_pre_counts = min(VHLx1arL42_cSNV_all_df$corr_pre)
VHLx1arL42_cSNV_all_min_corr_pre_counts
VHLx1arL42_cSNV_all_max_corr_pre_counts = max(VHLx1arL42_cSNV_all_df$corr_pre)
VHLx1arL42_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx1a less than SGE region length x 3 due to PAM edits
VHLx1arL42_cSNV_all_corr_post_count = length(VHLx1arL42_cSNV_all_df$corr_post)
VHLx1arL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx1arL42_cSNV_all_min_corr_post_counts = min(VHLx1arL42_cSNV_all_df$corr_post)
VHLx1arL42_cSNV_all_min_corr_post_counts
VHLx1arL42_cSNV_all_max_corr_post_counts = max(VHLx1arL42_cSNV_all_df$corr_post)
VHLx1arL42_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx1a_p_hdr_snv = paste('p_hdr_',VHLx1a_cut_end,'_snv',sep='')
VHLx1arL42_pSNV_all <- which(VHLx1arL42[,VHLx1a_p_hdr_snv]=='True')
VHLx1arL42_pSNV_all_df = VHLx1arL42[VHLx1arL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx1a less than SGE region length x 3 due to PAM edits
VHLx1arL42_pSNV_all_lib_count = length(VHLx1arL42_pSNV_all_df$lib)
VHLx1arL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx1arL42_pSNV_all_min_lib_counts = min(VHLx1arL42_pSNV_all_df$lib)
VHLx1arL42_pSNV_all_min_lib_counts
VHLx1arL42_pSNV_all_max_lib_counts = max(VHLx1arL42_pSNV_all_df$lib)
VHLx1arL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx1arL42_pSNV_all_pre_count = length(VHLx1arL42_pSNV_all_df$pre)
VHLx1arL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx1arL42_pSNV_all_min_pre_counts = min(VHLx1arL42_pSNV_all_df$pre)
VHLx1arL42_pSNV_all_min_pre_counts
VHLx1arL42_pSNV_all_max_pre_counts = max(VHLx1arL42_pSNV_all_df$pre)
VHLx1arL42_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx1a less than SGE region length x 3 due to PAM edits
VHLx1arL42_pSNV_all_post_count = length(VHLx1arL42_pSNV_all_df$post)
VHLx1arL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx1arL42_pSNV_all_min_post_counts = min(VHLx1arL42_pSNV_all_df$post)
VHLx1arL42_pSNV_all_min_post_counts
VHLx1arL42_pSNV_all_max_post_counts = max(VHLx1arL42_pSNV_all_df$post)
VHLx1arL42_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx1a less than SGE region length x 3 due to PAM edits
VHLx1arL42_prog_map_thresh5_lib_count = length(VHLx1arL42_prog_map_thresh5_df$lib)
VHLx1arL42_prog_map_thresh5_lib_count
VHLx1arL42_prog_map_thresh5_min_lib_counts = min(VHLx1arL42_prog_map_thresh5_df$lib)
VHLx1arL42_prog_map_thresh5_min_lib_counts
VHLx1arL42_prog_map_thresh5_max_lib_counts = max(VHLx1arL42_prog_map_thresh5_df$lib)
VHLx1arL42_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx1a less than SGE region length x 3 due to PAM edits
VHLx1arL42_prog_map_thresh5_pre_count = length(VHLx1arL42_prog_map_thresh5_df$pre)
VHLx1arL42_prog_map_thresh5_pre_count
VHLx1arL42_prog_map_thresh5_min_pre_counts = min(VHLx1arL42_prog_map_thresh5_df$pre)
VHLx1arL42_prog_map_thresh5_min_pre_counts
VHLx1arL42_prog_map_thresh5_max_pre_counts = max(VHLx1arL42_prog_map_thresh5_df$pre)
VHLx1arL42_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1arL42_prog_map_thresh5_post_count = length(VHLx1arL42_prog_map_thresh5_df$post)
VHLx1arL42_prog_map_thresh5_post_count
VHLx1arL42_prog_map_thresh5_min_post_counts = min(VHLx1arL42_prog_map_thresh5_df$post)
VHLx1arL42_prog_map_thresh5_min_post_counts
VHLx1arL42_prog_map_thresh5_max_post_counts = max(VHLx1arL42_prog_map_thresh5_df$post)
VHLx1arL42_prog_map_thresh5_max_post_counts
VHLx1arL42_prog_map_thresh5_corr_post_count = length(VHLx1arL42_cSNV_all_df$corr_post)
VHLx1arL42_prog_map_thresh5_corr_post_count
VHLx1arL42_prog_map_thresh5_min_corr_post_counts = min(VHLx1arL42_cSNV_all_df$corr_post)
VHLx1arL42_prog_map_thresh5_min_corr_post_counts
VHLx1arL42_prog_map_thresh5_max_corr_post_counts = max(VHLx1arL42_cSNV_all_df$corr_post)
VHLx1arL42_prog_map_thresh5_max_corr_post_counts

VHLx1arL42_pSNV_thresh5 <- which(VHLx1arL42[,VHLx1a_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1arL42[,'pre_freq']))>=0.00001)
VHLx1arL42_pSNV_thresh5_df = VHLx1arL42[VHLx1arL42_pSNV_thresh5,]
VHLx1arL42_pSNV_thresh5_lib_count = length(VHLx1arL42_pSNV_thresh5_df$lib)
VHLx1arL42_pSNV_thresh5_lib_count
VHLx1arL42_pSNV_thresh5_min_lib_counts = min(VHLx1arL42_pSNV_thresh5_df$lib)
VHLx1arL42_pSNV_thresh5_min_lib_counts
VHLx1arL42_pSNV_thresh5_max_lib_counts = max(VHLx1arL42_pSNV_thresh5_df$lib)
VHLx1arL42_pSNV_thresh5_max_lib_counts
VHLx1arL42_pSNV_thresh5_pre_count = length(VHLx1arL42_pSNV_thresh5_df$pre)
VHLx1arL42_pSNV_thresh5_pre_count
VHLx1arL42_pSNV_thresh5_min_pre_counts = min(VHLx1arL42_pSNV_thresh5_df$pre)
VHLx1arL42_pSNV_thresh5_min_pre_counts
VHLx1arL42_pSNV_thresh5_max_pre_counts = max(VHLx1arL42_pSNV_thresh5_df$pre)
VHLx1arL42_pSNV_thresh5_max_pre_counts
VHLx1arL42_pSNV_thresh5_post_count = length(VHLx1arL42_pSNV_thresh5_df$post)
VHLx1arL42_pSNV_thresh5_post_count
VHLx1arL42_pSNV_thresh5_min_post_counts = min(VHLx1arL42_pSNV_thresh5_df$post)
VHLx1arL42_pSNV_thresh5_min_post_counts
VHLx1arL42_pSNV_thresh5_max_post_counts = max(VHLx1arL42_pSNV_thresh5_df$post)
VHLx1arL42_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx1arL41_prog_var_thresh5_df:
VHLx1arL41_prog_var_thresh5_df_rL42_int <- VHLx1arL41_prog_var_thresh5_df[which(VHLx1arL41_prog_var_thresh5_df$variant %in% VHLx1arL42_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx1arL42_prog_var_thresh5_df:
VHLx1arL42_prog_var_thresh5_df_rL41_int <- VHLx1arL42_prog_var_thresh5_df[which(VHLx1arL42_prog_var_thresh5_df$variant %in% VHLx1arL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord <- VHLx1arL41_prog_var_thresh5_df_rL42_int[order(VHLx1arL41_prog_var_thresh5_df_rL42_int$variant),]
VHLx1arL42_prog_var_thresh5_df_rL41_int_ord <- VHLx1arL42_prog_var_thresh5_df_rL41_int[order(VHLx1arL42_prog_var_thresh5_df_rL41_int$variant),]
dim(VHLx1arL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
VHLx1arL41rL42int_prog_var_thresh5_pre_count <- dim(VHLx1arL41_prog_var_thresh5_df_rL42_int)[1] 
VHLx1arL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(VHLx1arL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(VHLx1arL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41

#Add the following columns from the from rL42 df to the rL41 df:
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$pre
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$lib
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$rna
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2 <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post2
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3 <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post3
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2 <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$rna2
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pseudo <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post2_pseudo
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pseudo <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post3_pseudo
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_pseudo <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$rna2_pseudo
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post2_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post3_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$rna2_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pseudo_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post2_pseudo_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pseudo_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post3_pseudo_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_pseudo_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$rna2_pseudo_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post2_pre_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pre_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post3_pre_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$rna2_post_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$corr_post
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2 <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3 <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2 <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pseudo_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2_pseudo_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pseudo_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3_pseudo_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_pseudo_freq <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2_pseudo_freq
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2_pre_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pre_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3_pre_ratio
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio <- VHLx1arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio) + log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio))/2)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio) + log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio))/2)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio) + log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio))/2)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio) + log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio))/2)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post3_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post3_pre_ratio) + log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pre_ratio))/2)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rna2_post_ratio_rL41rL42_mean <- 2^((log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rna2_post_ratio) + log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio))/2)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio) + log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio))/2)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio) + log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio))/2)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio) + log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio))/2)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio) + log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio))/2)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- 2^((log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio) + log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio))/2)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio) + log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio))/2)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post3_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post3_pre_ratio) + log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pre_ratio))/2)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean <- 2^((log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio) + log2(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq)) >= 10) {
    VHLx1arL41_cSNV_pre_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx1arL41_cSNV_post_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx1arL41_cSNV_post2_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx1arL41_cSNV_post_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx1arL41_tSNV_pre_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx1arL41_tSNV_post_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx1arL41_tSNV_post_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx1arL41_tSNV_rna_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx1arL41_tSNV_rna_post_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx1arL41_tSNV_rna2_post_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx1arL42_cSNV_pre_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_pre_lib_ratio)
VHLx1arL42_cSNV_post_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post_pre_ratio)
VHLx1arL42_cSNV_post2_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post2_pre_ratio)

VHLx1arL42_cSNV_post_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post_lib_ratio)
VHLx1arL42_tSNV_pre_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_pre_lib_ratio)
VHLx1arL42_tSNV_post_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post_pre_ratio)
VHLx1arL42_tSNV_post2_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post2_pre_ratio)
VHLx1arL42_tSNV_post_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post_lib_ratio)
VHLx1arL42_tSNV_rna_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna_pre_ratio)
VHLx1arL42_tSNV_rna_post_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna_post_ratio)
VHLx1arL42_tSNV_rna2_post_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna2_post_ratio)
VHLx1arL41rL42a_cSNV_pre_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rL41rL42_mean)
VHLx1arL41rL42a_cSNV_post_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rL41rL42_mean)
VHLx1arL41rL42a_cSNV_post2_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rL41rL42_mean)
VHLx1arL41rL42a_cSNV_post_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rL41rL42_mean)
VHLx1arL41rL42a_tSNV_pre_lib_med <- 
  median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rL41rL42_mean)
VHLx1arL41rL42a_tSNV_post_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rL41rL42_mean)
VHLx1arL41rL42a_tSNV_post2_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rL41rL42_mean)
VHLx1arL41rL42a_tSNV_post_lib_med <-
  median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rL41rL42_mean)
VHLx1arL41rL42a_tSNV_rna_pre_med <-
  median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rL41rL42_mean)
VHLx1arL41rL42a_tSNV_rna_post_med <-
  median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rL41rL42_mean)
VHLx1arL41rL42a_tSNV_rna2_post_med <-
  median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rL41rL42_mean)
VHLx1arL41rL42pw_tSNV_post_pre_med  <-
  median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
VHLx1arL41rL42pw_cSNV_post_pre_med  <-
  median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rL41rL42_pre_weighted)
  } else {
  VHLx1arL41_cSNV_pre_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio)
VHLx1arL41_cSNV_post_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio)
VHLx1arL41_cSNV_post2_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio)
VHLx1arL41_cSNV_post_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio)
VHLx1arL41_tSNV_pre_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio)
VHLx1arL41_tSNV_post_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio)
VHLx1arL41_tSNV_post_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio)
VHLx1arL41_tSNV_rna_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio)
VHLx1arL41_tSNV_rna_post_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio)
VHLx1arL41_tSNV_rna2_post_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio)
VHLx1arL42_cSNV_pre_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)
VHLx1arL42_cSNV_post_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)
VHLx1arL42_cSNV_post2_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio)

VHLx1arL42_cSNV_post_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)
VHLx1arL42_tSNV_pre_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)
VHLx1arL42_tSNV_post_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)
VHLx1arL42_tSNV_post2_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio)
VHLx1arL42_tSNV_post_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)
VHLx1arL42_tSNV_rna_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)
VHLx1arL42_tSNV_rna_post_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)
VHLx1arL42_tSNV_rna2_post_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio)
VHLx1arL41rL42a_cSNV_pre_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean)
VHLx1arL41rL42a_cSNV_post_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean)
VHLx1arL41rL42a_cSNV_post2_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_rL41rL42_mean)
VHLx1arL41rL42a_cSNV_post_lib_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean)
VHLx1arL41rL42a_tSNV_pre_lib_med <- 
  median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean)
VHLx1arL41rL42a_tSNV_post_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean)
VHLx1arL41rL42a_tSNV_post2_pre_med <- median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean)
VHLx1arL41rL42a_tSNV_post_lib_med <-
  median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean)
VHLx1arL41rL42a_tSNV_rna_pre_med <-
  median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean)
VHLx1arL41rL42a_tSNV_rna_post_med <-
  median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean)
VHLx1arL41rL42a_tSNV_rna2_post_med <-
  median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean)
VHLx1arL41rL42pw_tSNV_post_pre_med  <-
  median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
VHLx1arL41rL42pw_cSNV_post_pre_med  <-
  median(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted)
}

VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/VHLx1arL41_cSNV_pre_lib_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/VHLx1arL41_cSNV_post_pre_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/VHLx1arL41_cSNV_post_lib_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio/VHLx1arL41_cSNV_post2_pre_med

VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/VHLx1arL41_tSNV_pre_lib_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/VHLx1arL41_tSNV_post_pre_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/VHLx1arL41_tSNV_post_lib_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/VHLx1arL41_tSNV_rna_pre_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/VHLx1arL41_tSNV_rna_post_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio/VHLx1arL42_tSNV_post2_pre_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio/VHLx1arL41_tSNV_rna2_post_med

VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/VHLx1arL42_cSNV_pre_lib_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/VHLx1arL42_cSNV_post_pre_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/VHLx1arL42_cSNV_post_lib_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio/VHLx1arL41rL42a_cSNV_post2_pre_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio/VHLx1arL42_tSNV_rna2_post_med


VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/VHLx1arL42_tSNV_pre_lib_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/VHLx1arL42_tSNV_post_pre_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio/VHLx1arL42_tSNV_post2_pre_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/VHLx1arL42_tSNV_post_lib_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/VHLx1arL42_tSNV_rna_pre_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/VHLx1arL42_tSNV_rna_post_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio/VHLx1arL42_tSNV_rna2_post_med

###normalize the means
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/VHLx1arL41rL42a_cSNV_pre_lib_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/VHLx1arL41rL42a_cSNV_post_pre_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/VHLx1arL41rL42a_cSNV_post_lib_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/VHLx1arL41rL42a_tSNV_pre_lib_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/VHLx1arL41rL42a_tSNV_post_pre_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean/VHLx1arL41rL42a_tSNV_post2_pre_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/VHLx1arL41rL42a_tSNV_post_lib_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/VHLx1arL41rL42a_tSNV_rna_pre_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/VHLx1arL41rL42a_tSNV_rna_post_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean/VHLx1arL41rL42a_tSNV_rna2_post_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/VHLx1arL41rL42pw_tSNV_post_pre_med
VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- VHLx1arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/VHLx1arL41rL42pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx1arL41_prog_var_thresh5_df_rL42_int_ord
VHLx1arL41_prog_map_thresh5_df_rL42_int_ord = which(VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df = VHLx1arL41_prog_var_thresh5_df_rL42_int_ord[VHLx1arL41_prog_map_thresh5_df_rL42_int_ord,]
VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord = which(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df = VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df[VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord,]
VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df[VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord,]
VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx1arL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
VHLx1arL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
VHLx1arL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
VHLx1arL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p
VHLx1arL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
VHLx1arL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
VHLx1arL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
VHLx1arL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p
VHLx1arL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post2_pre_ratio_synnorm),method='spearman')
VHLx1arL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s
VHLx1arL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_p <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post2_pre_ratio_synnorm),method='pearson')
VHLx1arL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_p
VHLx1arL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1arL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
VHLx1arL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx1arL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p
VHLx1arL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1arL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
VHLx1arL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx1arL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p
VHLx1arL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1arL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
VHLx1arL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx1arL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p
VHLx1arL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_s <- cor(log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1arL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_s
VHLx1arL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_p <- cor(log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx1arL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_p
VHLx1arL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
VHLx1arL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
VHLx1arL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$post_pseudo_freq),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pseudo_freq),method='pearson')
VHLx1arL41rL42_cSNV_rL41_post_by_rL42_post_cor_p
VHLx1arL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
VHLx1arL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
VHLx1arL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
VHLx1arL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p
VHLx1arL41rL42_tSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx1arL41rL42_tSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s
VHLx1arL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1arL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
VHLx1arL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1arL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
VHLx1arL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1arL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s
VHLx1arL41rL42_tSNV_rL41_rna2_post_by_rL42_rna2_post_cor_s <- cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1arL41rL42_tSNV_rL41_rna2_post_by_rL42_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx1arL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41_cSNV_post_pre_by_cadd_cor_s
VHLx1arL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL42_cSNV_post_pre_by_cadd_cor_s
VHLx1arL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41_cSNV_post_lib_by_cadd_cor_s
VHLx1arL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL42_cSNV_post_lib_by_cadd_cor_s
VHLx1arL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41_tSNV_post_pre_by_cadd_cor_s
VHLx1arL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL42_tSNV_post_pre_by_cadd_cor_s
VHLx1arL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41_tSNV_post_lib_by_cadd_cor_s
VHLx1arL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx1arL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42a_cSNV_pre_lib_by_cadd_cor_s
VHLx1arL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42w_cSNV_pre_lib_by_cadd_cor_s
VHLx1arL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42a_cSNV_post_pre_by_cadd_cor_s
VHLx1arL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42w_cSNV_post_pre_by_cadd_cor_s
VHLx1arL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42a_cSNV_post_lib_by_cadd_cor_s
VHLx1arL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42w_cSNV_post_lib_by_cadd_cor_s
VHLx1arL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42a_tSNV_pre_lib_by_cadd_cor_s
VHLx1arL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42a_tSNV_post_pre_by_cadd_cor_s
VHLx1arL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42w_tSNV_post_pre_by_cadd_cor_s
VHLx1arL41rL42a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post2_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42a_tSNV_post2_pre_by_cadd_cor_s
VHLx1arL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx1arL41_cSNV_pre_lib_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1arL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1arL41_tSNV_pre_lib_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1arL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1arL41_cSNV_post_lib_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1arL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1arL41_tSNV_post_lib_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1arL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1arL41_cSNV_post_pre_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1arL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1arL41_tSNV_post_pre_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1arL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1arL41_cSNV_rna_lib_cors = cor(log2(VHLx1arL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1arL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1arL41_tSNV_rna_lib_cors = cor(log2(VHLx1arL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1arL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1arL41_cSNV_rna_pre_cors = cor(log2(VHLx1arL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1arL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1arL41_tSNV_rna_pre_cors = cor(log2(VHLx1arL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1arL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1arL41rL42_cSNV_pre_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
VHLx1arL41rL42_tSNV_pre_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
VHLx1arL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
VHLx1arL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
VHLx1arL41rL42_cSNV_post_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
VHLx1arL41rL42_tSNV_post_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
VHLx1arL41rL42_cSNV_post_lib_ratio_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
VHLx1arL41rL42_tSNV_post_lib_ratio_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1arL41rL42_cSNV_post_pre_ratio_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
VHLx1arL41rL42_tSNV_post_pre_ratio_cors = cor(log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1arL41rL42_cSNV_rna_cors = cor(log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
VHLx1arL41rL42_tSNV_rna_cors = cor(log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
VHLx1arL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1arL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1arL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1arL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1arL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1arL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1arL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1arL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1arL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1arL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1arL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1arL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1arL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1arL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1arL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1arL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1arL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1arL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1arL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1arL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1arL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

VHLx1arL41_cors <- c("VHLx1arL41",VHLx1arL41_cSNV_pre_lib_cors,VHLx1arL41_tSNV_pre_lib_cors,VHLx1arL41_cSNV_post_lib_cors,VHLx1arL41_tSNV_post_lib_cors,VHLx1arL41_cSNV_post_pre_cors,VHLx1arL41_tSNV_post_pre_cors,VHLx1arL41_cSNV_rna_lib_cors,VHLx1arL41_tSNV_rna_lib_cors,VHLx1arL41_cSNV_rna_pre_cors,VHLx1arL41_tSNV_rna_pre_cors,VHLx1arL41rL42_cSNV_pre_cors,VHLx1arL41rL42_tSNV_pre_cors,VHLx1arL41rL42_cSNV_pre_lib_ratio_cors,VHLx1arL41rL42_tSNV_pre_lib_ratio_cors,VHLx1arL41rL42_cSNV_post_cors,VHLx1arL41rL42_tSNV_post_cors,VHLx1arL41rL42_cSNV_post_lib_ratio_cors,VHLx1arL41rL42_tSNV_post_lib_ratio_cors,VHLx1arL41rL42_cSNV_post_pre_ratio_cors,VHLx1arL41rL42_tSNV_post_pre_ratio_cors,VHLx1arL41rL42_cSNV_rna_cors,VHLx1arL41rL42_tSNV_rna_cors,VHLx1arL41rL42_tSNV_rna_pre_ratio_cors,VHLx1arL41_cSNV_pre_lib_ratio_cadd_cors,VHLx1arL41_tSNV_pre_lib_ratio_cadd_cors,VHLx1arL41_cSNV_post_lib_ratio_cadd_cors,VHLx1arL41_tSNV_post_lib_ratio_cadd_cors,VHLx1arL41_cSNV_post_pre_ratio_cadd_cors,VHLx1arL41_tSNV_post_pre_ratio_cadd_cors,VHLx1arL41_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1arL41_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1arL41_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1arL41_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1arL41_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1arL41_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1arL41rL42a_cSNV_pre_lib_ratio_cadd_cors,VHLx1arL41rL42a_tSNV_pre_lib_ratio_cadd_cors,VHLx1arL41rL42a_cSNV_post_lib_ratio_cadd_cors,VHLx1arL41rL42a_tSNV_post_lib_ratio_cadd_cors,VHLx1arL41rL42a_cSNV_post_pre_ratio_cadd_cors,VHLx1arL41rL42a_tSNV_post_pre_ratio_cadd_cors,VHLx1arL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1arL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1arL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1arL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1arL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1arL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1arL41rL42w_cSNV_pre_lib_ratio_cadd_cors,VHLx1arL41rL42w_cSNV_post_lib_ratio_cadd_cors,VHLx1arL41rL42w_cSNV_post_pre_ratio_cadd_cors,VHLx1arL41rL42w_tSNV_post_pre_ratio_cadd_cors)

VHLx1arL42_cSNV_pre_lib_cors = cor(log2(VHLx1arL42_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1arL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1arL42_tSNV_pre_lib_cors = cor(log2(VHLx1arL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1arL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1arL42_cSNV_post_lib_cors = cor(log2(VHLx1arL42_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1arL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1arL42_tSNV_post_lib_cors = cor(log2(VHLx1arL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1arL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1arL42_cSNV_post_pre_cors = cor(log2(VHLx1arL42_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1arL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1arL42_tSNV_post_pre_cors = cor(log2(VHLx1arL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1arL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1arL42_cSNV_rna_lib_cors = cor(log2(VHLx1arL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1arL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1arL42_tSNV_rna_lib_cors = cor(log2(VHLx1arL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1arL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1arL42_cSNV_rna_pre_cors = cor(log2(VHLx1arL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1arL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1arL42_tSNV_rna_pre_cors = cor(log2(VHLx1arL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1arL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1arL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1arL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1arL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1arL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1arL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1arL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1arL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1arL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1arL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1arL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1arL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1arL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1arL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1arL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1arL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1arL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1arL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1arL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1arL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1arL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1arL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1arL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1arL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1arL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

VHLx1arL42_cors <- c("VHLx1arL42",VHLx1arL42_cSNV_pre_lib_cors,VHLx1arL42_tSNV_pre_lib_cors,VHLx1arL42_cSNV_post_lib_cors,VHLx1arL42_tSNV_post_lib_cors,VHLx1arL42_cSNV_post_pre_cors,VHLx1arL42_tSNV_post_pre_cors,VHLx1arL42_cSNV_rna_lib_cors,VHLx1arL42_tSNV_rna_lib_cors,VHLx1arL42_cSNV_rna_pre_cors,VHLx1arL42_tSNV_rna_pre_cors,VHLx1arL41rL42_cSNV_pre_cors,VHLx1arL41rL42_tSNV_pre_cors,VHLx1arL41rL42_cSNV_pre_lib_ratio_cors,VHLx1arL41rL42_tSNV_pre_lib_ratio_cors,VHLx1arL41rL42_cSNV_post_cors,VHLx1arL41rL42_tSNV_post_cors,VHLx1arL41rL42_cSNV_post_lib_ratio_cors,VHLx1arL41rL42_tSNV_post_lib_ratio_cors,VHLx1arL41rL42_cSNV_post_pre_ratio_cors,VHLx1arL41rL42_tSNV_post_pre_ratio_cors,VHLx1arL41rL42_cSNV_rna_cors,VHLx1arL41rL42_tSNV_rna_cors,VHLx1arL41rL42_tSNV_rna_pre_ratio_cors,VHLx1arL42_cSNV_pre_lib_ratio_cadd_cors,VHLx1arL42_tSNV_pre_lib_ratio_cadd_cors,VHLx1arL42_cSNV_post_lib_ratio_cadd_cors,VHLx1arL42_tSNV_post_lib_ratio_cadd_cors,VHLx1arL42_cSNV_post_pre_ratio_cadd_cors,VHLx1arL42_tSNV_post_pre_ratio_cadd_cors,VHLx1arL42_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1arL42_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1arL42_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1arL42_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1arL42_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1arL42_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1arL41rL42a_cSNV_pre_lib_ratio_cadd_cors,VHLx1arL41rL42a_tSNV_pre_lib_ratio_cadd_cors,VHLx1arL41rL42a_cSNV_post_lib_ratio_cadd_cors,VHLx1arL41rL42a_tSNV_post_lib_ratio_cadd_cors,VHLx1arL41rL42a_cSNV_post_pre_ratio_cadd_cors,VHLx1arL41rL42a_tSNV_post_pre_ratio_cadd_cors,VHLx1arL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1arL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1arL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1arL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1arL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1arL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1arL41rL42w_cSNV_pre_lib_ratio_cadd_cors,VHLx1arL41rL42w_cSNV_post_lib_ratio_cadd_cors,VHLx1arL41rL42w_cSNV_post_pre_ratio_cadd_cors,VHLx1arL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx1arL41)
rm(VHLx1arL42)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx1arL41
VHLx1a_posrange <- range(as.numeric(as.character(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$pos)))
VHLx1a_posseq <- seq(from=VHLx1a_posrange[1], to=VHLx1a_posrange[2])
VHLx1arL41_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1arL41_tHDR_pre_lib_pred <- predict(VHLx1arL41_tHDR_pre_lib_ratio.lo, newdata = VHLx1a_posseq, se=TRUE)
VHLx1arL41_tHDR_pre_lib_pos_effects <- VHLx1arL41_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1arL41_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1arL41_tHDR_pre_lib_pos_effects)
VHLx1arL41_tHDR_pre_lib_pos_effects_ci <- VHLx1arL41_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1arL41_tHDR_pre_lib_pred$df)
VHLx1arL41_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1arL41_tHDR_pre_lib_pos_effects - VHLx1arL41_tHDR_pre_lib_pos_effects_ci
VHLx1arL41_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1arL41_tHDR_pre_lib_pos_effects + VHLx1arL41_tHDR_pre_lib_pos_effects_ci
VHLx1arL41_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1a_posseq, VHLx1arL41_tHDR_pre_lib_pos_effects, VHLx1arL41_tHDR_pre_lib_pos_effects.x, VHLx1arL41_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1arL41_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1arL41_tHDR_pre_lib_pred_se = VHLx1arL41_tHDR_pre_lib_pred$se.fit)
#VHLx1arL42
VHLx1arL42_tHDR_pre_lib_ratio.lo <- loess(log2(rL42_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1arL42_tHDR_pre_lib_pred <- predict(VHLx1arL42_tHDR_pre_lib_ratio.lo, newdata = VHLx1a_posseq, se=TRUE)
VHLx1arL42_tHDR_pre_lib_pos_effects <- VHLx1arL42_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1arL42_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1arL42_tHDR_pre_lib_pos_effects)
VHLx1arL42_tHDR_pre_lib_pos_effects_ci <- VHLx1arL42_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1arL42_tHDR_pre_lib_pred$df)
VHLx1arL42_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1arL42_tHDR_pre_lib_pos_effects - VHLx1arL42_tHDR_pre_lib_pos_effects_ci
VHLx1arL42_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1arL42_tHDR_pre_lib_pos_effects + VHLx1arL42_tHDR_pre_lib_pos_effects_ci
VHLx1arL42_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1a_posseq, VHLx1arL42_tHDR_pre_lib_pos_effects, VHLx1arL42_tHDR_pre_lib_pos_effects.x, VHLx1arL42_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1arL42_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1arL42_tHDR_pre_lib_pred_se = VHLx1arL42_tHDR_pre_lib_pred$se.fit)

#VHLx1arL41rL42
VHLx1arL41rL42_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rL41rL42_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm > 0.7 & VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm > 0.3 & VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1arL41rL42_tHDR_pre_lib_pred <- predict(VHLx1arL41rL42_tHDR_pre_lib_ratio.lo, newdata = VHLx1a_posseq, se=TRUE)
VHLx1arL41rL42_tHDR_pre_lib_pos_effects <- VHLx1arL41rL42_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1arL41rL42_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1arL41rL42_tHDR_pre_lib_pos_effects)
VHLx1arL41rL42_tHDR_pre_lib_pos_effects_ci <- VHLx1arL41rL42_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1arL41rL42_tHDR_pre_lib_pred$df)
VHLx1arL41rL42_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1arL41rL42_tHDR_pre_lib_pos_effects - VHLx1arL41rL42_tHDR_pre_lib_pos_effects_ci
VHLx1arL41rL42_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1arL41rL42_tHDR_pre_lib_pos_effects + VHLx1arL41rL42_tHDR_pre_lib_pos_effects_ci
VHLx1arL41rL42_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1a_posseq, VHLx1arL41rL42_tHDR_pre_lib_pos_effects, VHLx1arL41rL42_tHDR_pre_lib_pos_effects.x, VHLx1arL41rL42_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1arL41rL42_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1arL41rL42_tHDR_pre_lib_pred_se = VHLx1arL41rL42_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rL41, rL42, rL41rL42)
VHLx1arL4_tHDR_pos_merge_df <- VHLx1arL41_prog_map_thresh5_df_rL42_int_ord_df 
VHLx1arL4_tHDR_pos_merge_df <- merge(VHLx1arL4_tHDR_pos_merge_df, VHLx1arL41_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx1arL41_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1arL4_tHDR_pos_merge_df <- merge(VHLx1arL4_tHDR_pos_merge_df, VHLx1arL42_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1arL42_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1arL4_tHDR_pos_merge_df <- merge(VHLx1arL4_tHDR_pos_merge_df, VHLx1arL41rL42_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1arL41rL42_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx1arL4_tHDR_pos_merge_df <- VHLx1arL4_tHDR_pos_merge_df %>% 
  rename(
    rL41_tHDR_pre_lib_pos_effects.x = VHLx1arL41_tHDR_pre_lib_pos_effects.x,
    rL42_tHDR_pre_lib_pos_effects.x = VHLx1arL42_tHDR_pre_lib_pos_effects.x,
    rL41rL42_tHDR_pre_lib_pos_effects.x = VHLx1arL41rL42_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rL41 vs. rL41_fit and vs. mean_fit)
VHLx1arL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41 <- log2(VHLx1arL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1arL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_pos_effects.x
VHLx1arL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx1arL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1arL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1arL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42 <- log2(VHLx1arL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_ratio_synnorm) - VHLx1arL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_pos_effects.x
VHLx1arL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx1arL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_ratio_synnorm) - VHLx1arL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1arL4_tHDR_pos_merge_df$rL41rL42_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx1arL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm) - VHLx1arL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx1arL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_loess_rL41 <- log2(VHLx1arL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1arL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_pos_effects.x
VHLx1arL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx1arL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1arL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1arL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_loess_rL42 <- log2(VHLx1arL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_ratio_synnorm) - VHLx1arL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_pos_effects.x
VHLx1arL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx1arL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_ratio_synnorm) - VHLx1arL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1arL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx1arL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm) - VHLx1arL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rL41 and rL42 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx1arL4_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1arL4_tHDR_post_lib_loess_median_syn_rL41 <- median(VHLx1arL4_tHDR_pos_merge_df[which(VHLx1arL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rL41_tHDR_post_lib_loess_rL41')])
  VHLx1arL4_tHDR_post_lib_loess_median_syn_rL42 <- median(VHLx1arL4_tHDR_pos_merge_df[which(VHLx1arL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rL42_tHDR_post_lib_loess_rL42')])
  } else {
  VHLx1arL4_tHDR_post_lib_loess_median_syn_rL41 <- median(VHLx1arL4_tHDR_pos_merge_df[which(VHLx1arL4_tHDR_pos_merge_df$conseq != 'could be anything'),c('rL41_tHDR_post_lib_loess_rL41')])
  VHLx1arL4_tHDR_post_lib_loess_median_syn_rL42 <- median(VHLx1arL4_tHDR_pos_merge_df[which(VHLx1arL4_tHDR_pos_merge_df$conseq != 'could be anything'),c('rL42_tHDR_post_lib_loess_rL42')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rL41 'e.sns' = exon syn/ns norm.
VHLx1arL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41_e.sns <- (VHLx1arL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41-VHLx1arL4_tHDR_post_lib_loess_median_syn_rL41)
#calculate new b values for rL42 'e.sns' = exon syn/ns norm.
VHLx1arL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42_e.sns <- (VHLx1arL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42-VHLx1arL4_tHDR_post_lib_loess_median_syn_rL42)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx1arL4_tHDR_pos_merge_df$rL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean <- (VHLx1arL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41_e.sns+VHLx1arL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx1arL4_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1arL4_tHDR_post_lib_loess_e.sns_rL41rL42_syn_median <- median(VHLx1arL4_tHDR_pos_merge_df[which(VHLx1arL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('VHLx1arL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean')])
  } else {
  VHLx1arL4_tHDR_post_lib_loess_e.sns_rL41rL42_syn_median <- median(VHLx1arL4_tHDR_pos_merge_df[which(VHLx1arL4_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('VHLx1arL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean')])
}

#RNA analysis
VHLx1arL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1arL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41_tHDR_rna2_rna_ratio <- VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_pseudo_freq/VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq
VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_rna_ratio <- VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_pseudo_freq/VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq
VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41rL42_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41_tHDR_rna2_rna_ratio)+log2(VHLx1arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_rna_ratio))/2

```

```{r}
#VHLx1crL4
VHLx1crL41_file <- paste(experiment_dir_210729,'VHLx1crL41','_annotated.txt',sep='')
VHLx1crL42_file <- paste(experiment_dir_210729,'VHLx1crL42','_annotated.txt',sep='')
VHLx1crL41 <- read.table(VHLx1crL41_file, header=TRUE, sep="\t")
VHLx1crL42 <- read.table(VHLx1crL42_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx1crL41 <- VHLx1crL41 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

VHLx1crL42 <- VHLx1crL42 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx1c <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx1c'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx1c_HDR_5_SNV = as.character(VHL_editing_info_VHLx1c$HDR_5_SNV)
VHLx1c_HDR_3_SNV = as.character(VHL_editing_info_VHLx1c$HDR_3_SNV)
#VHLx1c_cut_pos = as.character(VHL_editing_info_VHLx1c$cut_pos)
VHLx1c_cut_end = as.character(VHL_editing_info_VHLx1c$cut_end)
VHLx1c_mut_start = as.character(VHL_editing_info_VHLx1c$mut_start)
VHLx1c_mut_end = as.character(VHL_editing_info_VHLx1c$mut_end)

### Replicate 1
VHLx1crL41_cSNV_all <- which(VHLx1crL41[,'c_hdr_snv']=='True')
VHLx1crL41_cSNV_all_df = VHLx1crL41[VHLx1crL41_cSNV_all,]
VHLx1crL41_prog_var_all <- which(VHLx1crL41[,'all_hdr_variant']=='True' & VHLx1crL41[,'edit_string']!='-WT')
VHLx1crL41_prog_var_all_df = VHLx1crL41[VHLx1crL41_prog_var_all,]
VHLx1crL41_prog_map_all = which(VHLx1crL41_prog_var_all_df[,'pos']!='REF')
VHLx1crL41_prog_map_all_df = VHLx1crL41_prog_var_all_df[VHLx1crL41_prog_map_all,]
VHLx1crL41_prog_map_exon_all = which(VHLx1crL41_prog_map_all_df[,'cDNApos']!='REF' & VHLx1crL41_prog_map_all_df[,'cDNApos']!='NA')
VHLx1crL41_prog_map_exon_all_df = VHLx1crL41_prog_map_all_df[VHLx1crL41_prog_map_exon_all,]
VHLx1crL41_prog_map_CADD = which(VHLx1crL41_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1crL41_prog_map_CADD_df = VHLx1crL41_prog_map_all_df[VHLx1crL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx1crL41_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1crL41_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx1crL41_prog_var_thresh5_df = VHLx1crL41_prog_var_all_df[VHLx1crL41_prog_var_thresh5,]
VHLx1crL41_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1crL41_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx1crL41_prog_map_thresh5_df = VHLx1crL41_prog_map_all_df[VHLx1crL41_prog_map_thresh5,]
VHLx1crL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1crL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx1crL41_prog_map_exon_thresh5_df = VHLx1crL41_prog_map_exon_all_df[VHLx1crL41_prog_map_exon_thresh5,]
VHLx1crL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1crL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx1crL41_prog_map_CADD_thresh5_df = VHLx1crL41_prog_map_CADD_df[VHLx1crL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1crL41_prog_var_all_lib_count = length(VHLx1crL41_prog_var_all_df$lib)
VHLx1crL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx1crL41_prog_var_all_min_lib_counts = min(VHLx1crL41_prog_var_all_df$lib)
VHLx1crL41_prog_var_all_min_lib_counts
VHLx1crL41_prog_var_all_max_lib_counts = max(VHLx1crL41_prog_var_all_df$lib)
VHLx1crL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1crL41_prog_map_all_lib_count = length(VHLx1crL41_prog_map_all_df$lib)
VHLx1crL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx1crL41_prog_map_all_min_lib_counts = min(VHLx1crL41_prog_map_all_df$lib)
VHLx1crL41_prog_map_all_min_lib_counts
VHLx1crL41_prog_map_all_max_lib_counts = max(VHLx1crL41_prog_map_all_df$lib)
VHLx1crL41_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx1crL41_prog_var_all_pre_count = length(VHLx1crL41_prog_var_all_df$pre)
VHLx1crL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx1crL41_prog_var_all_min_pre_counts = min(VHLx1crL41_prog_var_all_df$pre)
VHLx1crL41_prog_var_all_min_pre_counts
VHLx1crL41_prog_var_all_max_pre_counts = max(VHLx1crL41_prog_var_all_df$pre)
VHLx1crL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1crL41_prog_map_all_pre_count = length(VHLx1crL41_prog_map_all_df$pre)
VHLx1crL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx1crL41_prog_map_all_min_pre_counts = min(VHLx1crL41_prog_map_all_df$pre)
VHLx1crL41_prog_map_all_min_pre_counts
VHLx1crL41_prog_map_all_max_pre_counts = max(VHLx1crL41_prog_map_all_df$pre)
VHLx1crL41_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx1crL41_prog_map_all_post_count = length(VHLx1crL41_prog_map_all_df$post)
VHLx1crL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx1crL41_prog_map_all_min_post_counts = min(VHLx1crL41_prog_map_all_df$post)
VHLx1crL41_prog_map_all_min_post_counts
VHLx1crL41_prog_map_all_max_post_counts = max(VHLx1crL41_prog_map_all_df$post)
VHLx1crL41_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx1crL41_prog_map_all_syn_df <- VHLx1crL41_prog_map_all_df[which(VHLx1crL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1crL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1crL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1crL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1crL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1crL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1crL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1crL41_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1crL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx1crL41_prog_map_all_min_rna_counts = min(VHLx1crL41_prog_map_exon_all_df$tHDR_rna)
VHLx1crL41_prog_map_all_min_rna_counts
VHLx1crL41_prog_map_all_max_rna_counts = max(VHLx1crL41_prog_map_exon_all_df$tHDR_rna)
VHLx1crL41_prog_map_all_max_rna_counts
VHLx1crL41_prog_map_all_min_rna_pseudo_freq = min(VHLx1crL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1crL41_prog_map_all_min_rna_pseudo_freq
VHLx1crL41_prog_map_all_max_rna_pseudo_freq = max(VHLx1crL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1crL41_prog_map_all_max_rna_pseudo_freq
VHLx1crL41_prog_map_all_min_rna_pre_ratio = min(VHLx1crL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1crL41_prog_map_all_min_rna_pre_ratio
VHLx1crL41_prog_map_all_max_rna_pre_ratio = max(VHLx1crL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1crL41_prog_map_all_max_rna_pre_ratio
VHLx1crL41_prog_map_all_min_rna_post_ratio = min(VHLx1crL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1crL41_prog_map_all_min_rna_post_ratio
VHLx1crL41_prog_map_all_max_rna_post_ratio = max(VHLx1crL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1crL41_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1crL41_cSNV_all_corr_pre_count = length(VHLx1crL41_cSNV_all_df$corr_pre)
VHLx1crL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx1crL41_cSNV_all_min_corr_pre_counts = min(VHLx1crL41_cSNV_all_df$corr_pre)
VHLx1crL41_cSNV_all_min_corr_pre_counts
VHLx1crL41_cSNV_all_max_corr_pre_counts = max(VHLx1crL41_cSNV_all_df$corr_pre)
VHLx1crL41_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx1c less than SGE region length x 3 due to PAM edits
VHLx1crL41_cSNV_all_corr_post_count = length(VHLx1crL41_cSNV_all_df$corr_post)
VHLx1crL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx1crL41_cSNV_all_min_corr_post_counts = min(VHLx1crL41_cSNV_all_df$corr_post)
VHLx1crL41_cSNV_all_min_corr_post_counts
VHLx1crL41_cSNV_all_max_corr_post_counts = max(VHLx1crL41_cSNV_all_df$corr_post)
VHLx1crL41_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx1c_p_hdr_snv = paste('p_hdr_',VHLx1c_cut_end,'_snv',sep='')
VHLx1crL41_pSNV_all <- which(VHLx1crL41[,VHLx1c_p_hdr_snv]=='True')
VHLx1crL41_pSNV_all_df = VHLx1crL41[VHLx1crL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx1c less than SGE region length x 3 due to PAM edits
VHLx1crL41_pSNV_all_lib_count = length(VHLx1crL41_pSNV_all_df$lib)
VHLx1crL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx1crL41_pSNV_all_min_lib_counts = min(VHLx1crL41_pSNV_all_df$lib)
VHLx1crL41_pSNV_all_min_lib_counts
VHLx1crL41_pSNV_all_max_lib_counts = max(VHLx1crL41_pSNV_all_df$lib)
VHLx1crL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx1crL41_pSNV_all_pre_count = length(VHLx1crL41_pSNV_all_df$pre)
VHLx1crL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx1crL41_pSNV_all_min_pre_counts = min(VHLx1crL41_pSNV_all_df$pre)
VHLx1crL41_pSNV_all_min_pre_counts
VHLx1crL41_pSNV_all_max_pre_counts = max(VHLx1crL41_pSNV_all_df$pre)
VHLx1crL41_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx1c less than SGE region length x 3 due to PAM edits
VHLx1crL41_pSNV_all_post_count = length(VHLx1crL41_pSNV_all_df$post)
VHLx1crL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx1crL41_pSNV_all_min_post_counts = min(VHLx1crL41_pSNV_all_df$post)
VHLx1crL41_pSNV_all_min_post_counts
VHLx1crL41_pSNV_all_max_post_counts = max(VHLx1crL41_pSNV_all_df$post)
VHLx1crL41_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx1c less than SGE region length x 3 due to PAM edits
VHLx1crL41_prog_map_thresh5_lib_count = length(VHLx1crL41_prog_map_thresh5_df$lib)
VHLx1crL41_prog_map_thresh5_lib_count
VHLx1crL41_prog_map_thresh5_min_lib_counts = min(VHLx1crL41_prog_map_thresh5_df$lib)
VHLx1crL41_prog_map_thresh5_min_lib_counts
VHLx1crL41_prog_map_thresh5_max_lib_counts = max(VHLx1crL41_prog_map_thresh5_df$lib)
VHLx1crL41_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx1c less than SGE region length x 3 due to PAM edits
VHLx1crL41_prog_map_thresh5_pre_count = length(VHLx1crL41_prog_map_thresh5_df$pre)
VHLx1crL41_prog_map_thresh5_pre_count
VHLx1crL41_prog_map_thresh5_min_pre_counts = min(VHLx1crL41_prog_map_thresh5_df$pre)
VHLx1crL41_prog_map_thresh5_min_pre_counts
VHLx1crL41_prog_map_thresh5_max_pre_counts = max(VHLx1crL41_prog_map_thresh5_df$pre)
VHLx1crL41_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1crL41_prog_map_thresh5_post_count = length(VHLx1crL41_prog_map_thresh5_df$post)
VHLx1crL41_prog_map_thresh5_post_count
VHLx1crL41_prog_map_thresh5_min_post_counts = min(VHLx1crL41_prog_map_thresh5_df$post)
VHLx1crL41_prog_map_thresh5_min_post_counts
VHLx1crL41_prog_map_thresh5_max_post_counts = max(VHLx1crL41_prog_map_thresh5_df$post)
VHLx1crL41_prog_map_thresh5_max_post_counts
VHLx1crL41_prog_map_thresh5_corr_post_count = length(VHLx1crL41_cSNV_all_df$corr_post)
VHLx1crL41_prog_map_thresh5_corr_post_count
VHLx1crL41_prog_map_thresh5_min_corr_post_counts = min(VHLx1crL41_cSNV_all_df$corr_post)
VHLx1crL41_prog_map_thresh5_min_corr_post_counts
VHLx1crL41_prog_map_thresh5_max_corr_post_counts = max(VHLx1crL41_cSNV_all_df$corr_post)
VHLx1crL41_prog_map_thresh5_max_corr_post_counts

VHLx1crL41_pSNV_thresh5 <- which(VHLx1crL41[,VHLx1c_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1crL41[,'pre_freq']))>=0.00001)
VHLx1crL41_pSNV_thresh5_df = VHLx1crL41[VHLx1crL41_pSNV_thresh5,]
VHLx1crL41_pSNV_thresh5_lib_count = length(VHLx1crL41_pSNV_thresh5_df$lib)
VHLx1crL41_pSNV_thresh5_lib_count
VHLx1crL41_pSNV_thresh5_min_lib_counts = min(VHLx1crL41_pSNV_thresh5_df$lib)
VHLx1crL41_pSNV_thresh5_min_lib_counts
VHLx1crL41_pSNV_thresh5_max_lib_counts = max(VHLx1crL41_pSNV_thresh5_df$lib)
VHLx1crL41_pSNV_thresh5_max_lib_counts
VHLx1crL41_pSNV_thresh5_pre_count = length(VHLx1crL41_pSNV_thresh5_df$pre)
VHLx1crL41_pSNV_thresh5_pre_count
VHLx1crL41_pSNV_thresh5_min_pre_counts = min(VHLx1crL41_pSNV_thresh5_df$pre)
VHLx1crL41_pSNV_thresh5_min_pre_counts
VHLx1crL41_pSNV_thresh5_max_pre_counts = max(VHLx1crL41_pSNV_thresh5_df$pre)
VHLx1crL41_pSNV_thresh5_max_pre_counts
VHLx1crL41_pSNV_thresh5_post_count = length(VHLx1crL41_pSNV_thresh5_df$post)
VHLx1crL41_pSNV_thresh5_post_count
VHLx1crL41_pSNV_thresh5_min_post_counts = min(VHLx1crL41_pSNV_thresh5_df$post)
VHLx1crL41_pSNV_thresh5_min_post_counts
VHLx1crL41_pSNV_thresh5_max_post_counts = max(VHLx1crL41_pSNV_thresh5_df$post)
VHLx1crL41_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx1crL42_cSNV_all <- which(VHLx1crL42[,'c_hdr_snv']=='True')
VHLx1crL42_cSNV_all_df = VHLx1crL42[VHLx1crL42_cSNV_all,]
VHLx1crL42_prog_var_all <- which(VHLx1crL42[,'all_hdr_variant']=='True' & VHLx1crL42[,'edit_string']!='-WT')
VHLx1crL42_prog_var_all_df = VHLx1crL42[VHLx1crL42_prog_var_all,]
VHLx1crL42_prog_map_all = which(VHLx1crL42_prog_var_all_df[,'pos']!='REF')
VHLx1crL42_prog_map_all_df = VHLx1crL42_prog_var_all_df[VHLx1crL42_prog_map_all,]
VHLx1crL42_prog_map_exon_all = which(VHLx1crL42_prog_map_all_df[,'cDNApos']!='REF' & VHLx1crL42_prog_map_all_df[,'cDNApos']!='NA')
VHLx1crL42_prog_map_exon_all_df = VHLx1crL42_prog_map_all_df[VHLx1crL42_prog_map_exon_all,]
VHLx1crL42_prog_map_CADD = which(VHLx1crL42_prog_map_all_df[,'CADD.phred']!='NA')
VHLx1crL42_prog_map_CADD_df = VHLx1crL42_prog_map_all_df[VHLx1crL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx1crL42_prog_var_thresh5 <- which(as.numeric(as.character(VHLx1crL42_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx1crL42_prog_var_thresh5_df = VHLx1crL42_prog_var_all_df[VHLx1crL42_prog_var_thresh5,]
VHLx1crL42_prog_map_thresh5 <- which(as.numeric(as.character(VHLx1crL42_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx1crL42_prog_map_thresh5_df = VHLx1crL42_prog_map_all_df[VHLx1crL42_prog_map_thresh5,]
VHLx1crL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx1crL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx1crL42_prog_map_exon_thresh5_df = VHLx1crL42_prog_map_exon_all_df[VHLx1crL42_prog_map_exon_thresh5,]
VHLx1crL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx1crL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx1crL42_prog_map_CADD_thresh5_df = VHLx1crL42_prog_map_CADD_df[VHLx1crL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx1crL42_prog_var_all_lib_count = length(VHLx1crL42_prog_var_all_df$lib)
VHLx1crL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx1crL42_prog_var_all_min_lib_counts = min(VHLx1crL42_prog_var_all_df$lib)
VHLx1crL42_prog_var_all_min_lib_counts
VHLx1crL42_prog_var_all_max_lib_counts = max(VHLx1crL42_prog_var_all_df$lib)
VHLx1crL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx1crL42_prog_map_all_lib_count = length(VHLx1crL42_prog_map_all_df$lib)
VHLx1crL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx1crL42_prog_map_all_min_lib_counts = min(VHLx1crL42_prog_map_all_df$lib)
VHLx1crL42_prog_map_all_min_lib_counts
VHLx1crL42_prog_map_all_max_lib_counts = max(VHLx1crL42_prog_map_all_df$lib)
VHLx1crL42_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx1crL42_prog_var_all_pre_count = length(VHLx1crL42_prog_var_all_df$pre)
VHLx1crL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx1crL42_prog_var_all_min_pre_counts = min(VHLx1crL42_prog_var_all_df$pre)
VHLx1crL42_prog_var_all_min_pre_counts
VHLx1crL42_prog_var_all_max_pre_counts = max(VHLx1crL42_prog_var_all_df$pre)
VHLx1crL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx1crL42_prog_map_all_pre_count = length(VHLx1crL42_prog_map_all_df$pre)
VHLx1crL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx1crL42_prog_map_all_min_pre_counts = min(VHLx1crL42_prog_map_all_df$pre)
VHLx1crL42_prog_map_all_min_pre_counts
VHLx1crL42_prog_map_all_max_pre_counts = max(VHLx1crL42_prog_map_all_df$pre)
VHLx1crL42_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx1crL42_prog_map_all_post_count = length(VHLx1crL42_prog_map_all_df$post)
VHLx1crL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx1crL42_prog_map_all_min_post_counts = min(VHLx1crL42_prog_map_all_df$post)
VHLx1crL42_prog_map_all_min_post_counts
VHLx1crL42_prog_map_all_max_post_counts = max(VHLx1crL42_prog_map_all_df$post)
VHLx1crL42_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx1crL42_prog_map_all_syn_df <- VHLx1crL42_prog_map_all_df[which(VHLx1crL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx1crL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx1crL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx1crL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx1crL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx1crL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx1crL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx1crL42_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx1crL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx1crL42_prog_map_all_min_rna_counts = min(VHLx1crL42_prog_map_exon_all_df$tHDR_rna)
VHLx1crL42_prog_map_all_min_rna_counts
VHLx1crL42_prog_map_all_max_rna_counts = max(VHLx1crL42_prog_map_exon_all_df$tHDR_rna)
VHLx1crL42_prog_map_all_max_rna_counts
VHLx1crL42_prog_map_all_min_rna_pseudo_freq = min(VHLx1crL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1crL42_prog_map_all_min_rna_pseudo_freq
VHLx1crL42_prog_map_all_max_rna_pseudo_freq = max(VHLx1crL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx1crL42_prog_map_all_max_rna_pseudo_freq
VHLx1crL42_prog_map_all_min_rna_pre_ratio = min(VHLx1crL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1crL42_prog_map_all_min_rna_pre_ratio
VHLx1crL42_prog_map_all_max_rna_pre_ratio = max(VHLx1crL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx1crL42_prog_map_all_max_rna_pre_ratio
VHLx1crL42_prog_map_all_min_rna_post_ratio = min(VHLx1crL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1crL42_prog_map_all_min_rna_post_ratio
VHLx1crL42_prog_map_all_max_rna_post_ratio = max(VHLx1crL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx1crL42_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx1crL42_cSNV_all_corr_pre_count = length(VHLx1crL42_cSNV_all_df$corr_pre)
VHLx1crL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx1crL42_cSNV_all_min_corr_pre_counts = min(VHLx1crL42_cSNV_all_df$corr_pre)
VHLx1crL42_cSNV_all_min_corr_pre_counts
VHLx1crL42_cSNV_all_max_corr_pre_counts = max(VHLx1crL42_cSNV_all_df$corr_pre)
VHLx1crL42_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx1c less than SGE region length x 3 due to PAM edits
VHLx1crL42_cSNV_all_corr_post_count = length(VHLx1crL42_cSNV_all_df$corr_post)
VHLx1crL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx1crL42_cSNV_all_min_corr_post_counts = min(VHLx1crL42_cSNV_all_df$corr_post)
VHLx1crL42_cSNV_all_min_corr_post_counts
VHLx1crL42_cSNV_all_max_corr_post_counts = max(VHLx1crL42_cSNV_all_df$corr_post)
VHLx1crL42_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx1c_p_hdr_snv = paste('p_hdr_',VHLx1c_cut_end,'_snv',sep='')
VHLx1crL42_pSNV_all <- which(VHLx1crL42[,VHLx1c_p_hdr_snv]=='True')
VHLx1crL42_pSNV_all_df = VHLx1crL42[VHLx1crL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx1c less than SGE region length x 3 due to PAM edits
VHLx1crL42_pSNV_all_lib_count = length(VHLx1crL42_pSNV_all_df$lib)
VHLx1crL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx1crL42_pSNV_all_min_lib_counts = min(VHLx1crL42_pSNV_all_df$lib)
VHLx1crL42_pSNV_all_min_lib_counts
VHLx1crL42_pSNV_all_max_lib_counts = max(VHLx1crL42_pSNV_all_df$lib)
VHLx1crL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx1crL42_pSNV_all_pre_count = length(VHLx1crL42_pSNV_all_df$pre)
VHLx1crL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx1crL42_pSNV_all_min_pre_counts = min(VHLx1crL42_pSNV_all_df$pre)
VHLx1crL42_pSNV_all_min_pre_counts
VHLx1crL42_pSNV_all_max_pre_counts = max(VHLx1crL42_pSNV_all_df$pre)
VHLx1crL42_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx1c less than SGE region length x 3 due to PAM edits
VHLx1crL42_pSNV_all_post_count = length(VHLx1crL42_pSNV_all_df$post)
VHLx1crL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx1crL42_pSNV_all_min_post_counts = min(VHLx1crL42_pSNV_all_df$post)
VHLx1crL42_pSNV_all_min_post_counts
VHLx1crL42_pSNV_all_max_post_counts = max(VHLx1crL42_pSNV_all_df$post)
VHLx1crL42_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx1c less than SGE region length x 3 due to PAM edits
VHLx1crL42_prog_map_thresh5_lib_count = length(VHLx1crL42_prog_map_thresh5_df$lib)
VHLx1crL42_prog_map_thresh5_lib_count
VHLx1crL42_prog_map_thresh5_min_lib_counts = min(VHLx1crL42_prog_map_thresh5_df$lib)
VHLx1crL42_prog_map_thresh5_min_lib_counts
VHLx1crL42_prog_map_thresh5_max_lib_counts = max(VHLx1crL42_prog_map_thresh5_df$lib)
VHLx1crL42_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx1c less than SGE region length x 3 due to PAM edits
VHLx1crL42_prog_map_thresh5_pre_count = length(VHLx1crL42_prog_map_thresh5_df$pre)
VHLx1crL42_prog_map_thresh5_pre_count
VHLx1crL42_prog_map_thresh5_min_pre_counts = min(VHLx1crL42_prog_map_thresh5_df$pre)
VHLx1crL42_prog_map_thresh5_min_pre_counts
VHLx1crL42_prog_map_thresh5_max_pre_counts = max(VHLx1crL42_prog_map_thresh5_df$pre)
VHLx1crL42_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx1crL42_prog_map_thresh5_post_count = length(VHLx1crL42_prog_map_thresh5_df$post)
VHLx1crL42_prog_map_thresh5_post_count
VHLx1crL42_prog_map_thresh5_min_post_counts = min(VHLx1crL42_prog_map_thresh5_df$post)
VHLx1crL42_prog_map_thresh5_min_post_counts
VHLx1crL42_prog_map_thresh5_max_post_counts = max(VHLx1crL42_prog_map_thresh5_df$post)
VHLx1crL42_prog_map_thresh5_max_post_counts
VHLx1crL42_prog_map_thresh5_corr_post_count = length(VHLx1crL42_cSNV_all_df$corr_post)
VHLx1crL42_prog_map_thresh5_corr_post_count
VHLx1crL42_prog_map_thresh5_min_corr_post_counts = min(VHLx1crL42_cSNV_all_df$corr_post)
VHLx1crL42_prog_map_thresh5_min_corr_post_counts
VHLx1crL42_prog_map_thresh5_max_corr_post_counts = max(VHLx1crL42_cSNV_all_df$corr_post)
VHLx1crL42_prog_map_thresh5_max_corr_post_counts

VHLx1crL42_pSNV_thresh5 <- which(VHLx1crL42[,VHLx1c_p_hdr_snv]=='True' & as.numeric(as.character(VHLx1crL42[,'pre_freq']))>=0.00001)
VHLx1crL42_pSNV_thresh5_df = VHLx1crL42[VHLx1crL42_pSNV_thresh5,]
VHLx1crL42_pSNV_thresh5_lib_count = length(VHLx1crL42_pSNV_thresh5_df$lib)
VHLx1crL42_pSNV_thresh5_lib_count
VHLx1crL42_pSNV_thresh5_min_lib_counts = min(VHLx1crL42_pSNV_thresh5_df$lib)
VHLx1crL42_pSNV_thresh5_min_lib_counts
VHLx1crL42_pSNV_thresh5_max_lib_counts = max(VHLx1crL42_pSNV_thresh5_df$lib)
VHLx1crL42_pSNV_thresh5_max_lib_counts
VHLx1crL42_pSNV_thresh5_pre_count = length(VHLx1crL42_pSNV_thresh5_df$pre)
VHLx1crL42_pSNV_thresh5_pre_count
VHLx1crL42_pSNV_thresh5_min_pre_counts = min(VHLx1crL42_pSNV_thresh5_df$pre)
VHLx1crL42_pSNV_thresh5_min_pre_counts
VHLx1crL42_pSNV_thresh5_max_pre_counts = max(VHLx1crL42_pSNV_thresh5_df$pre)
VHLx1crL42_pSNV_thresh5_max_pre_counts
VHLx1crL42_pSNV_thresh5_post_count = length(VHLx1crL42_pSNV_thresh5_df$post)
VHLx1crL42_pSNV_thresh5_post_count
VHLx1crL42_pSNV_thresh5_min_post_counts = min(VHLx1crL42_pSNV_thresh5_df$post)
VHLx1crL42_pSNV_thresh5_min_post_counts
VHLx1crL42_pSNV_thresh5_max_post_counts = max(VHLx1crL42_pSNV_thresh5_df$post)
VHLx1crL42_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx1crL41_prog_var_thresh5_df:
VHLx1crL41_prog_var_thresh5_df_rL42_int <- VHLx1crL41_prog_var_thresh5_df[which(VHLx1crL41_prog_var_thresh5_df$variant %in% VHLx1crL42_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx1crL42_prog_var_thresh5_df:
VHLx1crL42_prog_var_thresh5_df_rL41_int <- VHLx1crL42_prog_var_thresh5_df[which(VHLx1crL42_prog_var_thresh5_df$variant %in% VHLx1crL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord <- VHLx1crL41_prog_var_thresh5_df_rL42_int[order(VHLx1crL41_prog_var_thresh5_df_rL42_int$variant),]
VHLx1crL42_prog_var_thresh5_df_rL41_int_ord <- VHLx1crL42_prog_var_thresh5_df_rL41_int[order(VHLx1crL42_prog_var_thresh5_df_rL41_int$variant),]
dim(VHLx1crL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
VHLx1crL41rL42int_prog_var_thresh5_pre_count <- dim(VHLx1crL41_prog_var_thresh5_df_rL42_int)[1] 
VHLx1crL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(VHLx1crL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(VHLx1crL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41

#Add the following columns from the from rL42 df to the rL41 df:
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$pre
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$lib
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$rna
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2 <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post2
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3 <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post3
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2 <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$rna2
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pseudo <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post2_pseudo
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pseudo <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post3_pseudo
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_pseudo <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$rna2_pseudo
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post2_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post3_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$rna2_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pseudo_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post2_pseudo_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pseudo_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post3_pseudo_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_pseudo_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$rna2_pseudo_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post2_pre_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pre_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post3_pre_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$rna2_post_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$corr_post
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2 <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3 <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2 <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pseudo_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2_pseudo_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pseudo_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3_pseudo_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_pseudo_freq <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2_pseudo_freq
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2_pre_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pre_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3_pre_ratio
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio <- VHLx1crL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio) + log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio))/2)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio) + log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio))/2)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio) + log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio))/2)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio) + log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio))/2)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post3_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post3_pre_ratio) + log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pre_ratio))/2)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rna2_post_ratio_rL41rL42_mean <- 2^((log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rna2_post_ratio) + log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio))/2)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio) + log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio))/2)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio) + log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio))/2)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio) + log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio))/2)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio) + log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio))/2)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- 2^((log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio) + log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio))/2)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio) + log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio))/2)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post3_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post3_pre_ratio) + log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pre_ratio))/2)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean <- 2^((log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio) + log2(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq)) >= 10) {
    VHLx1crL41_cSNV_pre_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx1crL41_cSNV_post_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx1crL41_cSNV_post2_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx1crL41_cSNV_post_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx1crL41_tSNV_pre_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx1crL41_tSNV_post_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx1crL41_tSNV_post_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx1crL41_tSNV_rna_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx1crL41_tSNV_rna_post_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx1crL41_tSNV_rna2_post_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx1crL42_cSNV_pre_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_pre_lib_ratio)
VHLx1crL42_cSNV_post_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post_pre_ratio)
VHLx1crL42_cSNV_post2_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post2_pre_ratio)

VHLx1crL42_cSNV_post_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post_lib_ratio)
VHLx1crL42_tSNV_pre_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_pre_lib_ratio)
VHLx1crL42_tSNV_post_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post_pre_ratio)
VHLx1crL42_tSNV_post2_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post2_pre_ratio)
VHLx1crL42_tSNV_post_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post_lib_ratio)
VHLx1crL42_tSNV_rna_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna_pre_ratio)
VHLx1crL42_tSNV_rna_post_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna_post_ratio)
VHLx1crL42_tSNV_rna2_post_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna2_post_ratio)
VHLx1crL41rL42a_cSNV_pre_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rL41rL42_mean)
VHLx1crL41rL42a_cSNV_post_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rL41rL42_mean)
VHLx1crL41rL42a_cSNV_post2_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rL41rL42_mean)
VHLx1crL41rL42a_cSNV_post_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rL41rL42_mean)
VHLx1crL41rL42a_tSNV_pre_lib_med <- 
  median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rL41rL42_mean)
VHLx1crL41rL42a_tSNV_post_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rL41rL42_mean)
VHLx1crL41rL42a_tSNV_post2_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rL41rL42_mean)
VHLx1crL41rL42a_tSNV_post_lib_med <-
  median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rL41rL42_mean)
VHLx1crL41rL42a_tSNV_rna_pre_med <-
  median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rL41rL42_mean)
VHLx1crL41rL42a_tSNV_rna_post_med <-
  median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rL41rL42_mean)
VHLx1crL41rL42a_tSNV_rna2_post_med <-
  median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rL41rL42_mean)
VHLx1crL41rL42pw_tSNV_post_pre_med  <-
  median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
VHLx1crL41rL42pw_cSNV_post_pre_med  <-
  median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rL41rL42_pre_weighted)
  } else {
  VHLx1crL41_cSNV_pre_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio)
VHLx1crL41_cSNV_post_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio)
VHLx1crL41_cSNV_post2_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio)
VHLx1crL41_cSNV_post_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio)
VHLx1crL41_tSNV_pre_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio)
VHLx1crL41_tSNV_post_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio)
VHLx1crL41_tSNV_post_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio)
VHLx1crL41_tSNV_rna_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio)
VHLx1crL41_tSNV_rna_post_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio)
VHLx1crL41_tSNV_rna2_post_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio)
VHLx1crL42_cSNV_pre_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)
VHLx1crL42_cSNV_post_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)
VHLx1crL42_cSNV_post2_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio)

VHLx1crL42_cSNV_post_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)
VHLx1crL42_tSNV_pre_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)
VHLx1crL42_tSNV_post_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)
VHLx1crL42_tSNV_post2_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio)
VHLx1crL42_tSNV_post_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)
VHLx1crL42_tSNV_rna_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)
VHLx1crL42_tSNV_rna_post_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)
VHLx1crL42_tSNV_rna2_post_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio)
VHLx1crL41rL42a_cSNV_pre_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean)
VHLx1crL41rL42a_cSNV_post_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean)
VHLx1crL41rL42a_cSNV_post2_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_rL41rL42_mean)
VHLx1crL41rL42a_cSNV_post_lib_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean)
VHLx1crL41rL42a_tSNV_pre_lib_med <- 
  median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean)
VHLx1crL41rL42a_tSNV_post_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean)
VHLx1crL41rL42a_tSNV_post2_pre_med <- median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean)
VHLx1crL41rL42a_tSNV_post_lib_med <-
  median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean)
VHLx1crL41rL42a_tSNV_rna_pre_med <-
  median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean)
VHLx1crL41rL42a_tSNV_rna_post_med <-
  median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean)
VHLx1crL41rL42a_tSNV_rna2_post_med <-
  median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean)
VHLx1crL41rL42pw_tSNV_post_pre_med  <-
  median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
VHLx1crL41rL42pw_cSNV_post_pre_med  <-
  median(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted)
}

VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/VHLx1crL41_cSNV_pre_lib_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/VHLx1crL41_cSNV_post_pre_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/VHLx1crL41_cSNV_post_lib_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio/VHLx1crL41_cSNV_post2_pre_med

VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/VHLx1crL41_tSNV_pre_lib_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/VHLx1crL41_tSNV_post_pre_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/VHLx1crL41_tSNV_post_lib_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/VHLx1crL41_tSNV_rna_pre_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/VHLx1crL41_tSNV_rna_post_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio/VHLx1crL42_tSNV_post2_pre_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio/VHLx1crL41_tSNV_rna2_post_med

VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/VHLx1crL42_cSNV_pre_lib_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/VHLx1crL42_cSNV_post_pre_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/VHLx1crL42_cSNV_post_lib_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio/VHLx1crL41rL42a_cSNV_post2_pre_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio/VHLx1crL42_tSNV_rna2_post_med


VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/VHLx1crL42_tSNV_pre_lib_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/VHLx1crL42_tSNV_post_pre_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio/VHLx1crL42_tSNV_post2_pre_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/VHLx1crL42_tSNV_post_lib_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/VHLx1crL42_tSNV_rna_pre_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/VHLx1crL42_tSNV_rna_post_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio/VHLx1crL42_tSNV_rna2_post_med

###normalize the means
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/VHLx1crL41rL42a_cSNV_pre_lib_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/VHLx1crL41rL42a_cSNV_post_pre_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/VHLx1crL41rL42a_cSNV_post_lib_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/VHLx1crL41rL42a_tSNV_pre_lib_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/VHLx1crL41rL42a_tSNV_post_pre_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean/VHLx1crL41rL42a_tSNV_post2_pre_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/VHLx1crL41rL42a_tSNV_post_lib_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/VHLx1crL41rL42a_tSNV_rna_pre_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/VHLx1crL41rL42a_tSNV_rna_post_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean/VHLx1crL41rL42a_tSNV_rna2_post_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/VHLx1crL41rL42pw_tSNV_post_pre_med
VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- VHLx1crL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/VHLx1crL41rL42pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx1crL41_prog_var_thresh5_df_rL42_int_ord
VHLx1crL41_prog_map_thresh5_df_rL42_int_ord = which(VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df = VHLx1crL41_prog_var_thresh5_df_rL42_int_ord[VHLx1crL41_prog_map_thresh5_df_rL42_int_ord,]
VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord = which(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df = VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df[VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord,]
VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df[VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord,]
VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx1crL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
VHLx1crL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
VHLx1crL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
VHLx1crL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p
VHLx1crL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
VHLx1crL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
VHLx1crL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
VHLx1crL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p
VHLx1crL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post2_pre_ratio_synnorm),method='spearman')
VHLx1crL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s
VHLx1crL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_p <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post2_pre_ratio_synnorm),method='pearson')
VHLx1crL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_p
VHLx1crL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1crL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
VHLx1crL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx1crL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p
VHLx1crL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1crL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
VHLx1crL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx1crL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p
VHLx1crL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1crL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
VHLx1crL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx1crL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p
VHLx1crL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_s <- cor(log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1crL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_s
VHLx1crL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_p <- cor(log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx1crL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_p
VHLx1crL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
VHLx1crL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
VHLx1crL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$post_pseudo_freq),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pseudo_freq),method='pearson')
VHLx1crL41rL42_cSNV_rL41_post_by_rL42_post_cor_p
VHLx1crL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
VHLx1crL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
VHLx1crL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
VHLx1crL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p
VHLx1crL41rL42_tSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx1crL41rL42_tSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s
VHLx1crL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1crL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
VHLx1crL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1crL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
VHLx1crL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1crL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s
VHLx1crL41rL42_tSNV_rL41_rna2_post_by_rL42_rna2_post_cor_s <- cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx1crL41rL42_tSNV_rL41_rna2_post_by_rL42_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx1crL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41_cSNV_post_pre_by_cadd_cor_s
VHLx1crL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL42_cSNV_post_pre_by_cadd_cor_s
VHLx1crL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41_cSNV_post_lib_by_cadd_cor_s
VHLx1crL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL42_cSNV_post_lib_by_cadd_cor_s
VHLx1crL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41_tSNV_post_pre_by_cadd_cor_s
VHLx1crL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL42_tSNV_post_pre_by_cadd_cor_s
VHLx1crL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41_tSNV_post_lib_by_cadd_cor_s
VHLx1crL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx1crL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42a_cSNV_pre_lib_by_cadd_cor_s
VHLx1crL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42w_cSNV_pre_lib_by_cadd_cor_s
VHLx1crL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42a_cSNV_post_pre_by_cadd_cor_s
VHLx1crL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42w_cSNV_post_pre_by_cadd_cor_s
VHLx1crL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42a_cSNV_post_lib_by_cadd_cor_s
VHLx1crL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42w_cSNV_post_lib_by_cadd_cor_s
VHLx1crL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42a_tSNV_pre_lib_by_cadd_cor_s
VHLx1crL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42a_tSNV_post_pre_by_cadd_cor_s
VHLx1crL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42w_tSNV_post_pre_by_cadd_cor_s
VHLx1crL41rL42a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post2_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42a_tSNV_post2_pre_by_cadd_cor_s
VHLx1crL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx1crL41_cSNV_pre_lib_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1crL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1crL41_tSNV_pre_lib_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1crL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1crL41_cSNV_post_lib_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1crL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1crL41_tSNV_post_lib_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1crL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1crL41_cSNV_post_pre_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1crL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1crL41_tSNV_post_pre_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1crL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1crL41_cSNV_rna_lib_cors = cor(log2(VHLx1crL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1crL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1crL41_tSNV_rna_lib_cors = cor(log2(VHLx1crL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1crL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1crL41_cSNV_rna_pre_cors = cor(log2(VHLx1crL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1crL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1crL41_tSNV_rna_pre_cors = cor(log2(VHLx1crL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1crL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1crL41rL42_cSNV_pre_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
VHLx1crL41rL42_tSNV_pre_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
VHLx1crL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
VHLx1crL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
VHLx1crL41rL42_cSNV_post_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
VHLx1crL41rL42_tSNV_post_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
VHLx1crL41rL42_cSNV_post_lib_ratio_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
VHLx1crL41rL42_tSNV_post_lib_ratio_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx1crL41rL42_cSNV_post_pre_ratio_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
VHLx1crL41rL42_tSNV_post_pre_ratio_cors = cor(log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx1crL41rL42_cSNV_rna_cors = cor(log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
VHLx1crL41rL42_tSNV_rna_cors = cor(log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
VHLx1crL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1crL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1crL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1crL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1crL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1crL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1crL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1crL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1crL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1crL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1crL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1crL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1crL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1crL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1crL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1crL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1crL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1crL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1crL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1crL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx1crL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

VHLx1crL41_cors <- c("VHLx1crL41",VHLx1crL41_cSNV_pre_lib_cors,VHLx1crL41_tSNV_pre_lib_cors,VHLx1crL41_cSNV_post_lib_cors,VHLx1crL41_tSNV_post_lib_cors,VHLx1crL41_cSNV_post_pre_cors,VHLx1crL41_tSNV_post_pre_cors,VHLx1crL41_cSNV_rna_lib_cors,VHLx1crL41_tSNV_rna_lib_cors,VHLx1crL41_cSNV_rna_pre_cors,VHLx1crL41_tSNV_rna_pre_cors,VHLx1crL41rL42_cSNV_pre_cors,VHLx1crL41rL42_tSNV_pre_cors,VHLx1crL41rL42_cSNV_pre_lib_ratio_cors,VHLx1crL41rL42_tSNV_pre_lib_ratio_cors,VHLx1crL41rL42_cSNV_post_cors,VHLx1crL41rL42_tSNV_post_cors,VHLx1crL41rL42_cSNV_post_lib_ratio_cors,VHLx1crL41rL42_tSNV_post_lib_ratio_cors,VHLx1crL41rL42_cSNV_post_pre_ratio_cors,VHLx1crL41rL42_tSNV_post_pre_ratio_cors,VHLx1crL41rL42_cSNV_rna_cors,VHLx1crL41rL42_tSNV_rna_cors,VHLx1crL41rL42_tSNV_rna_pre_ratio_cors,VHLx1crL41_cSNV_pre_lib_ratio_cadd_cors,VHLx1crL41_tSNV_pre_lib_ratio_cadd_cors,VHLx1crL41_cSNV_post_lib_ratio_cadd_cors,VHLx1crL41_tSNV_post_lib_ratio_cadd_cors,VHLx1crL41_cSNV_post_pre_ratio_cadd_cors,VHLx1crL41_tSNV_post_pre_ratio_cadd_cors,VHLx1crL41_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1crL41_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1crL41_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1crL41_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1crL41_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1crL41_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1crL41rL42a_cSNV_pre_lib_ratio_cadd_cors,VHLx1crL41rL42a_tSNV_pre_lib_ratio_cadd_cors,VHLx1crL41rL42a_cSNV_post_lib_ratio_cadd_cors,VHLx1crL41rL42a_tSNV_post_lib_ratio_cadd_cors,VHLx1crL41rL42a_cSNV_post_pre_ratio_cadd_cors,VHLx1crL41rL42a_tSNV_post_pre_ratio_cadd_cors,VHLx1crL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1crL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1crL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1crL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1crL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1crL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1crL41rL42w_cSNV_pre_lib_ratio_cadd_cors,VHLx1crL41rL42w_cSNV_post_lib_ratio_cadd_cors,VHLx1crL41rL42w_cSNV_post_pre_ratio_cadd_cors,VHLx1crL41rL42w_tSNV_post_pre_ratio_cadd_cors)

VHLx1crL42_cSNV_pre_lib_cors = cor(log2(VHLx1crL42_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1crL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1crL42_tSNV_pre_lib_cors = cor(log2(VHLx1crL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1crL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1crL42_cSNV_post_lib_cors = cor(log2(VHLx1crL42_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx1crL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx1crL42_tSNV_post_lib_cors = cor(log2(VHLx1crL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1crL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx1crL42_cSNV_post_pre_cors = cor(log2(VHLx1crL42_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx1crL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx1crL42_tSNV_post_pre_cors = cor(log2(VHLx1crL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx1crL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1crL42_cSNV_rna_lib_cors = cor(log2(VHLx1crL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx1crL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1crL42_tSNV_rna_lib_cors = cor(log2(VHLx1crL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx1crL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx1crL42_cSNV_rna_pre_cors = cor(log2(VHLx1crL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx1crL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx1crL42_tSNV_rna_pre_cors = cor(log2(VHLx1crL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx1crL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx1crL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1crL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx1crL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1crL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx1crL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx1crL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1crL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1crL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx1crL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1crL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx1crL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx1crL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1crL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1crL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx1crL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1crL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx1crL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx1crL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx1crL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1crL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx1crL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1crL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx1crL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx1crL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx1crL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

VHLx1crL42_cors <- c("VHLx1crL42",VHLx1crL42_cSNV_pre_lib_cors,VHLx1crL42_tSNV_pre_lib_cors,VHLx1crL42_cSNV_post_lib_cors,VHLx1crL42_tSNV_post_lib_cors,VHLx1crL42_cSNV_post_pre_cors,VHLx1crL42_tSNV_post_pre_cors,VHLx1crL42_cSNV_rna_lib_cors,VHLx1crL42_tSNV_rna_lib_cors,VHLx1crL42_cSNV_rna_pre_cors,VHLx1crL42_tSNV_rna_pre_cors,VHLx1crL41rL42_cSNV_pre_cors,VHLx1crL41rL42_tSNV_pre_cors,VHLx1crL41rL42_cSNV_pre_lib_ratio_cors,VHLx1crL41rL42_tSNV_pre_lib_ratio_cors,VHLx1crL41rL42_cSNV_post_cors,VHLx1crL41rL42_tSNV_post_cors,VHLx1crL41rL42_cSNV_post_lib_ratio_cors,VHLx1crL41rL42_tSNV_post_lib_ratio_cors,VHLx1crL41rL42_cSNV_post_pre_ratio_cors,VHLx1crL41rL42_tSNV_post_pre_ratio_cors,VHLx1crL41rL42_cSNV_rna_cors,VHLx1crL41rL42_tSNV_rna_cors,VHLx1crL41rL42_tSNV_rna_pre_ratio_cors,VHLx1crL42_cSNV_pre_lib_ratio_cadd_cors,VHLx1crL42_tSNV_pre_lib_ratio_cadd_cors,VHLx1crL42_cSNV_post_lib_ratio_cadd_cors,VHLx1crL42_tSNV_post_lib_ratio_cadd_cors,VHLx1crL42_cSNV_post_pre_ratio_cadd_cors,VHLx1crL42_tSNV_post_pre_ratio_cadd_cors,VHLx1crL42_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1crL42_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1crL42_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1crL42_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1crL42_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1crL42_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1crL41rL42a_cSNV_pre_lib_ratio_cadd_cors,VHLx1crL41rL42a_tSNV_pre_lib_ratio_cadd_cors,VHLx1crL41rL42a_cSNV_post_lib_ratio_cadd_cors,VHLx1crL41rL42a_tSNV_post_lib_ratio_cadd_cors,VHLx1crL41rL42a_cSNV_post_pre_ratio_cadd_cors,VHLx1crL41rL42a_tSNV_post_pre_ratio_cadd_cors,VHLx1crL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx1crL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx1crL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx1crL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx1crL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx1crL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx1crL41rL42w_cSNV_pre_lib_ratio_cadd_cors,VHLx1crL41rL42w_cSNV_post_lib_ratio_cadd_cors,VHLx1crL41rL42w_cSNV_post_pre_ratio_cadd_cors,VHLx1crL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx1crL41)
rm(VHLx1crL42)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx1crL41
VHLx1c_posrange <- range(as.numeric(as.character(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$pos)))
VHLx1c_posseq <- seq(from=VHLx1c_posrange[1], to=VHLx1c_posrange[2])
VHLx1crL41_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1crL41_tHDR_pre_lib_pred <- predict(VHLx1crL41_tHDR_pre_lib_ratio.lo, newdata = VHLx1c_posseq, se=TRUE)
VHLx1crL41_tHDR_pre_lib_pos_effects <- VHLx1crL41_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1crL41_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1crL41_tHDR_pre_lib_pos_effects)
VHLx1crL41_tHDR_pre_lib_pos_effects_ci <- VHLx1crL41_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1crL41_tHDR_pre_lib_pred$df)
VHLx1crL41_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1crL41_tHDR_pre_lib_pos_effects - VHLx1crL41_tHDR_pre_lib_pos_effects_ci
VHLx1crL41_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1crL41_tHDR_pre_lib_pos_effects + VHLx1crL41_tHDR_pre_lib_pos_effects_ci
VHLx1crL41_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1c_posseq, VHLx1crL41_tHDR_pre_lib_pos_effects, VHLx1crL41_tHDR_pre_lib_pos_effects.x, VHLx1crL41_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1crL41_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1crL41_tHDR_pre_lib_pred_se = VHLx1crL41_tHDR_pre_lib_pred$se.fit)
#VHLx1crL42
VHLx1crL42_tHDR_pre_lib_ratio.lo <- loess(log2(rL42_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1crL42_tHDR_pre_lib_pred <- predict(VHLx1crL42_tHDR_pre_lib_ratio.lo, newdata = VHLx1c_posseq, se=TRUE)
VHLx1crL42_tHDR_pre_lib_pos_effects <- VHLx1crL42_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1crL42_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1crL42_tHDR_pre_lib_pos_effects)
VHLx1crL42_tHDR_pre_lib_pos_effects_ci <- VHLx1crL42_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1crL42_tHDR_pre_lib_pred$df)
VHLx1crL42_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1crL42_tHDR_pre_lib_pos_effects - VHLx1crL42_tHDR_pre_lib_pos_effects_ci
VHLx1crL42_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1crL42_tHDR_pre_lib_pos_effects + VHLx1crL42_tHDR_pre_lib_pos_effects_ci
VHLx1crL42_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1c_posseq, VHLx1crL42_tHDR_pre_lib_pos_effects, VHLx1crL42_tHDR_pre_lib_pos_effects.x, VHLx1crL42_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1crL42_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1crL42_tHDR_pre_lib_pred_se = VHLx1crL42_tHDR_pre_lib_pred$se.fit)

#VHLx1crL41rL42
VHLx1crL41rL42_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rL41rL42_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm > 0.7 & VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm > 0.3 & VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx1crL41rL42_tHDR_pre_lib_pred <- predict(VHLx1crL41rL42_tHDR_pre_lib_ratio.lo, newdata = VHLx1c_posseq, se=TRUE)
VHLx1crL41rL42_tHDR_pre_lib_pos_effects <- VHLx1crL41rL42_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx1crL41rL42_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx1crL41rL42_tHDR_pre_lib_pos_effects)
VHLx1crL41rL42_tHDR_pre_lib_pos_effects_ci <- VHLx1crL41rL42_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx1crL41rL42_tHDR_pre_lib_pred$df)
VHLx1crL41rL42_tHDR_pre_lib_pos_effects_ci_ymin = VHLx1crL41rL42_tHDR_pre_lib_pos_effects - VHLx1crL41rL42_tHDR_pre_lib_pos_effects_ci
VHLx1crL41rL42_tHDR_pre_lib_pos_effects_ci_ymax = VHLx1crL41rL42_tHDR_pre_lib_pos_effects + VHLx1crL41rL42_tHDR_pre_lib_pos_effects_ci
VHLx1crL41rL42_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx1c_posseq, VHLx1crL41rL42_tHDR_pre_lib_pos_effects, VHLx1crL41rL42_tHDR_pre_lib_pos_effects.x, VHLx1crL41rL42_tHDR_pre_lib_pos_effects_ci_ymin, VHLx1crL41rL42_tHDR_pre_lib_pos_effects_ci_ymax, VHLx1crL41rL42_tHDR_pre_lib_pred_se = VHLx1crL41rL42_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rL41, rL42, rL41rL42)
VHLx1crL4_tHDR_pos_merge_df <- VHLx1crL41_prog_map_thresh5_df_rL42_int_ord_df 
VHLx1crL4_tHDR_pos_merge_df <- merge(VHLx1crL4_tHDR_pos_merge_df, VHLx1crL41_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx1crL41_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1crL4_tHDR_pos_merge_df <- merge(VHLx1crL4_tHDR_pos_merge_df, VHLx1crL42_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1crL42_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx1crL4_tHDR_pos_merge_df <- merge(VHLx1crL4_tHDR_pos_merge_df, VHLx1crL41rL42_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx1crL41rL42_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx1crL4_tHDR_pos_merge_df <- VHLx1crL4_tHDR_pos_merge_df %>% 
  rename(
    rL41_tHDR_pre_lib_pos_effects.x = VHLx1crL41_tHDR_pre_lib_pos_effects.x,
    rL42_tHDR_pre_lib_pos_effects.x = VHLx1crL42_tHDR_pre_lib_pos_effects.x,
    rL41rL42_tHDR_pre_lib_pos_effects.x = VHLx1crL41rL42_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rL41 vs. rL41_fit and vs. mean_fit)
VHLx1crL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41 <- log2(VHLx1crL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1crL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_pos_effects.x
VHLx1crL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx1crL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx1crL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1crL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42 <- log2(VHLx1crL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_ratio_synnorm) - VHLx1crL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_pos_effects.x
VHLx1crL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx1crL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_ratio_synnorm) - VHLx1crL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1crL4_tHDR_pos_merge_df$rL41rL42_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx1crL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm) - VHLx1crL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx1crL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_loess_rL41 <- log2(VHLx1crL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1crL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_pos_effects.x
VHLx1crL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx1crL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx1crL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1crL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_loess_rL42 <- log2(VHLx1crL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_ratio_synnorm) - VHLx1crL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_pos_effects.x
VHLx1crL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx1crL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_ratio_synnorm) - VHLx1crL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx1crL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx1crL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm) - VHLx1crL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rL41 and rL42 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx1crL4_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1crL4_tHDR_post_lib_loess_median_syn_rL41 <- median(VHLx1crL4_tHDR_pos_merge_df[which(VHLx1crL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rL41_tHDR_post_lib_loess_rL41')])
  VHLx1crL4_tHDR_post_lib_loess_median_syn_rL42 <- median(VHLx1crL4_tHDR_pos_merge_df[which(VHLx1crL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rL42_tHDR_post_lib_loess_rL42')])
  } else {
  VHLx1crL4_tHDR_post_lib_loess_median_syn_rL41 <- median(VHLx1crL4_tHDR_pos_merge_df[which(VHLx1crL4_tHDR_pos_merge_df$conseq != 'could be anything'),c('rL41_tHDR_post_lib_loess_rL41')])
  VHLx1crL4_tHDR_post_lib_loess_median_syn_rL42 <- median(VHLx1crL4_tHDR_pos_merge_df[which(VHLx1crL4_tHDR_pos_merge_df$conseq != 'could be anything'),c('rL42_tHDR_post_lib_loess_rL42')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rL41 'e.sns' = exon syn/ns norm.
VHLx1crL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41_e.sns <- (VHLx1crL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41-VHLx1crL4_tHDR_post_lib_loess_median_syn_rL41)
#calculate new b values for rL42 'e.sns' = exon syn/ns norm.
VHLx1crL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42_e.sns <- (VHLx1crL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42-VHLx1crL4_tHDR_post_lib_loess_median_syn_rL42)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx1crL4_tHDR_pos_merge_df$rL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean <- (VHLx1crL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41_e.sns+VHLx1crL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx1crL4_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx1crL4_tHDR_post_lib_loess_e.sns_rL41rL42_syn_median <- median(VHLx1crL4_tHDR_pos_merge_df[which(VHLx1crL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('VHLx1crL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean')])
  } else {
  VHLx1crL4_tHDR_post_lib_loess_e.sns_rL41rL42_syn_median <- median(VHLx1crL4_tHDR_pos_merge_df[which(VHLx1crL4_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('VHLx1crL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean')])
}

#RNA analysis
VHLx1crL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx1crL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41_tHDR_rna2_rna_ratio <- VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_pseudo_freq/VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq
VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_rna_ratio <- VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_pseudo_freq/VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq
VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41rL42_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41_tHDR_rna2_rna_ratio)+log2(VHLx1crL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_rna_ratio))/2

```

```{r}
#VHLx3arL4
VHLx3arL41_file <- paste(experiment_dir_210915,'VHLx3arL41','_annotated.txt',sep='')
VHLx3arL42_file <- paste(experiment_dir_210915,'VHLx3arL42','_annotated.txt',sep='')
VHLx3arL41 <- read.table(VHLx3arL41_file, header=TRUE, sep="\t")
VHLx3arL42 <- read.table(VHLx3arL42_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx3arL41 <- VHLx3arL41 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

VHLx3arL42 <- VHLx3arL42 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx3a <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx3a'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx3a_HDR_5_SNV = as.character(VHL_editing_info_VHLx3a$HDR_5_SNV)
VHLx3a_HDR_3_SNV = as.character(VHL_editing_info_VHLx3a$HDR_3_SNV)
#VHLx3a_cut_pos = as.character(VHL_editing_info_VHLx3a$cut_pos)
VHLx3a_cut_end = as.character(VHL_editing_info_VHLx3a$cut_end)
VHLx3a_mut_start = as.character(VHL_editing_info_VHLx3a$mut_start)
VHLx3a_mut_end = as.character(VHL_editing_info_VHLx3a$mut_end)

### Replicate 1
VHLx3arL41_cSNV_all <- which(VHLx3arL41[,'c_hdr_snv']=='True')
VHLx3arL41_cSNV_all_df = VHLx3arL41[VHLx3arL41_cSNV_all,]
VHLx3arL41_prog_var_all <- which(VHLx3arL41[,'all_hdr_variant']=='True' & VHLx3arL41[,'edit_string']!='-WT')
VHLx3arL41_prog_var_all_df = VHLx3arL41[VHLx3arL41_prog_var_all,]
VHLx3arL41_prog_map_all = which(VHLx3arL41_prog_var_all_df[,'pos']!='REF')
VHLx3arL41_prog_map_all_df = VHLx3arL41_prog_var_all_df[VHLx3arL41_prog_map_all,]
VHLx3arL41_prog_map_exon_all = which(VHLx3arL41_prog_map_all_df[,'cDNApos']!='REF' & VHLx3arL41_prog_map_all_df[,'cDNApos']!='NA')
VHLx3arL41_prog_map_exon_all_df = VHLx3arL41_prog_map_all_df[VHLx3arL41_prog_map_exon_all,]
VHLx3arL41_prog_map_CADD = which(VHLx3arL41_prog_map_all_df[,'CADD.phred']!='NA')
VHLx3arL41_prog_map_CADD_df = VHLx3arL41_prog_map_all_df[VHLx3arL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx3arL41_prog_var_thresh5 <- which(as.numeric(as.character(VHLx3arL41_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx3arL41_prog_var_thresh5_df = VHLx3arL41_prog_var_all_df[VHLx3arL41_prog_var_thresh5,]
VHLx3arL41_prog_map_thresh5 <- which(as.numeric(as.character(VHLx3arL41_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx3arL41_prog_map_thresh5_df = VHLx3arL41_prog_map_all_df[VHLx3arL41_prog_map_thresh5,]
VHLx3arL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx3arL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx3arL41_prog_map_exon_thresh5_df = VHLx3arL41_prog_map_exon_all_df[VHLx3arL41_prog_map_exon_thresh5,]
VHLx3arL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx3arL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx3arL41_prog_map_CADD_thresh5_df = VHLx3arL41_prog_map_CADD_df[VHLx3arL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx3arL41_prog_var_all_lib_count = length(VHLx3arL41_prog_var_all_df$lib)
VHLx3arL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx3arL41_prog_var_all_min_lib_counts = min(VHLx3arL41_prog_var_all_df$lib)
VHLx3arL41_prog_var_all_min_lib_counts
VHLx3arL41_prog_var_all_max_lib_counts = max(VHLx3arL41_prog_var_all_df$lib)
VHLx3arL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx3arL41_prog_map_all_lib_count = length(VHLx3arL41_prog_map_all_df$lib)
VHLx3arL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx3arL41_prog_map_all_min_lib_counts = min(VHLx3arL41_prog_map_all_df$lib)
VHLx3arL41_prog_map_all_min_lib_counts
VHLx3arL41_prog_map_all_max_lib_counts = max(VHLx3arL41_prog_map_all_df$lib)
VHLx3arL41_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx3arL41_prog_var_all_pre_count = length(VHLx3arL41_prog_var_all_df$pre)
VHLx3arL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx3arL41_prog_var_all_min_pre_counts = min(VHLx3arL41_prog_var_all_df$pre)
VHLx3arL41_prog_var_all_min_pre_counts
VHLx3arL41_prog_var_all_max_pre_counts = max(VHLx3arL41_prog_var_all_df$pre)
VHLx3arL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx3arL41_prog_map_all_pre_count = length(VHLx3arL41_prog_map_all_df$pre)
VHLx3arL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx3arL41_prog_map_all_min_pre_counts = min(VHLx3arL41_prog_map_all_df$pre)
VHLx3arL41_prog_map_all_min_pre_counts
VHLx3arL41_prog_map_all_max_pre_counts = max(VHLx3arL41_prog_map_all_df$pre)
VHLx3arL41_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx3arL41_prog_map_all_post_count = length(VHLx3arL41_prog_map_all_df$post)
VHLx3arL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx3arL41_prog_map_all_min_post_counts = min(VHLx3arL41_prog_map_all_df$post)
VHLx3arL41_prog_map_all_min_post_counts
VHLx3arL41_prog_map_all_max_post_counts = max(VHLx3arL41_prog_map_all_df$post)
VHLx3arL41_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx3arL41_prog_map_all_syn_df <- VHLx3arL41_prog_map_all_df[which(VHLx3arL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx3arL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx3arL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx3arL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx3arL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx3arL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx3arL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx3arL41_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx3arL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx3arL41_prog_map_all_min_rna_counts = min(VHLx3arL41_prog_map_exon_all_df$tHDR_rna)
VHLx3arL41_prog_map_all_min_rna_counts
VHLx3arL41_prog_map_all_max_rna_counts = max(VHLx3arL41_prog_map_exon_all_df$tHDR_rna)
VHLx3arL41_prog_map_all_max_rna_counts
VHLx3arL41_prog_map_all_min_rna_pseudo_freq = min(VHLx3arL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3arL41_prog_map_all_min_rna_pseudo_freq
VHLx3arL41_prog_map_all_max_rna_pseudo_freq = max(VHLx3arL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3arL41_prog_map_all_max_rna_pseudo_freq
VHLx3arL41_prog_map_all_min_rna_pre_ratio = min(VHLx3arL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3arL41_prog_map_all_min_rna_pre_ratio
VHLx3arL41_prog_map_all_max_rna_pre_ratio = max(VHLx3arL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3arL41_prog_map_all_max_rna_pre_ratio
VHLx3arL41_prog_map_all_min_rna_post_ratio = min(VHLx3arL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3arL41_prog_map_all_min_rna_post_ratio
VHLx3arL41_prog_map_all_max_rna_post_ratio = max(VHLx3arL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3arL41_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx3arL41_cSNV_all_corr_pre_count = length(VHLx3arL41_cSNV_all_df$corr_pre)
VHLx3arL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx3arL41_cSNV_all_min_corr_pre_counts = min(VHLx3arL41_cSNV_all_df$corr_pre)
VHLx3arL41_cSNV_all_min_corr_pre_counts
VHLx3arL41_cSNV_all_max_corr_pre_counts = max(VHLx3arL41_cSNV_all_df$corr_pre)
VHLx3arL41_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arL41_cSNV_all_corr_post_count = length(VHLx3arL41_cSNV_all_df$corr_post)
VHLx3arL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx3arL41_cSNV_all_min_corr_post_counts = min(VHLx3arL41_cSNV_all_df$corr_post)
VHLx3arL41_cSNV_all_min_corr_post_counts
VHLx3arL41_cSNV_all_max_corr_post_counts = max(VHLx3arL41_cSNV_all_df$corr_post)
VHLx3arL41_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx3a_p_hdr_snv = paste('p_hdr_',VHLx3a_cut_end,'_snv',sep='')
VHLx3arL41_pSNV_all <- which(VHLx3arL41[,VHLx3a_p_hdr_snv]=='True')
VHLx3arL41_pSNV_all_df = VHLx3arL41[VHLx3arL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arL41_pSNV_all_lib_count = length(VHLx3arL41_pSNV_all_df$lib)
VHLx3arL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx3arL41_pSNV_all_min_lib_counts = min(VHLx3arL41_pSNV_all_df$lib)
VHLx3arL41_pSNV_all_min_lib_counts
VHLx3arL41_pSNV_all_max_lib_counts = max(VHLx3arL41_pSNV_all_df$lib)
VHLx3arL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx3arL41_pSNV_all_pre_count = length(VHLx3arL41_pSNV_all_df$pre)
VHLx3arL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx3arL41_pSNV_all_min_pre_counts = min(VHLx3arL41_pSNV_all_df$pre)
VHLx3arL41_pSNV_all_min_pre_counts
VHLx3arL41_pSNV_all_max_pre_counts = max(VHLx3arL41_pSNV_all_df$pre)
VHLx3arL41_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arL41_pSNV_all_post_count = length(VHLx3arL41_pSNV_all_df$post)
VHLx3arL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx3arL41_pSNV_all_min_post_counts = min(VHLx3arL41_pSNV_all_df$post)
VHLx3arL41_pSNV_all_min_post_counts
VHLx3arL41_pSNV_all_max_post_counts = max(VHLx3arL41_pSNV_all_df$post)
VHLx3arL41_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arL41_prog_map_thresh5_lib_count = length(VHLx3arL41_prog_map_thresh5_df$lib)
VHLx3arL41_prog_map_thresh5_lib_count
VHLx3arL41_prog_map_thresh5_min_lib_counts = min(VHLx3arL41_prog_map_thresh5_df$lib)
VHLx3arL41_prog_map_thresh5_min_lib_counts
VHLx3arL41_prog_map_thresh5_max_lib_counts = max(VHLx3arL41_prog_map_thresh5_df$lib)
VHLx3arL41_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arL41_prog_map_thresh5_pre_count = length(VHLx3arL41_prog_map_thresh5_df$pre)
VHLx3arL41_prog_map_thresh5_pre_count
VHLx3arL41_prog_map_thresh5_min_pre_counts = min(VHLx3arL41_prog_map_thresh5_df$pre)
VHLx3arL41_prog_map_thresh5_min_pre_counts
VHLx3arL41_prog_map_thresh5_max_pre_counts = max(VHLx3arL41_prog_map_thresh5_df$pre)
VHLx3arL41_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx3arL41_prog_map_thresh5_post_count = length(VHLx3arL41_prog_map_thresh5_df$post)
VHLx3arL41_prog_map_thresh5_post_count
VHLx3arL41_prog_map_thresh5_min_post_counts = min(VHLx3arL41_prog_map_thresh5_df$post)
VHLx3arL41_prog_map_thresh5_min_post_counts
VHLx3arL41_prog_map_thresh5_max_post_counts = max(VHLx3arL41_prog_map_thresh5_df$post)
VHLx3arL41_prog_map_thresh5_max_post_counts
VHLx3arL41_prog_map_thresh5_corr_post_count = length(VHLx3arL41_cSNV_all_df$corr_post)
VHLx3arL41_prog_map_thresh5_corr_post_count
VHLx3arL41_prog_map_thresh5_min_corr_post_counts = min(VHLx3arL41_cSNV_all_df$corr_post)
VHLx3arL41_prog_map_thresh5_min_corr_post_counts
VHLx3arL41_prog_map_thresh5_max_corr_post_counts = max(VHLx3arL41_cSNV_all_df$corr_post)
VHLx3arL41_prog_map_thresh5_max_corr_post_counts

VHLx3arL41_pSNV_thresh5 <- which(VHLx3arL41[,VHLx3a_p_hdr_snv]=='True' & as.numeric(as.character(VHLx3arL41[,'pre_freq']))>=0.00001)
VHLx3arL41_pSNV_thresh5_df = VHLx3arL41[VHLx3arL41_pSNV_thresh5,]
VHLx3arL41_pSNV_thresh5_lib_count = length(VHLx3arL41_pSNV_thresh5_df$lib)
VHLx3arL41_pSNV_thresh5_lib_count
VHLx3arL41_pSNV_thresh5_min_lib_counts = min(VHLx3arL41_pSNV_thresh5_df$lib)
VHLx3arL41_pSNV_thresh5_min_lib_counts
VHLx3arL41_pSNV_thresh5_max_lib_counts = max(VHLx3arL41_pSNV_thresh5_df$lib)
VHLx3arL41_pSNV_thresh5_max_lib_counts
VHLx3arL41_pSNV_thresh5_pre_count = length(VHLx3arL41_pSNV_thresh5_df$pre)
VHLx3arL41_pSNV_thresh5_pre_count
VHLx3arL41_pSNV_thresh5_min_pre_counts = min(VHLx3arL41_pSNV_thresh5_df$pre)
VHLx3arL41_pSNV_thresh5_min_pre_counts
VHLx3arL41_pSNV_thresh5_max_pre_counts = max(VHLx3arL41_pSNV_thresh5_df$pre)
VHLx3arL41_pSNV_thresh5_max_pre_counts
VHLx3arL41_pSNV_thresh5_post_count = length(VHLx3arL41_pSNV_thresh5_df$post)
VHLx3arL41_pSNV_thresh5_post_count
VHLx3arL41_pSNV_thresh5_min_post_counts = min(VHLx3arL41_pSNV_thresh5_df$post)
VHLx3arL41_pSNV_thresh5_min_post_counts
VHLx3arL41_pSNV_thresh5_max_post_counts = max(VHLx3arL41_pSNV_thresh5_df$post)
VHLx3arL41_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx3arL42_cSNV_all <- which(VHLx3arL42[,'c_hdr_snv']=='True')
VHLx3arL42_cSNV_all_df = VHLx3arL42[VHLx3arL42_cSNV_all,]
VHLx3arL42_prog_var_all <- which(VHLx3arL42[,'all_hdr_variant']=='True' & VHLx3arL42[,'edit_string']!='-WT')
VHLx3arL42_prog_var_all_df = VHLx3arL42[VHLx3arL42_prog_var_all,]
VHLx3arL42_prog_map_all = which(VHLx3arL42_prog_var_all_df[,'pos']!='REF')
VHLx3arL42_prog_map_all_df = VHLx3arL42_prog_var_all_df[VHLx3arL42_prog_map_all,]
VHLx3arL42_prog_map_exon_all = which(VHLx3arL42_prog_map_all_df[,'cDNApos']!='REF' & VHLx3arL42_prog_map_all_df[,'cDNApos']!='NA')
VHLx3arL42_prog_map_exon_all_df = VHLx3arL42_prog_map_all_df[VHLx3arL42_prog_map_exon_all,]
VHLx3arL42_prog_map_CADD = which(VHLx3arL42_prog_map_all_df[,'CADD.phred']!='NA')
VHLx3arL42_prog_map_CADD_df = VHLx3arL42_prog_map_all_df[VHLx3arL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx3arL42_prog_var_thresh5 <- which(as.numeric(as.character(VHLx3arL42_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx3arL42_prog_var_thresh5_df = VHLx3arL42_prog_var_all_df[VHLx3arL42_prog_var_thresh5,]
VHLx3arL42_prog_map_thresh5 <- which(as.numeric(as.character(VHLx3arL42_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx3arL42_prog_map_thresh5_df = VHLx3arL42_prog_map_all_df[VHLx3arL42_prog_map_thresh5,]
VHLx3arL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx3arL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx3arL42_prog_map_exon_thresh5_df = VHLx3arL42_prog_map_exon_all_df[VHLx3arL42_prog_map_exon_thresh5,]
VHLx3arL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx3arL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx3arL42_prog_map_CADD_thresh5_df = VHLx3arL42_prog_map_CADD_df[VHLx3arL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx3arL42_prog_var_all_lib_count = length(VHLx3arL42_prog_var_all_df$lib)
VHLx3arL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx3arL42_prog_var_all_min_lib_counts = min(VHLx3arL42_prog_var_all_df$lib)
VHLx3arL42_prog_var_all_min_lib_counts
VHLx3arL42_prog_var_all_max_lib_counts = max(VHLx3arL42_prog_var_all_df$lib)
VHLx3arL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx3arL42_prog_map_all_lib_count = length(VHLx3arL42_prog_map_all_df$lib)
VHLx3arL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx3arL42_prog_map_all_min_lib_counts = min(VHLx3arL42_prog_map_all_df$lib)
VHLx3arL42_prog_map_all_min_lib_counts
VHLx3arL42_prog_map_all_max_lib_counts = max(VHLx3arL42_prog_map_all_df$lib)
VHLx3arL42_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx3arL42_prog_var_all_pre_count = length(VHLx3arL42_prog_var_all_df$pre)
VHLx3arL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx3arL42_prog_var_all_min_pre_counts = min(VHLx3arL42_prog_var_all_df$pre)
VHLx3arL42_prog_var_all_min_pre_counts
VHLx3arL42_prog_var_all_max_pre_counts = max(VHLx3arL42_prog_var_all_df$pre)
VHLx3arL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx3arL42_prog_map_all_pre_count = length(VHLx3arL42_prog_map_all_df$pre)
VHLx3arL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx3arL42_prog_map_all_min_pre_counts = min(VHLx3arL42_prog_map_all_df$pre)
VHLx3arL42_prog_map_all_min_pre_counts
VHLx3arL42_prog_map_all_max_pre_counts = max(VHLx3arL42_prog_map_all_df$pre)
VHLx3arL42_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx3arL42_prog_map_all_post_count = length(VHLx3arL42_prog_map_all_df$post)
VHLx3arL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx3arL42_prog_map_all_min_post_counts = min(VHLx3arL42_prog_map_all_df$post)
VHLx3arL42_prog_map_all_min_post_counts
VHLx3arL42_prog_map_all_max_post_counts = max(VHLx3arL42_prog_map_all_df$post)
VHLx3arL42_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx3arL42_prog_map_all_syn_df <- VHLx3arL42_prog_map_all_df[which(VHLx3arL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx3arL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx3arL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx3arL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx3arL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx3arL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx3arL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx3arL42_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx3arL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx3arL42_prog_map_all_min_rna_counts = min(VHLx3arL42_prog_map_exon_all_df$tHDR_rna)
VHLx3arL42_prog_map_all_min_rna_counts
VHLx3arL42_prog_map_all_max_rna_counts = max(VHLx3arL42_prog_map_exon_all_df$tHDR_rna)
VHLx3arL42_prog_map_all_max_rna_counts
VHLx3arL42_prog_map_all_min_rna_pseudo_freq = min(VHLx3arL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3arL42_prog_map_all_min_rna_pseudo_freq
VHLx3arL42_prog_map_all_max_rna_pseudo_freq = max(VHLx3arL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3arL42_prog_map_all_max_rna_pseudo_freq
VHLx3arL42_prog_map_all_min_rna_pre_ratio = min(VHLx3arL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3arL42_prog_map_all_min_rna_pre_ratio
VHLx3arL42_prog_map_all_max_rna_pre_ratio = max(VHLx3arL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3arL42_prog_map_all_max_rna_pre_ratio
VHLx3arL42_prog_map_all_min_rna_post_ratio = min(VHLx3arL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3arL42_prog_map_all_min_rna_post_ratio
VHLx3arL42_prog_map_all_max_rna_post_ratio = max(VHLx3arL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3arL42_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx3arL42_cSNV_all_corr_pre_count = length(VHLx3arL42_cSNV_all_df$corr_pre)
VHLx3arL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx3arL42_cSNV_all_min_corr_pre_counts = min(VHLx3arL42_cSNV_all_df$corr_pre)
VHLx3arL42_cSNV_all_min_corr_pre_counts
VHLx3arL42_cSNV_all_max_corr_pre_counts = max(VHLx3arL42_cSNV_all_df$corr_pre)
VHLx3arL42_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arL42_cSNV_all_corr_post_count = length(VHLx3arL42_cSNV_all_df$corr_post)
VHLx3arL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx3arL42_cSNV_all_min_corr_post_counts = min(VHLx3arL42_cSNV_all_df$corr_post)
VHLx3arL42_cSNV_all_min_corr_post_counts
VHLx3arL42_cSNV_all_max_corr_post_counts = max(VHLx3arL42_cSNV_all_df$corr_post)
VHLx3arL42_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx3a_p_hdr_snv = paste('p_hdr_',VHLx3a_cut_end,'_snv',sep='')
VHLx3arL42_pSNV_all <- which(VHLx3arL42[,VHLx3a_p_hdr_snv]=='True')
VHLx3arL42_pSNV_all_df = VHLx3arL42[VHLx3arL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arL42_pSNV_all_lib_count = length(VHLx3arL42_pSNV_all_df$lib)
VHLx3arL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx3arL42_pSNV_all_min_lib_counts = min(VHLx3arL42_pSNV_all_df$lib)
VHLx3arL42_pSNV_all_min_lib_counts
VHLx3arL42_pSNV_all_max_lib_counts = max(VHLx3arL42_pSNV_all_df$lib)
VHLx3arL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx3arL42_pSNV_all_pre_count = length(VHLx3arL42_pSNV_all_df$pre)
VHLx3arL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx3arL42_pSNV_all_min_pre_counts = min(VHLx3arL42_pSNV_all_df$pre)
VHLx3arL42_pSNV_all_min_pre_counts
VHLx3arL42_pSNV_all_max_pre_counts = max(VHLx3arL42_pSNV_all_df$pre)
VHLx3arL42_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arL42_pSNV_all_post_count = length(VHLx3arL42_pSNV_all_df$post)
VHLx3arL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx3arL42_pSNV_all_min_post_counts = min(VHLx3arL42_pSNV_all_df$post)
VHLx3arL42_pSNV_all_min_post_counts
VHLx3arL42_pSNV_all_max_post_counts = max(VHLx3arL42_pSNV_all_df$post)
VHLx3arL42_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arL42_prog_map_thresh5_lib_count = length(VHLx3arL42_prog_map_thresh5_df$lib)
VHLx3arL42_prog_map_thresh5_lib_count
VHLx3arL42_prog_map_thresh5_min_lib_counts = min(VHLx3arL42_prog_map_thresh5_df$lib)
VHLx3arL42_prog_map_thresh5_min_lib_counts
VHLx3arL42_prog_map_thresh5_max_lib_counts = max(VHLx3arL42_prog_map_thresh5_df$lib)
VHLx3arL42_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arL42_prog_map_thresh5_pre_count = length(VHLx3arL42_prog_map_thresh5_df$pre)
VHLx3arL42_prog_map_thresh5_pre_count
VHLx3arL42_prog_map_thresh5_min_pre_counts = min(VHLx3arL42_prog_map_thresh5_df$pre)
VHLx3arL42_prog_map_thresh5_min_pre_counts
VHLx3arL42_prog_map_thresh5_max_pre_counts = max(VHLx3arL42_prog_map_thresh5_df$pre)
VHLx3arL42_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx3arL42_prog_map_thresh5_post_count = length(VHLx3arL42_prog_map_thresh5_df$post)
VHLx3arL42_prog_map_thresh5_post_count
VHLx3arL42_prog_map_thresh5_min_post_counts = min(VHLx3arL42_prog_map_thresh5_df$post)
VHLx3arL42_prog_map_thresh5_min_post_counts
VHLx3arL42_prog_map_thresh5_max_post_counts = max(VHLx3arL42_prog_map_thresh5_df$post)
VHLx3arL42_prog_map_thresh5_max_post_counts
VHLx3arL42_prog_map_thresh5_corr_post_count = length(VHLx3arL42_cSNV_all_df$corr_post)
VHLx3arL42_prog_map_thresh5_corr_post_count
VHLx3arL42_prog_map_thresh5_min_corr_post_counts = min(VHLx3arL42_cSNV_all_df$corr_post)
VHLx3arL42_prog_map_thresh5_min_corr_post_counts
VHLx3arL42_prog_map_thresh5_max_corr_post_counts = max(VHLx3arL42_cSNV_all_df$corr_post)
VHLx3arL42_prog_map_thresh5_max_corr_post_counts

VHLx3arL42_pSNV_thresh5 <- which(VHLx3arL42[,VHLx3a_p_hdr_snv]=='True' & as.numeric(as.character(VHLx3arL42[,'pre_freq']))>=0.00001)
VHLx3arL42_pSNV_thresh5_df = VHLx3arL42[VHLx3arL42_pSNV_thresh5,]
VHLx3arL42_pSNV_thresh5_lib_count = length(VHLx3arL42_pSNV_thresh5_df$lib)
VHLx3arL42_pSNV_thresh5_lib_count
VHLx3arL42_pSNV_thresh5_min_lib_counts = min(VHLx3arL42_pSNV_thresh5_df$lib)
VHLx3arL42_pSNV_thresh5_min_lib_counts
VHLx3arL42_pSNV_thresh5_max_lib_counts = max(VHLx3arL42_pSNV_thresh5_df$lib)
VHLx3arL42_pSNV_thresh5_max_lib_counts
VHLx3arL42_pSNV_thresh5_pre_count = length(VHLx3arL42_pSNV_thresh5_df$pre)
VHLx3arL42_pSNV_thresh5_pre_count
VHLx3arL42_pSNV_thresh5_min_pre_counts = min(VHLx3arL42_pSNV_thresh5_df$pre)
VHLx3arL42_pSNV_thresh5_min_pre_counts
VHLx3arL42_pSNV_thresh5_max_pre_counts = max(VHLx3arL42_pSNV_thresh5_df$pre)
VHLx3arL42_pSNV_thresh5_max_pre_counts
VHLx3arL42_pSNV_thresh5_post_count = length(VHLx3arL42_pSNV_thresh5_df$post)
VHLx3arL42_pSNV_thresh5_post_count
VHLx3arL42_pSNV_thresh5_min_post_counts = min(VHLx3arL42_pSNV_thresh5_df$post)
VHLx3arL42_pSNV_thresh5_min_post_counts
VHLx3arL42_pSNV_thresh5_max_post_counts = max(VHLx3arL42_pSNV_thresh5_df$post)
VHLx3arL42_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx3arL41_prog_var_thresh5_df:
VHLx3arL41_prog_var_thresh5_df_rL42_int <- VHLx3arL41_prog_var_thresh5_df[which(VHLx3arL41_prog_var_thresh5_df$variant %in% VHLx3arL42_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx3arL42_prog_var_thresh5_df:
VHLx3arL42_prog_var_thresh5_df_rL41_int <- VHLx3arL42_prog_var_thresh5_df[which(VHLx3arL42_prog_var_thresh5_df$variant %in% VHLx3arL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord <- VHLx3arL41_prog_var_thresh5_df_rL42_int[order(VHLx3arL41_prog_var_thresh5_df_rL42_int$variant),]
VHLx3arL42_prog_var_thresh5_df_rL41_int_ord <- VHLx3arL42_prog_var_thresh5_df_rL41_int[order(VHLx3arL42_prog_var_thresh5_df_rL41_int$variant),]
dim(VHLx3arL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
VHLx3arL41rL42int_prog_var_thresh5_pre_count <- dim(VHLx3arL41_prog_var_thresh5_df_rL42_int)[1] 
VHLx3arL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(VHLx3arL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(VHLx3arL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41

#Add the following columns from the from rL42 df to the rL41 df:
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$pre
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$lib
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$rna
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2 <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post2
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3 <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post3
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2 <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$rna2
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pseudo <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post2_pseudo
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pseudo <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post3_pseudo
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_pseudo <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$rna2_pseudo
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post2_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post3_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$rna2_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pseudo_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post2_pseudo_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pseudo_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post3_pseudo_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_pseudo_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$rna2_pseudo_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post2_pre_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pre_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post3_pre_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$rna2_post_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$corr_post
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2 <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3 <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2 <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pseudo_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2_pseudo_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pseudo_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3_pseudo_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_pseudo_freq <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2_pseudo_freq
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2_pre_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pre_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3_pre_ratio
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio <- VHLx3arL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio) + log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio))/2)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio) + log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio))/2)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio) + log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio))/2)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio) + log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio))/2)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post3_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post3_pre_ratio) + log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pre_ratio))/2)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rna2_post_ratio_rL41rL42_mean <- 2^((log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rna2_post_ratio) + log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio))/2)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio) + log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio))/2)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio) + log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio))/2)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio) + log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio))/2)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio) + log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio))/2)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- 2^((log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio) + log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio))/2)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio) + log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio))/2)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post3_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post3_pre_ratio) + log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pre_ratio))/2)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean <- 2^((log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio) + log2(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq)) >= 10) {
    VHLx3arL41_cSNV_pre_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx3arL41_cSNV_post_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx3arL41_cSNV_post2_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx3arL41_cSNV_post_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx3arL41_tSNV_pre_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx3arL41_tSNV_post_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx3arL41_tSNV_post_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx3arL41_tSNV_rna_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx3arL41_tSNV_rna_post_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx3arL41_tSNV_rna2_post_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx3arL42_cSNV_pre_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_pre_lib_ratio)
VHLx3arL42_cSNV_post_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post_pre_ratio)
VHLx3arL42_cSNV_post2_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post2_pre_ratio)

VHLx3arL42_cSNV_post_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post_lib_ratio)
VHLx3arL42_tSNV_pre_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_pre_lib_ratio)
VHLx3arL42_tSNV_post_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post_pre_ratio)
VHLx3arL42_tSNV_post2_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post2_pre_ratio)
VHLx3arL42_tSNV_post_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post_lib_ratio)
VHLx3arL42_tSNV_rna_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna_pre_ratio)
VHLx3arL42_tSNV_rna_post_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna_post_ratio)
VHLx3arL42_tSNV_rna2_post_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna2_post_ratio)
VHLx3arL41rL42a_cSNV_pre_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rL41rL42_mean)
VHLx3arL41rL42a_cSNV_post_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rL41rL42_mean)
VHLx3arL41rL42a_cSNV_post2_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rL41rL42_mean)
VHLx3arL41rL42a_cSNV_post_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rL41rL42_mean)
VHLx3arL41rL42a_tSNV_pre_lib_med <- 
  median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rL41rL42_mean)
VHLx3arL41rL42a_tSNV_post_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rL41rL42_mean)
VHLx3arL41rL42a_tSNV_post2_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rL41rL42_mean)
VHLx3arL41rL42a_tSNV_post_lib_med <-
  median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rL41rL42_mean)
VHLx3arL41rL42a_tSNV_rna_pre_med <-
  median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rL41rL42_mean)
VHLx3arL41rL42a_tSNV_rna_post_med <-
  median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rL41rL42_mean)
VHLx3arL41rL42a_tSNV_rna2_post_med <-
  median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rL41rL42_mean)
VHLx3arL41rL42pw_tSNV_post_pre_med  <-
  median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
VHLx3arL41rL42pw_cSNV_post_pre_med  <-
  median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rL41rL42_pre_weighted)
  } else {
  VHLx3arL41_cSNV_pre_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio)
VHLx3arL41_cSNV_post_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio)
VHLx3arL41_cSNV_post2_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio)
VHLx3arL41_cSNV_post_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio)
VHLx3arL41_tSNV_pre_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio)
VHLx3arL41_tSNV_post_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio)
VHLx3arL41_tSNV_post_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio)
VHLx3arL41_tSNV_rna_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio)
VHLx3arL41_tSNV_rna_post_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio)
VHLx3arL41_tSNV_rna2_post_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio)
VHLx3arL42_cSNV_pre_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)
VHLx3arL42_cSNV_post_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)
VHLx3arL42_cSNV_post2_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio)

VHLx3arL42_cSNV_post_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)
VHLx3arL42_tSNV_pre_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)
VHLx3arL42_tSNV_post_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)
VHLx3arL42_tSNV_post2_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio)
VHLx3arL42_tSNV_post_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)
VHLx3arL42_tSNV_rna_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)
VHLx3arL42_tSNV_rna_post_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)
VHLx3arL42_tSNV_rna2_post_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio)
VHLx3arL41rL42a_cSNV_pre_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean)
VHLx3arL41rL42a_cSNV_post_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean)
VHLx3arL41rL42a_cSNV_post2_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_rL41rL42_mean)
VHLx3arL41rL42a_cSNV_post_lib_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean)
VHLx3arL41rL42a_tSNV_pre_lib_med <- 
  median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean)
VHLx3arL41rL42a_tSNV_post_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean)
VHLx3arL41rL42a_tSNV_post2_pre_med <- median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean)
VHLx3arL41rL42a_tSNV_post_lib_med <-
  median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean)
VHLx3arL41rL42a_tSNV_rna_pre_med <-
  median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean)
VHLx3arL41rL42a_tSNV_rna_post_med <-
  median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean)
VHLx3arL41rL42a_tSNV_rna2_post_med <-
  median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean)
VHLx3arL41rL42pw_tSNV_post_pre_med  <-
  median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
VHLx3arL41rL42pw_cSNV_post_pre_med  <-
  median(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted)
}

VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/VHLx3arL41_cSNV_pre_lib_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/VHLx3arL41_cSNV_post_pre_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/VHLx3arL41_cSNV_post_lib_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio/VHLx3arL41_cSNV_post2_pre_med

VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/VHLx3arL41_tSNV_pre_lib_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/VHLx3arL41_tSNV_post_pre_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/VHLx3arL41_tSNV_post_lib_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/VHLx3arL41_tSNV_rna_pre_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/VHLx3arL41_tSNV_rna_post_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio/VHLx3arL42_tSNV_post2_pre_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio/VHLx3arL41_tSNV_rna2_post_med

VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/VHLx3arL42_cSNV_pre_lib_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/VHLx3arL42_cSNV_post_pre_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/VHLx3arL42_cSNV_post_lib_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio/VHLx3arL41rL42a_cSNV_post2_pre_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio/VHLx3arL42_tSNV_rna2_post_med


VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/VHLx3arL42_tSNV_pre_lib_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/VHLx3arL42_tSNV_post_pre_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio/VHLx3arL42_tSNV_post2_pre_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/VHLx3arL42_tSNV_post_lib_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/VHLx3arL42_tSNV_rna_pre_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/VHLx3arL42_tSNV_rna_post_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio/VHLx3arL42_tSNV_rna2_post_med

###normalize the means
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/VHLx3arL41rL42a_cSNV_pre_lib_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/VHLx3arL41rL42a_cSNV_post_pre_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/VHLx3arL41rL42a_cSNV_post_lib_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/VHLx3arL41rL42a_tSNV_pre_lib_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/VHLx3arL41rL42a_tSNV_post_pre_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean/VHLx3arL41rL42a_tSNV_post2_pre_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/VHLx3arL41rL42a_tSNV_post_lib_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/VHLx3arL41rL42a_tSNV_rna_pre_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/VHLx3arL41rL42a_tSNV_rna_post_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean/VHLx3arL41rL42a_tSNV_rna2_post_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/VHLx3arL41rL42pw_tSNV_post_pre_med
VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- VHLx3arL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/VHLx3arL41rL42pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx3arL41_prog_var_thresh5_df_rL42_int_ord
VHLx3arL41_prog_map_thresh5_df_rL42_int_ord = which(VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df = VHLx3arL41_prog_var_thresh5_df_rL42_int_ord[VHLx3arL41_prog_map_thresh5_df_rL42_int_ord,]
VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord = which(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df = VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df[VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord,]
VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df[VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord,]
VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx3arL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
VHLx3arL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
VHLx3arL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
VHLx3arL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p
VHLx3arL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
VHLx3arL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
VHLx3arL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
VHLx3arL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p
VHLx3arL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post2_pre_ratio_synnorm),method='spearman')
VHLx3arL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s
VHLx3arL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_p <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post2_pre_ratio_synnorm),method='pearson')
VHLx3arL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_p
VHLx3arL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx3arL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
VHLx3arL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx3arL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p
VHLx3arL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx3arL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
VHLx3arL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx3arL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p
VHLx3arL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3arL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
VHLx3arL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx3arL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p
VHLx3arL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_s <- cor(log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx3arL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_s
VHLx3arL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_p <- cor(log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx3arL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_p
VHLx3arL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
VHLx3arL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
VHLx3arL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$post_pseudo_freq),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pseudo_freq),method='pearson')
VHLx3arL41rL42_cSNV_rL41_post_by_rL42_post_cor_p
VHLx3arL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
VHLx3arL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
VHLx3arL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
VHLx3arL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p
VHLx3arL41rL42_tSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx3arL41rL42_tSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s
VHLx3arL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx3arL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
VHLx3arL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx3arL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
VHLx3arL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3arL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s
VHLx3arL41rL42_tSNV_rL41_rna2_post_by_rL42_rna2_post_cor_s <- cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx3arL41rL42_tSNV_rL41_rna2_post_by_rL42_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx3arL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41_cSNV_post_pre_by_cadd_cor_s
VHLx3arL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL42_cSNV_post_pre_by_cadd_cor_s
VHLx3arL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41_cSNV_post_lib_by_cadd_cor_s
VHLx3arL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL42_cSNV_post_lib_by_cadd_cor_s
VHLx3arL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41_tSNV_post_pre_by_cadd_cor_s
VHLx3arL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL42_tSNV_post_pre_by_cadd_cor_s
VHLx3arL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41_tSNV_post_lib_by_cadd_cor_s
VHLx3arL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx3arL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42a_cSNV_pre_lib_by_cadd_cor_s
VHLx3arL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42w_cSNV_pre_lib_by_cadd_cor_s
VHLx3arL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42a_cSNV_post_pre_by_cadd_cor_s
VHLx3arL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42w_cSNV_post_pre_by_cadd_cor_s
VHLx3arL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42a_cSNV_post_lib_by_cadd_cor_s
VHLx3arL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42w_cSNV_post_lib_by_cadd_cor_s
VHLx3arL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42a_tSNV_pre_lib_by_cadd_cor_s
VHLx3arL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42a_tSNV_post_pre_by_cadd_cor_s
VHLx3arL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42w_tSNV_post_pre_by_cadd_cor_s
VHLx3arL41rL42a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post2_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42a_tSNV_post2_pre_by_cadd_cor_s
VHLx3arL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx3arL41_cSNV_pre_lib_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3arL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3arL41_tSNV_pre_lib_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arL41_cSNV_post_lib_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3arL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx3arL41_tSNV_post_lib_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx3arL41_cSNV_post_pre_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx3arL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3arL41_tSNV_post_pre_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx3arL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arL41_cSNV_rna_lib_cors = cor(log2(VHLx3arL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx3arL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3arL41_tSNV_rna_lib_cors = cor(log2(VHLx3arL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx3arL41_cSNV_rna_pre_cors = cor(log2(VHLx3arL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx3arL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3arL41_tSNV_rna_pre_cors = cor(log2(VHLx3arL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx3arL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arL41rL42_cSNV_pre_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
VHLx3arL41rL42_tSNV_pre_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
VHLx3arL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
VHLx3arL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
VHLx3arL41rL42_cSNV_post_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
VHLx3arL41rL42_tSNV_post_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
VHLx3arL41rL42_cSNV_post_lib_ratio_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
VHLx3arL41rL42_tSNV_post_lib_ratio_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx3arL41rL42_cSNV_post_pre_ratio_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
VHLx3arL41rL42_tSNV_post_pre_ratio_cors = cor(log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx3arL41rL42_cSNV_rna_cors = cor(log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
VHLx3arL41rL42_tSNV_rna_cors = cor(log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
VHLx3arL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3arL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx3arL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx3arL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx3arL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx3arL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3arL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

VHLx3arL41_cors <- c("VHLx3arL41",VHLx3arL41_cSNV_pre_lib_cors,VHLx3arL41_tSNV_pre_lib_cors,VHLx3arL41_cSNV_post_lib_cors,VHLx3arL41_tSNV_post_lib_cors,VHLx3arL41_cSNV_post_pre_cors,VHLx3arL41_tSNV_post_pre_cors,VHLx3arL41_cSNV_rna_lib_cors,VHLx3arL41_tSNV_rna_lib_cors,VHLx3arL41_cSNV_rna_pre_cors,VHLx3arL41_tSNV_rna_pre_cors,VHLx3arL41rL42_cSNV_pre_cors,VHLx3arL41rL42_tSNV_pre_cors,VHLx3arL41rL42_cSNV_pre_lib_ratio_cors,VHLx3arL41rL42_tSNV_pre_lib_ratio_cors,VHLx3arL41rL42_cSNV_post_cors,VHLx3arL41rL42_tSNV_post_cors,VHLx3arL41rL42_cSNV_post_lib_ratio_cors,VHLx3arL41rL42_tSNV_post_lib_ratio_cors,VHLx3arL41rL42_cSNV_post_pre_ratio_cors,VHLx3arL41rL42_tSNV_post_pre_ratio_cors,VHLx3arL41rL42_cSNV_rna_cors,VHLx3arL41rL42_tSNV_rna_cors,VHLx3arL41rL42_tSNV_rna_pre_ratio_cors,VHLx3arL41_cSNV_pre_lib_ratio_cadd_cors,VHLx3arL41_tSNV_pre_lib_ratio_cadd_cors,VHLx3arL41_cSNV_post_lib_ratio_cadd_cors,VHLx3arL41_tSNV_post_lib_ratio_cadd_cors,VHLx3arL41_cSNV_post_pre_ratio_cadd_cors,VHLx3arL41_tSNV_post_pre_ratio_cadd_cors,VHLx3arL41_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3arL41_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3arL41_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arL41_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arL41_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3arL41_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3arL41rL42a_cSNV_pre_lib_ratio_cadd_cors,VHLx3arL41rL42a_tSNV_pre_lib_ratio_cadd_cors,VHLx3arL41rL42a_cSNV_post_lib_ratio_cadd_cors,VHLx3arL41rL42a_tSNV_post_lib_ratio_cadd_cors,VHLx3arL41rL42a_cSNV_post_pre_ratio_cadd_cors,VHLx3arL41rL42a_tSNV_post_pre_ratio_cadd_cors,VHLx3arL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3arL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3arL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3arL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3arL41rL42w_cSNV_pre_lib_ratio_cadd_cors,VHLx3arL41rL42w_cSNV_post_lib_ratio_cadd_cors,VHLx3arL41rL42w_cSNV_post_pre_ratio_cadd_cors,VHLx3arL41rL42w_tSNV_post_pre_ratio_cadd_cors)

VHLx3arL42_cSNV_pre_lib_cors = cor(log2(VHLx3arL42_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3arL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3arL42_tSNV_pre_lib_cors = cor(log2(VHLx3arL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arL42_cSNV_post_lib_cors = cor(log2(VHLx3arL42_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3arL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx3arL42_tSNV_post_lib_cors = cor(log2(VHLx3arL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx3arL42_cSNV_post_pre_cors = cor(log2(VHLx3arL42_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx3arL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3arL42_tSNV_post_pre_cors = cor(log2(VHLx3arL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx3arL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arL42_cSNV_rna_lib_cors = cor(log2(VHLx3arL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx3arL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3arL42_tSNV_rna_lib_cors = cor(log2(VHLx3arL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx3arL42_cSNV_rna_pre_cors = cor(log2(VHLx3arL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx3arL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3arL42_tSNV_rna_pre_cors = cor(log2(VHLx3arL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx3arL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx3arL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx3arL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx3arL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx3arL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx3arL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx3arL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

VHLx3arL42_cors <- c("VHLx3arL42",VHLx3arL42_cSNV_pre_lib_cors,VHLx3arL42_tSNV_pre_lib_cors,VHLx3arL42_cSNV_post_lib_cors,VHLx3arL42_tSNV_post_lib_cors,VHLx3arL42_cSNV_post_pre_cors,VHLx3arL42_tSNV_post_pre_cors,VHLx3arL42_cSNV_rna_lib_cors,VHLx3arL42_tSNV_rna_lib_cors,VHLx3arL42_cSNV_rna_pre_cors,VHLx3arL42_tSNV_rna_pre_cors,VHLx3arL41rL42_cSNV_pre_cors,VHLx3arL41rL42_tSNV_pre_cors,VHLx3arL41rL42_cSNV_pre_lib_ratio_cors,VHLx3arL41rL42_tSNV_pre_lib_ratio_cors,VHLx3arL41rL42_cSNV_post_cors,VHLx3arL41rL42_tSNV_post_cors,VHLx3arL41rL42_cSNV_post_lib_ratio_cors,VHLx3arL41rL42_tSNV_post_lib_ratio_cors,VHLx3arL41rL42_cSNV_post_pre_ratio_cors,VHLx3arL41rL42_tSNV_post_pre_ratio_cors,VHLx3arL41rL42_cSNV_rna_cors,VHLx3arL41rL42_tSNV_rna_cors,VHLx3arL41rL42_tSNV_rna_pre_ratio_cors,VHLx3arL42_cSNV_pre_lib_ratio_cadd_cors,VHLx3arL42_tSNV_pre_lib_ratio_cadd_cors,VHLx3arL42_cSNV_post_lib_ratio_cadd_cors,VHLx3arL42_tSNV_post_lib_ratio_cadd_cors,VHLx3arL42_cSNV_post_pre_ratio_cadd_cors,VHLx3arL42_tSNV_post_pre_ratio_cadd_cors,VHLx3arL42_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3arL42_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3arL42_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arL42_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arL42_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3arL42_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3arL41rL42a_cSNV_pre_lib_ratio_cadd_cors,VHLx3arL41rL42a_tSNV_pre_lib_ratio_cadd_cors,VHLx3arL41rL42a_cSNV_post_lib_ratio_cadd_cors,VHLx3arL41rL42a_tSNV_post_lib_ratio_cadd_cors,VHLx3arL41rL42a_cSNV_post_pre_ratio_cadd_cors,VHLx3arL41rL42a_tSNV_post_pre_ratio_cadd_cors,VHLx3arL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3arL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3arL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3arL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3arL41rL42w_cSNV_pre_lib_ratio_cadd_cors,VHLx3arL41rL42w_cSNV_post_lib_ratio_cadd_cors,VHLx3arL41rL42w_cSNV_post_pre_ratio_cadd_cors,VHLx3arL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx3arL41)
rm(VHLx3arL42)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx3arL41
VHLx3a_posrange <- range(as.numeric(as.character(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$pos)))
VHLx3a_posseq <- seq(from=VHLx3a_posrange[1], to=VHLx3a_posrange[2])
VHLx3arL41_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx3arL41_tHDR_pre_lib_pred <- predict(VHLx3arL41_tHDR_pre_lib_ratio.lo, newdata = VHLx3a_posseq, se=TRUE)
VHLx3arL41_tHDR_pre_lib_pos_effects <- VHLx3arL41_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx3arL41_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx3arL41_tHDR_pre_lib_pos_effects)
VHLx3arL41_tHDR_pre_lib_pos_effects_ci <- VHLx3arL41_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx3arL41_tHDR_pre_lib_pred$df)
VHLx3arL41_tHDR_pre_lib_pos_effects_ci_ymin = VHLx3arL41_tHDR_pre_lib_pos_effects - VHLx3arL41_tHDR_pre_lib_pos_effects_ci
VHLx3arL41_tHDR_pre_lib_pos_effects_ci_ymax = VHLx3arL41_tHDR_pre_lib_pos_effects + VHLx3arL41_tHDR_pre_lib_pos_effects_ci
VHLx3arL41_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx3a_posseq, VHLx3arL41_tHDR_pre_lib_pos_effects, VHLx3arL41_tHDR_pre_lib_pos_effects.x, VHLx3arL41_tHDR_pre_lib_pos_effects_ci_ymin, VHLx3arL41_tHDR_pre_lib_pos_effects_ci_ymax, VHLx3arL41_tHDR_pre_lib_pred_se = VHLx3arL41_tHDR_pre_lib_pred$se.fit)
#VHLx3arL42
VHLx3arL42_tHDR_pre_lib_ratio.lo <- loess(log2(rL42_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx3arL42_tHDR_pre_lib_pred <- predict(VHLx3arL42_tHDR_pre_lib_ratio.lo, newdata = VHLx3a_posseq, se=TRUE)
VHLx3arL42_tHDR_pre_lib_pos_effects <- VHLx3arL42_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx3arL42_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx3arL42_tHDR_pre_lib_pos_effects)
VHLx3arL42_tHDR_pre_lib_pos_effects_ci <- VHLx3arL42_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx3arL42_tHDR_pre_lib_pred$df)
VHLx3arL42_tHDR_pre_lib_pos_effects_ci_ymin = VHLx3arL42_tHDR_pre_lib_pos_effects - VHLx3arL42_tHDR_pre_lib_pos_effects_ci
VHLx3arL42_tHDR_pre_lib_pos_effects_ci_ymax = VHLx3arL42_tHDR_pre_lib_pos_effects + VHLx3arL42_tHDR_pre_lib_pos_effects_ci
VHLx3arL42_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx3a_posseq, VHLx3arL42_tHDR_pre_lib_pos_effects, VHLx3arL42_tHDR_pre_lib_pos_effects.x, VHLx3arL42_tHDR_pre_lib_pos_effects_ci_ymin, VHLx3arL42_tHDR_pre_lib_pos_effects_ci_ymax, VHLx3arL42_tHDR_pre_lib_pred_se = VHLx3arL42_tHDR_pre_lib_pred$se.fit)

#VHLx3arL41rL42
VHLx3arL41rL42_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rL41rL42_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm > 0.7 & VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm > 0.3 & VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx3arL41rL42_tHDR_pre_lib_pred <- predict(VHLx3arL41rL42_tHDR_pre_lib_ratio.lo, newdata = VHLx3a_posseq, se=TRUE)
VHLx3arL41rL42_tHDR_pre_lib_pos_effects <- VHLx3arL41rL42_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx3arL41rL42_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx3arL41rL42_tHDR_pre_lib_pos_effects)
VHLx3arL41rL42_tHDR_pre_lib_pos_effects_ci <- VHLx3arL41rL42_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx3arL41rL42_tHDR_pre_lib_pred$df)
VHLx3arL41rL42_tHDR_pre_lib_pos_effects_ci_ymin = VHLx3arL41rL42_tHDR_pre_lib_pos_effects - VHLx3arL41rL42_tHDR_pre_lib_pos_effects_ci
VHLx3arL41rL42_tHDR_pre_lib_pos_effects_ci_ymax = VHLx3arL41rL42_tHDR_pre_lib_pos_effects + VHLx3arL41rL42_tHDR_pre_lib_pos_effects_ci
VHLx3arL41rL42_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx3a_posseq, VHLx3arL41rL42_tHDR_pre_lib_pos_effects, VHLx3arL41rL42_tHDR_pre_lib_pos_effects.x, VHLx3arL41rL42_tHDR_pre_lib_pos_effects_ci_ymin, VHLx3arL41rL42_tHDR_pre_lib_pos_effects_ci_ymax, VHLx3arL41rL42_tHDR_pre_lib_pred_se = VHLx3arL41rL42_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rL41, rL42, rL41rL42)
VHLx3arL4_tHDR_pos_merge_df <- VHLx3arL41_prog_map_thresh5_df_rL42_int_ord_df 
VHLx3arL4_tHDR_pos_merge_df <- merge(VHLx3arL4_tHDR_pos_merge_df, VHLx3arL41_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx3arL41_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx3arL4_tHDR_pos_merge_df <- merge(VHLx3arL4_tHDR_pos_merge_df, VHLx3arL42_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx3arL42_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx3arL4_tHDR_pos_merge_df <- merge(VHLx3arL4_tHDR_pos_merge_df, VHLx3arL41rL42_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx3arL41rL42_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx3arL4_tHDR_pos_merge_df <- VHLx3arL4_tHDR_pos_merge_df %>% 
  rename(
    rL41_tHDR_pre_lib_pos_effects.x = VHLx3arL41_tHDR_pre_lib_pos_effects.x,
    rL42_tHDR_pre_lib_pos_effects.x = VHLx3arL42_tHDR_pre_lib_pos_effects.x,
    rL41rL42_tHDR_pre_lib_pos_effects.x = VHLx3arL41rL42_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rL41 vs. rL41_fit and vs. mean_fit)
VHLx3arL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41 <- log2(VHLx3arL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx3arL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_pos_effects.x
VHLx3arL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx3arL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx3arL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx3arL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42 <- log2(VHLx3arL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_ratio_synnorm) - VHLx3arL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_pos_effects.x
VHLx3arL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx3arL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_ratio_synnorm) - VHLx3arL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx3arL4_tHDR_pos_merge_df$rL41rL42_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx3arL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm) - VHLx3arL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx3arL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_loess_rL41 <- log2(VHLx3arL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx3arL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_pos_effects.x
VHLx3arL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx3arL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx3arL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx3arL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_loess_rL42 <- log2(VHLx3arL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_ratio_synnorm) - VHLx3arL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_pos_effects.x
VHLx3arL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx3arL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_ratio_synnorm) - VHLx3arL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx3arL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx3arL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm) - VHLx3arL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rL41 and rL42 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx3arL4_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx3arL4_tHDR_post_lib_loess_median_syn_rL41 <- median(VHLx3arL4_tHDR_pos_merge_df[which(VHLx3arL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rL41_tHDR_post_lib_loess_rL41')])
  VHLx3arL4_tHDR_post_lib_loess_median_syn_rL42 <- median(VHLx3arL4_tHDR_pos_merge_df[which(VHLx3arL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rL42_tHDR_post_lib_loess_rL42')])
  } else {
  VHLx3arL4_tHDR_post_lib_loess_median_syn_rL41 <- median(VHLx3arL4_tHDR_pos_merge_df[which(VHLx3arL4_tHDR_pos_merge_df$conseq != 'could be anything'),c('rL41_tHDR_post_lib_loess_rL41')])
  VHLx3arL4_tHDR_post_lib_loess_median_syn_rL42 <- median(VHLx3arL4_tHDR_pos_merge_df[which(VHLx3arL4_tHDR_pos_merge_df$conseq != 'could be anything'),c('rL42_tHDR_post_lib_loess_rL42')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rL41 'e.sns' = exon syn/ns norm.
VHLx3arL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41_e.sns <- (VHLx3arL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41-VHLx3arL4_tHDR_post_lib_loess_median_syn_rL41)
#calculate new b values for rL42 'e.sns' = exon syn/ns norm.
VHLx3arL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42_e.sns <- (VHLx3arL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42-VHLx3arL4_tHDR_post_lib_loess_median_syn_rL42)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx3arL4_tHDR_pos_merge_df$rL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean <- (VHLx3arL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41_e.sns+VHLx3arL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx3arL4_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx3arL4_tHDR_post_lib_loess_e.sns_rL41rL42_syn_median <- median(VHLx3arL4_tHDR_pos_merge_df[which(VHLx3arL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('VHLx3arL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean')])
  } else {
  VHLx3arL4_tHDR_post_lib_loess_e.sns_rL41rL42_syn_median <- median(VHLx3arL4_tHDR_pos_merge_df[which(VHLx3arL4_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('VHLx3arL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean')])
}

#RNA analysis
VHLx3arL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3arL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41_tHDR_rna2_rna_ratio <- VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_pseudo_freq/VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq
VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_rna_ratio <- VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_pseudo_freq/VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq
VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41rL42_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41_tHDR_rna2_rna_ratio)+log2(VHLx3arL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_rna_ratio))/2

```

```{r}
#VHLx3brL4
VHLx3brL41_file <- paste(experiment_dir_210915,'VHLx3brL41','_annotated.txt',sep='')
VHLx3brL42_file <- paste(experiment_dir_210915,'VHLx3brL42','_annotated.txt',sep='')
VHLx3brL41 <- read.table(VHLx3brL41_file, header=TRUE, sep="\t")
VHLx3brL42 <- read.table(VHLx3brL42_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx3brL41 <- VHLx3brL41 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

VHLx3brL42 <- VHLx3brL42 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx3b <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx3b'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx3b_HDR_5_SNV = as.character(VHL_editing_info_VHLx3b$HDR_5_SNV)
VHLx3b_HDR_3_SNV = as.character(VHL_editing_info_VHLx3b$HDR_3_SNV)
#VHLx3b_cut_pos = as.character(VHL_editing_info_VHLx3b$cut_pos)
VHLx3b_cut_end = as.character(VHL_editing_info_VHLx3b$cut_end)
VHLx3b_mut_start = as.character(VHL_editing_info_VHLx3b$mut_start)
VHLx3b_mut_end = as.character(VHL_editing_info_VHLx3b$mut_end)

### Replicate 1
VHLx3brL41_cSNV_all <- which(VHLx3brL41[,'c_hdr_snv']=='True')
VHLx3brL41_cSNV_all_df = VHLx3brL41[VHLx3brL41_cSNV_all,]
VHLx3brL41_prog_var_all <- which(VHLx3brL41[,'all_hdr_variant']=='True' & VHLx3brL41[,'edit_string']!='-WT')
VHLx3brL41_prog_var_all_df = VHLx3brL41[VHLx3brL41_prog_var_all,]
VHLx3brL41_prog_map_all = which(VHLx3brL41_prog_var_all_df[,'pos']!='REF')
VHLx3brL41_prog_map_all_df = VHLx3brL41_prog_var_all_df[VHLx3brL41_prog_map_all,]
VHLx3brL41_prog_map_exon_all = which(VHLx3brL41_prog_map_all_df[,'cDNApos']!='REF' & VHLx3brL41_prog_map_all_df[,'cDNApos']!='NA')
VHLx3brL41_prog_map_exon_all_df = VHLx3brL41_prog_map_all_df[VHLx3brL41_prog_map_exon_all,]
VHLx3brL41_prog_map_CADD = which(VHLx3brL41_prog_map_all_df[,'CADD.phred']!='NA')
VHLx3brL41_prog_map_CADD_df = VHLx3brL41_prog_map_all_df[VHLx3brL41_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx3brL41_prog_var_thresh5 <- which(as.numeric(as.character(VHLx3brL41_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx3brL41_prog_var_thresh5_df = VHLx3brL41_prog_var_all_df[VHLx3brL41_prog_var_thresh5,]
VHLx3brL41_prog_map_thresh5 <- which(as.numeric(as.character(VHLx3brL41_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx3brL41_prog_map_thresh5_df = VHLx3brL41_prog_map_all_df[VHLx3brL41_prog_map_thresh5,]
VHLx3brL41_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx3brL41_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx3brL41_prog_map_exon_thresh5_df = VHLx3brL41_prog_map_exon_all_df[VHLx3brL41_prog_map_exon_thresh5,]
VHLx3brL41_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx3brL41_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx3brL41_prog_map_CADD_thresh5_df = VHLx3brL41_prog_map_CADD_df[VHLx3brL41_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx3brL41_prog_var_all_lib_count = length(VHLx3brL41_prog_var_all_df$lib)
VHLx3brL41_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx3brL41_prog_var_all_min_lib_counts = min(VHLx3brL41_prog_var_all_df$lib)
VHLx3brL41_prog_var_all_min_lib_counts
VHLx3brL41_prog_var_all_max_lib_counts = max(VHLx3brL41_prog_var_all_df$lib)
VHLx3brL41_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx3brL41_prog_map_all_lib_count = length(VHLx3brL41_prog_map_all_df$lib)
VHLx3brL41_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx3brL41_prog_map_all_min_lib_counts = min(VHLx3brL41_prog_map_all_df$lib)
VHLx3brL41_prog_map_all_min_lib_counts
VHLx3brL41_prog_map_all_max_lib_counts = max(VHLx3brL41_prog_map_all_df$lib)
VHLx3brL41_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx3brL41_prog_var_all_pre_count = length(VHLx3brL41_prog_var_all_df$pre)
VHLx3brL41_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx3brL41_prog_var_all_min_pre_counts = min(VHLx3brL41_prog_var_all_df$pre)
VHLx3brL41_prog_var_all_min_pre_counts
VHLx3brL41_prog_var_all_max_pre_counts = max(VHLx3brL41_prog_var_all_df$pre)
VHLx3brL41_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx3brL41_prog_map_all_pre_count = length(VHLx3brL41_prog_map_all_df$pre)
VHLx3brL41_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx3brL41_prog_map_all_min_pre_counts = min(VHLx3brL41_prog_map_all_df$pre)
VHLx3brL41_prog_map_all_min_pre_counts
VHLx3brL41_prog_map_all_max_pre_counts = max(VHLx3brL41_prog_map_all_df$pre)
VHLx3brL41_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx3brL41_prog_map_all_post_count = length(VHLx3brL41_prog_map_all_df$post)
VHLx3brL41_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx3brL41_prog_map_all_min_post_counts = min(VHLx3brL41_prog_map_all_df$post)
VHLx3brL41_prog_map_all_min_post_counts
VHLx3brL41_prog_map_all_max_post_counts = max(VHLx3brL41_prog_map_all_df$post)
VHLx3brL41_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx3brL41_prog_map_all_syn_df <- VHLx3brL41_prog_map_all_df[which(VHLx3brL41_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx3brL41_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx3brL41_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx3brL41_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx3brL41_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx3brL41_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx3brL41_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx3brL41_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx3brL41_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx3brL41_prog_map_all_min_rna_counts = min(VHLx3brL41_prog_map_exon_all_df$tHDR_rna)
VHLx3brL41_prog_map_all_min_rna_counts
VHLx3brL41_prog_map_all_max_rna_counts = max(VHLx3brL41_prog_map_exon_all_df$tHDR_rna)
VHLx3brL41_prog_map_all_max_rna_counts
VHLx3brL41_prog_map_all_min_rna_pseudo_freq = min(VHLx3brL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3brL41_prog_map_all_min_rna_pseudo_freq
VHLx3brL41_prog_map_all_max_rna_pseudo_freq = max(VHLx3brL41_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3brL41_prog_map_all_max_rna_pseudo_freq
VHLx3brL41_prog_map_all_min_rna_pre_ratio = min(VHLx3brL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3brL41_prog_map_all_min_rna_pre_ratio
VHLx3brL41_prog_map_all_max_rna_pre_ratio = max(VHLx3brL41_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3brL41_prog_map_all_max_rna_pre_ratio
VHLx3brL41_prog_map_all_min_rna_post_ratio = min(VHLx3brL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3brL41_prog_map_all_min_rna_post_ratio
VHLx3brL41_prog_map_all_max_rna_post_ratio = max(VHLx3brL41_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3brL41_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx3brL41_cSNV_all_corr_pre_count = length(VHLx3brL41_cSNV_all_df$corr_pre)
VHLx3brL41_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx3brL41_cSNV_all_min_corr_pre_counts = min(VHLx3brL41_cSNV_all_df$corr_pre)
VHLx3brL41_cSNV_all_min_corr_pre_counts
VHLx3brL41_cSNV_all_max_corr_pre_counts = max(VHLx3brL41_cSNV_all_df$corr_pre)
VHLx3brL41_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brL41_cSNV_all_corr_post_count = length(VHLx3brL41_cSNV_all_df$corr_post)
VHLx3brL41_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx3brL41_cSNV_all_min_corr_post_counts = min(VHLx3brL41_cSNV_all_df$corr_post)
VHLx3brL41_cSNV_all_min_corr_post_counts
VHLx3brL41_cSNV_all_max_corr_post_counts = max(VHLx3brL41_cSNV_all_df$corr_post)
VHLx3brL41_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx3b_p_hdr_snv = paste('p_hdr_',VHLx3b_cut_end,'_snv',sep='')
VHLx3brL41_pSNV_all <- which(VHLx3brL41[,VHLx3b_p_hdr_snv]=='True')
VHLx3brL41_pSNV_all_df = VHLx3brL41[VHLx3brL41_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brL41_pSNV_all_lib_count = length(VHLx3brL41_pSNV_all_df$lib)
VHLx3brL41_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx3brL41_pSNV_all_min_lib_counts = min(VHLx3brL41_pSNV_all_df$lib)
VHLx3brL41_pSNV_all_min_lib_counts
VHLx3brL41_pSNV_all_max_lib_counts = max(VHLx3brL41_pSNV_all_df$lib)
VHLx3brL41_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx3brL41_pSNV_all_pre_count = length(VHLx3brL41_pSNV_all_df$pre)
VHLx3brL41_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx3brL41_pSNV_all_min_pre_counts = min(VHLx3brL41_pSNV_all_df$pre)
VHLx3brL41_pSNV_all_min_pre_counts
VHLx3brL41_pSNV_all_max_pre_counts = max(VHLx3brL41_pSNV_all_df$pre)
VHLx3brL41_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brL41_pSNV_all_post_count = length(VHLx3brL41_pSNV_all_df$post)
VHLx3brL41_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx3brL41_pSNV_all_min_post_counts = min(VHLx3brL41_pSNV_all_df$post)
VHLx3brL41_pSNV_all_min_post_counts
VHLx3brL41_pSNV_all_max_post_counts = max(VHLx3brL41_pSNV_all_df$post)
VHLx3brL41_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brL41_prog_map_thresh5_lib_count = length(VHLx3brL41_prog_map_thresh5_df$lib)
VHLx3brL41_prog_map_thresh5_lib_count
VHLx3brL41_prog_map_thresh5_min_lib_counts = min(VHLx3brL41_prog_map_thresh5_df$lib)
VHLx3brL41_prog_map_thresh5_min_lib_counts
VHLx3brL41_prog_map_thresh5_max_lib_counts = max(VHLx3brL41_prog_map_thresh5_df$lib)
VHLx3brL41_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brL41_prog_map_thresh5_pre_count = length(VHLx3brL41_prog_map_thresh5_df$pre)
VHLx3brL41_prog_map_thresh5_pre_count
VHLx3brL41_prog_map_thresh5_min_pre_counts = min(VHLx3brL41_prog_map_thresh5_df$pre)
VHLx3brL41_prog_map_thresh5_min_pre_counts
VHLx3brL41_prog_map_thresh5_max_pre_counts = max(VHLx3brL41_prog_map_thresh5_df$pre)
VHLx3brL41_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx3brL41_prog_map_thresh5_post_count = length(VHLx3brL41_prog_map_thresh5_df$post)
VHLx3brL41_prog_map_thresh5_post_count
VHLx3brL41_prog_map_thresh5_min_post_counts = min(VHLx3brL41_prog_map_thresh5_df$post)
VHLx3brL41_prog_map_thresh5_min_post_counts
VHLx3brL41_prog_map_thresh5_max_post_counts = max(VHLx3brL41_prog_map_thresh5_df$post)
VHLx3brL41_prog_map_thresh5_max_post_counts
VHLx3brL41_prog_map_thresh5_corr_post_count = length(VHLx3brL41_cSNV_all_df$corr_post)
VHLx3brL41_prog_map_thresh5_corr_post_count
VHLx3brL41_prog_map_thresh5_min_corr_post_counts = min(VHLx3brL41_cSNV_all_df$corr_post)
VHLx3brL41_prog_map_thresh5_min_corr_post_counts
VHLx3brL41_prog_map_thresh5_max_corr_post_counts = max(VHLx3brL41_cSNV_all_df$corr_post)
VHLx3brL41_prog_map_thresh5_max_corr_post_counts

VHLx3brL41_pSNV_thresh5 <- which(VHLx3brL41[,VHLx3b_p_hdr_snv]=='True' & as.numeric(as.character(VHLx3brL41[,'pre_freq']))>=0.00001)
VHLx3brL41_pSNV_thresh5_df = VHLx3brL41[VHLx3brL41_pSNV_thresh5,]
VHLx3brL41_pSNV_thresh5_lib_count = length(VHLx3brL41_pSNV_thresh5_df$lib)
VHLx3brL41_pSNV_thresh5_lib_count
VHLx3brL41_pSNV_thresh5_min_lib_counts = min(VHLx3brL41_pSNV_thresh5_df$lib)
VHLx3brL41_pSNV_thresh5_min_lib_counts
VHLx3brL41_pSNV_thresh5_max_lib_counts = max(VHLx3brL41_pSNV_thresh5_df$lib)
VHLx3brL41_pSNV_thresh5_max_lib_counts
VHLx3brL41_pSNV_thresh5_pre_count = length(VHLx3brL41_pSNV_thresh5_df$pre)
VHLx3brL41_pSNV_thresh5_pre_count
VHLx3brL41_pSNV_thresh5_min_pre_counts = min(VHLx3brL41_pSNV_thresh5_df$pre)
VHLx3brL41_pSNV_thresh5_min_pre_counts
VHLx3brL41_pSNV_thresh5_max_pre_counts = max(VHLx3brL41_pSNV_thresh5_df$pre)
VHLx3brL41_pSNV_thresh5_max_pre_counts
VHLx3brL41_pSNV_thresh5_post_count = length(VHLx3brL41_pSNV_thresh5_df$post)
VHLx3brL41_pSNV_thresh5_post_count
VHLx3brL41_pSNV_thresh5_min_post_counts = min(VHLx3brL41_pSNV_thresh5_df$post)
VHLx3brL41_pSNV_thresh5_min_post_counts
VHLx3brL41_pSNV_thresh5_max_post_counts = max(VHLx3brL41_pSNV_thresh5_df$post)
VHLx3brL41_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx3brL42_cSNV_all <- which(VHLx3brL42[,'c_hdr_snv']=='True')
VHLx3brL42_cSNV_all_df = VHLx3brL42[VHLx3brL42_cSNV_all,]
VHLx3brL42_prog_var_all <- which(VHLx3brL42[,'all_hdr_variant']=='True' & VHLx3brL42[,'edit_string']!='-WT')
VHLx3brL42_prog_var_all_df = VHLx3brL42[VHLx3brL42_prog_var_all,]
VHLx3brL42_prog_map_all = which(VHLx3brL42_prog_var_all_df[,'pos']!='REF')
VHLx3brL42_prog_map_all_df = VHLx3brL42_prog_var_all_df[VHLx3brL42_prog_map_all,]
VHLx3brL42_prog_map_exon_all = which(VHLx3brL42_prog_map_all_df[,'cDNApos']!='REF' & VHLx3brL42_prog_map_all_df[,'cDNApos']!='NA')
VHLx3brL42_prog_map_exon_all_df = VHLx3brL42_prog_map_all_df[VHLx3brL42_prog_map_exon_all,]
VHLx3brL42_prog_map_CADD = which(VHLx3brL42_prog_map_all_df[,'CADD.phred']!='NA')
VHLx3brL42_prog_map_CADD_df = VHLx3brL42_prog_map_all_df[VHLx3brL42_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx3brL42_prog_var_thresh5 <- which(as.numeric(as.character(VHLx3brL42_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx3brL42_prog_var_thresh5_df = VHLx3brL42_prog_var_all_df[VHLx3brL42_prog_var_thresh5,]
VHLx3brL42_prog_map_thresh5 <- which(as.numeric(as.character(VHLx3brL42_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx3brL42_prog_map_thresh5_df = VHLx3brL42_prog_map_all_df[VHLx3brL42_prog_map_thresh5,]
VHLx3brL42_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx3brL42_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx3brL42_prog_map_exon_thresh5_df = VHLx3brL42_prog_map_exon_all_df[VHLx3brL42_prog_map_exon_thresh5,]
VHLx3brL42_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx3brL42_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx3brL42_prog_map_CADD_thresh5_df = VHLx3brL42_prog_map_CADD_df[VHLx3brL42_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx3brL42_prog_var_all_lib_count = length(VHLx3brL42_prog_var_all_df$lib)
VHLx3brL42_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx3brL42_prog_var_all_min_lib_counts = min(VHLx3brL42_prog_var_all_df$lib)
VHLx3brL42_prog_var_all_min_lib_counts
VHLx3brL42_prog_var_all_max_lib_counts = max(VHLx3brL42_prog_var_all_df$lib)
VHLx3brL42_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx3brL42_prog_map_all_lib_count = length(VHLx3brL42_prog_map_all_df$lib)
VHLx3brL42_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx3brL42_prog_map_all_min_lib_counts = min(VHLx3brL42_prog_map_all_df$lib)
VHLx3brL42_prog_map_all_min_lib_counts
VHLx3brL42_prog_map_all_max_lib_counts = max(VHLx3brL42_prog_map_all_df$lib)
VHLx3brL42_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx3brL42_prog_var_all_pre_count = length(VHLx3brL42_prog_var_all_df$pre)
VHLx3brL42_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx3brL42_prog_var_all_min_pre_counts = min(VHLx3brL42_prog_var_all_df$pre)
VHLx3brL42_prog_var_all_min_pre_counts
VHLx3brL42_prog_var_all_max_pre_counts = max(VHLx3brL42_prog_var_all_df$pre)
VHLx3brL42_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx3brL42_prog_map_all_pre_count = length(VHLx3brL42_prog_map_all_df$pre)
VHLx3brL42_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx3brL42_prog_map_all_min_pre_counts = min(VHLx3brL42_prog_map_all_df$pre)
VHLx3brL42_prog_map_all_min_pre_counts
VHLx3brL42_prog_map_all_max_pre_counts = max(VHLx3brL42_prog_map_all_df$pre)
VHLx3brL42_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx3brL42_prog_map_all_post_count = length(VHLx3brL42_prog_map_all_df$post)
VHLx3brL42_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx3brL42_prog_map_all_min_post_counts = min(VHLx3brL42_prog_map_all_df$post)
VHLx3brL42_prog_map_all_min_post_counts
VHLx3brL42_prog_map_all_max_post_counts = max(VHLx3brL42_prog_map_all_df$post)
VHLx3brL42_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx3brL42_prog_map_all_syn_df <- VHLx3brL42_prog_map_all_df[which(VHLx3brL42_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx3brL42_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx3brL42_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx3brL42_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx3brL42_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx3brL42_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx3brL42_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx3brL42_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx3brL42_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx3brL42_prog_map_all_min_rna_counts = min(VHLx3brL42_prog_map_exon_all_df$tHDR_rna)
VHLx3brL42_prog_map_all_min_rna_counts
VHLx3brL42_prog_map_all_max_rna_counts = max(VHLx3brL42_prog_map_exon_all_df$tHDR_rna)
VHLx3brL42_prog_map_all_max_rna_counts
VHLx3brL42_prog_map_all_min_rna_pseudo_freq = min(VHLx3brL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3brL42_prog_map_all_min_rna_pseudo_freq
VHLx3brL42_prog_map_all_max_rna_pseudo_freq = max(VHLx3brL42_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3brL42_prog_map_all_max_rna_pseudo_freq
VHLx3brL42_prog_map_all_min_rna_pre_ratio = min(VHLx3brL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3brL42_prog_map_all_min_rna_pre_ratio
VHLx3brL42_prog_map_all_max_rna_pre_ratio = max(VHLx3brL42_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3brL42_prog_map_all_max_rna_pre_ratio
VHLx3brL42_prog_map_all_min_rna_post_ratio = min(VHLx3brL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3brL42_prog_map_all_min_rna_post_ratio
VHLx3brL42_prog_map_all_max_rna_post_ratio = max(VHLx3brL42_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3brL42_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx3brL42_cSNV_all_corr_pre_count = length(VHLx3brL42_cSNV_all_df$corr_pre)
VHLx3brL42_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx3brL42_cSNV_all_min_corr_pre_counts = min(VHLx3brL42_cSNV_all_df$corr_pre)
VHLx3brL42_cSNV_all_min_corr_pre_counts
VHLx3brL42_cSNV_all_max_corr_pre_counts = max(VHLx3brL42_cSNV_all_df$corr_pre)
VHLx3brL42_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brL42_cSNV_all_corr_post_count = length(VHLx3brL42_cSNV_all_df$corr_post)
VHLx3brL42_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx3brL42_cSNV_all_min_corr_post_counts = min(VHLx3brL42_cSNV_all_df$corr_post)
VHLx3brL42_cSNV_all_min_corr_post_counts
VHLx3brL42_cSNV_all_max_corr_post_counts = max(VHLx3brL42_cSNV_all_df$corr_post)
VHLx3brL42_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx3b_p_hdr_snv = paste('p_hdr_',VHLx3b_cut_end,'_snv',sep='')
VHLx3brL42_pSNV_all <- which(VHLx3brL42[,VHLx3b_p_hdr_snv]=='True')
VHLx3brL42_pSNV_all_df = VHLx3brL42[VHLx3brL42_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brL42_pSNV_all_lib_count = length(VHLx3brL42_pSNV_all_df$lib)
VHLx3brL42_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx3brL42_pSNV_all_min_lib_counts = min(VHLx3brL42_pSNV_all_df$lib)
VHLx3brL42_pSNV_all_min_lib_counts
VHLx3brL42_pSNV_all_max_lib_counts = max(VHLx3brL42_pSNV_all_df$lib)
VHLx3brL42_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx3brL42_pSNV_all_pre_count = length(VHLx3brL42_pSNV_all_df$pre)
VHLx3brL42_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx3brL42_pSNV_all_min_pre_counts = min(VHLx3brL42_pSNV_all_df$pre)
VHLx3brL42_pSNV_all_min_pre_counts
VHLx3brL42_pSNV_all_max_pre_counts = max(VHLx3brL42_pSNV_all_df$pre)
VHLx3brL42_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brL42_pSNV_all_post_count = length(VHLx3brL42_pSNV_all_df$post)
VHLx3brL42_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx3brL42_pSNV_all_min_post_counts = min(VHLx3brL42_pSNV_all_df$post)
VHLx3brL42_pSNV_all_min_post_counts
VHLx3brL42_pSNV_all_max_post_counts = max(VHLx3brL42_pSNV_all_df$post)
VHLx3brL42_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brL42_prog_map_thresh5_lib_count = length(VHLx3brL42_prog_map_thresh5_df$lib)
VHLx3brL42_prog_map_thresh5_lib_count
VHLx3brL42_prog_map_thresh5_min_lib_counts = min(VHLx3brL42_prog_map_thresh5_df$lib)
VHLx3brL42_prog_map_thresh5_min_lib_counts
VHLx3brL42_prog_map_thresh5_max_lib_counts = max(VHLx3brL42_prog_map_thresh5_df$lib)
VHLx3brL42_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx3b less than SGE region length x 3 due to PAM edits
VHLx3brL42_prog_map_thresh5_pre_count = length(VHLx3brL42_prog_map_thresh5_df$pre)
VHLx3brL42_prog_map_thresh5_pre_count
VHLx3brL42_prog_map_thresh5_min_pre_counts = min(VHLx3brL42_prog_map_thresh5_df$pre)
VHLx3brL42_prog_map_thresh5_min_pre_counts
VHLx3brL42_prog_map_thresh5_max_pre_counts = max(VHLx3brL42_prog_map_thresh5_df$pre)
VHLx3brL42_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx3brL42_prog_map_thresh5_post_count = length(VHLx3brL42_prog_map_thresh5_df$post)
VHLx3brL42_prog_map_thresh5_post_count
VHLx3brL42_prog_map_thresh5_min_post_counts = min(VHLx3brL42_prog_map_thresh5_df$post)
VHLx3brL42_prog_map_thresh5_min_post_counts
VHLx3brL42_prog_map_thresh5_max_post_counts = max(VHLx3brL42_prog_map_thresh5_df$post)
VHLx3brL42_prog_map_thresh5_max_post_counts
VHLx3brL42_prog_map_thresh5_corr_post_count = length(VHLx3brL42_cSNV_all_df$corr_post)
VHLx3brL42_prog_map_thresh5_corr_post_count
VHLx3brL42_prog_map_thresh5_min_corr_post_counts = min(VHLx3brL42_cSNV_all_df$corr_post)
VHLx3brL42_prog_map_thresh5_min_corr_post_counts
VHLx3brL42_prog_map_thresh5_max_corr_post_counts = max(VHLx3brL42_cSNV_all_df$corr_post)
VHLx3brL42_prog_map_thresh5_max_corr_post_counts

VHLx3brL42_pSNV_thresh5 <- which(VHLx3brL42[,VHLx3b_p_hdr_snv]=='True' & as.numeric(as.character(VHLx3brL42[,'pre_freq']))>=0.00001)
VHLx3brL42_pSNV_thresh5_df = VHLx3brL42[VHLx3brL42_pSNV_thresh5,]
VHLx3brL42_pSNV_thresh5_lib_count = length(VHLx3brL42_pSNV_thresh5_df$lib)
VHLx3brL42_pSNV_thresh5_lib_count
VHLx3brL42_pSNV_thresh5_min_lib_counts = min(VHLx3brL42_pSNV_thresh5_df$lib)
VHLx3brL42_pSNV_thresh5_min_lib_counts
VHLx3brL42_pSNV_thresh5_max_lib_counts = max(VHLx3brL42_pSNV_thresh5_df$lib)
VHLx3brL42_pSNV_thresh5_max_lib_counts
VHLx3brL42_pSNV_thresh5_pre_count = length(VHLx3brL42_pSNV_thresh5_df$pre)
VHLx3brL42_pSNV_thresh5_pre_count
VHLx3brL42_pSNV_thresh5_min_pre_counts = min(VHLx3brL42_pSNV_thresh5_df$pre)
VHLx3brL42_pSNV_thresh5_min_pre_counts
VHLx3brL42_pSNV_thresh5_max_pre_counts = max(VHLx3brL42_pSNV_thresh5_df$pre)
VHLx3brL42_pSNV_thresh5_max_pre_counts
VHLx3brL42_pSNV_thresh5_post_count = length(VHLx3brL42_pSNV_thresh5_df$post)
VHLx3brL42_pSNV_thresh5_post_count
VHLx3brL42_pSNV_thresh5_min_post_counts = min(VHLx3brL42_pSNV_thresh5_df$post)
VHLx3brL42_pSNV_thresh5_min_post_counts
VHLx3brL42_pSNV_thresh5_max_post_counts = max(VHLx3brL42_pSNV_thresh5_df$post)
VHLx3brL42_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx3brL41_prog_var_thresh5_df:
VHLx3brL41_prog_var_thresh5_df_rL42_int <- VHLx3brL41_prog_var_thresh5_df[which(VHLx3brL41_prog_var_thresh5_df$variant %in% VHLx3brL42_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx3brL42_prog_var_thresh5_df:
VHLx3brL42_prog_var_thresh5_df_rL41_int <- VHLx3brL42_prog_var_thresh5_df[which(VHLx3brL42_prog_var_thresh5_df$variant %in% VHLx3brL41_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord <- VHLx3brL41_prog_var_thresh5_df_rL42_int[order(VHLx3brL41_prog_var_thresh5_df_rL42_int$variant),]
VHLx3brL42_prog_var_thresh5_df_rL41_int_ord <- VHLx3brL42_prog_var_thresh5_df_rL41_int[order(VHLx3brL42_prog_var_thresh5_df_rL41_int$variant),]
dim(VHLx3brL41_prog_var_thresh5_df)[1] #Number of prog_vars in rL41
VHLx3brL41rL42int_prog_var_thresh5_pre_count <- dim(VHLx3brL41_prog_var_thresh5_df_rL42_int)[1] 
VHLx3brL41rL42int_prog_var_thresh5_pre_count #Number of prog_vars in rL41 also in rL42
dim(VHLx3brL42_prog_var_thresh5_df)[1] #Number of prog_vars in rL42
dim(VHLx3brL42_prog_var_thresh5_df_rL41_int)[1] #Number of prog_vars in rL42 also in rL41

#Add the following columns from the from rL42 df to the rL41 df:
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$pre
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_lib <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$lib
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$rna
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2 <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post2
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3 <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post3
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2 <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$rna2
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pseudo <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post2_pseudo
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pseudo <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post3_pseudo
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_pseudo <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$rna2_pseudo
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$pre_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$rna_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post2_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post3_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$rna2_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$pre_pseudo_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post_pseudo_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pseudo_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$rna_pseudo_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pseudo_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post2_pseudo_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pseudo_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post3_pseudo_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_pseudo_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$rna2_pseudo_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$pre_lib_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post_pre_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post_lib_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_pre_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$rna_pre_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna_post_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$rna_post_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post2_pre_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pre_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post3_pre_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$rna2_post_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_snv_error_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$pre_snv_error_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_snv_error_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$post_snv_error_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_pre <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_pre
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_exp_snv_error_reads_post <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$exp_snv_error_reads_post
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$corr_pre
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$corr_post
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pre_pseudo <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$corr_pre_pseudo
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_post_pseudo <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$corr_post_pseudo
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_corr_pseudo_post_pre_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$corr_pseudo_post_pre_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_lib <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_lib
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2 <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3 <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2 <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_pseudo_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pseudo_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pseudo_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pseudo_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pseudo_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2_pseudo_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pseudo_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3_pseudo_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_pseudo_freq <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2_pseudo_freq
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_pre_lib_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_pre_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post_lib_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_pre_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna_post_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post2_pre_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pre_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_post3_pre_ratio
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio <- VHLx3brL42_prog_var_thresh5_df_rL41_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio) + log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio))/2)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio) + log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio))/2)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio) + log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio))/2)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio) + log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio))/2)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post3_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post3_pre_ratio) + log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post3_pre_ratio))/2)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rna2_post_ratio_rL41rL42_mean <- 2^((log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rna2_post_ratio) + log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio))/2)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio) + log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio))/2)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio) + log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio))/2)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean <- 2^((log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio) + log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio))/2)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio) + log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio))/2)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean <- 2^((log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio) + log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio))/2)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio) + log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio))/2)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post3_pre_ratio_rL41rL42_mean <- 2^((log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post3_pre_ratio) + log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post3_pre_ratio))/2)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean <- 2^((log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio) + log2(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_pre_weighted <- ((VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq*VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq))+(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq*VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)))/VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq
#rL41 pre-freq weighting coefficient (rL41_pre-freq / (rL41 + rL42 pre-freq's))
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_weight <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq/(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq/(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq+VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted <- (VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_pseudo_freq)*(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_pseudo_freq)*(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#this will be weighted by denominator:  (rL41_pof/lif')*(rL41_prwc)+(rL42_pof/lif)*(rL42_prwc)
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_pre_weighted <- (VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_pseudo_freq/VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_weight)+(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pseudo_freq/VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$lib_pseudo_freq)*(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_weight)
#rL41 tHDR_pre-freq weighting coefficient (rL41_tHDR_pre-freq / (rL41 + rL42 pre-freq's))
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq/(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#rL42 tHDR_pre-freq weighting coefficient
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq/(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq+VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rL41_pof/rL41_prf)(rL41_prwc)+(rL42_pof/rL42_prf)*(rL42_prwc)
#tHDR_post_pre_ratio_rL41rL42_pre_weighted
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted <- (VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pseudo_freq/VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_pseudo_freq)*(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_weight)+(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pseudo_freq/VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_pseudo_freq)*(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq)) >= 10) {
    VHLx3brL41_cSNV_pre_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx3brL41_cSNV_post_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx3brL41_cSNV_post2_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx3brL41_cSNV_post_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx3brL41_tSNV_pre_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx3brL41_tSNV_post_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx3brL41_tSNV_post_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx3brL41_tSNV_rna_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx3brL41_tSNV_rna_post_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx3brL41_tSNV_rna2_post_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx3brL42_cSNV_pre_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_pre_lib_ratio)
VHLx3brL42_cSNV_post_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post_pre_ratio)
VHLx3brL42_cSNV_post2_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post2_pre_ratio)

VHLx3brL42_cSNV_post_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_post_lib_ratio)
VHLx3brL42_tSNV_pre_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_pre_lib_ratio)
VHLx3brL42_tSNV_post_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post_pre_ratio)
VHLx3brL42_tSNV_post2_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post2_pre_ratio)
VHLx3brL42_tSNV_post_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_post_lib_ratio)
VHLx3brL42_tSNV_rna_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna_pre_ratio)
VHLx3brL42_tSNV_rna_post_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna_post_ratio)
VHLx3brL42_tSNV_rna2_post_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$rL42_tHDR_rna2_post_ratio)
VHLx3brL41rL42a_cSNV_pre_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rL41rL42_mean)
VHLx3brL41rL42a_cSNV_post_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rL41rL42_mean)
VHLx3brL41rL42a_cSNV_post2_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rL41rL42_mean)
VHLx3brL41rL42a_cSNV_post_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rL41rL42_mean)
VHLx3brL41rL42a_tSNV_pre_lib_med <- 
  median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rL41rL42_mean)
VHLx3brL41rL42a_tSNV_post_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rL41rL42_mean)
VHLx3brL41rL42a_tSNV_post2_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rL41rL42_mean)
VHLx3brL41rL42a_tSNV_post_lib_med <-
  median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rL41rL42_mean)
VHLx3brL41rL42a_tSNV_rna_pre_med <-
  median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rL41rL42_mean)
VHLx3brL41rL42a_tSNV_rna_post_med <-
  median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rL41rL42_mean)
VHLx3brL41rL42a_tSNV_rna2_post_med <-
  median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rL41rL42_mean)
VHLx3brL41rL42pw_tSNV_post_pre_med  <-
  median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
VHLx3brL41rL42pw_cSNV_post_pre_med  <-
  median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rL41rL42_pre_weighted)
  } else {
  VHLx3brL41_cSNV_pre_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio)
VHLx3brL41_cSNV_post_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio)
VHLx3brL41_cSNV_post2_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio)
VHLx3brL41_cSNV_post_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio)
VHLx3brL41_tSNV_pre_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio)
VHLx3brL41_tSNV_post_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio)
VHLx3brL41_tSNV_post_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio)
VHLx3brL41_tSNV_rna_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio)
VHLx3brL41_tSNV_rna_post_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio)
VHLx3brL41_tSNV_rna2_post_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio)
VHLx3brL42_cSNV_pre_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio)
VHLx3brL42_cSNV_post_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio)
VHLx3brL42_cSNV_post2_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio)

VHLx3brL42_cSNV_post_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio)
VHLx3brL42_tSNV_pre_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio)
VHLx3brL42_tSNV_post_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio)
VHLx3brL42_tSNV_post2_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio)
VHLx3brL42_tSNV_post_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio)
VHLx3brL42_tSNV_rna_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio)
VHLx3brL42_tSNV_rna_post_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio)
VHLx3brL42_tSNV_rna2_post_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio)
VHLx3brL41rL42a_cSNV_pre_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean)
VHLx3brL41rL42a_cSNV_post_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean)
VHLx3brL41rL42a_cSNV_post2_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_rL41rL42_mean)
VHLx3brL41rL42a_cSNV_post_lib_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean)
VHLx3brL41rL42a_tSNV_pre_lib_med <- 
  median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean)
VHLx3brL41rL42a_tSNV_post_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean)
VHLx3brL41rL42a_tSNV_post2_pre_med <- median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean)
VHLx3brL41rL42a_tSNV_post_lib_med <-
  median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean)
VHLx3brL41rL42a_tSNV_rna_pre_med <-
  median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean)
VHLx3brL41rL42a_tSNV_rna_post_med <-
  median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean)
VHLx3brL41rL42a_tSNV_rna2_post_med <-
  median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean)
VHLx3brL41rL42pw_tSNV_post_pre_med  <-
  median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted)
VHLx3brL41rL42pw_cSNV_post_pre_med  <-
  median(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted)
}

VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio/VHLx3brL41_cSNV_pre_lib_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio/VHLx3brL41_cSNV_post_pre_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio/VHLx3brL41_cSNV_post_lib_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post2_pre_ratio/VHLx3brL41_cSNV_post2_pre_med

VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio/VHLx3brL41_tSNV_pre_lib_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio/VHLx3brL41_tSNV_post_pre_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio/VHLx3brL41_tSNV_post_lib_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio/VHLx3brL41_tSNV_rna_pre_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio/VHLx3brL41_tSNV_rna_post_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio/VHLx3brL42_tSNV_post2_pre_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio/VHLx3brL41_tSNV_rna2_post_med

VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_pre_lib_ratio/VHLx3brL42_cSNV_pre_lib_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_pre_ratio/VHLx3brL42_cSNV_post_pre_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post_lib_ratio/VHLx3brL42_cSNV_post_lib_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_post2_pre_ratio/VHLx3brL41rL42a_cSNV_post2_pre_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_rna2_post_ratio/VHLx3brL42_tSNV_rna2_post_med


VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_pre_lib_ratio/VHLx3brL42_tSNV_pre_lib_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_pre_ratio/VHLx3brL42_tSNV_post_pre_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post2_pre_ratio/VHLx3brL42_tSNV_post2_pre_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_post_lib_ratio/VHLx3brL42_tSNV_post_lib_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_pre_ratio/VHLx3brL42_tSNV_rna_pre_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna_post_ratio/VHLx3brL42_tSNV_rna_post_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$rL42_tHDR_rna2_post_ratio/VHLx3brL42_tSNV_rna2_post_med

###normalize the means
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$pre_lib_ratio_rL41rL42_mean/VHLx3brL41rL42a_cSNV_pre_lib_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_mean/VHLx3brL41rL42a_cSNV_post_pre_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_lib_ratio_rL41rL42_mean/VHLx3brL41rL42a_cSNV_post_lib_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_pre_lib_ratio_rL41rL42_mean/VHLx3brL41rL42a_tSNV_pre_lib_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_mean/VHLx3brL41rL42a_tSNV_post_pre_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post2_pre_ratio_rL41rL42_mean/VHLx3brL41rL42a_tSNV_post2_pre_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_lib_ratio_rL41rL42_mean/VHLx3brL41rL42a_tSNV_post_lib_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_pre_ratio_rL41rL42_mean/VHLx3brL41rL42a_tSNV_rna_pre_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna_post_ratio_rL41rL42_mean/VHLx3brL41rL42a_tSNV_rna_post_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_rna2_post_ratio_rL41rL42_mean/VHLx3brL41rL42a_tSNV_rna2_post_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$tHDR_post_pre_ratio_rL41rL42_pre_weighted/VHLx3brL41rL42pw_tSNV_post_pre_med
VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted_synnorm <- VHLx3brL41_prog_var_thresh5_df_rL42_int_ord$post_pre_ratio_rL41rL42_pre_weighted/VHLx3brL41rL42pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx3brL41_prog_var_thresh5_df_rL42_int_ord
VHLx3brL41_prog_map_thresh5_df_rL42_int_ord = which(VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[,'pos']!='REF')
VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df = VHLx3brL41_prog_var_thresh5_df_rL42_int_ord[VHLx3brL41_prog_map_thresh5_df_rL42_int_ord,]
VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord = which(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='REF' & VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df[,'cDNApos']!='NA')
VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df = VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df[VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord,]
VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord = which(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df[,'CADD.phred']!='NA')
VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df = VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df[VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord,]
VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense <- VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df[which(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx3brL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
VHLx3brL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_s
VHLx3brL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='pearson')
VHLx3brL41rL42_cSNV_rL41_post_pre_by_rL42_post_pre_cor_p
VHLx3brL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
VHLx3brL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_s
VHLx3brL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='pearson')
VHLx3brL41rL42_cSNV_rL41_post_lib_by_rL42_post_lib_cor_p
VHLx3brL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post2_pre_ratio_synnorm),method='spearman')
VHLx3brL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s
VHLx3brL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_p <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post2_pre_ratio_synnorm),method='pearson')
VHLx3brL41rL42_cSNV_rL41_post2_pre_by_rL42_post2_pre_cor_p
VHLx3brL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx3brL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_s
VHLx3brL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx3brL41rL42_tSNV_rL41_tHDR_post_pre_by_rL42_tHDR_post_pre_cor_p
VHLx3brL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx3brL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_s
VHLx3brL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx3brL41rL42_tSNV_rL41_tHDR_post_lib_by_rL42_tHDR_post_lib_cor_p
VHLx3brL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s <- cor(log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3brL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_s
VHLx3brL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p <- cor(log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx3brL41rL42_tSNV_rL41_tHDR_rna_pre_by_rL42_tHDR_rna_pre_cor_p
VHLx3brL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_s <- cor(log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx3brL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_s
VHLx3brL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_p <- cor(log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx3brL41rL42_tSNV_rL41_tHDR_rna2_post_by_rL42_tHDR_rna2_post_cor_p
VHLx3brL41rL42_cSNV_rL41_post_by_rL42_post_cor_s <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
VHLx3brL41rL42_cSNV_rL41_post_by_rL42_post_cor_s
VHLx3brL41rL42_cSNV_rL41_post_by_rL42_post_cor_p <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$post_pseudo_freq),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pseudo_freq),method='pearson')
VHLx3brL41rL42_cSNV_rL41_post_by_rL42_post_cor_p
VHLx3brL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='spearman')
VHLx3brL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_s
VHLx3brL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p <-cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio_synnorm),method='pearson')
VHLx3brL41rL42_cSNV_rL41_pre_lib_by_rL42_pre_lib_cor_p
VHLx3brL41rL42_tSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx3brL41rL42_tSNV_rL41_post2_pre_by_rL42_post2_pre_cor_s
VHLx3brL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx3brL41rL42_tSNV_rL41_post_lib_by_rL42_post_lib_cor_s
VHLx3brL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx3brL41rL42_tSNV_rL41_post_pre_by_rL42_post_pre_cor_s
VHLx3brL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3brL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s
VHLx3brL41rL42_tSNV_rL41_rna2_post_by_rL42_rna2_post_cor_s <- cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx3brL41rL42_tSNV_rL41_rna2_post_by_rL42_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx3brL41_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41_cSNV_post_pre_by_cadd_cor_s
VHLx3brL42_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL42_cSNV_post_pre_by_cadd_cor_s
VHLx3brL41_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41_cSNV_post_lib_by_cadd_cor_s
VHLx3brL42_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL42_cSNV_post_lib_by_cadd_cor_s
VHLx3brL41_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41_tSNV_post_pre_by_cadd_cor_s
VHLx3brL42_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL42_tSNV_post_pre_by_cadd_cor_s
VHLx3brL41_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41_tSNV_post_lib_by_cadd_cor_s
VHLx3brL42_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL42_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx3brL41rL42a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42a_cSNV_pre_lib_by_cadd_cor_s
VHLx3brL41rL42w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42w_cSNV_pre_lib_by_cadd_cor_s
VHLx3brL41rL42a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42a_cSNV_post_pre_by_cadd_cor_s
VHLx3brL41rL42w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42w_cSNV_post_pre_by_cadd_cor_s
VHLx3brL41rL42a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42a_cSNV_post_lib_by_cadd_cor_s
VHLx3brL41rL42w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42w_cSNV_post_lib_by_cadd_cor_s
VHLx3brL41rL42a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42a_tSNV_pre_lib_by_cadd_cor_s
VHLx3brL41rL42a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42a_tSNV_post_pre_by_cadd_cor_s
VHLx3brL41rL42w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42w_tSNV_post_pre_by_cadd_cor_s
VHLx3brL41rL42a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post2_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42a_tSNV_post2_pre_by_cadd_cor_s
VHLx3brL41rL42a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx3brL41_cSNV_pre_lib_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3brL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3brL41_tSNV_pre_lib_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3brL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3brL41_cSNV_post_lib_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3brL41_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx3brL41_tSNV_post_lib_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3brL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx3brL41_cSNV_post_pre_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx3brL41_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3brL41_tSNV_post_pre_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx3brL41_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3brL41_cSNV_rna_lib_cors = cor(log2(VHLx3brL41_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx3brL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3brL41_tSNV_rna_lib_cors = cor(log2(VHLx3brL41_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3brL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx3brL41_cSNV_rna_pre_cors = cor(log2(VHLx3brL41_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx3brL41_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3brL41_tSNV_rna_pre_cors = cor(log2(VHLx3brL41_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx3brL41_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3brL41rL42_cSNV_pre_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$pre_freq),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_freq),method='spearman')
VHLx3brL41rL42_tSNV_pre_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_pseudo_freq),method='spearman')
VHLx3brL41rL42_cSNV_pre_lib_ratio_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$pre_lib_ratio),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_pre_lib_ratio),method='spearman')
VHLx3brL41rL42_tSNV_pre_lib_ratio_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio),method='spearman')
VHLx3brL41rL42_cSNV_post_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$post_freq),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_freq),method='spearman')
VHLx3brL41rL42_tSNV_post_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pseudo_freq),method='spearman')
VHLx3brL41rL42_cSNV_post_lib_ratio_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$post_lib_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_lib_ratio_synnorm),method='spearman')
VHLx3brL41rL42_tSNV_post_lib_ratio_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx3brL41rL42_cSNV_post_pre_ratio_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$post_pre_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_post_pre_ratio_synnorm),method='spearman')
VHLx3brL41rL42_tSNV_post_pre_ratio_cors = cor(log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx3brL41rL42_cSNV_rna_cors = cor(log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rna_freq),log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_rna_freq),method='spearman')
VHLx3brL41rL42_tSNV_rna_cors = cor(log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq),method='spearman')
VHLx3brL41rL42_tSNV_rna_pre_ratio_cors = cor(log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3brL41_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brL41_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brL41_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brL41_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brL41_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brL41_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brL41_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3brL41_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3brL41_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3brL41_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3brL41_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx3brL41_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx3brL41rL42a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3brL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3brL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3brL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3brL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx3brL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$tHDR_post_pre_ratio_rL41rL42_mean_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx3brL41rL42w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$pre_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_lib_ratio_rL41rL42_pre_weighted),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')
VHLx3brL41rL42w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_pre_weighted_synnorm),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df$CADD.phred)),method='spearman')

VHLx3brL41_cors <- c("VHLx3brL41",VHLx3brL41_cSNV_pre_lib_cors,VHLx3brL41_tSNV_pre_lib_cors,VHLx3brL41_cSNV_post_lib_cors,VHLx3brL41_tSNV_post_lib_cors,VHLx3brL41_cSNV_post_pre_cors,VHLx3brL41_tSNV_post_pre_cors,VHLx3brL41_cSNV_rna_lib_cors,VHLx3brL41_tSNV_rna_lib_cors,VHLx3brL41_cSNV_rna_pre_cors,VHLx3brL41_tSNV_rna_pre_cors,VHLx3brL41rL42_cSNV_pre_cors,VHLx3brL41rL42_tSNV_pre_cors,VHLx3brL41rL42_cSNV_pre_lib_ratio_cors,VHLx3brL41rL42_tSNV_pre_lib_ratio_cors,VHLx3brL41rL42_cSNV_post_cors,VHLx3brL41rL42_tSNV_post_cors,VHLx3brL41rL42_cSNV_post_lib_ratio_cors,VHLx3brL41rL42_tSNV_post_lib_ratio_cors,VHLx3brL41rL42_cSNV_post_pre_ratio_cors,VHLx3brL41rL42_tSNV_post_pre_ratio_cors,VHLx3brL41rL42_cSNV_rna_cors,VHLx3brL41rL42_tSNV_rna_cors,VHLx3brL41rL42_tSNV_rna_pre_ratio_cors,VHLx3brL41_cSNV_pre_lib_ratio_cadd_cors,VHLx3brL41_tSNV_pre_lib_ratio_cadd_cors,VHLx3brL41_cSNV_post_lib_ratio_cadd_cors,VHLx3brL41_tSNV_post_lib_ratio_cadd_cors,VHLx3brL41_cSNV_post_pre_ratio_cadd_cors,VHLx3brL41_tSNV_post_pre_ratio_cadd_cors,VHLx3brL41_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3brL41_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3brL41_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brL41_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brL41_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3brL41_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3brL41rL42a_cSNV_pre_lib_ratio_cadd_cors,VHLx3brL41rL42a_tSNV_pre_lib_ratio_cadd_cors,VHLx3brL41rL42a_cSNV_post_lib_ratio_cadd_cors,VHLx3brL41rL42a_tSNV_post_lib_ratio_cadd_cors,VHLx3brL41rL42a_cSNV_post_pre_ratio_cadd_cors,VHLx3brL41rL42a_tSNV_post_pre_ratio_cadd_cors,VHLx3brL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3brL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3brL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3brL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3brL41rL42w_cSNV_pre_lib_ratio_cadd_cors,VHLx3brL41rL42w_cSNV_post_lib_ratio_cadd_cors,VHLx3brL41rL42w_cSNV_post_pre_ratio_cadd_cors,VHLx3brL41rL42w_tSNV_post_pre_ratio_cadd_cors)

VHLx3brL42_cSNV_pre_lib_cors = cor(log2(VHLx3brL42_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3brL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3brL42_tSNV_pre_lib_cors = cor(log2(VHLx3brL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3brL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3brL42_cSNV_post_lib_cors = cor(log2(VHLx3brL42_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3brL42_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx3brL42_tSNV_post_lib_cors = cor(log2(VHLx3brL42_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3brL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx3brL42_cSNV_post_pre_cors = cor(log2(VHLx3brL42_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx3brL42_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3brL42_tSNV_post_pre_cors = cor(log2(VHLx3brL42_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx3brL42_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3brL42_cSNV_rna_lib_cors = cor(log2(VHLx3brL42_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx3brL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3brL42_tSNV_rna_lib_cors = cor(log2(VHLx3brL42_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3brL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx3brL42_cSNV_rna_pre_cors = cor(log2(VHLx3brL42_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx3brL42_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3brL42_tSNV_rna_pre_cors = cor(log2(VHLx3brL42_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx3brL42_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3brL42_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3brL42_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx3brL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brL42_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3brL42_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx3brL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brL42_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3brL42_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx3brL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brL42_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3brL42_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx3brL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brL42_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brL42_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx3brL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brL42_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3brL42_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brL42_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3brL42_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3brL42_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3brL42_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3brL42_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3brL42_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_post_pre_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')
VHLx3brL42_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$rL42_tHDR_post_pre_ratio),as.numeric(as.character(VHLx3brL41_prog_map_CADD_thresh5_df_rL42_int_ord_df_missense$Grantham)),method='spearman')

VHLx3brL42_cors <- c("VHLx3brL42",VHLx3brL42_cSNV_pre_lib_cors,VHLx3brL42_tSNV_pre_lib_cors,VHLx3brL42_cSNV_post_lib_cors,VHLx3brL42_tSNV_post_lib_cors,VHLx3brL42_cSNV_post_pre_cors,VHLx3brL42_tSNV_post_pre_cors,VHLx3brL42_cSNV_rna_lib_cors,VHLx3brL42_tSNV_rna_lib_cors,VHLx3brL42_cSNV_rna_pre_cors,VHLx3brL42_tSNV_rna_pre_cors,VHLx3brL41rL42_cSNV_pre_cors,VHLx3brL41rL42_tSNV_pre_cors,VHLx3brL41rL42_cSNV_pre_lib_ratio_cors,VHLx3brL41rL42_tSNV_pre_lib_ratio_cors,VHLx3brL41rL42_cSNV_post_cors,VHLx3brL41rL42_tSNV_post_cors,VHLx3brL41rL42_cSNV_post_lib_ratio_cors,VHLx3brL41rL42_tSNV_post_lib_ratio_cors,VHLx3brL41rL42_cSNV_post_pre_ratio_cors,VHLx3brL41rL42_tSNV_post_pre_ratio_cors,VHLx3brL41rL42_cSNV_rna_cors,VHLx3brL41rL42_tSNV_rna_cors,VHLx3brL41rL42_tSNV_rna_pre_ratio_cors,VHLx3brL42_cSNV_pre_lib_ratio_cadd_cors,VHLx3brL42_tSNV_pre_lib_ratio_cadd_cors,VHLx3brL42_cSNV_post_lib_ratio_cadd_cors,VHLx3brL42_tSNV_post_lib_ratio_cadd_cors,VHLx3brL42_cSNV_post_pre_ratio_cadd_cors,VHLx3brL42_tSNV_post_pre_ratio_cadd_cors,VHLx3brL42_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3brL42_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3brL42_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brL42_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brL42_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3brL42_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3brL41rL42a_cSNV_pre_lib_ratio_cadd_cors,VHLx3brL41rL42a_tSNV_pre_lib_ratio_cadd_cors,VHLx3brL41rL42a_cSNV_post_lib_ratio_cadd_cors,VHLx3brL41rL42a_tSNV_post_lib_ratio_cadd_cors,VHLx3brL41rL42a_cSNV_post_pre_ratio_cadd_cors,VHLx3brL41rL42a_tSNV_post_pre_ratio_cadd_cors,VHLx3brL41rL42a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3brL41rL42a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3brL41rL42a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brL41rL42a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3brL41rL42a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3brL41rL42a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3brL41rL42w_cSNV_pre_lib_ratio_cadd_cors,VHLx3brL41rL42w_cSNV_post_lib_ratio_cadd_cors,VHLx3brL41rL42w_cSNV_post_pre_ratio_cadd_cors,VHLx3brL41rL42w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx3brL41)
rm(VHLx3brL42)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx3brL41
VHLx3b_posrange <- range(as.numeric(as.character(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$pos)))
VHLx3b_posseq <- seq(from=VHLx3b_posrange[1], to=VHLx3b_posrange[2])
VHLx3brL41_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx3brL41_tHDR_pre_lib_pred <- predict(VHLx3brL41_tHDR_pre_lib_ratio.lo, newdata = VHLx3b_posseq, se=TRUE)
VHLx3brL41_tHDR_pre_lib_pos_effects <- VHLx3brL41_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx3brL41_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx3brL41_tHDR_pre_lib_pos_effects)
VHLx3brL41_tHDR_pre_lib_pos_effects_ci <- VHLx3brL41_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx3brL41_tHDR_pre_lib_pred$df)
VHLx3brL41_tHDR_pre_lib_pos_effects_ci_ymin = VHLx3brL41_tHDR_pre_lib_pos_effects - VHLx3brL41_tHDR_pre_lib_pos_effects_ci
VHLx3brL41_tHDR_pre_lib_pos_effects_ci_ymax = VHLx3brL41_tHDR_pre_lib_pos_effects + VHLx3brL41_tHDR_pre_lib_pos_effects_ci
VHLx3brL41_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx3b_posseq, VHLx3brL41_tHDR_pre_lib_pos_effects, VHLx3brL41_tHDR_pre_lib_pos_effects.x, VHLx3brL41_tHDR_pre_lib_pos_effects_ci_ymin, VHLx3brL41_tHDR_pre_lib_pos_effects_ci_ymax, VHLx3brL41_tHDR_pre_lib_pred_se = VHLx3brL41_tHDR_pre_lib_pred$se.fit)
#VHLx3brL42
VHLx3brL42_tHDR_pre_lib_ratio.lo <- loess(log2(rL42_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$rL42_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx3brL42_tHDR_pre_lib_pred <- predict(VHLx3brL42_tHDR_pre_lib_ratio.lo, newdata = VHLx3b_posseq, se=TRUE)
VHLx3brL42_tHDR_pre_lib_pos_effects <- VHLx3brL42_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx3brL42_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx3brL42_tHDR_pre_lib_pos_effects)
VHLx3brL42_tHDR_pre_lib_pos_effects_ci <- VHLx3brL42_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx3brL42_tHDR_pre_lib_pred$df)
VHLx3brL42_tHDR_pre_lib_pos_effects_ci_ymin = VHLx3brL42_tHDR_pre_lib_pos_effects - VHLx3brL42_tHDR_pre_lib_pos_effects_ci
VHLx3brL42_tHDR_pre_lib_pos_effects_ci_ymax = VHLx3brL42_tHDR_pre_lib_pos_effects + VHLx3brL42_tHDR_pre_lib_pos_effects_ci
VHLx3brL42_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx3b_posseq, VHLx3brL42_tHDR_pre_lib_pos_effects, VHLx3brL42_tHDR_pre_lib_pos_effects.x, VHLx3brL42_tHDR_pre_lib_pos_effects_ci_ymin, VHLx3brL42_tHDR_pre_lib_pos_effects_ci_ymax, VHLx3brL42_tHDR_pre_lib_pred_se = VHLx3brL42_tHDR_pre_lib_pred$se.fit)

#VHLx3brL41rL42
VHLx3brL41rL42_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rL41rL42_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df, subset = which(VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_post_pre_ratio_rL41rL42_mean_synnorm > 0.7 & VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm > 0.3 & VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx3brL41rL42_tHDR_pre_lib_pred <- predict(VHLx3brL41rL42_tHDR_pre_lib_ratio.lo, newdata = VHLx3b_posseq, se=TRUE)
VHLx3brL41rL42_tHDR_pre_lib_pos_effects <- VHLx3brL41rL42_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx3brL41rL42_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx3brL41rL42_tHDR_pre_lib_pos_effects)
VHLx3brL41rL42_tHDR_pre_lib_pos_effects_ci <- VHLx3brL41rL42_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx3brL41rL42_tHDR_pre_lib_pred$df)
VHLx3brL41rL42_tHDR_pre_lib_pos_effects_ci_ymin = VHLx3brL41rL42_tHDR_pre_lib_pos_effects - VHLx3brL41rL42_tHDR_pre_lib_pos_effects_ci
VHLx3brL41rL42_tHDR_pre_lib_pos_effects_ci_ymax = VHLx3brL41rL42_tHDR_pre_lib_pos_effects + VHLx3brL41rL42_tHDR_pre_lib_pos_effects_ci
VHLx3brL41rL42_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx3b_posseq, VHLx3brL41rL42_tHDR_pre_lib_pos_effects, VHLx3brL41rL42_tHDR_pre_lib_pos_effects.x, VHLx3brL41rL42_tHDR_pre_lib_pos_effects_ci_ymin, VHLx3brL41rL42_tHDR_pre_lib_pos_effects_ci_ymax, VHLx3brL41rL42_tHDR_pre_lib_pred_se = VHLx3brL41rL42_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rL41, rL42, rL41rL42)
VHLx3brL4_tHDR_pos_merge_df <- VHLx3brL41_prog_map_thresh5_df_rL42_int_ord_df 
VHLx3brL4_tHDR_pos_merge_df <- merge(VHLx3brL4_tHDR_pos_merge_df, VHLx3brL41_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx3brL41_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx3brL4_tHDR_pos_merge_df <- merge(VHLx3brL4_tHDR_pos_merge_df, VHLx3brL42_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx3brL42_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx3brL4_tHDR_pos_merge_df <- merge(VHLx3brL4_tHDR_pos_merge_df, VHLx3brL41rL42_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx3brL41rL42_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx3brL4_tHDR_pos_merge_df <- VHLx3brL4_tHDR_pos_merge_df %>% 
  rename(
    rL41_tHDR_pre_lib_pos_effects.x = VHLx3brL41_tHDR_pre_lib_pos_effects.x,
    rL42_tHDR_pre_lib_pos_effects.x = VHLx3brL42_tHDR_pre_lib_pos_effects.x,
    rL41rL42_tHDR_pre_lib_pos_effects.x = VHLx3brL41rL42_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rL41 vs. rL41_fit and vs. mean_fit)
VHLx3brL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41 <- log2(VHLx3brL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx3brL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_pos_effects.x
VHLx3brL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx3brL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx3brL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx3brL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42 <- log2(VHLx3brL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_ratio_synnorm) - VHLx3brL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_pos_effects.x
VHLx3brL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx3brL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_ratio_synnorm) - VHLx3brL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx3brL4_tHDR_pos_merge_df$rL41rL42_tHDR_post_lib_loess_rL41rL42 <- log2(VHLx3brL4_tHDR_pos_merge_df$tHDR_post_lib_ratio_rL41rL42_mean_synnorm) - VHLx3brL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx3brL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_loess_rL41 <- log2(VHLx3brL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx3brL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_pos_effects.x
VHLx3brL4_tHDR_pos_merge_df$rL41_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx3brL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx3brL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx3brL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_loess_rL42 <- log2(VHLx3brL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_ratio_synnorm) - VHLx3brL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_pos_effects.x
VHLx3brL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx3brL4_tHDR_pos_merge_df$rL42_tHDR_pre_lib_ratio_synnorm) - VHLx3brL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x
VHLx3brL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_loess_rL41rL42 <- log2(VHLx3brL4_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rL41rL42_mean_synnorm) - VHLx3brL4_tHDR_pos_merge_df$rL41rL42_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rL41 and rL42 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx3brL4_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx3brL4_tHDR_post_lib_loess_median_syn_rL41 <- median(VHLx3brL4_tHDR_pos_merge_df[which(VHLx3brL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rL41_tHDR_post_lib_loess_rL41')])
  VHLx3brL4_tHDR_post_lib_loess_median_syn_rL42 <- median(VHLx3brL4_tHDR_pos_merge_df[which(VHLx3brL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rL42_tHDR_post_lib_loess_rL42')])
  } else {
  VHLx3brL4_tHDR_post_lib_loess_median_syn_rL41 <- median(VHLx3brL4_tHDR_pos_merge_df[which(VHLx3brL4_tHDR_pos_merge_df$conseq != 'could be anything'),c('rL41_tHDR_post_lib_loess_rL41')])
  VHLx3brL4_tHDR_post_lib_loess_median_syn_rL42 <- median(VHLx3brL4_tHDR_pos_merge_df[which(VHLx3brL4_tHDR_pos_merge_df$conseq != 'could be anything'),c('rL42_tHDR_post_lib_loess_rL42')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rL41 'e.sns' = exon syn/ns norm.
VHLx3brL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41_e.sns <- (VHLx3brL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41-VHLx3brL4_tHDR_post_lib_loess_median_syn_rL41)
#calculate new b values for rL42 'e.sns' = exon syn/ns norm.
VHLx3brL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42_e.sns <- (VHLx3brL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42-VHLx3brL4_tHDR_post_lib_loess_median_syn_rL42)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx3brL4_tHDR_pos_merge_df$rL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean <- (VHLx3brL4_tHDR_pos_merge_df$rL41_tHDR_post_lib_loess_rL41_e.sns+VHLx3brL4_tHDR_pos_merge_df$rL42_tHDR_post_lib_loess_rL42_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx3brL4_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx3brL4_tHDR_post_lib_loess_e.sns_rL41rL42_syn_median <- median(VHLx3brL4_tHDR_pos_merge_df[which(VHLx3brL4_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('VHLx3brL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean')])
  } else {
  VHLx3brL4_tHDR_post_lib_loess_e.sns_rL41rL42_syn_median <- median(VHLx3brL4_tHDR_pos_merge_df[which(VHLx3brL4_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('VHLx3brL4_tHDR_post_lib_loess_e.sns_rL41rL42_mean')])
}

#RNA analysis
VHLx3brL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s <- cor(log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3brL41rL42_tSNV_rL41_rna_pre_by_rL42_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41_tHDR_rna2_rna_ratio <- VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna2_pseudo_freq/VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$tHDR_rna_pseudo_freq
VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_rna_ratio <- VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_pseudo_freq/VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna_pseudo_freq
VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41rL42_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL41_tHDR_rna2_rna_ratio)+log2(VHLx3brL41_prog_map_exon_thresh5_df_rL42_int_ord_df$rL42_tHDR_rna2_rna_ratio))/2

```

rLH section, experiments performed in LIG4-KO+HIF1A-KO HAP1 cells (DAB treated)

```{r}
#VHLx2rLH
VHLx2rLH1_file <- paste(experiment_dir_220822,'VHLx2rL4H1','_annotated.txt',sep='')
VHLx2rLH2_file <- paste(experiment_dir_220822,'VHLx2rL4H2','_annotated.txt',sep='')
VHLx2rLH1 <- read.table(VHLx2rLH1_file, header=TRUE, sep="\t")
VHLx2rLH2 <- read.table(VHLx2rLH2_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx2rLH1 <- VHLx2rLH1 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

VHLx2rLH2 <- VHLx2rLH2 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx2 <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx2'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx2_HDR_5_SNV = as.character(VHL_editing_info_VHLx2$HDR_5_SNV)
VHLx2_HDR_3_SNV = as.character(VHL_editing_info_VHLx2$HDR_3_SNV)
#VHLx2_cut_pos = as.character(VHL_editing_info_VHLx2$cut_pos)
VHLx2_cut_end = as.character(VHL_editing_info_VHLx2$cut_end)
VHLx2_mut_start = as.character(VHL_editing_info_VHLx2$mut_start)
VHLx2_mut_end = as.character(VHL_editing_info_VHLx2$mut_end)

### Replicate 1
VHLx2rLH1_cSNV_all <- which(VHLx2rLH1[,'c_hdr_snv']=='True')
VHLx2rLH1_cSNV_all_df = VHLx2rLH1[VHLx2rLH1_cSNV_all,]
VHLx2rLH1_prog_var_all <- which(VHLx2rLH1[,'all_hdr_variant']=='True' & VHLx2rLH1[,'edit_string']!='-WT')
VHLx2rLH1_prog_var_all_df = VHLx2rLH1[VHLx2rLH1_prog_var_all,]
VHLx2rLH1_prog_map_all = which(VHLx2rLH1_prog_var_all_df[,'pos']!='REF')
VHLx2rLH1_prog_map_all_df = VHLx2rLH1_prog_var_all_df[VHLx2rLH1_prog_map_all,]
VHLx2rLH1_prog_map_exon_all = which(VHLx2rLH1_prog_map_all_df[,'cDNApos']!='REF' & VHLx2rLH1_prog_map_all_df[,'cDNApos']!='NA')
VHLx2rLH1_prog_map_exon_all_df = VHLx2rLH1_prog_map_all_df[VHLx2rLH1_prog_map_exon_all,]
VHLx2rLH1_prog_map_CADD = which(VHLx2rLH1_prog_map_all_df[,'CADD.phred']!='NA')
VHLx2rLH1_prog_map_CADD_df = VHLx2rLH1_prog_map_all_df[VHLx2rLH1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx2rLH1_prog_var_thresh5 <- which(as.numeric(as.character(VHLx2rLH1_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx2rLH1_prog_var_thresh5_df = VHLx2rLH1_prog_var_all_df[VHLx2rLH1_prog_var_thresh5,]
VHLx2rLH1_prog_map_thresh5 <- which(as.numeric(as.character(VHLx2rLH1_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx2rLH1_prog_map_thresh5_df = VHLx2rLH1_prog_map_all_df[VHLx2rLH1_prog_map_thresh5,]
VHLx2rLH1_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx2rLH1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx2rLH1_prog_map_exon_thresh5_df = VHLx2rLH1_prog_map_exon_all_df[VHLx2rLH1_prog_map_exon_thresh5,]
VHLx2rLH1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx2rLH1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx2rLH1_prog_map_CADD_thresh5_df = VHLx2rLH1_prog_map_CADD_df[VHLx2rLH1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx2rLH1_prog_var_all_lib_count = length(VHLx2rLH1_prog_var_all_df$lib)
VHLx2rLH1_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx2rLH1_prog_var_all_min_lib_counts = min(VHLx2rLH1_prog_var_all_df$lib)
VHLx2rLH1_prog_var_all_min_lib_counts
VHLx2rLH1_prog_var_all_max_lib_counts = max(VHLx2rLH1_prog_var_all_df$lib)
VHLx2rLH1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx2rLH1_prog_map_all_lib_count = length(VHLx2rLH1_prog_map_all_df$lib)
VHLx2rLH1_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx2rLH1_prog_map_all_min_lib_counts = min(VHLx2rLH1_prog_map_all_df$lib)
VHLx2rLH1_prog_map_all_min_lib_counts
VHLx2rLH1_prog_map_all_max_lib_counts = max(VHLx2rLH1_prog_map_all_df$lib)
VHLx2rLH1_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx2rLH1_prog_var_all_pre_count = length(VHLx2rLH1_prog_var_all_df$pre)
VHLx2rLH1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx2rLH1_prog_var_all_min_pre_counts = min(VHLx2rLH1_prog_var_all_df$pre)
VHLx2rLH1_prog_var_all_min_pre_counts
VHLx2rLH1_prog_var_all_max_pre_counts = max(VHLx2rLH1_prog_var_all_df$pre)
VHLx2rLH1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx2rLH1_prog_map_all_pre_count = length(VHLx2rLH1_prog_map_all_df$pre)
VHLx2rLH1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx2rLH1_prog_map_all_min_pre_counts = min(VHLx2rLH1_prog_map_all_df$pre)
VHLx2rLH1_prog_map_all_min_pre_counts
VHLx2rLH1_prog_map_all_max_pre_counts = max(VHLx2rLH1_prog_map_all_df$pre)
VHLx2rLH1_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx2rLH1_prog_map_all_post_count = length(VHLx2rLH1_prog_map_all_df$post)
VHLx2rLH1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx2rLH1_prog_map_all_min_post_counts = min(VHLx2rLH1_prog_map_all_df$post)
VHLx2rLH1_prog_map_all_min_post_counts
VHLx2rLH1_prog_map_all_max_post_counts = max(VHLx2rLH1_prog_map_all_df$post)
VHLx2rLH1_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx2rLH1_prog_map_all_syn_df <- VHLx2rLH1_prog_map_all_df[which(VHLx2rLH1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx2rLH1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx2rLH1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx2rLH1_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx2rLH1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx2rLH1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx2rLH1_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx2rLH1_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx2rLH1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx2rLH1_prog_map_all_min_rna_counts = min(VHLx2rLH1_prog_map_exon_all_df$tHDR_rna)
VHLx2rLH1_prog_map_all_min_rna_counts
VHLx2rLH1_prog_map_all_max_rna_counts = max(VHLx2rLH1_prog_map_exon_all_df$tHDR_rna)
VHLx2rLH1_prog_map_all_max_rna_counts
VHLx2rLH1_prog_map_all_min_rna_pseudo_freq = min(VHLx2rLH1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx2rLH1_prog_map_all_min_rna_pseudo_freq
VHLx2rLH1_prog_map_all_max_rna_pseudo_freq = max(VHLx2rLH1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx2rLH1_prog_map_all_max_rna_pseudo_freq
VHLx2rLH1_prog_map_all_min_rna_pre_ratio = min(VHLx2rLH1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx2rLH1_prog_map_all_min_rna_pre_ratio
VHLx2rLH1_prog_map_all_max_rna_pre_ratio = max(VHLx2rLH1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx2rLH1_prog_map_all_max_rna_pre_ratio
VHLx2rLH1_prog_map_all_min_rna_post_ratio = min(VHLx2rLH1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx2rLH1_prog_map_all_min_rna_post_ratio
VHLx2rLH1_prog_map_all_max_rna_post_ratio = max(VHLx2rLH1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx2rLH1_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx2rLH1_cSNV_all_corr_pre_count = length(VHLx2rLH1_cSNV_all_df$corr_pre)
VHLx2rLH1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx2rLH1_cSNV_all_min_corr_pre_counts = min(VHLx2rLH1_cSNV_all_df$corr_pre)
VHLx2rLH1_cSNV_all_min_corr_pre_counts
VHLx2rLH1_cSNV_all_max_corr_pre_counts = max(VHLx2rLH1_cSNV_all_df$corr_pre)
VHLx2rLH1_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLH1_cSNV_all_corr_post_count = length(VHLx2rLH1_cSNV_all_df$corr_post)
VHLx2rLH1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx2rLH1_cSNV_all_min_corr_post_counts = min(VHLx2rLH1_cSNV_all_df$corr_post)
VHLx2rLH1_cSNV_all_min_corr_post_counts
VHLx2rLH1_cSNV_all_max_corr_post_counts = max(VHLx2rLH1_cSNV_all_df$corr_post)
VHLx2rLH1_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx2_p_hdr_snv = paste('p_hdr_',VHLx2_cut_end,'_snv',sep='')
VHLx2rLH1_pSNV_all <- which(VHLx2rLH1[,VHLx2_p_hdr_snv]=='True')
VHLx2rLH1_pSNV_all_df = VHLx2rLH1[VHLx2rLH1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLH1_pSNV_all_lib_count = length(VHLx2rLH1_pSNV_all_df$lib)
VHLx2rLH1_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx2rLH1_pSNV_all_min_lib_counts = min(VHLx2rLH1_pSNV_all_df$lib)
VHLx2rLH1_pSNV_all_min_lib_counts
VHLx2rLH1_pSNV_all_max_lib_counts = max(VHLx2rLH1_pSNV_all_df$lib)
VHLx2rLH1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx2rLH1_pSNV_all_pre_count = length(VHLx2rLH1_pSNV_all_df$pre)
VHLx2rLH1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx2rLH1_pSNV_all_min_pre_counts = min(VHLx2rLH1_pSNV_all_df$pre)
VHLx2rLH1_pSNV_all_min_pre_counts
VHLx2rLH1_pSNV_all_max_pre_counts = max(VHLx2rLH1_pSNV_all_df$pre)
VHLx2rLH1_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLH1_pSNV_all_post_count = length(VHLx2rLH1_pSNV_all_df$post)
VHLx2rLH1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx2rLH1_pSNV_all_min_post_counts = min(VHLx2rLH1_pSNV_all_df$post)
VHLx2rLH1_pSNV_all_min_post_counts
VHLx2rLH1_pSNV_all_max_post_counts = max(VHLx2rLH1_pSNV_all_df$post)
VHLx2rLH1_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLH1_prog_map_thresh5_lib_count = length(VHLx2rLH1_prog_map_thresh5_df$lib)
VHLx2rLH1_prog_map_thresh5_lib_count
VHLx2rLH1_prog_map_thresh5_min_lib_counts = min(VHLx2rLH1_prog_map_thresh5_df$lib)
VHLx2rLH1_prog_map_thresh5_min_lib_counts
VHLx2rLH1_prog_map_thresh5_max_lib_counts = max(VHLx2rLH1_prog_map_thresh5_df$lib)
VHLx2rLH1_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLH1_prog_map_thresh5_pre_count = length(VHLx2rLH1_prog_map_thresh5_df$pre)
VHLx2rLH1_prog_map_thresh5_pre_count
VHLx2rLH1_prog_map_thresh5_min_pre_counts = min(VHLx2rLH1_prog_map_thresh5_df$pre)
VHLx2rLH1_prog_map_thresh5_min_pre_counts
VHLx2rLH1_prog_map_thresh5_max_pre_counts = max(VHLx2rLH1_prog_map_thresh5_df$pre)
VHLx2rLH1_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx2rLH1_prog_map_thresh5_post_count = length(VHLx2rLH1_prog_map_thresh5_df$post)
VHLx2rLH1_prog_map_thresh5_post_count
VHLx2rLH1_prog_map_thresh5_min_post_counts = min(VHLx2rLH1_prog_map_thresh5_df$post)
VHLx2rLH1_prog_map_thresh5_min_post_counts
VHLx2rLH1_prog_map_thresh5_max_post_counts = max(VHLx2rLH1_prog_map_thresh5_df$post)
VHLx2rLH1_prog_map_thresh5_max_post_counts
VHLx2rLH1_prog_map_thresh5_corr_post_count = length(VHLx2rLH1_cSNV_all_df$corr_post)
VHLx2rLH1_prog_map_thresh5_corr_post_count
VHLx2rLH1_prog_map_thresh5_min_corr_post_counts = min(VHLx2rLH1_cSNV_all_df$corr_post)
VHLx2rLH1_prog_map_thresh5_min_corr_post_counts
VHLx2rLH1_prog_map_thresh5_max_corr_post_counts = max(VHLx2rLH1_cSNV_all_df$corr_post)
VHLx2rLH1_prog_map_thresh5_max_corr_post_counts

VHLx2rLH1_pSNV_thresh5 <- which(VHLx2rLH1[,VHLx2_p_hdr_snv]=='True' & as.numeric(as.character(VHLx2rLH1[,'pre_freq']))>=0.00001)
VHLx2rLH1_pSNV_thresh5_df = VHLx2rLH1[VHLx2rLH1_pSNV_thresh5,]
VHLx2rLH1_pSNV_thresh5_lib_count = length(VHLx2rLH1_pSNV_thresh5_df$lib)
VHLx2rLH1_pSNV_thresh5_lib_count
VHLx2rLH1_pSNV_thresh5_min_lib_counts = min(VHLx2rLH1_pSNV_thresh5_df$lib)
VHLx2rLH1_pSNV_thresh5_min_lib_counts
VHLx2rLH1_pSNV_thresh5_max_lib_counts = max(VHLx2rLH1_pSNV_thresh5_df$lib)
VHLx2rLH1_pSNV_thresh5_max_lib_counts
VHLx2rLH1_pSNV_thresh5_pre_count = length(VHLx2rLH1_pSNV_thresh5_df$pre)
VHLx2rLH1_pSNV_thresh5_pre_count
VHLx2rLH1_pSNV_thresh5_min_pre_counts = min(VHLx2rLH1_pSNV_thresh5_df$pre)
VHLx2rLH1_pSNV_thresh5_min_pre_counts
VHLx2rLH1_pSNV_thresh5_max_pre_counts = max(VHLx2rLH1_pSNV_thresh5_df$pre)
VHLx2rLH1_pSNV_thresh5_max_pre_counts
VHLx2rLH1_pSNV_thresh5_post_count = length(VHLx2rLH1_pSNV_thresh5_df$post)
VHLx2rLH1_pSNV_thresh5_post_count
VHLx2rLH1_pSNV_thresh5_min_post_counts = min(VHLx2rLH1_pSNV_thresh5_df$post)
VHLx2rLH1_pSNV_thresh5_min_post_counts
VHLx2rLH1_pSNV_thresh5_max_post_counts = max(VHLx2rLH1_pSNV_thresh5_df$post)
VHLx2rLH1_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx2rLH2_cSNV_all <- which(VHLx2rLH2[,'c_hdr_snv']=='True')
VHLx2rLH2_cSNV_all_df = VHLx2rLH2[VHLx2rLH2_cSNV_all,]
VHLx2rLH2_prog_var_all <- which(VHLx2rLH2[,'all_hdr_variant']=='True' & VHLx2rLH2[,'edit_string']!='-WT')
VHLx2rLH2_prog_var_all_df = VHLx2rLH2[VHLx2rLH2_prog_var_all,]
VHLx2rLH2_prog_map_all = which(VHLx2rLH2_prog_var_all_df[,'pos']!='REF')
VHLx2rLH2_prog_map_all_df = VHLx2rLH2_prog_var_all_df[VHLx2rLH2_prog_map_all,]
VHLx2rLH2_prog_map_exon_all = which(VHLx2rLH2_prog_map_all_df[,'cDNApos']!='REF' & VHLx2rLH2_prog_map_all_df[,'cDNApos']!='NA')
VHLx2rLH2_prog_map_exon_all_df = VHLx2rLH2_prog_map_all_df[VHLx2rLH2_prog_map_exon_all,]
VHLx2rLH2_prog_map_CADD = which(VHLx2rLH2_prog_map_all_df[,'CADD.phred']!='NA')
VHLx2rLH2_prog_map_CADD_df = VHLx2rLH2_prog_map_all_df[VHLx2rLH2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx2rLH2_prog_var_thresh5 <- which(as.numeric(as.character(VHLx2rLH2_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx2rLH2_prog_var_thresh5_df = VHLx2rLH2_prog_var_all_df[VHLx2rLH2_prog_var_thresh5,]
VHLx2rLH2_prog_map_thresh5 <- which(as.numeric(as.character(VHLx2rLH2_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx2rLH2_prog_map_thresh5_df = VHLx2rLH2_prog_map_all_df[VHLx2rLH2_prog_map_thresh5,]
VHLx2rLH2_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx2rLH2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx2rLH2_prog_map_exon_thresh5_df = VHLx2rLH2_prog_map_exon_all_df[VHLx2rLH2_prog_map_exon_thresh5,]
VHLx2rLH2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx2rLH2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx2rLH2_prog_map_CADD_thresh5_df = VHLx2rLH2_prog_map_CADD_df[VHLx2rLH2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx2rLH2_prog_var_all_lib_count = length(VHLx2rLH2_prog_var_all_df$lib)
VHLx2rLH2_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx2rLH2_prog_var_all_min_lib_counts = min(VHLx2rLH2_prog_var_all_df$lib)
VHLx2rLH2_prog_var_all_min_lib_counts
VHLx2rLH2_prog_var_all_max_lib_counts = max(VHLx2rLH2_prog_var_all_df$lib)
VHLx2rLH2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx2rLH2_prog_map_all_lib_count = length(VHLx2rLH2_prog_map_all_df$lib)
VHLx2rLH2_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx2rLH2_prog_map_all_min_lib_counts = min(VHLx2rLH2_prog_map_all_df$lib)
VHLx2rLH2_prog_map_all_min_lib_counts
VHLx2rLH2_prog_map_all_max_lib_counts = max(VHLx2rLH2_prog_map_all_df$lib)
VHLx2rLH2_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx2rLH2_prog_var_all_pre_count = length(VHLx2rLH2_prog_var_all_df$pre)
VHLx2rLH2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx2rLH2_prog_var_all_min_pre_counts = min(VHLx2rLH2_prog_var_all_df$pre)
VHLx2rLH2_prog_var_all_min_pre_counts
VHLx2rLH2_prog_var_all_max_pre_counts = max(VHLx2rLH2_prog_var_all_df$pre)
VHLx2rLH2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx2rLH2_prog_map_all_pre_count = length(VHLx2rLH2_prog_map_all_df$pre)
VHLx2rLH2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx2rLH2_prog_map_all_min_pre_counts = min(VHLx2rLH2_prog_map_all_df$pre)
VHLx2rLH2_prog_map_all_min_pre_counts
VHLx2rLH2_prog_map_all_max_pre_counts = max(VHLx2rLH2_prog_map_all_df$pre)
VHLx2rLH2_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx2rLH2_prog_map_all_post_count = length(VHLx2rLH2_prog_map_all_df$post)
VHLx2rLH2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx2rLH2_prog_map_all_min_post_counts = min(VHLx2rLH2_prog_map_all_df$post)
VHLx2rLH2_prog_map_all_min_post_counts
VHLx2rLH2_prog_map_all_max_post_counts = max(VHLx2rLH2_prog_map_all_df$post)
VHLx2rLH2_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx2rLH2_prog_map_all_syn_df <- VHLx2rLH2_prog_map_all_df[which(VHLx2rLH2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx2rLH2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx2rLH2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx2rLH2_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx2rLH2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx2rLH2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx2rLH2_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx2rLH2_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx2rLH2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx2rLH2_prog_map_all_min_rna_counts = min(VHLx2rLH2_prog_map_exon_all_df$tHDR_rna)
VHLx2rLH2_prog_map_all_min_rna_counts
VHLx2rLH2_prog_map_all_max_rna_counts = max(VHLx2rLH2_prog_map_exon_all_df$tHDR_rna)
VHLx2rLH2_prog_map_all_max_rna_counts
VHLx2rLH2_prog_map_all_min_rna_pseudo_freq = min(VHLx2rLH2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx2rLH2_prog_map_all_min_rna_pseudo_freq
VHLx2rLH2_prog_map_all_max_rna_pseudo_freq = max(VHLx2rLH2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx2rLH2_prog_map_all_max_rna_pseudo_freq
VHLx2rLH2_prog_map_all_min_rna_pre_ratio = min(VHLx2rLH2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx2rLH2_prog_map_all_min_rna_pre_ratio
VHLx2rLH2_prog_map_all_max_rna_pre_ratio = max(VHLx2rLH2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx2rLH2_prog_map_all_max_rna_pre_ratio
VHLx2rLH2_prog_map_all_min_rna_post_ratio = min(VHLx2rLH2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx2rLH2_prog_map_all_min_rna_post_ratio
VHLx2rLH2_prog_map_all_max_rna_post_ratio = max(VHLx2rLH2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx2rLH2_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx2rLH2_cSNV_all_corr_pre_count = length(VHLx2rLH2_cSNV_all_df$corr_pre)
VHLx2rLH2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx2rLH2_cSNV_all_min_corr_pre_counts = min(VHLx2rLH2_cSNV_all_df$corr_pre)
VHLx2rLH2_cSNV_all_min_corr_pre_counts
VHLx2rLH2_cSNV_all_max_corr_pre_counts = max(VHLx2rLH2_cSNV_all_df$corr_pre)
VHLx2rLH2_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLH2_cSNV_all_corr_post_count = length(VHLx2rLH2_cSNV_all_df$corr_post)
VHLx2rLH2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx2rLH2_cSNV_all_min_corr_post_counts = min(VHLx2rLH2_cSNV_all_df$corr_post)
VHLx2rLH2_cSNV_all_min_corr_post_counts
VHLx2rLH2_cSNV_all_max_corr_post_counts = max(VHLx2rLH2_cSNV_all_df$corr_post)
VHLx2rLH2_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx2_p_hdr_snv = paste('p_hdr_',VHLx2_cut_end,'_snv',sep='')
VHLx2rLH2_pSNV_all <- which(VHLx2rLH2[,VHLx2_p_hdr_snv]=='True')
VHLx2rLH2_pSNV_all_df = VHLx2rLH2[VHLx2rLH2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLH2_pSNV_all_lib_count = length(VHLx2rLH2_pSNV_all_df$lib)
VHLx2rLH2_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx2rLH2_pSNV_all_min_lib_counts = min(VHLx2rLH2_pSNV_all_df$lib)
VHLx2rLH2_pSNV_all_min_lib_counts
VHLx2rLH2_pSNV_all_max_lib_counts = max(VHLx2rLH2_pSNV_all_df$lib)
VHLx2rLH2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx2rLH2_pSNV_all_pre_count = length(VHLx2rLH2_pSNV_all_df$pre)
VHLx2rLH2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx2rLH2_pSNV_all_min_pre_counts = min(VHLx2rLH2_pSNV_all_df$pre)
VHLx2rLH2_pSNV_all_min_pre_counts
VHLx2rLH2_pSNV_all_max_pre_counts = max(VHLx2rLH2_pSNV_all_df$pre)
VHLx2rLH2_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLH2_pSNV_all_post_count = length(VHLx2rLH2_pSNV_all_df$post)
VHLx2rLH2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx2rLH2_pSNV_all_min_post_counts = min(VHLx2rLH2_pSNV_all_df$post)
VHLx2rLH2_pSNV_all_min_post_counts
VHLx2rLH2_pSNV_all_max_post_counts = max(VHLx2rLH2_pSNV_all_df$post)
VHLx2rLH2_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLH2_prog_map_thresh5_lib_count = length(VHLx2rLH2_prog_map_thresh5_df$lib)
VHLx2rLH2_prog_map_thresh5_lib_count
VHLx2rLH2_prog_map_thresh5_min_lib_counts = min(VHLx2rLH2_prog_map_thresh5_df$lib)
VHLx2rLH2_prog_map_thresh5_min_lib_counts
VHLx2rLH2_prog_map_thresh5_max_lib_counts = max(VHLx2rLH2_prog_map_thresh5_df$lib)
VHLx2rLH2_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx2 less than SGE region length x 3 due to PAM edits
VHLx2rLH2_prog_map_thresh5_pre_count = length(VHLx2rLH2_prog_map_thresh5_df$pre)
VHLx2rLH2_prog_map_thresh5_pre_count
VHLx2rLH2_prog_map_thresh5_min_pre_counts = min(VHLx2rLH2_prog_map_thresh5_df$pre)
VHLx2rLH2_prog_map_thresh5_min_pre_counts
VHLx2rLH2_prog_map_thresh5_max_pre_counts = max(VHLx2rLH2_prog_map_thresh5_df$pre)
VHLx2rLH2_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx2rLH2_prog_map_thresh5_post_count = length(VHLx2rLH2_prog_map_thresh5_df$post)
VHLx2rLH2_prog_map_thresh5_post_count
VHLx2rLH2_prog_map_thresh5_min_post_counts = min(VHLx2rLH2_prog_map_thresh5_df$post)
VHLx2rLH2_prog_map_thresh5_min_post_counts
VHLx2rLH2_prog_map_thresh5_max_post_counts = max(VHLx2rLH2_prog_map_thresh5_df$post)
VHLx2rLH2_prog_map_thresh5_max_post_counts
VHLx2rLH2_prog_map_thresh5_corr_post_count = length(VHLx2rLH2_cSNV_all_df$corr_post)
VHLx2rLH2_prog_map_thresh5_corr_post_count
VHLx2rLH2_prog_map_thresh5_min_corr_post_counts = min(VHLx2rLH2_cSNV_all_df$corr_post)
VHLx2rLH2_prog_map_thresh5_min_corr_post_counts
VHLx2rLH2_prog_map_thresh5_max_corr_post_counts = max(VHLx2rLH2_cSNV_all_df$corr_post)
VHLx2rLH2_prog_map_thresh5_max_corr_post_counts

VHLx2rLH2_pSNV_thresh5 <- which(VHLx2rLH2[,VHLx2_p_hdr_snv]=='True' & as.numeric(as.character(VHLx2rLH2[,'pre_freq']))>=0.00001)
VHLx2rLH2_pSNV_thresh5_df = VHLx2rLH2[VHLx2rLH2_pSNV_thresh5,]
VHLx2rLH2_pSNV_thresh5_lib_count = length(VHLx2rLH2_pSNV_thresh5_df$lib)
VHLx2rLH2_pSNV_thresh5_lib_count
VHLx2rLH2_pSNV_thresh5_min_lib_counts = min(VHLx2rLH2_pSNV_thresh5_df$lib)
VHLx2rLH2_pSNV_thresh5_min_lib_counts
VHLx2rLH2_pSNV_thresh5_max_lib_counts = max(VHLx2rLH2_pSNV_thresh5_df$lib)
VHLx2rLH2_pSNV_thresh5_max_lib_counts
VHLx2rLH2_pSNV_thresh5_pre_count = length(VHLx2rLH2_pSNV_thresh5_df$pre)
VHLx2rLH2_pSNV_thresh5_pre_count
VHLx2rLH2_pSNV_thresh5_min_pre_counts = min(VHLx2rLH2_pSNV_thresh5_df$pre)
VHLx2rLH2_pSNV_thresh5_min_pre_counts
VHLx2rLH2_pSNV_thresh5_max_pre_counts = max(VHLx2rLH2_pSNV_thresh5_df$pre)
VHLx2rLH2_pSNV_thresh5_max_pre_counts
VHLx2rLH2_pSNV_thresh5_post_count = length(VHLx2rLH2_pSNV_thresh5_df$post)
VHLx2rLH2_pSNV_thresh5_post_count
VHLx2rLH2_pSNV_thresh5_min_post_counts = min(VHLx2rLH2_pSNV_thresh5_df$post)
VHLx2rLH2_pSNV_thresh5_min_post_counts
VHLx2rLH2_pSNV_thresh5_max_post_counts = max(VHLx2rLH2_pSNV_thresh5_df$post)
VHLx2rLH2_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx2rLH1_prog_var_thresh5_df:
VHLx2rLH1_prog_var_thresh5_df_rLH2_int <- VHLx2rLH1_prog_var_thresh5_df[which(VHLx2rLH1_prog_var_thresh5_df$variant %in% VHLx2rLH2_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx2rLH2_prog_var_thresh5_df:
VHLx2rLH2_prog_var_thresh5_df_rLH1_int <- VHLx2rLH2_prog_var_thresh5_df[which(VHLx2rLH2_prog_var_thresh5_df$variant %in% VHLx2rLH1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int[order(VHLx2rLH1_prog_var_thresh5_df_rLH2_int$variant),]
VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int[order(VHLx2rLH2_prog_var_thresh5_df_rLH1_int$variant),]
dim(VHLx2rLH1_prog_var_thresh5_df)[1] #Number of prog_vars in rLH1
VHLx2rLH1rLH2int_prog_var_thresh5_pre_count <- dim(VHLx2rLH1_prog_var_thresh5_df_rLH2_int)[1] 
VHLx2rLH1rLH2int_prog_var_thresh5_pre_count #Number of prog_vars in rLH1 also in rLH2
dim(VHLx2rLH2_prog_var_thresh5_df)[1] #Number of prog_vars in rLH2
dim(VHLx2rLH2_prog_var_thresh5_df_rLH1_int)[1] #Number of prog_vars in rLH2 also in rLH1

#Add the following columns from the from rLH2 df to the rLH1 df:
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$pre
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_lib <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$lib
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$rna
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2 <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post2
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post3 <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post3
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2 <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$rna2
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$pre_pseudo
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pseudo <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post_pseudo
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna_pseudo <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$rna_pseudo
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_pseudo <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post2_pseudo
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post3_pseudo <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post3_pseudo
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2_pseudo <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$rna2_pseudo
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$pre_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$rna_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post2_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post3_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post3_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$rna2_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$pre_pseudo_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pseudo_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post_pseudo_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna_pseudo_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$rna_pseudo_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_pseudo_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post2_pseudo_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post3_pseudo_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post3_pseudo_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2_pseudo_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$rna2_pseudo_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_lib_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$pre_lib_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pre_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post_pre_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_lib_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post_lib_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna_pre_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$rna_pre_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna_post_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$rna_post_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_pre_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post2_pre_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post3_pre_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post3_pre_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2_post_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$rna2_post_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_snv_error_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$pre_snv_error_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_snv_error_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$post_snv_error_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_exp_snv_error_reads_pre <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$exp_snv_error_reads_pre
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_exp_snv_error_reads_post <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$exp_snv_error_reads_post
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_corr_pre <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$corr_pre
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_corr_post <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$corr_post
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_corr_pre_pseudo <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$corr_pre_pseudo
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_corr_post_pseudo <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$corr_post_pseudo
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_corr_pseudo_post_pre_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$corr_pseudo_post_pre_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_pre
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_lib <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_lib
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_rna
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post2 <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post2
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post3 <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post3
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna2 <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_rna2
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_pseudo_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_pre_pseudo_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_pseudo_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post_pseudo_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_pseudo_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_rna_pseudo_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post2_pseudo_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post2_pseudo_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post3_pseudo_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post3_pseudo_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna2_pseudo_freq <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_rna2_pseudo_freq
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_lib_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_pre_lib_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_pre_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post_pre_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_lib_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post_lib_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_pre_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_rna_pre_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_post_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_rna_post_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post2_pre_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post2_pre_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post3_pre_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post3_pre_ratio
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna2_post_ratio <- VHLx2rLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio_rLH1rLH2_mean <- 2^((log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio) + log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_lib_ratio))/2)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_mean <- 2^((log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio) + log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pre_ratio))/2)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio_rLH1rLH2_mean <- 2^((log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio) + log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_lib_ratio))/2)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post2_pre_ratio_rLH1rLH2_mean <- 2^((log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post2_pre_ratio) + log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_pre_ratio))/2)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post3_pre_ratio_rLH1rLH2_mean <- 2^((log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post3_pre_ratio) + log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post3_pre_ratio))/2)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rna2_post_ratio_rLH1rLH2_mean <- 2^((log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rna2_post_ratio) + log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2_post_ratio))/2)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio_rLH1rLH2_mean <- 2^((log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio) + log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_lib_ratio))/2)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_mean <- 2^((log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio) + log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_pre_ratio))/2)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio_rLH1rLH2_mean <- 2^((log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio) + log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_lib_ratio))/2)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio_rLH1rLH2_mean <- 2^((log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio) + log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_pre_ratio))/2)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio_rLH1rLH2_mean <- 2^((log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio) + log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_post_ratio))/2)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post2_pre_ratio_rLH1rLH2_mean <- 2^((log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post2_pre_ratio) + log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post2_pre_ratio))/2)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post3_pre_ratio_rLH1rLH2_mean <- 2^((log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post3_pre_ratio) + log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post3_pre_ratio))/2)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio_rLH1rLH2_mean <- 2^((log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio) + log2(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio_rLH1rLH2_pre_weighted <- ((VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq*VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq/(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq+VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq))+(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq*VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq/(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq+VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq)))/VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$lib_pseudo_freq
#rLH1 pre-freq weighting coefficient (rLH1_pre-freq / (rLH1 + rLH2 pre-freq's))
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_weight <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq/(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq+VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_weight <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq/(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq+VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq)
#this will be weighted by denominator:  (rLH1_pof/rLH1_prf)(rLH1_prwc)+(rLH2_pof/rLH2_prf)*(rLH2_prwc)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_pre_weighted <- (VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_pseudo_freq/VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq)*(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_weight)+(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pseudo_freq/VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq)*(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_weight)
#this will be weighted by denominator:  (rLH1_pof/lif')*(rLH1_prwc)+(rLH2_pof/lif)*(rLH2_prwc)
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio_rLH1rLH2_pre_weighted <- (VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_pseudo_freq/VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$lib_pseudo_freq)*(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_weight)+(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pseudo_freq/VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$lib_pseudo_freq)*(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_weight)
#rLH1 tHDR_pre-freq weighting coefficient (rLH1_tHDR_pre-freq / (rLH1 + rLH2 pre-freq's))
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_weight <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_pseudo_freq/(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_pseudo_freq+VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_pseudo_freq)
#rLH2 tHDR_pre-freq weighting coefficient
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_weight <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_pseudo_freq/(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_pseudo_freq+VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rLH1_pof/rLH1_prf)(rLH1_prwc)+(rLH2_pof/rLH2_prf)*(rLH2_prwc)
#tHDR_post_pre_ratio_rLH1rLH2_pre_weighted
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_pre_weighted <- (VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pseudo_freq/VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_pseudo_freq)*(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_weight)+(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_pseudo_freq/VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_pseudo_freq)*(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq)) >= 10) {
    VHLx2rLH1_cSNV_pre_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx2rLH1_cSNV_post_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx2rLH1_cSNV_post2_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx2rLH1_cSNV_post_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx2rLH1_tSNV_pre_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx2rLH1_tSNV_post_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx2rLH1_tSNV_post_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx2rLH1_tSNV_rna_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx2rLH1_tSNV_rna_post_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx2rLH1_tSNV_rna2_post_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx2rLH2_cSNV_pre_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_pre_lib_ratio)
VHLx2rLH2_cSNV_post_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_post_pre_ratio)
VHLx2rLH2_cSNV_post2_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_post2_pre_ratio)

VHLx2rLH2_cSNV_post_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_post_lib_ratio)
VHLx2rLH2_tSNV_pre_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_tHDR_pre_lib_ratio)
VHLx2rLH2_tSNV_post_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_tHDR_post_pre_ratio)
VHLx2rLH2_tSNV_post2_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_tHDR_post2_pre_ratio)
VHLx2rLH2_tSNV_post_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_tHDR_post_lib_ratio)
VHLx2rLH2_tSNV_rna_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_tHDR_rna_pre_ratio)
VHLx2rLH2_tSNV_rna_post_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_tHDR_rna_post_ratio)
VHLx2rLH2_tSNV_rna2_post_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_tHDR_rna2_post_ratio)
VHLx2rLH1rLH2a_cSNV_pre_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_cSNV_post_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_cSNV_post2_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_cSNV_post_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_tSNV_pre_lib_med <- 
  median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_tSNV_post_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_tSNV_post2_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_tSNV_post_lib_med <-
  median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_tSNV_rna_pre_med <-
  median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_tSNV_rna_post_med <-
  median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_tSNV_rna2_post_med <-
  median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2pw_tSNV_post_pre_med  <-
  median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLH1rLH2_pre_weighted)
VHLx2rLH1rLH2pw_cSNV_post_pre_med  <-
  median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLH1rLH2_pre_weighted)
  } else {
  VHLx2rLH1_cSNV_pre_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio)
VHLx2rLH1_cSNV_post_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio)
VHLx2rLH1_cSNV_post2_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post2_pre_ratio)
VHLx2rLH1_cSNV_post_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio)
VHLx2rLH1_tSNV_pre_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio)
VHLx2rLH1_tSNV_post_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio)
VHLx2rLH1_tSNV_post_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio)
VHLx2rLH1_tSNV_rna_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio)
VHLx2rLH1_tSNV_rna_post_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio)
VHLx2rLH1_tSNV_rna2_post_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio)
VHLx2rLH2_cSNV_pre_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_lib_ratio)
VHLx2rLH2_cSNV_post_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pre_ratio)
VHLx2rLH2_cSNV_post2_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_pre_ratio)

VHLx2rLH2_cSNV_post_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_lib_ratio)
VHLx2rLH2_tSNV_pre_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_lib_ratio)
VHLx2rLH2_tSNV_post_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_pre_ratio)
VHLx2rLH2_tSNV_post2_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post2_pre_ratio)
VHLx2rLH2_tSNV_post_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_lib_ratio)
VHLx2rLH2_tSNV_rna_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_pre_ratio)
VHLx2rLH2_tSNV_rna_post_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_post_ratio)
VHLx2rLH2_tSNV_rna2_post_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna2_post_ratio)
VHLx2rLH1rLH2a_cSNV_pre_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_cSNV_post_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_cSNV_post2_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post2_pre_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_cSNV_post_lib_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_tSNV_pre_lib_med <- 
  median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_tSNV_post_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_tSNV_post2_pre_med <- median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post2_pre_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_tSNV_post_lib_med <-
  median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_tSNV_rna_pre_med <-
  median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_tSNV_rna_post_med <-
  median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2a_tSNV_rna2_post_med <-
  median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio_rLH1rLH2_mean)
VHLx2rLH1rLH2pw_tSNV_post_pre_med  <-
  median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_pre_weighted)
VHLx2rLH1rLH2pw_cSNV_post_pre_med  <-
  median(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_pre_weighted)
}

VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio/VHLx2rLH1_cSNV_pre_lib_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio/VHLx2rLH1_cSNV_post_pre_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio/VHLx2rLH1_cSNV_post_lib_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post2_pre_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post2_pre_ratio/VHLx2rLH1_cSNV_post2_pre_med

VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio/VHLx2rLH1_tSNV_pre_lib_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio/VHLx2rLH1_tSNV_post_pre_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio/VHLx2rLH1_tSNV_post_lib_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio/VHLx2rLH1_tSNV_rna_pre_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio/VHLx2rLH1_tSNV_rna_post_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post2_pre_ratio/VHLx2rLH2_tSNV_post2_pre_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio/VHLx2rLH1_tSNV_rna2_post_med

VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_lib_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_lib_ratio/VHLx2rLH2_cSNV_pre_lib_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pre_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pre_ratio/VHLx2rLH2_cSNV_post_pre_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_lib_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_lib_ratio/VHLx2rLH2_cSNV_post_lib_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_pre_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_pre_ratio/VHLx2rLH1rLH2a_cSNV_post2_pre_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2_post_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2_post_ratio/VHLx2rLH2_tSNV_rna2_post_med


VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_lib_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_lib_ratio/VHLx2rLH2_tSNV_pre_lib_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_pre_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_pre_ratio/VHLx2rLH2_tSNV_post_pre_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post2_pre_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post2_pre_ratio/VHLx2rLH2_tSNV_post2_pre_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_lib_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_lib_ratio/VHLx2rLH2_tSNV_post_lib_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_pre_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_pre_ratio/VHLx2rLH2_tSNV_rna_pre_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_post_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_post_ratio/VHLx2rLH2_tSNV_rna_post_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna2_post_ratio_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna2_post_ratio/VHLx2rLH2_tSNV_rna2_post_med

###normalize the means
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio_rLH1rLH2_mean_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio_rLH1rLH2_mean/VHLx2rLH1rLH2a_cSNV_pre_lib_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_mean_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_mean/VHLx2rLH1rLH2a_cSNV_post_pre_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio_rLH1rLH2_mean_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio_rLH1rLH2_mean/VHLx2rLH1rLH2a_cSNV_post_lib_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio_rLH1rLH2_mean_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio_rLH1rLH2_mean/VHLx2rLH1rLH2a_tSNV_pre_lib_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_mean_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_mean/VHLx2rLH1rLH2a_tSNV_post_pre_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post2_pre_ratio_rLH1rLH2_mean_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post2_pre_ratio_rLH1rLH2_mean/VHLx2rLH1rLH2a_tSNV_post2_pre_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio_rLH1rLH2_mean_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio_rLH1rLH2_mean/VHLx2rLH1rLH2a_tSNV_post_lib_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio_rLH1rLH2_mean_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio_rLH1rLH2_mean/VHLx2rLH1rLH2a_tSNV_rna_pre_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio_rLH1rLH2_mean_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio_rLH1rLH2_mean/VHLx2rLH1rLH2a_tSNV_rna_post_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio_rLH1rLH2_mean_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio_rLH1rLH2_mean/VHLx2rLH1rLH2a_tSNV_rna2_post_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_pre_weighted_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_pre_weighted/VHLx2rLH1rLH2pw_tSNV_post_pre_med
VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_pre_weighted_synnorm <- VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_pre_weighted/VHLx2rLH1rLH2pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord
VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord = which(VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[,'pos']!='REF')
VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df = VHLx2rLH1_prog_var_thresh5_df_rLH2_int_ord[VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord,]
VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord = which(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df[,'cDNApos']!='REF' & VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df[,'cDNApos']!='NA')
VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df = VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df[VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord,]
VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord = which(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df[,'CADD.phred']!='NA')
VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df = VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df[VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord,]
VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense <- VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df[which(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx2rLH1rLH2_cSNV_rLH1_post_pre_by_rLH2_post_pre_cor_s <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_pre_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_cSNV_rLH1_post_pre_by_rLH2_post_pre_cor_s
VHLx2rLH1rLH2_cSNV_rLH1_post_pre_by_rLH2_post_pre_cor_p <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_pre_ratio_synnorm),method='pearson')
VHLx2rLH1rLH2_cSNV_rLH1_post_pre_by_rLH2_post_pre_cor_p
VHLx2rLH1rLH2_cSNV_rLH1_post_lib_by_rLH2_post_lib_cor_s <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_lib_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_cSNV_rLH1_post_lib_by_rLH2_post_lib_cor_s
VHLx2rLH1rLH2_cSNV_rLH1_post_lib_by_rLH2_post_lib_cor_p <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_lib_ratio_synnorm),method='pearson')
VHLx2rLH1rLH2_cSNV_rLH1_post_lib_by_rLH2_post_lib_cor_p
VHLx2rLH1rLH2_cSNV_rLH1_post2_pre_by_rLH2_post2_pre_cor_s <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post2_pre_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_cSNV_rLH1_post2_pre_by_rLH2_post2_pre_cor_s
VHLx2rLH1rLH2_cSNV_rLH1_post2_pre_by_rLH2_post2_pre_cor_p <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post2_pre_ratio_synnorm),method='pearson')
VHLx2rLH1rLH2_cSNV_rLH1_post2_pre_by_rLH2_post2_pre_cor_p
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_post_pre_by_rLH2_tHDR_post_pre_cor_s <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_post_pre_by_rLH2_tHDR_post_pre_cor_s
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_post_pre_by_rLH2_tHDR_post_pre_cor_p <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_post_pre_by_rLH2_tHDR_post_pre_cor_p
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_post_lib_by_rLH2_tHDR_post_lib_cor_s <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_post_lib_by_rLH2_tHDR_post_lib_cor_s
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_post_lib_by_rLH2_tHDR_post_lib_cor_p <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_post_lib_by_rLH2_tHDR_post_lib_cor_p
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_rna_pre_by_rLH2_tHDR_rna_pre_cor_s <- cor(log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_rna_pre_by_rLH2_tHDR_rna_pre_cor_s
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_rna_pre_by_rLH2_tHDR_rna_pre_cor_p <- cor(log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_rna_pre_by_rLH2_tHDR_rna_pre_cor_p
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_rna2_post_by_rLH2_tHDR_rna2_post_cor_s <- cor(log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_rna2_post_by_rLH2_tHDR_rna2_post_cor_s
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_rna2_post_by_rLH2_tHDR_rna2_post_cor_p <- cor(log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx2rLH1rLH2_tSNV_rLH1_tHDR_rna2_post_by_rLH2_tHDR_rna2_post_cor_p
VHLx2rLH1rLH2_cSNV_rLH1_post_by_rLH2_post_cor_s <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_freq),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_freq),method='spearman')
VHLx2rLH1rLH2_cSNV_rLH1_post_by_rLH2_post_cor_s
VHLx2rLH1rLH2_cSNV_rLH1_post_by_rLH2_post_cor_p <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_pseudo_freq),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_pseudo_freq),method='pearson')
VHLx2rLH1rLH2_cSNV_rLH1_post_by_rLH2_post_cor_p
VHLx2rLH1rLH2_cSNV_rLH1_pre_lib_by_rLH2_pre_lib_cor_s <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_pre_lib_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_cSNV_rLH1_pre_lib_by_rLH2_pre_lib_cor_s
VHLx2rLH1rLH2_cSNV_rLH1_pre_lib_by_rLH2_pre_lib_cor_p <-cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_pre_lib_ratio_synnorm),method='pearson')
VHLx2rLH1rLH2_cSNV_rLH1_pre_lib_by_rLH2_pre_lib_cor_p
VHLx2rLH1rLH2_tSNV_rLH1_post2_pre_by_rLH2_post2_pre_cor_s <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_tSNV_rLH1_post2_pre_by_rLH2_post2_pre_cor_s
VHLx2rLH1rLH2_tSNV_rLH1_post_lib_by_rLH2_post_lib_cor_s <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_tSNV_rLH1_post_lib_by_rLH2_post_lib_cor_s
VHLx2rLH1rLH2_tSNV_rLH1_post_pre_by_rLH2_post_pre_cor_s <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_tSNV_rLH1_post_pre_by_rLH2_post_pre_cor_s
VHLx2rLH1rLH2_tSNV_rLH1_rna_pre_by_rLH2_rna_pre_cor_s <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_tSNV_rLH1_rna_pre_by_rLH2_rna_pre_cor_s
VHLx2rLH1rLH2_tSNV_rLH1_rna2_post_by_rLH2_rna2_post_cor_s <- cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_tSNV_rLH1_rna2_post_by_rLH2_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx2rLH1_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1_cSNV_post_pre_by_cadd_cor_s
VHLx2rLH2_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$rLH2_post_pre_ratio_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH2_cSNV_post_pre_by_cadd_cor_s
VHLx2rLH1_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1_cSNV_post_lib_by_cadd_cor_s
VHLx2rLH2_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$rLH2_post_lib_ratio_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH2_cSNV_post_lib_by_cadd_cor_s
VHLx2rLH1_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1_tSNV_post_pre_by_cadd_cor_s
VHLx2rLH2_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH2_tSNV_post_pre_by_cadd_cor_s
VHLx2rLH1_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1_tSNV_post_lib_by_cadd_cor_s
VHLx2rLH2_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx2rLH1rLH2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$pre_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2a_cSNV_pre_lib_by_cadd_cor_s
VHLx2rLH1rLH2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$pre_lib_ratio_rLH1rLH2_pre_weighted),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2w_cSNV_pre_lib_by_cadd_cor_s
VHLx2rLH1rLH2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2a_cSNV_post_pre_by_cadd_cor_s
VHLx2rLH1rLH2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_pre_ratio_rLH1rLH2_pre_weighted_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2w_cSNV_post_pre_by_cadd_cor_s
VHLx2rLH1rLH2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2a_cSNV_post_lib_by_cadd_cor_s
VHLx2rLH1rLH2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_lib_ratio_rLH1rLH2_pre_weighted),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2w_cSNV_post_lib_by_cadd_cor_s
VHLx2rLH1rLH2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_pre_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2a_tSNV_pre_lib_by_cadd_cor_s
VHLx2rLH1rLH2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2a_tSNV_post_pre_by_cadd_cor_s
VHLx2rLH1rLH2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_rLH1rLH2_pre_weighted_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2w_tSNV_post_pre_by_cadd_cor_s
VHLx2rLH1rLH2a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post2_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2a_tSNV_post2_pre_by_cadd_cor_s
VHLx2rLH1rLH2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx2rLH1_cSNV_pre_lib_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx2rLH1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx2rLH1_tSNV_pre_lib_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rLH1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rLH1_cSNV_post_lib_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx2rLH1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx2rLH1_tSNV_post_lib_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rLH1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx2rLH1_cSNV_post_pre_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx2rLH1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx2rLH1_tSNV_post_pre_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx2rLH1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rLH1_cSNV_rna_lib_cors = cor(log2(VHLx2rLH1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx2rLH1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx2rLH1_tSNV_rna_lib_cors = cor(log2(VHLx2rLH1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rLH1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx2rLH1_cSNV_rna_pre_cors = cor(log2(VHLx2rLH1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx2rLH1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx2rLH1_tSNV_rna_pre_cors = cor(log2(VHLx2rLH1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx2rLH1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rLH1rLH2_cSNV_pre_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$pre_freq),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_pre_freq),method='spearman')
VHLx2rLH1rLH2_tSNV_pre_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_pre_pseudo_freq),method='spearman')
VHLx2rLH1rLH2_cSNV_pre_lib_ratio_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$pre_lib_ratio),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_pre_lib_ratio),method='spearman')
VHLx2rLH1rLH2_tSNV_pre_lib_ratio_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_pre_lib_ratio),method='spearman')
VHLx2rLH1rLH2_cSNV_post_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_freq),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_freq),method='spearman')
VHLx2rLH1rLH2_tSNV_post_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_pseudo_freq),method='spearman')
VHLx2rLH1rLH2_cSNV_post_lib_ratio_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_lib_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_tSNV_post_lib_ratio_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_cSNV_post_pre_ratio_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_pre_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_tSNV_post_pre_ratio_cors = cor(log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_cSNV_rna_cors = cor(log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rna_freq),log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_rna_freq),method='spearman')
VHLx2rLH1rLH2_tSNV_rna_cors = cor(log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna_pseudo_freq),method='spearman')
VHLx2rLH1rLH2_tSNV_rna_pre_ratio_cors = cor(log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx2rLH1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLH1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLH1_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLH1_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLH1_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLH1_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLH1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rLH1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rLH1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rLH1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rLH1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$Grantham)),method='spearman')
VHLx2rLH1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$Grantham)),method='spearman')
VHLx2rLH1rLH2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$pre_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_pre_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rLH1rLH2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$tHDR_post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rLH1rLH2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rLH1rLH2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$tHDR_post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rLH1rLH2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$Grantham)),method='spearman')
VHLx2rLH1rLH2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$tHDR_post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$Grantham)),method='spearman')
VHLx2rLH1rLH2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$pre_lib_ratio_rLH1rLH2_pre_weighted),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_lib_ratio_rLH1rLH2_pre_weighted),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_pre_ratio_rLH1rLH2_pre_weighted_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx2rLH1rLH2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_rLH1rLH2_pre_weighted_synnorm),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')

VHLx2rLH1_cors <- c("VHLx2rLH1",VHLx2rLH1_cSNV_pre_lib_cors,VHLx2rLH1_tSNV_pre_lib_cors,VHLx2rLH1_cSNV_post_lib_cors,VHLx2rLH1_tSNV_post_lib_cors,VHLx2rLH1_cSNV_post_pre_cors,VHLx2rLH1_tSNV_post_pre_cors,VHLx2rLH1_cSNV_rna_lib_cors,VHLx2rLH1_tSNV_rna_lib_cors,VHLx2rLH1_cSNV_rna_pre_cors,VHLx2rLH1_tSNV_rna_pre_cors,VHLx2rLH1rLH2_cSNV_pre_cors,VHLx2rLH1rLH2_tSNV_pre_cors,VHLx2rLH1rLH2_cSNV_pre_lib_ratio_cors,VHLx2rLH1rLH2_tSNV_pre_lib_ratio_cors,VHLx2rLH1rLH2_cSNV_post_cors,VHLx2rLH1rLH2_tSNV_post_cors,VHLx2rLH1rLH2_cSNV_post_lib_ratio_cors,VHLx2rLH1rLH2_tSNV_post_lib_ratio_cors,VHLx2rLH1rLH2_cSNV_post_pre_ratio_cors,VHLx2rLH1rLH2_tSNV_post_pre_ratio_cors,VHLx2rLH1rLH2_cSNV_rna_cors,VHLx2rLH1rLH2_tSNV_rna_cors,VHLx2rLH1rLH2_tSNV_rna_pre_ratio_cors,VHLx2rLH1_cSNV_pre_lib_ratio_cadd_cors,VHLx2rLH1_tSNV_pre_lib_ratio_cadd_cors,VHLx2rLH1_cSNV_post_lib_ratio_cadd_cors,VHLx2rLH1_tSNV_post_lib_ratio_cadd_cors,VHLx2rLH1_cSNV_post_pre_ratio_cadd_cors,VHLx2rLH1_tSNV_post_pre_ratio_cadd_cors,VHLx2rLH1_cSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLH1_tSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLH1_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLH1_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLH1_cSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLH1_tSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLH1rLH2a_cSNV_pre_lib_ratio_cadd_cors,VHLx2rLH1rLH2a_tSNV_pre_lib_ratio_cadd_cors,VHLx2rLH1rLH2a_cSNV_post_lib_ratio_cadd_cors,VHLx2rLH1rLH2a_tSNV_post_lib_ratio_cadd_cors,VHLx2rLH1rLH2a_cSNV_post_pre_ratio_cadd_cors,VHLx2rLH1rLH2a_tSNV_post_pre_ratio_cadd_cors,VHLx2rLH1rLH2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLH1rLH2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLH1rLH2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLH1rLH2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLH1rLH2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLH1rLH2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLH1rLH2w_cSNV_pre_lib_ratio_cadd_cors,VHLx2rLH1rLH2w_cSNV_post_lib_ratio_cadd_cors,VHLx2rLH1rLH2w_cSNV_post_pre_ratio_cadd_cors,VHLx2rLH1rLH2w_tSNV_post_pre_ratio_cadd_cors)

VHLx2rLH2_cSNV_pre_lib_cors = cor(log2(VHLx2rLH2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx2rLH2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx2rLH2_tSNV_pre_lib_cors = cor(log2(VHLx2rLH2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rLH2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rLH2_cSNV_post_lib_cors = cor(log2(VHLx2rLH2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx2rLH2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx2rLH2_tSNV_post_lib_cors = cor(log2(VHLx2rLH2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rLH2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx2rLH2_cSNV_post_pre_cors = cor(log2(VHLx2rLH2_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx2rLH2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx2rLH2_tSNV_post_pre_cors = cor(log2(VHLx2rLH2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx2rLH2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rLH2_cSNV_rna_lib_cors = cor(log2(VHLx2rLH2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx2rLH2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx2rLH2_tSNV_rna_lib_cors = cor(log2(VHLx2rLH2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx2rLH2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx2rLH2_cSNV_rna_pre_cors = cor(log2(VHLx2rLH2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx2rLH2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx2rLH2_tSNV_rna_pre_cors = cor(log2(VHLx2rLH2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx2rLH2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx2rLH2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rLH2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx2rLH2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLH2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx2rLH2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx2rLH2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLH2_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rLH2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx2rLH2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLH2_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx2rLH2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx2rLH2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLH2_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLH2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx2rLH2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLH2_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx2rLH2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLH2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx2rLH2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$rLH2_post_pre_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rLH2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$rLH2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx2rLH2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$rLH2_post_pre_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rLH2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$rLH2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx2rLH2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$rLH2_post_pre_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$Grantham)),method='spearman')
VHLx2rLH2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$rLH2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx2rLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$Grantham)),method='spearman')

VHLx2rLH2_cors <- c("VHLx2rLH2",VHLx2rLH2_cSNV_pre_lib_cors,VHLx2rLH2_tSNV_pre_lib_cors,VHLx2rLH2_cSNV_post_lib_cors,VHLx2rLH2_tSNV_post_lib_cors,VHLx2rLH2_cSNV_post_pre_cors,VHLx2rLH2_tSNV_post_pre_cors,VHLx2rLH2_cSNV_rna_lib_cors,VHLx2rLH2_tSNV_rna_lib_cors,VHLx2rLH2_cSNV_rna_pre_cors,VHLx2rLH2_tSNV_rna_pre_cors,VHLx2rLH1rLH2_cSNV_pre_cors,VHLx2rLH1rLH2_tSNV_pre_cors,VHLx2rLH1rLH2_cSNV_pre_lib_ratio_cors,VHLx2rLH1rLH2_tSNV_pre_lib_ratio_cors,VHLx2rLH1rLH2_cSNV_post_cors,VHLx2rLH1rLH2_tSNV_post_cors,VHLx2rLH1rLH2_cSNV_post_lib_ratio_cors,VHLx2rLH1rLH2_tSNV_post_lib_ratio_cors,VHLx2rLH1rLH2_cSNV_post_pre_ratio_cors,VHLx2rLH1rLH2_tSNV_post_pre_ratio_cors,VHLx2rLH1rLH2_cSNV_rna_cors,VHLx2rLH1rLH2_tSNV_rna_cors,VHLx2rLH1rLH2_tSNV_rna_pre_ratio_cors,VHLx2rLH2_cSNV_pre_lib_ratio_cadd_cors,VHLx2rLH2_tSNV_pre_lib_ratio_cadd_cors,VHLx2rLH2_cSNV_post_lib_ratio_cadd_cors,VHLx2rLH2_tSNV_post_lib_ratio_cadd_cors,VHLx2rLH2_cSNV_post_pre_ratio_cadd_cors,VHLx2rLH2_tSNV_post_pre_ratio_cadd_cors,VHLx2rLH2_cSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLH2_tSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLH2_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLH2_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLH2_cSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLH2_tSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLH1rLH2a_cSNV_pre_lib_ratio_cadd_cors,VHLx2rLH1rLH2a_tSNV_pre_lib_ratio_cadd_cors,VHLx2rLH1rLH2a_cSNV_post_lib_ratio_cadd_cors,VHLx2rLH1rLH2a_tSNV_post_lib_ratio_cadd_cors,VHLx2rLH1rLH2a_cSNV_post_pre_ratio_cadd_cors,VHLx2rLH1rLH2a_tSNV_post_pre_ratio_cadd_cors,VHLx2rLH1rLH2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLH1rLH2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx2rLH1rLH2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLH1rLH2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx2rLH1rLH2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLH1rLH2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx2rLH1rLH2w_cSNV_pre_lib_ratio_cadd_cors,VHLx2rLH1rLH2w_cSNV_post_lib_ratio_cadd_cors,VHLx2rLH1rLH2w_cSNV_post_pre_ratio_cadd_cors,VHLx2rLH1rLH2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx2rLH1)
rm(VHLx2rLH2)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx2rLH1
VHLx2_posrange <- range(as.numeric(as.character(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$pos)))
VHLx2_posseq <- seq(from=VHLx2_posrange[1], to=VHLx2_posrange[2])
VHLx2rLH1_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df, subset = which(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx2rLH1_tHDR_pre_lib_pred <- predict(VHLx2rLH1_tHDR_pre_lib_ratio.lo, newdata = VHLx2_posseq, se=TRUE)
VHLx2rLH1_tHDR_pre_lib_pos_effects <- VHLx2rLH1_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx2rLH1_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx2rLH1_tHDR_pre_lib_pos_effects)
VHLx2rLH1_tHDR_pre_lib_pos_effects_ci <- VHLx2rLH1_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx2rLH1_tHDR_pre_lib_pred$df)
VHLx2rLH1_tHDR_pre_lib_pos_effects_ci_ymin = VHLx2rLH1_tHDR_pre_lib_pos_effects - VHLx2rLH1_tHDR_pre_lib_pos_effects_ci
VHLx2rLH1_tHDR_pre_lib_pos_effects_ci_ymax = VHLx2rLH1_tHDR_pre_lib_pos_effects + VHLx2rLH1_tHDR_pre_lib_pos_effects_ci
VHLx2rLH1_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx2_posseq, VHLx2rLH1_tHDR_pre_lib_pos_effects, VHLx2rLH1_tHDR_pre_lib_pos_effects.x, VHLx2rLH1_tHDR_pre_lib_pos_effects_ci_ymin, VHLx2rLH1_tHDR_pre_lib_pos_effects_ci_ymax, VHLx2rLH1_tHDR_pre_lib_pred_se = VHLx2rLH1_tHDR_pre_lib_pred$se.fit)
#VHLx2rLH2
VHLx2rLH2_tHDR_pre_lib_ratio.lo <- loess(log2(rLH2_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df, subset = which(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx2rLH2_tHDR_pre_lib_pred <- predict(VHLx2rLH2_tHDR_pre_lib_ratio.lo, newdata = VHLx2_posseq, se=TRUE)
VHLx2rLH2_tHDR_pre_lib_pos_effects <- VHLx2rLH2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx2rLH2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx2rLH2_tHDR_pre_lib_pos_effects)
VHLx2rLH2_tHDR_pre_lib_pos_effects_ci <- VHLx2rLH2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx2rLH2_tHDR_pre_lib_pred$df)
VHLx2rLH2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx2rLH2_tHDR_pre_lib_pos_effects - VHLx2rLH2_tHDR_pre_lib_pos_effects_ci
VHLx2rLH2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx2rLH2_tHDR_pre_lib_pos_effects + VHLx2rLH2_tHDR_pre_lib_pos_effects_ci
VHLx2rLH2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx2_posseq, VHLx2rLH2_tHDR_pre_lib_pos_effects, VHLx2rLH2_tHDR_pre_lib_pos_effects.x, VHLx2rLH2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx2rLH2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx2rLH2_tHDR_pre_lib_pred_se = VHLx2rLH2_tHDR_pre_lib_pred$se.fit)

#VHLx2rLH1rLH2
VHLx2rLH1rLH2_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rLH1rLH2_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df, subset = which(VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_rLH1rLH2_mean_synnorm > 0.7 & VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_pre_lib_ratio_rLH1rLH2_mean_synnorm > 0.3 & VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_pre_lib_ratio_rLH1rLH2_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx2rLH1rLH2_tHDR_pre_lib_pred <- predict(VHLx2rLH1rLH2_tHDR_pre_lib_ratio.lo, newdata = VHLx2_posseq, se=TRUE)
VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects <- VHLx2rLH1rLH2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects)
VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects_ci <- VHLx2rLH1rLH2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx2rLH1rLH2_tHDR_pre_lib_pred$df)
VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects - VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects_ci
VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects + VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects_ci
VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx2_posseq, VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects, VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects.x, VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx2rLH1rLH2_tHDR_pre_lib_pred_se = VHLx2rLH1rLH2_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rLH1, rLH2, rLH1rLH2)
VHLx2rLH_tHDR_pos_merge_df <- VHLx2rLH1_prog_map_thresh5_df_rLH2_int_ord_df 
VHLx2rLH_tHDR_pos_merge_df <- merge(VHLx2rLH_tHDR_pos_merge_df, VHLx2rLH1_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx2rLH1_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx2rLH_tHDR_pos_merge_df <- merge(VHLx2rLH_tHDR_pos_merge_df, VHLx2rLH2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx2rLH2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx2rLH_tHDR_pos_merge_df <- merge(VHLx2rLH_tHDR_pos_merge_df, VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx2rLH_tHDR_pos_merge_df <- VHLx2rLH_tHDR_pos_merge_df %>% 
  rename(
    rLH1_tHDR_pre_lib_pos_effects.x = VHLx2rLH1_tHDR_pre_lib_pos_effects.x,
    rLH2_tHDR_pre_lib_pos_effects.x = VHLx2rLH2_tHDR_pre_lib_pos_effects.x,
    rLH1rLH2_tHDR_pre_lib_pos_effects.x = VHLx2rLH1rLH2_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rLH1 vs. rLH1_fit and vs. mean_fit)
VHLx2rLH_tHDR_pos_merge_df$rLH1_tHDR_post_lib_loess_rLH1 <- log2(VHLx2rLH_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx2rLH_tHDR_pos_merge_df$rLH1_tHDR_pre_lib_pos_effects.x
VHLx2rLH_tHDR_pos_merge_df$rLH1_tHDR_post_lib_loess_rLH1rLH2 <- log2(VHLx2rLH_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx2rLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_pre_lib_pos_effects.x
VHLx2rLH_tHDR_pos_merge_df$rLH2_tHDR_post_lib_loess_rLH2 <- log2(VHLx2rLH_tHDR_pos_merge_df$rLH2_tHDR_post_lib_ratio_synnorm) - VHLx2rLH_tHDR_pos_merge_df$rLH2_tHDR_pre_lib_pos_effects.x
VHLx2rLH_tHDR_pos_merge_df$rLH2_tHDR_post_lib_loess_rLH1rLH2 <- log2(VHLx2rLH_tHDR_pos_merge_df$rLH2_tHDR_post_lib_ratio_synnorm) - VHLx2rLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_pre_lib_pos_effects.x
VHLx2rLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_post_lib_loess_rLH1rLH2 <- log2(VHLx2rLH_tHDR_pos_merge_df$tHDR_post_lib_ratio_rLH1rLH2_mean_synnorm) - VHLx2rLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx2rLH_tHDR_pos_merge_df$rLH1_tHDR_pre_lib_loess_rLH1 <- log2(VHLx2rLH_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx2rLH_tHDR_pos_merge_df$rLH1_tHDR_pre_lib_pos_effects.x
VHLx2rLH_tHDR_pos_merge_df$rLH1_tHDR_pre_lib_loess_rLH1rLH2 <- log2(VHLx2rLH_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx2rLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_pre_lib_pos_effects.x
VHLx2rLH_tHDR_pos_merge_df$rLH2_tHDR_pre_lib_loess_rLH2 <- log2(VHLx2rLH_tHDR_pos_merge_df$rLH2_tHDR_pre_lib_ratio_synnorm) - VHLx2rLH_tHDR_pos_merge_df$rLH2_tHDR_pre_lib_pos_effects.x
VHLx2rLH_tHDR_pos_merge_df$rLH2_tHDR_pre_lib_loess_rLH1rLH2 <- log2(VHLx2rLH_tHDR_pos_merge_df$rLH2_tHDR_pre_lib_ratio_synnorm) - VHLx2rLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_pre_lib_pos_effects.x
VHLx2rLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_pre_lib_loess_rLH1rLH2 <- log2(VHLx2rLH_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rLH1rLH2_mean_synnorm) - VHLx2rLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rLH1 and rLH2 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx2rLH_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx2rLH_tHDR_post_lib_loess_median_syn_rLH1 <- median(VHLx2rLH_tHDR_pos_merge_df[which(VHLx2rLH_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLH1_tHDR_post_lib_loess_rLH1')])
  VHLx2rLH_tHDR_post_lib_loess_median_syn_rLH2 <- median(VHLx2rLH_tHDR_pos_merge_df[which(VHLx2rLH_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLH2_tHDR_post_lib_loess_rLH2')])
  } else {
  VHLx2rLH_tHDR_post_lib_loess_median_syn_rLH1 <- median(VHLx2rLH_tHDR_pos_merge_df[which(VHLx2rLH_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLH1_tHDR_post_lib_loess_rLH1')])
  VHLx2rLH_tHDR_post_lib_loess_median_syn_rLH2 <- median(VHLx2rLH_tHDR_pos_merge_df[which(VHLx2rLH_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLH2_tHDR_post_lib_loess_rLH2')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rLH1 'e.sns' = exon syn/ns norm.
VHLx2rLH_tHDR_pos_merge_df$rLH1_tHDR_post_lib_loess_rLH1_e.sns <- (VHLx2rLH_tHDR_pos_merge_df$rLH1_tHDR_post_lib_loess_rLH1-VHLx2rLH_tHDR_post_lib_loess_median_syn_rLH1)
#calculate new b values for rLH2 'e.sns' = exon syn/ns norm.
VHLx2rLH_tHDR_pos_merge_df$rLH2_tHDR_post_lib_loess_rLH2_e.sns <- (VHLx2rLH_tHDR_pos_merge_df$rLH2_tHDR_post_lib_loess_rLH2-VHLx2rLH_tHDR_post_lib_loess_median_syn_rLH2)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx2rLH_tHDR_pos_merge_df$rLH_tHDR_post_lib_loess_e.sns_rLH1rLH2_mean <- (VHLx2rLH_tHDR_pos_merge_df$rLH1_tHDR_post_lib_loess_rLH1_e.sns+VHLx2rLH_tHDR_pos_merge_df$rLH2_tHDR_post_lib_loess_rLH2_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx2rLH_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx2rLH_tHDR_post_lib_loess_e.sns_rLH1rLH2_syn_median <- median(VHLx2rLH_tHDR_pos_merge_df[which(VHLx2rLH_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('VHLx2rLH_tHDR_post_lib_loess_e.sns_rLH1rLH2_mean')])
  } else {
  VHLx2rLH_tHDR_post_lib_loess_e.sns_rLH1rLH2_syn_median <- median(VHLx2rLH_tHDR_pos_merge_df[which(VHLx2rLH_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('VHLx2rLH_tHDR_post_lib_loess_e.sns_rLH1rLH2_mean')])
}

#RNA analysis
VHLx2rLH1rLH2_tSNV_rLH1_rna_pre_by_rLH2_rna_pre_cor_s <- cor(log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx2rLH1rLH2_tSNV_rLH1_rna_pre_by_rLH2_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH1_tHDR_rna2_rna_ratio <- VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna2_pseudo_freq/VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna_pseudo_freq
VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna2_rna_ratio <- VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna2_pseudo_freq/VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna_pseudo_freq
VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH1rLH2_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH1_tHDR_rna2_rna_ratio)+log2(VHLx2rLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna2_rna_ratio))/2

```

```{r}
#VHLx3arLH
VHLx3arLH1_file <- paste(experiment_dir_220822,'VHLx3arL4H1','_annotated.txt',sep='')
VHLx3arLH2_file <- paste(experiment_dir_220822,'VHLx3arL4H2','_annotated.txt',sep='')
VHLx3arLH1 <- read.table(VHLx3arLH1_file, header=TRUE, sep="\t")
VHLx3arLH2 <- read.table(VHLx3arLH2_file, header=TRUE, sep="\t")

#rename the columns to match code below in place:
VHLx3arLH1 <- VHLx3arLH1 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

VHLx3arLH2 <- VHLx3arLH2 %>% 
  rename(
    CADD.phred = PHRED,
    CADD.raw = RawScore,
    pos = Pos,
    conseq = Consequence,
    alt = Alt,
    polyphen.val = PolyPhenVal
    )

#which p_hdr_read to use? get from editing info file
VHL_editing_info_VHLx3a <- VHL_editing_info[which(VHL_editing_info$amplicon == 'VHLx3a'),]
#HDR_5_SNV  HDR_3_SNV  cut_pos  cut_end  mut_start  mut_end
VHLx3a_HDR_5_SNV = as.character(VHL_editing_info_VHLx3a$HDR_5_SNV)
VHLx3a_HDR_3_SNV = as.character(VHL_editing_info_VHLx3a$HDR_3_SNV)
#VHLx3a_cut_pos = as.character(VHL_editing_info_VHLx3a$cut_pos)
VHLx3a_cut_end = as.character(VHL_editing_info_VHLx3a$cut_end)
VHLx3a_mut_start = as.character(VHL_editing_info_VHLx3a$mut_start)
VHLx3a_mut_end = as.character(VHL_editing_info_VHLx3a$mut_end)

### Replicate 1
VHLx3arLH1_cSNV_all <- which(VHLx3arLH1[,'c_hdr_snv']=='True')
VHLx3arLH1_cSNV_all_df = VHLx3arLH1[VHLx3arLH1_cSNV_all,]
VHLx3arLH1_prog_var_all <- which(VHLx3arLH1[,'all_hdr_variant']=='True' & VHLx3arLH1[,'edit_string']!='-WT')
VHLx3arLH1_prog_var_all_df = VHLx3arLH1[VHLx3arLH1_prog_var_all,]
VHLx3arLH1_prog_map_all = which(VHLx3arLH1_prog_var_all_df[,'pos']!='REF')
VHLx3arLH1_prog_map_all_df = VHLx3arLH1_prog_var_all_df[VHLx3arLH1_prog_map_all,]
VHLx3arLH1_prog_map_exon_all = which(VHLx3arLH1_prog_map_all_df[,'cDNApos']!='REF' & VHLx3arLH1_prog_map_all_df[,'cDNApos']!='NA')
VHLx3arLH1_prog_map_exon_all_df = VHLx3arLH1_prog_map_all_df[VHLx3arLH1_prog_map_exon_all,]
VHLx3arLH1_prog_map_CADD = which(VHLx3arLH1_prog_map_all_df[,'CADD.phred']!='NA')
VHLx3arLH1_prog_map_CADD_df = VHLx3arLH1_prog_map_all_df[VHLx3arLH1_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx3arLH1_prog_var_thresh5 <- which(as.numeric(as.character(VHLx3arLH1_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx3arLH1_prog_var_thresh5_df = VHLx3arLH1_prog_var_all_df[VHLx3arLH1_prog_var_thresh5,]
VHLx3arLH1_prog_map_thresh5 <- which(as.numeric(as.character(VHLx3arLH1_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx3arLH1_prog_map_thresh5_df = VHLx3arLH1_prog_map_all_df[VHLx3arLH1_prog_map_thresh5,]
VHLx3arLH1_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx3arLH1_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx3arLH1_prog_map_exon_thresh5_df = VHLx3arLH1_prog_map_exon_all_df[VHLx3arLH1_prog_map_exon_thresh5,]
VHLx3arLH1_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx3arLH1_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx3arLH1_prog_map_CADD_thresh5_df = VHLx3arLH1_prog_map_CADD_df[VHLx3arLH1_prog_map_CADD_thresh5,]

# r1 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx3arLH1_prog_var_all_lib_count = length(VHLx3arLH1_prog_var_all_df$lib)
VHLx3arLH1_prog_var_all_lib_count
# r1 Max and min reads for each variant
VHLx3arLH1_prog_var_all_min_lib_counts = min(VHLx3arLH1_prog_var_all_df$lib)
VHLx3arLH1_prog_var_all_min_lib_counts
VHLx3arLH1_prog_var_all_max_lib_counts = max(VHLx3arLH1_prog_var_all_df$lib)
VHLx3arLH1_prog_var_all_max_lib_counts

# r1 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx3arLH1_prog_map_all_lib_count = length(VHLx3arLH1_prog_map_all_df$lib)
VHLx3arLH1_prog_map_all_lib_count
# r1 Max and min reads for each variant
VHLx3arLH1_prog_map_all_min_lib_counts = min(VHLx3arLH1_prog_map_all_df$lib)
VHLx3arLH1_prog_map_all_min_lib_counts
VHLx3arLH1_prog_map_all_max_lib_counts = max(VHLx3arLH1_prog_map_all_df$lib)
VHLx3arLH1_prog_map_all_max_lib_counts

# r1 Number of pre 'SNV variants' --> out of all programmed.
VHLx3arLH1_prog_var_all_pre_count = length(VHLx3arLH1_prog_var_all_df$pre)
VHLx3arLH1_prog_var_all_pre_count
# r1 Max and min pre reads for each prog_var
VHLx3arLH1_prog_var_all_min_pre_counts = min(VHLx3arLH1_prog_var_all_df$pre)
VHLx3arLH1_prog_var_all_min_pre_counts
VHLx3arLH1_prog_var_all_max_pre_counts = max(VHLx3arLH1_prog_var_all_df$pre)
VHLx3arLH1_prog_var_all_max_pre_counts

# r1 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx3arLH1_prog_map_all_pre_count = length(VHLx3arLH1_prog_map_all_df$pre)
VHLx3arLH1_prog_map_all_pre_count
# r1 Max and min pre reads for each prog_map
VHLx3arLH1_prog_map_all_min_pre_counts = min(VHLx3arLH1_prog_map_all_df$pre)
VHLx3arLH1_prog_map_all_min_pre_counts
VHLx3arLH1_prog_map_all_max_pre_counts = max(VHLx3arLH1_prog_map_all_df$pre)
VHLx3arLH1_prog_map_all_max_pre_counts

# r1 Number of post 'SNV variants'
VHLx3arLH1_prog_map_all_post_count = length(VHLx3arLH1_prog_map_all_df$post)
VHLx3arLH1_prog_map_all_post_count
# r1 Max and min post reads for each prog_map
VHLx3arLH1_prog_map_all_min_post_counts = min(VHLx3arLH1_prog_map_all_df$post)
VHLx3arLH1_prog_map_all_min_post_counts
VHLx3arLH1_prog_map_all_max_post_counts = max(VHLx3arLH1_prog_map_all_df$post)
VHLx3arLH1_prog_map_all_max_post_counts

# r1 Now using tHDR frequencies instead (for RNA):
VHLx3arLH1_prog_map_all_syn_df <- VHLx3arLH1_prog_map_all_df[which(VHLx3arLH1_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx3arLH1_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx3arLH1_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx3arLH1_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx3arLH1_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx3arLH1_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx3arLH1_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx3arLH1_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx3arLH1_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r1 Max and min tHDR_rna reads for each prog_map
VHLx3arLH1_prog_map_all_min_rna_counts = min(VHLx3arLH1_prog_map_exon_all_df$tHDR_rna)
VHLx3arLH1_prog_map_all_min_rna_counts
VHLx3arLH1_prog_map_all_max_rna_counts = max(VHLx3arLH1_prog_map_exon_all_df$tHDR_rna)
VHLx3arLH1_prog_map_all_max_rna_counts
VHLx3arLH1_prog_map_all_min_rna_pseudo_freq = min(VHLx3arLH1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3arLH1_prog_map_all_min_rna_pseudo_freq
VHLx3arLH1_prog_map_all_max_rna_pseudo_freq = max(VHLx3arLH1_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3arLH1_prog_map_all_max_rna_pseudo_freq
VHLx3arLH1_prog_map_all_min_rna_pre_ratio = min(VHLx3arLH1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3arLH1_prog_map_all_min_rna_pre_ratio
VHLx3arLH1_prog_map_all_max_rna_pre_ratio = max(VHLx3arLH1_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3arLH1_prog_map_all_max_rna_pre_ratio
VHLx3arLH1_prog_map_all_min_rna_post_ratio = min(VHLx3arLH1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3arLH1_prog_map_all_min_rna_post_ratio
VHLx3arLH1_prog_map_all_max_rna_post_ratio = max(VHLx3arLH1_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3arLH1_prog_map_all_max_rna_post_ratio

# r1 # r1 SEQUENCING ERROR CORRECTION ANALYSIS:
# r1 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx3arLH1_cSNV_all_corr_pre_count = length(VHLx3arLH1_cSNV_all_df$corr_pre)
VHLx3arLH1_cSNV_all_corr_pre_count
# r1 Max and min corr_pre reads for each prog_map
VHLx3arLH1_cSNV_all_min_corr_pre_counts = min(VHLx3arLH1_cSNV_all_df$corr_pre)
VHLx3arLH1_cSNV_all_min_corr_pre_counts
VHLx3arLH1_cSNV_all_max_corr_pre_counts = max(VHLx3arLH1_cSNV_all_df$corr_pre)
VHLx3arLH1_cSNV_all_max_corr_pre_counts

# r1 Number of corr_post 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLH1_cSNV_all_corr_post_count = length(VHLx3arLH1_cSNV_all_df$corr_post)
VHLx3arLH1_cSNV_all_corr_post_count
# r1 Max and min corr_post reads for each cSNV
VHLx3arLH1_cSNV_all_min_corr_post_counts = min(VHLx3arLH1_cSNV_all_df$corr_post)
VHLx3arLH1_cSNV_all_min_corr_post_counts
VHLx3arLH1_cSNV_all_max_corr_post_counts = max(VHLx3arLH1_cSNV_all_df$corr_post)
VHLx3arLH1_cSNV_all_max_corr_post_counts

# r1 repeat with pSNV variants (only cut end is edited!)
VHLx3a_p_hdr_snv = paste('p_hdr_',VHLx3a_cut_end,'_snv',sep='')
VHLx3arLH1_pSNV_all <- which(VHLx3arLH1[,VHLx3a_p_hdr_snv]=='True')
VHLx3arLH1_pSNV_all_df = VHLx3arLH1[VHLx3arLH1_pSNV_all,]
# r1 Number of 'pSNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLH1_pSNV_all_lib_count = length(VHLx3arLH1_pSNV_all_df$lib)
VHLx3arLH1_pSNV_all_lib_count
# r1 Max and min reads for each variant
VHLx3arLH1_pSNV_all_min_lib_counts = min(VHLx3arLH1_pSNV_all_df$lib)
VHLx3arLH1_pSNV_all_min_lib_counts
VHLx3arLH1_pSNV_all_max_lib_counts = max(VHLx3arLH1_pSNV_all_df$lib)
VHLx3arLH1_pSNV_all_max_lib_counts
# r1 Number of pre 'SNV variants'
VHLx3arLH1_pSNV_all_pre_count = length(VHLx3arLH1_pSNV_all_df$pre)
VHLx3arLH1_pSNV_all_pre_count
# r1 Max and min pre reads for each pSNV
VHLx3arLH1_pSNV_all_min_pre_counts = min(VHLx3arLH1_pSNV_all_df$pre)
VHLx3arLH1_pSNV_all_min_pre_counts
VHLx3arLH1_pSNV_all_max_pre_counts = max(VHLx3arLH1_pSNV_all_df$pre)
VHLx3arLH1_pSNV_all_max_pre_counts
# r1 Number of post 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLH1_pSNV_all_post_count = length(VHLx3arLH1_pSNV_all_df$post)
VHLx3arLH1_pSNV_all_post_count
# r1 Max and min post reads for each pSNV
VHLx3arLH1_pSNV_all_min_post_counts = min(VHLx3arLH1_pSNV_all_df$post)
VHLx3arLH1_pSNV_all_min_post_counts
VHLx3arLH1_pSNV_all_max_post_counts = max(VHLx3arLH1_pSNV_all_df$post)
VHLx3arLH1_pSNV_all_max_post_counts
# r1 Number of 'cSNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLH1_prog_map_thresh5_lib_count = length(VHLx3arLH1_prog_map_thresh5_df$lib)
VHLx3arLH1_prog_map_thresh5_lib_count
VHLx3arLH1_prog_map_thresh5_min_lib_counts = min(VHLx3arLH1_prog_map_thresh5_df$lib)
VHLx3arLH1_prog_map_thresh5_min_lib_counts
VHLx3arLH1_prog_map_thresh5_max_lib_counts = max(VHLx3arLH1_prog_map_thresh5_df$lib)
VHLx3arLH1_prog_map_thresh5_max_lib_counts
# r1 Number of pre 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLH1_prog_map_thresh5_pre_count = length(VHLx3arLH1_prog_map_thresh5_df$pre)
VHLx3arLH1_prog_map_thresh5_pre_count
VHLx3arLH1_prog_map_thresh5_min_pre_counts = min(VHLx3arLH1_prog_map_thresh5_df$pre)
VHLx3arLH1_prog_map_thresh5_min_pre_counts
VHLx3arLH1_prog_map_thresh5_max_pre_counts = max(VHLx3arLH1_prog_map_thresh5_df$pre)
VHLx3arLH1_prog_map_thresh5_max_pre_counts

# r1 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx3arLH1_prog_map_thresh5_post_count = length(VHLx3arLH1_prog_map_thresh5_df$post)
VHLx3arLH1_prog_map_thresh5_post_count
VHLx3arLH1_prog_map_thresh5_min_post_counts = min(VHLx3arLH1_prog_map_thresh5_df$post)
VHLx3arLH1_prog_map_thresh5_min_post_counts
VHLx3arLH1_prog_map_thresh5_max_post_counts = max(VHLx3arLH1_prog_map_thresh5_df$post)
VHLx3arLH1_prog_map_thresh5_max_post_counts
VHLx3arLH1_prog_map_thresh5_corr_post_count = length(VHLx3arLH1_cSNV_all_df$corr_post)
VHLx3arLH1_prog_map_thresh5_corr_post_count
VHLx3arLH1_prog_map_thresh5_min_corr_post_counts = min(VHLx3arLH1_cSNV_all_df$corr_post)
VHLx3arLH1_prog_map_thresh5_min_corr_post_counts
VHLx3arLH1_prog_map_thresh5_max_corr_post_counts = max(VHLx3arLH1_cSNV_all_df$corr_post)
VHLx3arLH1_prog_map_thresh5_max_corr_post_counts

VHLx3arLH1_pSNV_thresh5 <- which(VHLx3arLH1[,VHLx3a_p_hdr_snv]=='True' & as.numeric(as.character(VHLx3arLH1[,'pre_freq']))>=0.00001)
VHLx3arLH1_pSNV_thresh5_df = VHLx3arLH1[VHLx3arLH1_pSNV_thresh5,]
VHLx3arLH1_pSNV_thresh5_lib_count = length(VHLx3arLH1_pSNV_thresh5_df$lib)
VHLx3arLH1_pSNV_thresh5_lib_count
VHLx3arLH1_pSNV_thresh5_min_lib_counts = min(VHLx3arLH1_pSNV_thresh5_df$lib)
VHLx3arLH1_pSNV_thresh5_min_lib_counts
VHLx3arLH1_pSNV_thresh5_max_lib_counts = max(VHLx3arLH1_pSNV_thresh5_df$lib)
VHLx3arLH1_pSNV_thresh5_max_lib_counts
VHLx3arLH1_pSNV_thresh5_pre_count = length(VHLx3arLH1_pSNV_thresh5_df$pre)
VHLx3arLH1_pSNV_thresh5_pre_count
VHLx3arLH1_pSNV_thresh5_min_pre_counts = min(VHLx3arLH1_pSNV_thresh5_df$pre)
VHLx3arLH1_pSNV_thresh5_min_pre_counts
VHLx3arLH1_pSNV_thresh5_max_pre_counts = max(VHLx3arLH1_pSNV_thresh5_df$pre)
VHLx3arLH1_pSNV_thresh5_max_pre_counts
VHLx3arLH1_pSNV_thresh5_post_count = length(VHLx3arLH1_pSNV_thresh5_df$post)
VHLx3arLH1_pSNV_thresh5_post_count
VHLx3arLH1_pSNV_thresh5_min_post_counts = min(VHLx3arLH1_pSNV_thresh5_df$post)
VHLx3arLH1_pSNV_thresh5_min_post_counts
VHLx3arLH1_pSNV_thresh5_max_post_counts = max(VHLx3arLH1_pSNV_thresh5_df$post)
VHLx3arLH1_pSNV_thresh5_max_post_counts

### Replicate 2
VHLx3arLH2_cSNV_all <- which(VHLx3arLH2[,'c_hdr_snv']=='True')
VHLx3arLH2_cSNV_all_df = VHLx3arLH2[VHLx3arLH2_cSNV_all,]
VHLx3arLH2_prog_var_all <- which(VHLx3arLH2[,'all_hdr_variant']=='True' & VHLx3arLH2[,'edit_string']!='-WT')
VHLx3arLH2_prog_var_all_df = VHLx3arLH2[VHLx3arLH2_prog_var_all,]
VHLx3arLH2_prog_map_all = which(VHLx3arLH2_prog_var_all_df[,'pos']!='REF')
VHLx3arLH2_prog_map_all_df = VHLx3arLH2_prog_var_all_df[VHLx3arLH2_prog_map_all,]
VHLx3arLH2_prog_map_exon_all = which(VHLx3arLH2_prog_map_all_df[,'cDNApos']!='REF' & VHLx3arLH2_prog_map_all_df[,'cDNApos']!='NA')
VHLx3arLH2_prog_map_exon_all_df = VHLx3arLH2_prog_map_all_df[VHLx3arLH2_prog_map_exon_all,]
VHLx3arLH2_prog_map_CADD = which(VHLx3arLH2_prog_map_all_df[,'CADD.phred']!='NA')
VHLx3arLH2_prog_map_CADD_df = VHLx3arLH2_prog_map_all_df[VHLx3arLH2_prog_map_CADD,]
#threshold at 1 in 100,000 pre reads called 'thresh5'
VHLx3arLH2_prog_var_thresh5 <- which(as.numeric(as.character(VHLx3arLH2_prog_var_all_df[,'pre_freq']))>=0.00001)
VHLx3arLH2_prog_var_thresh5_df = VHLx3arLH2_prog_var_all_df[VHLx3arLH2_prog_var_thresh5,]
VHLx3arLH2_prog_map_thresh5 <- which(as.numeric(as.character(VHLx3arLH2_prog_map_all_df[,'pre_freq']))>=0.00001)
VHLx3arLH2_prog_map_thresh5_df = VHLx3arLH2_prog_map_all_df[VHLx3arLH2_prog_map_thresh5,]
VHLx3arLH2_prog_map_exon_thresh5 <- which(as.numeric(as.character(VHLx3arLH2_prog_map_exon_all_df[,'pre_freq']))>=0.00001)
VHLx3arLH2_prog_map_exon_thresh5_df = VHLx3arLH2_prog_map_exon_all_df[VHLx3arLH2_prog_map_exon_thresh5,]
VHLx3arLH2_prog_map_CADD_thresh5 <- which(as.numeric(as.character(VHLx3arLH2_prog_map_CADD_df[,'pre_freq']))>=0.00001)
VHLx3arLH2_prog_map_CADD_thresh5_df = VHLx3arLH2_prog_map_CADD_df[VHLx3arLH2_prog_map_CADD_thresh5,]

# r2 Number of 'prog_var variants' --> all variants in library (i.e. length * 3 + 1)
VHLx3arLH2_prog_var_all_lib_count = length(VHLx3arLH2_prog_var_all_df$lib)
VHLx3arLH2_prog_var_all_lib_count
# r2 Max and min reads for each variant
VHLx3arLH2_prog_var_all_min_lib_counts = min(VHLx3arLH2_prog_var_all_df$lib)
VHLx3arLH2_prog_var_all_min_lib_counts
VHLx3arLH2_prog_var_all_max_lib_counts = max(VHLx3arLH2_prog_var_all_df$lib)
VHLx3arLH2_prog_var_all_max_lib_counts

# r2 Number of 'prog_map variants' --> will exclude the hdr_wt and any PAM_wt variants in sge region (1 or 2)
VHLx3arLH2_prog_map_all_lib_count = length(VHLx3arLH2_prog_map_all_df$lib)
VHLx3arLH2_prog_map_all_lib_count
# r2 Max and min reads for each variant
VHLx3arLH2_prog_map_all_min_lib_counts = min(VHLx3arLH2_prog_map_all_df$lib)
VHLx3arLH2_prog_map_all_min_lib_counts
VHLx3arLH2_prog_map_all_max_lib_counts = max(VHLx3arLH2_prog_map_all_df$lib)
VHLx3arLH2_prog_map_all_max_lib_counts

# r2 Number of pre 'SNV variants' --> out of all programmed.
VHLx3arLH2_prog_var_all_pre_count = length(VHLx3arLH2_prog_var_all_df$pre)
VHLx3arLH2_prog_var_all_pre_count
# r2 Max and min pre reads for each prog_var
VHLx3arLH2_prog_var_all_min_pre_counts = min(VHLx3arLH2_prog_var_all_df$pre)
VHLx3arLH2_prog_var_all_min_pre_counts
VHLx3arLH2_prog_var_all_max_pre_counts = max(VHLx3arLH2_prog_var_all_df$pre)
VHLx3arLH2_prog_var_all_max_pre_counts

# r2 Number of pre 'SNV variants' --> out of all non-wt variants (2-3 less than all programmed var.)
VHLx3arLH2_prog_map_all_pre_count = length(VHLx3arLH2_prog_map_all_df$pre)
VHLx3arLH2_prog_map_all_pre_count
# r2 Max and min pre reads for each prog_map
VHLx3arLH2_prog_map_all_min_pre_counts = min(VHLx3arLH2_prog_map_all_df$pre)
VHLx3arLH2_prog_map_all_min_pre_counts
VHLx3arLH2_prog_map_all_max_pre_counts = max(VHLx3arLH2_prog_map_all_df$pre)
VHLx3arLH2_prog_map_all_max_pre_counts

# r2 Number of post 'SNV variants'
VHLx3arLH2_prog_map_all_post_count = length(VHLx3arLH2_prog_map_all_df$post)
VHLx3arLH2_prog_map_all_post_count
# r2 Max and min post reads for each prog_map
VHLx3arLH2_prog_map_all_min_post_counts = min(VHLx3arLH2_prog_map_all_df$post)
VHLx3arLH2_prog_map_all_min_post_counts
VHLx3arLH2_prog_map_all_max_post_counts = max(VHLx3arLH2_prog_map_all_df$post)
VHLx3arLH2_prog_map_all_max_post_counts

# r2 Now using tHDR frequencies instead (for RNA):
VHLx3arLH2_prog_map_all_syn_df <- VHLx3arLH2_prog_map_all_df[which(VHLx3arLH2_prog_map_all_df$conseq == 'SYNONYMOUS'),]
VHLx3arLH2_prog_map_all_syn_tHDR_rna_pre_quarts <- quantile(log2(VHLx3arLH2_prog_map_all_syn_df$tHDR_rna_pre_ratio))
VHLx3arLH2_prog_map_all_syn_tHDR_rna_pre_med <- unname(VHLx3arLH2_prog_map_all_syn_tHDR_rna_pre_quarts[3])
VHLx3arLH2_prog_map_all_syn_tHDR_rna_post_quarts <- quantile(log2(VHLx3arLH2_prog_map_all_syn_df$tHDR_rna_post_ratio))
VHLx3arLH2_prog_map_all_syn_tHDR_rna_post_med <- unname(VHLx3arLH2_prog_map_all_syn_tHDR_rna_post_quarts[3])

# r2 Max and min tHDR_rna reads for each prog_map
VHLx3arLH2_prog_map_all_min_rna_counts = min(VHLx3arLH2_prog_map_exon_all_df$tHDR_rna)
VHLx3arLH2_prog_map_all_min_rna_counts
VHLx3arLH2_prog_map_all_max_rna_counts = max(VHLx3arLH2_prog_map_exon_all_df$tHDR_rna)
VHLx3arLH2_prog_map_all_max_rna_counts
VHLx3arLH2_prog_map_all_min_rna_pseudo_freq = min(VHLx3arLH2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3arLH2_prog_map_all_min_rna_pseudo_freq
VHLx3arLH2_prog_map_all_max_rna_pseudo_freq = max(VHLx3arLH2_prog_map_exon_all_df$tHDR_rna_pseudo_freq)
VHLx3arLH2_prog_map_all_max_rna_pseudo_freq
VHLx3arLH2_prog_map_all_min_rna_pre_ratio = min(VHLx3arLH2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3arLH2_prog_map_all_min_rna_pre_ratio
VHLx3arLH2_prog_map_all_max_rna_pre_ratio = max(VHLx3arLH2_prog_map_exon_all_df$tHDR_rna_pre_ratio)
VHLx3arLH2_prog_map_all_max_rna_pre_ratio
VHLx3arLH2_prog_map_all_min_rna_post_ratio = min(VHLx3arLH2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3arLH2_prog_map_all_min_rna_post_ratio
VHLx3arLH2_prog_map_all_max_rna_post_ratio = max(VHLx3arLH2_prog_map_exon_all_df$tHDR_rna_post_ratio)
VHLx3arLH2_prog_map_all_max_rna_post_ratio

# r2 # r2 SEQUENCING ERROR CORRECTION ANALYSIS:
# r2 Number of corr_pre 'SNV variants' --> length * 3 snvs minus 3 * PAM sites
VHLx3arLH2_cSNV_all_corr_pre_count = length(VHLx3arLH2_cSNV_all_df$corr_pre)
VHLx3arLH2_cSNV_all_corr_pre_count
# r2 Max and min corr_pre reads for each prog_map
VHLx3arLH2_cSNV_all_min_corr_pre_counts = min(VHLx3arLH2_cSNV_all_df$corr_pre)
VHLx3arLH2_cSNV_all_min_corr_pre_counts
VHLx3arLH2_cSNV_all_max_corr_pre_counts = max(VHLx3arLH2_cSNV_all_df$corr_pre)
VHLx3arLH2_cSNV_all_max_corr_pre_counts

# r2 Number of corr_post 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLH2_cSNV_all_corr_post_count = length(VHLx3arLH2_cSNV_all_df$corr_post)
VHLx3arLH2_cSNV_all_corr_post_count
# r2 Max and min corr_post reads for each cSNV
VHLx3arLH2_cSNV_all_min_corr_post_counts = min(VHLx3arLH2_cSNV_all_df$corr_post)
VHLx3arLH2_cSNV_all_min_corr_post_counts
VHLx3arLH2_cSNV_all_max_corr_post_counts = max(VHLx3arLH2_cSNV_all_df$corr_post)
VHLx3arLH2_cSNV_all_max_corr_post_counts

# r2 repeat with pSNV variants (only cut end is edited!)
VHLx3a_p_hdr_snv = paste('p_hdr_',VHLx3a_cut_end,'_snv',sep='')
VHLx3arLH2_pSNV_all <- which(VHLx3arLH2[,VHLx3a_p_hdr_snv]=='True')
VHLx3arLH2_pSNV_all_df = VHLx3arLH2[VHLx3arLH2_pSNV_all,]
# r2 Number of 'pSNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLH2_pSNV_all_lib_count = length(VHLx3arLH2_pSNV_all_df$lib)
VHLx3arLH2_pSNV_all_lib_count
# r2 Max and min reads for each variant
VHLx3arLH2_pSNV_all_min_lib_counts = min(VHLx3arLH2_pSNV_all_df$lib)
VHLx3arLH2_pSNV_all_min_lib_counts
VHLx3arLH2_pSNV_all_max_lib_counts = max(VHLx3arLH2_pSNV_all_df$lib)
VHLx3arLH2_pSNV_all_max_lib_counts
# r2 Number of pre 'SNV variants'
VHLx3arLH2_pSNV_all_pre_count = length(VHLx3arLH2_pSNV_all_df$pre)
VHLx3arLH2_pSNV_all_pre_count
# r2 Max and min pre reads for each pSNV
VHLx3arLH2_pSNV_all_min_pre_counts = min(VHLx3arLH2_pSNV_all_df$pre)
VHLx3arLH2_pSNV_all_min_pre_counts
VHLx3arLH2_pSNV_all_max_pre_counts = max(VHLx3arLH2_pSNV_all_df$pre)
VHLx3arLH2_pSNV_all_max_pre_counts
# r2 Number of post 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLH2_pSNV_all_post_count = length(VHLx3arLH2_pSNV_all_df$post)
VHLx3arLH2_pSNV_all_post_count
# r2 Max and min post reads for each pSNV
VHLx3arLH2_pSNV_all_min_post_counts = min(VHLx3arLH2_pSNV_all_df$post)
VHLx3arLH2_pSNV_all_min_post_counts
VHLx3arLH2_pSNV_all_max_post_counts = max(VHLx3arLH2_pSNV_all_df$post)
VHLx3arLH2_pSNV_all_max_post_counts
# r2 Number of 'cSNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLH2_prog_map_thresh5_lib_count = length(VHLx3arLH2_prog_map_thresh5_df$lib)
VHLx3arLH2_prog_map_thresh5_lib_count
VHLx3arLH2_prog_map_thresh5_min_lib_counts = min(VHLx3arLH2_prog_map_thresh5_df$lib)
VHLx3arLH2_prog_map_thresh5_min_lib_counts
VHLx3arLH2_prog_map_thresh5_max_lib_counts = max(VHLx3arLH2_prog_map_thresh5_df$lib)
VHLx3arLH2_prog_map_thresh5_max_lib_counts
# r2 Number of pre 'SNV variants' --> will be 2VHLx3a less than SGE region length x 3 due to PAM edits
VHLx3arLH2_prog_map_thresh5_pre_count = length(VHLx3arLH2_prog_map_thresh5_df$pre)
VHLx3arLH2_prog_map_thresh5_pre_count
VHLx3arLH2_prog_map_thresh5_min_pre_counts = min(VHLx3arLH2_prog_map_thresh5_df$pre)
VHLx3arLH2_prog_map_thresh5_min_pre_counts
VHLx3arLH2_prog_map_thresh5_max_pre_counts = max(VHLx3arLH2_prog_map_thresh5_df$pre)
VHLx3arLH2_prog_map_thresh5_max_pre_counts

# r2 Number of post 'SNV variants' --> will be 2 less than SGE region length x 3 due to PAM edits
VHLx3arLH2_prog_map_thresh5_post_count = length(VHLx3arLH2_prog_map_thresh5_df$post)
VHLx3arLH2_prog_map_thresh5_post_count
VHLx3arLH2_prog_map_thresh5_min_post_counts = min(VHLx3arLH2_prog_map_thresh5_df$post)
VHLx3arLH2_prog_map_thresh5_min_post_counts
VHLx3arLH2_prog_map_thresh5_max_post_counts = max(VHLx3arLH2_prog_map_thresh5_df$post)
VHLx3arLH2_prog_map_thresh5_max_post_counts
VHLx3arLH2_prog_map_thresh5_corr_post_count = length(VHLx3arLH2_cSNV_all_df$corr_post)
VHLx3arLH2_prog_map_thresh5_corr_post_count
VHLx3arLH2_prog_map_thresh5_min_corr_post_counts = min(VHLx3arLH2_cSNV_all_df$corr_post)
VHLx3arLH2_prog_map_thresh5_min_corr_post_counts
VHLx3arLH2_prog_map_thresh5_max_corr_post_counts = max(VHLx3arLH2_cSNV_all_df$corr_post)
VHLx3arLH2_prog_map_thresh5_max_corr_post_counts

VHLx3arLH2_pSNV_thresh5 <- which(VHLx3arLH2[,VHLx3a_p_hdr_snv]=='True' & as.numeric(as.character(VHLx3arLH2[,'pre_freq']))>=0.00001)
VHLx3arLH2_pSNV_thresh5_df = VHLx3arLH2[VHLx3arLH2_pSNV_thresh5,]
VHLx3arLH2_pSNV_thresh5_lib_count = length(VHLx3arLH2_pSNV_thresh5_df$lib)
VHLx3arLH2_pSNV_thresh5_lib_count
VHLx3arLH2_pSNV_thresh5_min_lib_counts = min(VHLx3arLH2_pSNV_thresh5_df$lib)
VHLx3arLH2_pSNV_thresh5_min_lib_counts
VHLx3arLH2_pSNV_thresh5_max_lib_counts = max(VHLx3arLH2_pSNV_thresh5_df$lib)
VHLx3arLH2_pSNV_thresh5_max_lib_counts
VHLx3arLH2_pSNV_thresh5_pre_count = length(VHLx3arLH2_pSNV_thresh5_df$pre)
VHLx3arLH2_pSNV_thresh5_pre_count
VHLx3arLH2_pSNV_thresh5_min_pre_counts = min(VHLx3arLH2_pSNV_thresh5_df$pre)
VHLx3arLH2_pSNV_thresh5_min_pre_counts
VHLx3arLH2_pSNV_thresh5_max_pre_counts = max(VHLx3arLH2_pSNV_thresh5_df$pre)
VHLx3arLH2_pSNV_thresh5_max_pre_counts
VHLx3arLH2_pSNV_thresh5_post_count = length(VHLx3arLH2_pSNV_thresh5_df$post)
VHLx3arLH2_pSNV_thresh5_post_count
VHLx3arLH2_pSNV_thresh5_min_post_counts = min(VHLx3arLH2_pSNV_thresh5_df$post)
VHLx3arLH2_pSNV_thresh5_min_post_counts
VHLx3arLH2_pSNV_thresh5_max_post_counts = max(VHLx3arLH2_pSNV_thresh5_df$post)
VHLx3arLH2_pSNV_thresh5_max_post_counts

#Replicate analysis
#define intersection based on most broad category , and then filter the others based on that intersection:
#Intersection variants of VHLx3arLH1_prog_var_thresh5_df:
VHLx3arLH1_prog_var_thresh5_df_rLH2_int <- VHLx3arLH1_prog_var_thresh5_df[which(VHLx3arLH1_prog_var_thresh5_df$variant %in% VHLx3arLH2_prog_var_thresh5_df$variant),]
#Intersection variants of VHLx3arLH2_prog_var_thresh5_df:
VHLx3arLH2_prog_var_thresh5_df_rLH1_int <- VHLx3arLH2_prog_var_thresh5_df[which(VHLx3arLH2_prog_var_thresh5_df$variant %in% VHLx3arLH1_prog_var_thresh5_df$variant),]
#Order each one by variant (check to see if same):
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int[order(VHLx3arLH1_prog_var_thresh5_df_rLH2_int$variant),]
VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int[order(VHLx3arLH2_prog_var_thresh5_df_rLH1_int$variant),]
dim(VHLx3arLH1_prog_var_thresh5_df)[1] #Number of prog_vars in rLH1
VHLx3arLH1rLH2int_prog_var_thresh5_pre_count <- dim(VHLx3arLH1_prog_var_thresh5_df_rLH2_int)[1] 
VHLx3arLH1rLH2int_prog_var_thresh5_pre_count #Number of prog_vars in rLH1 also in rLH2
dim(VHLx3arLH2_prog_var_thresh5_df)[1] #Number of prog_vars in rLH2
dim(VHLx3arLH2_prog_var_thresh5_df_rLH1_int)[1] #Number of prog_vars in rLH2 also in rLH1

#Add the following columns from the from rLH2 df to the rLH1 df:
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$pre
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_lib <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$lib
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$rna
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2 <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post2
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post3 <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post3
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2 <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$rna2
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$pre_pseudo
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pseudo <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post_pseudo
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna_pseudo <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$rna_pseudo
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_pseudo <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post2_pseudo
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post3_pseudo <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post3_pseudo
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2_pseudo <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$rna2_pseudo
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$pre_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$rna_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post2_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post3_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post3_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$rna2_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$pre_pseudo_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pseudo_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post_pseudo_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna_pseudo_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$rna_pseudo_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_pseudo_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post2_pseudo_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post3_pseudo_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post3_pseudo_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2_pseudo_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$rna2_pseudo_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_lib_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$pre_lib_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pre_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post_pre_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_lib_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post_lib_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna_pre_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$rna_pre_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna_post_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$rna_post_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_pre_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post2_pre_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post3_pre_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post3_pre_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2_post_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$rna2_post_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_snv_error_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$pre_snv_error_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_snv_error_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$post_snv_error_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_exp_snv_error_reads_pre <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$exp_snv_error_reads_pre
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_exp_snv_error_reads_post <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$exp_snv_error_reads_post
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_corr_pre <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$corr_pre
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_corr_post <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$corr_post
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_corr_pre_pseudo <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$corr_pre_pseudo
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_corr_post_pseudo <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$corr_post_pseudo
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_corr_pseudo_post_pre_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$corr_pseudo_post_pre_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_pre
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_lib <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_lib
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_rna
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post2 <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post2
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post3 <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post3
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna2 <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_rna2
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_pseudo_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_pre_pseudo_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_pseudo_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post_pseudo_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_pseudo_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_rna_pseudo_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post2_pseudo_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post2_pseudo_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post3_pseudo_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post3_pseudo_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna2_pseudo_freq <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_rna2_pseudo_freq
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_lib_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_pre_lib_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_pre_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post_pre_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_lib_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post_lib_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_pre_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_rna_pre_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_post_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_rna_post_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post2_pre_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post2_pre_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post3_pre_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_post3_pre_ratio
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna2_post_ratio <- VHLx3arLH2_prog_var_thresh5_df_rLH1_int_ord$tHDR_rna2_post_ratio

#compute new columns:  ratio means are calculated by averaging log2 values, and then exponentiating
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio_rLH1rLH2_mean <- 2^((log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio) + log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_lib_ratio))/2)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_mean <- 2^((log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio) + log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pre_ratio))/2)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio_rLH1rLH2_mean <- 2^((log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio) + log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_lib_ratio))/2)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post2_pre_ratio_rLH1rLH2_mean <- 2^((log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post2_pre_ratio) + log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_pre_ratio))/2)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post3_pre_ratio_rLH1rLH2_mean <- 2^((log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post3_pre_ratio) + log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post3_pre_ratio))/2)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rna2_post_ratio_rLH1rLH2_mean <- 2^((log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rna2_post_ratio) + log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2_post_ratio))/2)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio_rLH1rLH2_mean <- 2^((log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio) + log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_lib_ratio))/2)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_mean <- 2^((log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio) + log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_pre_ratio))/2)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio_rLH1rLH2_mean <- 2^((log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio) + log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_lib_ratio))/2)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio_rLH1rLH2_mean <- 2^((log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio) + log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_pre_ratio))/2)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio_rLH1rLH2_mean <- 2^((log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio) + log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_post_ratio))/2)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post2_pre_ratio_rLH1rLH2_mean <- 2^((log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post2_pre_ratio) + log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post2_pre_ratio))/2)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post3_pre_ratio_rLH1rLH2_mean <- 2^((log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post3_pre_ratio) + log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post3_pre_ratio))/2)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio_rLH1rLH2_mean <- 2^((log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio) + log2(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna2_post_ratio))/2)

#weighting by numerator:  <- ((a*a/(a+c))+(c*c/(a+c)))/b
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio_rLH1rLH2_pre_weighted <- ((VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq*VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq/(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq+VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq))+(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq*VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq/(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq+VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq)))/VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$lib_pseudo_freq
#rLH1 pre-freq weighting coefficient (rLH1_pre-freq / (rLH1 + rLH2 pre-freq's))
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_weight <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq/(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq+VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_weight <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq/(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq+VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq)
#this will be weighted by denominator:  (rLH1_pof/rLH1_prf)(rLH1_prwc)+(rLH2_pof/rLH2_prf)*(rLH2_prwc)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_pre_weighted <- (VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_pseudo_freq/VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_pseudo_freq)*(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_weight)+(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pseudo_freq/VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_pseudo_freq)*(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_weight)
#this will be weighted by denominator:  (rLH1_pof/lif')*(rLH1_prwc)+(rLH2_pof/lif)*(rLH2_prwc)
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio_rLH1rLH2_pre_weighted <- (VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_pseudo_freq/VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$lib_pseudo_freq)*(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_weight)+(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pseudo_freq/VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$lib_pseudo_freq)*(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_weight)
#rLH1 tHDR_pre-freq weighting coefficient (rLH1_tHDR_pre-freq / (rLH1 + rLH2 pre-freq's))
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_weight <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_pseudo_freq/(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_pseudo_freq+VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_pseudo_freq)
#rLH2 tHDR_pre-freq weighting coefficient
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_weight <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_pseudo_freq/(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_pseudo_freq+VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_pseudo_freq)
#this will be weighted by denominator:  (rLH1_pof/rLH1_prf)(rLH1_prwc)+(rLH2_pof/rLH2_prf)*(rLH2_prwc)
#tHDR_post_pre_ratio_rLH1rLH2_pre_weighted
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_pre_weighted <- (VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pseudo_freq/VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_pseudo_freq)*(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_weight)+(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_pseudo_freq/VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_pseudo_freq)*(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_weight)

#### This if statement determines whether or not to normalise to median of synonymous variants (if more than 10 in library), or to median of all points e.g. for non-coding sequences
if (length(grep("\\<SYNONYMOUS\\>",VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq)) >= 10) {
    VHLx3arLH1_cSNV_pre_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio)
VHLx3arLH1_cSNV_post_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio)
VHLx3arLH1_cSNV_post2_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio)
VHLx3arLH1_cSNV_post_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio)
VHLx3arLH1_tSNV_pre_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio)
VHLx3arLH1_tSNV_post_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio)
VHLx3arLH1_tSNV_post_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio)
VHLx3arLH1_tSNV_rna_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio)
VHLx3arLH1_tSNV_rna_post_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio)
VHLx3arLH1_tSNV_rna2_post_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio)
VHLx3arLH2_cSNV_pre_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_pre_lib_ratio)
VHLx3arLH2_cSNV_post_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_post_pre_ratio)
VHLx3arLH2_cSNV_post2_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_post2_pre_ratio)

VHLx3arLH2_cSNV_post_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_post_lib_ratio)
VHLx3arLH2_tSNV_pre_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_tHDR_pre_lib_ratio)
VHLx3arLH2_tSNV_post_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_tHDR_post_pre_ratio)
VHLx3arLH2_tSNV_post2_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_tHDR_post2_pre_ratio)
VHLx3arLH2_tSNV_post_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_tHDR_post_lib_ratio)
VHLx3arLH2_tSNV_rna_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_tHDR_rna_pre_ratio)
VHLx3arLH2_tSNV_rna_post_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_tHDR_rna_post_ratio)
VHLx3arLH2_tSNV_rna2_post_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$rLH2_tHDR_rna2_post_ratio)
VHLx3arLH1rLH2a_cSNV_pre_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$pre_lib_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_cSNV_post_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_cSNV_post2_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$post2_pre_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_cSNV_post_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$post_lib_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_tSNV_pre_lib_med <- 
  median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_pre_lib_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_tSNV_post_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_tSNV_post2_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post2_pre_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_tSNV_post_lib_med <-
  median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_lib_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_tSNV_rna_pre_med <-
  median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_pre_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_tSNV_rna_post_med <-
  median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna_post_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_tSNV_rna2_post_med <-
  median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_rna2_post_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2pw_tSNV_post_pre_med  <-
  median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$tHDR_post_pre_ratio_rLH1rLH2_pre_weighted)
VHLx3arLH1rLH2pw_cSNV_post_pre_med  <-
  median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$conseq == "SYNONYMOUS"),]$post_pre_ratio_rLH1rLH2_pre_weighted)
  } else {
  VHLx3arLH1_cSNV_pre_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio)
VHLx3arLH1_cSNV_post_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio)
VHLx3arLH1_cSNV_post2_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post2_pre_ratio)
VHLx3arLH1_cSNV_post_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio)
VHLx3arLH1_tSNV_pre_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio)
VHLx3arLH1_tSNV_post_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio)
VHLx3arLH1_tSNV_post_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio)
VHLx3arLH1_tSNV_rna_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio)
VHLx3arLH1_tSNV_rna_post_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio)
VHLx3arLH1_tSNV_rna2_post_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio)
VHLx3arLH2_cSNV_pre_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_lib_ratio)
VHLx3arLH2_cSNV_post_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pre_ratio)
VHLx3arLH2_cSNV_post2_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_pre_ratio)

VHLx3arLH2_cSNV_post_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_lib_ratio)
VHLx3arLH2_tSNV_pre_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_lib_ratio)
VHLx3arLH2_tSNV_post_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_pre_ratio)
VHLx3arLH2_tSNV_post2_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post2_pre_ratio)
VHLx3arLH2_tSNV_post_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_lib_ratio)
VHLx3arLH2_tSNV_rna_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_pre_ratio)
VHLx3arLH2_tSNV_rna_post_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_post_ratio)
VHLx3arLH2_tSNV_rna2_post_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna2_post_ratio)
VHLx3arLH1rLH2a_cSNV_pre_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_cSNV_post_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_cSNV_post2_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post2_pre_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_cSNV_post_lib_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_tSNV_pre_lib_med <- 
  median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_tSNV_post_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_tSNV_post2_pre_med <- median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post2_pre_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_tSNV_post_lib_med <-
  median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_tSNV_rna_pre_med <-
  median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_tSNV_rna_post_med <-
  median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2a_tSNV_rna2_post_med <-
  median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio_rLH1rLH2_mean)
VHLx3arLH1rLH2pw_tSNV_post_pre_med  <-
  median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_pre_weighted)
VHLx3arLH1rLH2pw_cSNV_post_pre_med  <-
  median(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_pre_weighted)
}

VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio/VHLx3arLH1_cSNV_pre_lib_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio/VHLx3arLH1_cSNV_post_pre_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio/VHLx3arLH1_cSNV_post_lib_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post2_pre_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post2_pre_ratio/VHLx3arLH1_cSNV_post2_pre_med

VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio/VHLx3arLH1_tSNV_pre_lib_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio/VHLx3arLH1_tSNV_post_pre_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio/VHLx3arLH1_tSNV_post_lib_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio/VHLx3arLH1_tSNV_rna_pre_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio/VHLx3arLH1_tSNV_rna_post_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post2_pre_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post2_pre_ratio/VHLx3arLH2_tSNV_post2_pre_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio/VHLx3arLH1_tSNV_rna2_post_med

VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_lib_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_pre_lib_ratio/VHLx3arLH2_cSNV_pre_lib_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pre_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_pre_ratio/VHLx3arLH2_cSNV_post_pre_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_lib_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post_lib_ratio/VHLx3arLH2_cSNV_post_lib_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_pre_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_post2_pre_ratio/VHLx3arLH1rLH2a_cSNV_post2_pre_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2_post_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_rna2_post_ratio/VHLx3arLH2_tSNV_rna2_post_med


VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_lib_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_pre_lib_ratio/VHLx3arLH2_tSNV_pre_lib_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_pre_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_pre_ratio/VHLx3arLH2_tSNV_post_pre_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post2_pre_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post2_pre_ratio/VHLx3arLH2_tSNV_post2_pre_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_lib_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_post_lib_ratio/VHLx3arLH2_tSNV_post_lib_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_pre_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_pre_ratio/VHLx3arLH2_tSNV_rna_pre_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_post_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna_post_ratio/VHLx3arLH2_tSNV_rna_post_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna2_post_ratio_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$rLH2_tHDR_rna2_post_ratio/VHLx3arLH2_tSNV_rna2_post_med

###normalize the means
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio_rLH1rLH2_mean_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$pre_lib_ratio_rLH1rLH2_mean/VHLx3arLH1rLH2a_cSNV_pre_lib_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_mean_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_mean/VHLx3arLH1rLH2a_cSNV_post_pre_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio_rLH1rLH2_mean_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_lib_ratio_rLH1rLH2_mean/VHLx3arLH1rLH2a_cSNV_post_lib_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio_rLH1rLH2_mean_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_pre_lib_ratio_rLH1rLH2_mean/VHLx3arLH1rLH2a_tSNV_pre_lib_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_mean_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_mean/VHLx3arLH1rLH2a_tSNV_post_pre_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post2_pre_ratio_rLH1rLH2_mean_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post2_pre_ratio_rLH1rLH2_mean/VHLx3arLH1rLH2a_tSNV_post2_pre_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio_rLH1rLH2_mean_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_lib_ratio_rLH1rLH2_mean/VHLx3arLH1rLH2a_tSNV_post_lib_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio_rLH1rLH2_mean_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_pre_ratio_rLH1rLH2_mean/VHLx3arLH1rLH2a_tSNV_rna_pre_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio_rLH1rLH2_mean_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna_post_ratio_rLH1rLH2_mean/VHLx3arLH1rLH2a_tSNV_rna_post_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio_rLH1rLH2_mean_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_rna2_post_ratio_rLH1rLH2_mean/VHLx3arLH1rLH2a_tSNV_rna2_post_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_pre_weighted_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$tHDR_post_pre_ratio_rLH1rLH2_pre_weighted/VHLx3arLH1rLH2pw_tSNV_post_pre_med
VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_pre_weighted_synnorm <- VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord$post_pre_ratio_rLH1rLH2_pre_weighted/VHLx3arLH1rLH2pw_cSNV_post_pre_med

#working intersection dictionary:  VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord
VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord = which(VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[,'pos']!='REF')
VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df = VHLx3arLH1_prog_var_thresh5_df_rLH2_int_ord[VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord,]
VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord = which(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df[,'cDNApos']!='REF' & VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df[,'cDNApos']!='NA')
VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df = VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df[VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord,]
VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord = which(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df[,'CADD.phred']!='NA')
VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df = VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df[VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord,]
VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense <- VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df[which(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$conseq=='NON_SYNONYMOUS'),]

###Replicate Plotting
#correlation between intersection of replicates, log-2 normalized:
VHLx3arLH1rLH2_cSNV_rLH1_post_pre_by_rLH2_post_pre_cor_s <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_pre_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_cSNV_rLH1_post_pre_by_rLH2_post_pre_cor_s
VHLx3arLH1rLH2_cSNV_rLH1_post_pre_by_rLH2_post_pre_cor_p <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_pre_ratio_synnorm),method='pearson')
VHLx3arLH1rLH2_cSNV_rLH1_post_pre_by_rLH2_post_pre_cor_p
VHLx3arLH1rLH2_cSNV_rLH1_post_lib_by_rLH2_post_lib_cor_s <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_lib_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_cSNV_rLH1_post_lib_by_rLH2_post_lib_cor_s
VHLx3arLH1rLH2_cSNV_rLH1_post_lib_by_rLH2_post_lib_cor_p <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_lib_ratio_synnorm),method='pearson')
VHLx3arLH1rLH2_cSNV_rLH1_post_lib_by_rLH2_post_lib_cor_p
VHLx3arLH1rLH2_cSNV_rLH1_post2_pre_by_rLH2_post2_pre_cor_s <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post2_pre_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_cSNV_rLH1_post2_pre_by_rLH2_post2_pre_cor_s
VHLx3arLH1rLH2_cSNV_rLH1_post2_pre_by_rLH2_post2_pre_cor_p <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$post2_pre_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post2_pre_ratio_synnorm),method='pearson')
VHLx3arLH1rLH2_cSNV_rLH1_post2_pre_by_rLH2_post2_pre_cor_p
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_post_pre_by_rLH2_tHDR_post_pre_cor_s <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_post_pre_by_rLH2_tHDR_post_pre_cor_s
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_post_pre_by_rLH2_tHDR_post_pre_cor_p <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_pre_ratio_synnorm),method='pearson')
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_post_pre_by_rLH2_tHDR_post_pre_cor_p
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_post_lib_by_rLH2_tHDR_post_lib_cor_s <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_post_lib_by_rLH2_tHDR_post_lib_cor_s
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_post_lib_by_rLH2_tHDR_post_lib_cor_p <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_lib_ratio_synnorm),method='pearson')
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_post_lib_by_rLH2_tHDR_post_lib_cor_p
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_rna_pre_by_rLH2_tHDR_rna_pre_cor_s <- cor(log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_rna_pre_by_rLH2_tHDR_rna_pre_cor_s
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_rna_pre_by_rLH2_tHDR_rna_pre_cor_p <- cor(log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna_pre_ratio_synnorm),method='pearson')
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_rna_pre_by_rLH2_tHDR_rna_pre_cor_p
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_rna2_post_by_rLH2_tHDR_rna2_post_cor_s <- cor(log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_rna2_post_by_rLH2_tHDR_rna2_post_cor_s
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_rna2_post_by_rLH2_tHDR_rna2_post_cor_p <- cor(log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna2_post_ratio_synnorm),method='pearson')
VHLx3arLH1rLH2_tSNV_rLH1_tHDR_rna2_post_by_rLH2_tHDR_rna2_post_cor_p
VHLx3arLH1rLH2_cSNV_rLH1_post_by_rLH2_post_cor_s <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_freq),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_freq),method='spearman')
VHLx3arLH1rLH2_cSNV_rLH1_post_by_rLH2_post_cor_s
VHLx3arLH1rLH2_cSNV_rLH1_post_by_rLH2_post_cor_p <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_pseudo_freq),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_pseudo_freq),method='pearson')
VHLx3arLH1rLH2_cSNV_rLH1_post_by_rLH2_post_cor_p
VHLx3arLH1rLH2_cSNV_rLH1_pre_lib_by_rLH2_pre_lib_cor_s <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_pre_lib_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_cSNV_rLH1_pre_lib_by_rLH2_pre_lib_cor_s
VHLx3arLH1rLH2_cSNV_rLH1_pre_lib_by_rLH2_pre_lib_cor_p <-cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$pre_lib_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_pre_lib_ratio_synnorm),method='pearson')
VHLx3arLH1rLH2_cSNV_rLH1_pre_lib_by_rLH2_pre_lib_cor_p
VHLx3arLH1rLH2_tSNV_rLH1_post2_pre_by_rLH2_post2_pre_cor_s <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post2_pre_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post2_pre_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_tSNV_rLH1_post2_pre_by_rLH2_post2_pre_cor_s
VHLx3arLH1rLH2_tSNV_rLH1_post_lib_by_rLH2_post_lib_cor_s <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_tSNV_rLH1_post_lib_by_rLH2_post_lib_cor_s
VHLx3arLH1rLH2_tSNV_rLH1_post_pre_by_rLH2_post_pre_cor_s <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_tSNV_rLH1_post_pre_by_rLH2_post_pre_cor_s
VHLx3arLH1rLH2_tSNV_rLH1_rna_pre_by_rLH2_rna_pre_cor_s <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_tSNV_rLH1_rna_pre_by_rLH2_rna_pre_cor_s
VHLx3arLH1rLH2_tSNV_rLH1_rna2_post_by_rLH2_rna2_post_cor_s <- cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_rna2_post_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna2_post_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_tSNV_rLH1_rna2_post_by_rLH2_rna2_post_cor_s

#COMPARISONS TO CADD
#COMPARISONS TO CADD
#single replicate comparisons
VHLx3arLH1_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_pre_ratio_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1_cSNV_post_pre_by_cadd_cor_s
VHLx3arLH2_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$rLH2_post_pre_ratio_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH2_cSNV_post_pre_by_cadd_cor_s
VHLx3arLH1_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_lib_ratio_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1_cSNV_post_lib_by_cadd_cor_s
VHLx3arLH2_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$rLH2_post_lib_ratio_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH2_cSNV_post_lib_by_cadd_cor_s
VHLx3arLH1_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1_tSNV_post_pre_by_cadd_cor_s
VHLx3arLH2_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_pre_ratio_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH2_tSNV_post_pre_by_cadd_cor_s
VHLx3arLH1_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1_tSNV_post_lib_by_cadd_cor_s
VHLx3arLH2_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_lib_ratio_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH2_tSNV_post_lib_by_cadd_cor_s

#calculate weighted average correlations with CADD for cSNV
VHLx3arLH1rLH2a_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$pre_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2a_cSNV_pre_lib_by_cadd_cor_s
VHLx3arLH1rLH2w_cSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$pre_lib_ratio_rLH1rLH2_pre_weighted),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2w_cSNV_pre_lib_by_cadd_cor_s
VHLx3arLH1rLH2a_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2a_cSNV_post_pre_by_cadd_cor_s
VHLx3arLH1rLH2w_cSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_pre_ratio_rLH1rLH2_pre_weighted_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2w_cSNV_post_pre_by_cadd_cor_s
VHLx3arLH1rLH2a_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2a_cSNV_post_lib_by_cadd_cor_s
VHLx3arLH1rLH2w_cSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_lib_ratio_rLH1rLH2_pre_weighted),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2w_cSNV_post_lib_by_cadd_cor_s
VHLx3arLH1rLH2a_tSNV_pre_lib_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_pre_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2a_tSNV_pre_lib_by_cadd_cor_s
VHLx3arLH1rLH2a_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2a_tSNV_post_pre_by_cadd_cor_s
VHLx3arLH1rLH2w_tSNV_post_pre_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_rLH1rLH2_pre_weighted_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2w_tSNV_post_pre_by_cadd_cor_s
VHLx3arLH1rLH2a_tSNV_post2_pre_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post2_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2a_tSNV_post2_pre_by_cadd_cor_s
VHLx3arLH1rLH2a_tSNV_post_lib_by_cadd_cor_s = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2a_tSNV_post_lib_by_cadd_cor_s

#final correlations to save as variables for heatmapping:
VHLx3arLH1_cSNV_pre_lib_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3arLH1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3arLH1_tSNV_pre_lib_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arLH1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arLH1_cSNV_post_lib_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3arLH1_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx3arLH1_tSNV_post_lib_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arLH1_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx3arLH1_cSNV_post_pre_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx3arLH1_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3arLH1_tSNV_post_pre_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx3arLH1_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arLH1_cSNV_rna_lib_cors = cor(log2(VHLx3arLH1_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx3arLH1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3arLH1_tSNV_rna_lib_cors = cor(log2(VHLx3arLH1_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arLH1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx3arLH1_cSNV_rna_pre_cors = cor(log2(VHLx3arLH1_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx3arLH1_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3arLH1_tSNV_rna_pre_cors = cor(log2(VHLx3arLH1_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx3arLH1_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arLH1rLH2_cSNV_pre_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$pre_freq),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_pre_freq),method='spearman')
VHLx3arLH1rLH2_tSNV_pre_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_pre_pseudo_freq),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_pre_pseudo_freq),method='spearman')
VHLx3arLH1rLH2_cSNV_pre_lib_ratio_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$pre_lib_ratio),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_pre_lib_ratio),method='spearman')
VHLx3arLH1rLH2_tSNV_pre_lib_ratio_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_pre_lib_ratio),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_pre_lib_ratio),method='spearman')
VHLx3arLH1rLH2_cSNV_post_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_freq),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_freq),method='spearman')
VHLx3arLH1rLH2_tSNV_post_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_pseudo_freq),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_pseudo_freq),method='spearman')
VHLx3arLH1rLH2_cSNV_post_lib_ratio_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_lib_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_lib_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_tSNV_post_lib_ratio_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_lib_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_lib_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_cSNV_post_pre_ratio_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$post_pre_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_post_pre_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_tSNV_post_pre_ratio_cors = cor(log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_synnorm),log2(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_pre_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_cSNV_rna_cors = cor(log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rna_freq),log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_rna_freq),method='spearman')
VHLx3arLH1rLH2_tSNV_rna_cors = cor(log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna_pseudo_freq),log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna_pseudo_freq),method='spearman')
VHLx3arLH1rLH2_tSNV_rna_pre_ratio_cors = cor(log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3arLH1_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLH1_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLH1_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLH1_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLH1_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLH1_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLH1_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arLH1_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arLH1_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arLH1_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arLH1_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$post_pre_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$Grantham)),method='spearman')
VHLx3arLH1_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$Grantham)),method='spearman')
VHLx3arLH1rLH2a_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$pre_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2a_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_pre_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2a_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2a_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_lib_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2a_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2a_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2a_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arLH1rLH2a_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$tHDR_post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arLH1rLH2a_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arLH1rLH2a_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$tHDR_post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arLH1rLH2a_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$Grantham)),method='spearman')
VHLx3arLH1rLH2a_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$tHDR_post_pre_ratio_rLH1rLH2_mean_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$Grantham)),method='spearman')
VHLx3arLH1rLH2w_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$pre_lib_ratio_rLH1rLH2_pre_weighted),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2w_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_lib_ratio_rLH1rLH2_pre_weighted),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2w_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$post_pre_ratio_rLH1rLH2_pre_weighted_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')
VHLx3arLH1rLH2w_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_rLH1rLH2_pre_weighted_synnorm),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df$CADD.phred)),method='spearman')

VHLx3arLH1_cors <- c("VHLx3arLH1",VHLx3arLH1_cSNV_pre_lib_cors,VHLx3arLH1_tSNV_pre_lib_cors,VHLx3arLH1_cSNV_post_lib_cors,VHLx3arLH1_tSNV_post_lib_cors,VHLx3arLH1_cSNV_post_pre_cors,VHLx3arLH1_tSNV_post_pre_cors,VHLx3arLH1_cSNV_rna_lib_cors,VHLx3arLH1_tSNV_rna_lib_cors,VHLx3arLH1_cSNV_rna_pre_cors,VHLx3arLH1_tSNV_rna_pre_cors,VHLx3arLH1rLH2_cSNV_pre_cors,VHLx3arLH1rLH2_tSNV_pre_cors,VHLx3arLH1rLH2_cSNV_pre_lib_ratio_cors,VHLx3arLH1rLH2_tSNV_pre_lib_ratio_cors,VHLx3arLH1rLH2_cSNV_post_cors,VHLx3arLH1rLH2_tSNV_post_cors,VHLx3arLH1rLH2_cSNV_post_lib_ratio_cors,VHLx3arLH1rLH2_tSNV_post_lib_ratio_cors,VHLx3arLH1rLH2_cSNV_post_pre_ratio_cors,VHLx3arLH1rLH2_tSNV_post_pre_ratio_cors,VHLx3arLH1rLH2_cSNV_rna_cors,VHLx3arLH1rLH2_tSNV_rna_cors,VHLx3arLH1rLH2_tSNV_rna_pre_ratio_cors,VHLx3arLH1_cSNV_pre_lib_ratio_cadd_cors,VHLx3arLH1_tSNV_pre_lib_ratio_cadd_cors,VHLx3arLH1_cSNV_post_lib_ratio_cadd_cors,VHLx3arLH1_tSNV_post_lib_ratio_cadd_cors,VHLx3arLH1_cSNV_post_pre_ratio_cadd_cors,VHLx3arLH1_tSNV_post_pre_ratio_cadd_cors,VHLx3arLH1_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLH1_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLH1_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLH1_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLH1_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLH1_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLH1rLH2a_cSNV_pre_lib_ratio_cadd_cors,VHLx3arLH1rLH2a_tSNV_pre_lib_ratio_cadd_cors,VHLx3arLH1rLH2a_cSNV_post_lib_ratio_cadd_cors,VHLx3arLH1rLH2a_tSNV_post_lib_ratio_cadd_cors,VHLx3arLH1rLH2a_cSNV_post_pre_ratio_cadd_cors,VHLx3arLH1rLH2a_tSNV_post_pre_ratio_cadd_cors,VHLx3arLH1rLH2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLH1rLH2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLH1rLH2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLH1rLH2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLH1rLH2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLH1rLH2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLH1rLH2w_cSNV_pre_lib_ratio_cadd_cors,VHLx3arLH1rLH2w_cSNV_post_lib_ratio_cadd_cors,VHLx3arLH1rLH2w_cSNV_post_pre_ratio_cadd_cors,VHLx3arLH1rLH2w_tSNV_post_pre_ratio_cadd_cors)

VHLx3arLH2_cSNV_pre_lib_cors = cor(log2(VHLx3arLH2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3arLH2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3arLH2_tSNV_pre_lib_cors = cor(log2(VHLx3arLH2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arLH2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arLH2_cSNV_post_lib_cors = cor(log2(VHLx3arLH2_prog_map_thresh5_df$lib_pseudo_freq),log2(VHLx3arLH2_prog_map_thresh5_df$post_pseudo_freq),method='spearman')
VHLx3arLH2_tSNV_post_lib_cors = cor(log2(VHLx3arLH2_prog_map_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arLH2_prog_map_thresh5_df$tHDR_post_pseudo_freq),method='spearman')
VHLx3arLH2_cSNV_post_pre_cors = cor(log2(VHLx3arLH2_prog_map_thresh5_df$post_pseudo_freq),log2(VHLx3arLH2_prog_map_thresh5_df$pre_pseudo_freq),method='spearman')
VHLx3arLH2_tSNV_post_pre_cors = cor(log2(VHLx3arLH2_prog_map_thresh5_df$tHDR_post_pseudo_freq),log2(VHLx3arLH2_prog_map_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arLH2_cSNV_rna_lib_cors = cor(log2(VHLx3arLH2_prog_map_exon_thresh5_df$lib_pseudo_freq),log2(VHLx3arLH2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3arLH2_tSNV_rna_lib_cors = cor(log2(VHLx3arLH2_prog_map_exon_thresh5_df$tHDR_lib_pseudo_freq),log2(VHLx3arLH2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),method='spearman')
VHLx3arLH2_cSNV_rna_pre_cors = cor(log2(VHLx3arLH2_prog_map_exon_thresh5_df$pre_pseudo_freq),log2(VHLx3arLH2_prog_map_exon_thresh5_df$rna_pseudo_freq),method='spearman')
VHLx3arLH2_tSNV_rna_pre_cors = cor(log2(VHLx3arLH2_prog_map_exon_thresh5_df$tHDR_rna_pseudo_freq),log2(VHLx3arLH2_prog_map_exon_thresh5_df$tHDR_pre_pseudo_freq),method='spearman')
VHLx3arLH2_cSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arLH2_prog_map_CADD_df$pre_lib_ratio),as.numeric(as.character(VHLx3arLH2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLH2_tSNV_pre_lib_ratio_cadd_cors = cor(log2(VHLx3arLH2_prog_map_CADD_df$tHDR_pre_lib_ratio),as.numeric(as.character(VHLx3arLH2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLH2_cSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arLH2_prog_map_CADD_df$post_lib_ratio),as.numeric(as.character(VHLx3arLH2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLH2_tSNV_post_lib_ratio_cadd_cors = cor(log2(VHLx3arLH2_prog_map_CADD_df$tHDR_post_lib_ratio),as.numeric(as.character(VHLx3arLH2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLH2_cSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLH2_prog_map_CADD_df$post_pre_ratio),as.numeric(as.character(VHLx3arLH2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLH2_tSNV_post_pre_ratio_cadd_cors = cor(log2(VHLx3arLH2_prog_map_CADD_df$tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLH2_prog_map_CADD_df$CADD.phred)),method='spearman')
VHLx3arLH2_cSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$rLH2_post_pre_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arLH2_tSNV_post_pre_ratio_cadd_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$rLH2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$CADD.phred)),method='spearman')
VHLx3arLH2_cSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$rLH2_post_pre_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arLH2_tSNV_post_pre_ratio_polyphen_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$rLH2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$polyphen.val)),method='spearman')
VHLx3arLH2_cSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$rLH2_post_pre_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$Grantham)),method='spearman')
VHLx3arLH2_tSNV_post_pre_ratio_grantham_missense_cors = cor(log2(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$rLH2_tHDR_post_pre_ratio),as.numeric(as.character(VHLx3arLH1_prog_map_CADD_thresh5_df_rLH2_int_ord_df_missense$Grantham)),method='spearman')

VHLx3arLH2_cors <- c("VHLx3arLH2",VHLx3arLH2_cSNV_pre_lib_cors,VHLx3arLH2_tSNV_pre_lib_cors,VHLx3arLH2_cSNV_post_lib_cors,VHLx3arLH2_tSNV_post_lib_cors,VHLx3arLH2_cSNV_post_pre_cors,VHLx3arLH2_tSNV_post_pre_cors,VHLx3arLH2_cSNV_rna_lib_cors,VHLx3arLH2_tSNV_rna_lib_cors,VHLx3arLH2_cSNV_rna_pre_cors,VHLx3arLH2_tSNV_rna_pre_cors,VHLx3arLH1rLH2_cSNV_pre_cors,VHLx3arLH1rLH2_tSNV_pre_cors,VHLx3arLH1rLH2_cSNV_pre_lib_ratio_cors,VHLx3arLH1rLH2_tSNV_pre_lib_ratio_cors,VHLx3arLH1rLH2_cSNV_post_cors,VHLx3arLH1rLH2_tSNV_post_cors,VHLx3arLH1rLH2_cSNV_post_lib_ratio_cors,VHLx3arLH1rLH2_tSNV_post_lib_ratio_cors,VHLx3arLH1rLH2_cSNV_post_pre_ratio_cors,VHLx3arLH1rLH2_tSNV_post_pre_ratio_cors,VHLx3arLH1rLH2_cSNV_rna_cors,VHLx3arLH1rLH2_tSNV_rna_cors,VHLx3arLH1rLH2_tSNV_rna_pre_ratio_cors,VHLx3arLH2_cSNV_pre_lib_ratio_cadd_cors,VHLx3arLH2_tSNV_pre_lib_ratio_cadd_cors,VHLx3arLH2_cSNV_post_lib_ratio_cadd_cors,VHLx3arLH2_tSNV_post_lib_ratio_cadd_cors,VHLx3arLH2_cSNV_post_pre_ratio_cadd_cors,VHLx3arLH2_tSNV_post_pre_ratio_cadd_cors,VHLx3arLH2_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLH2_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLH2_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLH2_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLH2_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLH2_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLH1rLH2a_cSNV_pre_lib_ratio_cadd_cors,VHLx3arLH1rLH2a_tSNV_pre_lib_ratio_cadd_cors,VHLx3arLH1rLH2a_cSNV_post_lib_ratio_cadd_cors,VHLx3arLH1rLH2a_tSNV_post_lib_ratio_cadd_cors,VHLx3arLH1rLH2a_cSNV_post_pre_ratio_cadd_cors,VHLx3arLH1rLH2a_tSNV_post_pre_ratio_cadd_cors,VHLx3arLH1rLH2a_cSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLH1rLH2a_tSNV_post_pre_ratio_cadd_missense_cors,VHLx3arLH1rLH2a_cSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLH1rLH2a_tSNV_post_pre_ratio_polyphen_missense_cors,VHLx3arLH1rLH2a_cSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLH1rLH2a_tSNV_post_pre_ratio_grantham_missense_cors,VHLx3arLH1rLH2w_cSNV_pre_lib_ratio_cadd_cors,VHLx3arLH1rLH2w_cSNV_post_lib_ratio_cadd_cors,VHLx3arLH1rLH2w_cSNV_post_pre_ratio_cadd_cors,VHLx3arLH1rLH2w_tSNV_post_pre_ratio_cadd_cors)

#clear the large data frame from memory
rm(VHLx3arLH1)
rm(VHLx3arLH2)
gc()

#Positional modeling included here
#requires exon-level snv dataframes generated above to be present
#Model averages replicates 1,2 after fitting a model for each independently
#For fitting the model, more lax criteria for inclusion were used due to fewer LOF variants needing to be excluded. (0.3 pre-lib and 0.7 post-pre).

#a function to extend the lowess fit to points missing on either end of the sequence (must be used on an ordered sequence vector, as supplied here. Will only fill in missing points on the ends)
library(gridExtra)
extend_fit <- function(fit_vector) {
  if (length(which(is.na(fit_vector))) == 0) {
    out_vector <- fit_vector
  }
  else {
    min_na <- min(which(is.na(fit_vector) == TRUE))
    min_point <- min(which(is.na(fit_vector) == FALSE))
    min_point_val <- fit_vector[min_point]
    max_point <- max(which(is.na(fit_vector) == FALSE))
    max_point_val <- fit_vector[max_point]
    max_na <- max(which(is.na(fit_vector) == TRUE))
    out_vector <- fit_vector
    if (min_na == 1) {
      out_vector[min_na:min_point] <- min_point_val
    }
    if (max_na == length(fit_vector)) {
      out_vector[(max_point+1):length(fit_vector)] <- max_point_val 
    }
  }
  return(out_vector)
}

#Note on modelling parameters for LOESS fit:  models the baseline on only variants that are 2.0 < and > 0.3 tHDR_pre_lib_ratio_synnorm, and tHDR_post_pre_ratio_synnorm > 0.7. Goal is to include variants neutral in the assay, and whose pre-lib ratios are not heavily biased, e.g., but something other than position.

#VHLx3arLH1
VHLx3a_posrange <- range(as.numeric(as.character(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$pos)))
VHLx3a_posseq <- seq(from=VHLx3a_posrange[1], to=VHLx3a_posrange[2])
VHLx3arLH1_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df, subset = which(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_synnorm > 0.7 & VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx3arLH1_tHDR_pre_lib_pred <- predict(VHLx3arLH1_tHDR_pre_lib_ratio.lo, newdata = VHLx3a_posseq, se=TRUE)
VHLx3arLH1_tHDR_pre_lib_pos_effects <- VHLx3arLH1_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx3arLH1_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx3arLH1_tHDR_pre_lib_pos_effects)
VHLx3arLH1_tHDR_pre_lib_pos_effects_ci <- VHLx3arLH1_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx3arLH1_tHDR_pre_lib_pred$df)
VHLx3arLH1_tHDR_pre_lib_pos_effects_ci_ymin = VHLx3arLH1_tHDR_pre_lib_pos_effects - VHLx3arLH1_tHDR_pre_lib_pos_effects_ci
VHLx3arLH1_tHDR_pre_lib_pos_effects_ci_ymax = VHLx3arLH1_tHDR_pre_lib_pos_effects + VHLx3arLH1_tHDR_pre_lib_pos_effects_ci
VHLx3arLH1_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx3a_posseq, VHLx3arLH1_tHDR_pre_lib_pos_effects, VHLx3arLH1_tHDR_pre_lib_pos_effects.x, VHLx3arLH1_tHDR_pre_lib_pos_effects_ci_ymin, VHLx3arLH1_tHDR_pre_lib_pos_effects_ci_ymax, VHLx3arLH1_tHDR_pre_lib_pred_se = VHLx3arLH1_tHDR_pre_lib_pred$se.fit)
#VHLx3arLH2
VHLx3arLH2_tHDR_pre_lib_ratio.lo <- loess(log2(rLH2_tHDR_pre_lib_ratio_synnorm) ~ as.numeric(as.character(pos)), VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df, subset = which(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_post_pre_ratio_synnorm > 0.7 & VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_pre_lib_ratio_synnorm > 0.3 & VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_pre_lib_ratio_synnorm < 2.0), model=TRUE,span=0.15)
VHLx3arLH2_tHDR_pre_lib_pred <- predict(VHLx3arLH2_tHDR_pre_lib_ratio.lo, newdata = VHLx3a_posseq, se=TRUE)
VHLx3arLH2_tHDR_pre_lib_pos_effects <- VHLx3arLH2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx3arLH2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx3arLH2_tHDR_pre_lib_pos_effects)
VHLx3arLH2_tHDR_pre_lib_pos_effects_ci <- VHLx3arLH2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx3arLH2_tHDR_pre_lib_pred$df)
VHLx3arLH2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx3arLH2_tHDR_pre_lib_pos_effects - VHLx3arLH2_tHDR_pre_lib_pos_effects_ci
VHLx3arLH2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx3arLH2_tHDR_pre_lib_pos_effects + VHLx3arLH2_tHDR_pre_lib_pos_effects_ci
VHLx3arLH2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx3a_posseq, VHLx3arLH2_tHDR_pre_lib_pos_effects, VHLx3arLH2_tHDR_pre_lib_pos_effects.x, VHLx3arLH2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx3arLH2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx3arLH2_tHDR_pre_lib_pred_se = VHLx3arLH2_tHDR_pre_lib_pred$se.fit)

#VHLx3arLH1rLH2
VHLx3arLH1rLH2_tHDR_pre_lib_ratio.lo <- loess(log2(tHDR_pre_lib_ratio_rLH1rLH2_mean_synnorm) ~ as.numeric(as.character(pos)), VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df, subset = which(VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_post_pre_ratio_rLH1rLH2_mean_synnorm > 0.7 & VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_pre_lib_ratio_rLH1rLH2_mean_synnorm > 0.3 & VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df$tHDR_pre_lib_ratio_rLH1rLH2_mean_synnorm < 2.0), model=TRUE,span=0.15)
VHLx3arLH1rLH2_tHDR_pre_lib_pred <- predict(VHLx3arLH1rLH2_tHDR_pre_lib_ratio.lo, newdata = VHLx3a_posseq, se=TRUE)
VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects <- VHLx3arLH1rLH2_tHDR_pre_lib_pred$fit
#.x represents the extended pos_effects.
VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects.x <- extend_fit(VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects)
VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects_ci <- VHLx3arLH1rLH2_tHDR_pre_lib_pred$se.fit * qt(0.95 / 2 + .5, VHLx3arLH1rLH2_tHDR_pre_lib_pred$df)
VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects_ci_ymin = VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects - VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects_ci
VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects_ci_ymax = VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects + VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects_ci
VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects.df <- data.frame(pos = VHLx3a_posseq, VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects, VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects.x, VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects_ci_ymin, VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects_ci_ymax, VHLx3arLH1rLH2_tHDR_pre_lib_pred_se = VHLx3arLH1rLH2_tHDR_pre_lib_pred$se.fit)

#merge into a single df (merge original df, and pos effects (extended) df's from all 3 fits -- rLH1, rLH2, rLH1rLH2)
VHLx3arLH_tHDR_pos_merge_df <- VHLx3arLH1_prog_map_thresh5_df_rLH2_int_ord_df 
VHLx3arLH_tHDR_pos_merge_df <- merge(VHLx3arLH_tHDR_pos_merge_df, VHLx3arLH1_tHDR_pre_lib_pos_effects.df[, c("pos", "VHLx3arLH1_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx3arLH_tHDR_pos_merge_df <- merge(VHLx3arLH_tHDR_pos_merge_df, VHLx3arLH2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx3arLH2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)
VHLx3arLH_tHDR_pos_merge_df <- merge(VHLx3arLH_tHDR_pos_merge_df, VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects.df[, c("pos","VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects.x")], by="pos",all.x=TRUE)

VHLx3arLH_tHDR_pos_merge_df <- VHLx3arLH_tHDR_pos_merge_df %>% 
  rename(
    rLH1_tHDR_pre_lib_pos_effects.x = VHLx3arLH1_tHDR_pre_lib_pos_effects.x,
    rLH2_tHDR_pre_lib_pos_effects.x = VHLx3arLH2_tHDR_pre_lib_pos_effects.x,
    rLH1rLH2_tHDR_pre_lib_pos_effects.x = VHLx3arLH1rLH2_tHDR_pre_lib_pos_effects.x
    )

#Calculate adjusted ratios and put into df (along with affect sizes)
#5 adjustments for each post-lib and pre-lib measurement (e.g. rLH1 vs. rLH1_fit and vs. mean_fit)
VHLx3arLH_tHDR_pos_merge_df$rLH1_tHDR_post_lib_loess_rLH1 <- log2(VHLx3arLH_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx3arLH_tHDR_pos_merge_df$rLH1_tHDR_pre_lib_pos_effects.x
VHLx3arLH_tHDR_pos_merge_df$rLH1_tHDR_post_lib_loess_rLH1rLH2 <- log2(VHLx3arLH_tHDR_pos_merge_df$tHDR_post_lib_ratio_synnorm) - VHLx3arLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_pre_lib_pos_effects.x
VHLx3arLH_tHDR_pos_merge_df$rLH2_tHDR_post_lib_loess_rLH2 <- log2(VHLx3arLH_tHDR_pos_merge_df$rLH2_tHDR_post_lib_ratio_synnorm) - VHLx3arLH_tHDR_pos_merge_df$rLH2_tHDR_pre_lib_pos_effects.x
VHLx3arLH_tHDR_pos_merge_df$rLH2_tHDR_post_lib_loess_rLH1rLH2 <- log2(VHLx3arLH_tHDR_pos_merge_df$rLH2_tHDR_post_lib_ratio_synnorm) - VHLx3arLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_pre_lib_pos_effects.x
VHLx3arLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_post_lib_loess_rLH1rLH2 <- log2(VHLx3arLH_tHDR_pos_merge_df$tHDR_post_lib_ratio_rLH1rLH2_mean_synnorm) - VHLx3arLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_pre_lib_pos_effects.x

###same for pre-lib
VHLx3arLH_tHDR_pos_merge_df$rLH1_tHDR_pre_lib_loess_rLH1 <- log2(VHLx3arLH_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx3arLH_tHDR_pos_merge_df$rLH1_tHDR_pre_lib_pos_effects.x
VHLx3arLH_tHDR_pos_merge_df$rLH1_tHDR_pre_lib_loess_rLH1rLH2 <- log2(VHLx3arLH_tHDR_pos_merge_df$tHDR_pre_lib_ratio_synnorm) - VHLx3arLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_pre_lib_pos_effects.x
VHLx3arLH_tHDR_pos_merge_df$rLH2_tHDR_pre_lib_loess_rLH2 <- log2(VHLx3arLH_tHDR_pos_merge_df$rLH2_tHDR_pre_lib_ratio_synnorm) - VHLx3arLH_tHDR_pos_merge_df$rLH2_tHDR_pre_lib_pos_effects.x
VHLx3arLH_tHDR_pos_merge_df$rLH2_tHDR_pre_lib_loess_rLH1rLH2 <- log2(VHLx3arLH_tHDR_pos_merge_df$rLH2_tHDR_pre_lib_ratio_synnorm) - VHLx3arLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_pre_lib_pos_effects.x
VHLx3arLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_pre_lib_loess_rLH1rLH2 <- log2(VHLx3arLH_tHDR_pos_merge_df$tHDR_pre_lib_ratio_rLH1rLH2_mean_synnorm) - VHLx3arLH_tHDR_pos_merge_df$rLH1rLH2_tHDR_pre_lib_pos_effects.x

#Synonymous to nonsense spread will vary experiment to experiment, sometimes due to biological reasons (e.g. less deleterious nonsense variants) and sometimes due to technical reasons (e.g. variability of guide activity, fraction of WT reads, etc.). Therefore, experiment-to-experiment variability can optionally be normalised.

#For some genes, may want to include a within-replicate synonymous to nonsense normalization (e.sns), using general formula:  b/(a-c)*(A-C) where b is snv score, a is the replicate's med syn, c is replicate's med nonsense, A is med syn between replicates, C is med nonsense btwn replicates. For genes with highly variable nonsense effects across exons, should not normalise the lower end of the score, instead just normalising to synonymous as here:

#defines a for rLH1 and rLH2 separately (this is on a log-2 scale) -- will normalise to synonymous if >10 synonymous variants to normalise to, otherwise will normalise to median of all

if (length(grep("\\<SYNONYMOUS\\>",VHLx3arLH_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx3arLH_tHDR_post_lib_loess_median_syn_rLH1 <- median(VHLx3arLH_tHDR_pos_merge_df[which(VHLx3arLH_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLH1_tHDR_post_lib_loess_rLH1')])
  VHLx3arLH_tHDR_post_lib_loess_median_syn_rLH2 <- median(VHLx3arLH_tHDR_pos_merge_df[which(VHLx3arLH_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('rLH2_tHDR_post_lib_loess_rLH2')])
  } else {
  VHLx3arLH_tHDR_post_lib_loess_median_syn_rLH1 <- median(VHLx3arLH_tHDR_pos_merge_df[which(VHLx3arLH_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLH1_tHDR_post_lib_loess_rLH1')])
  VHLx3arLH_tHDR_post_lib_loess_median_syn_rLH2 <- median(VHLx3arLH_tHDR_pos_merge_df[which(VHLx3arLH_tHDR_pos_merge_df$conseq != 'could be anything'),c('rLH2_tHDR_post_lib_loess_rLH2')])
}
#simply subtracting median synonymous post-lib score for each experiment to scale median to 0.
#calculate new b values for rLH1 'e.sns' = exon syn/ns norm.
VHLx3arLH_tHDR_pos_merge_df$rLH1_tHDR_post_lib_loess_rLH1_e.sns <- (VHLx3arLH_tHDR_pos_merge_df$rLH1_tHDR_post_lib_loess_rLH1-VHLx3arLH_tHDR_post_lib_loess_median_syn_rLH1)
#calculate new b values for rLH2 'e.sns' = exon syn/ns norm.
VHLx3arLH_tHDR_pos_merge_df$rLH2_tHDR_post_lib_loess_rLH2_e.sns <- (VHLx3arLH_tHDR_pos_merge_df$rLH2_tHDR_post_lib_loess_rLH2-VHLx3arLH_tHDR_post_lib_loess_median_syn_rLH2)

#calculate a new post_lib mean across replicates based on individually fit, exon-normalized data
VHLx3arLH_tHDR_pos_merge_df$rLH_tHDR_post_lib_loess_e.sns_rLH1rLH2_mean <- (VHLx3arLH_tHDR_pos_merge_df$rLH1_tHDR_post_lib_loess_rLH1_e.sns+VHLx3arLH_tHDR_pos_merge_df$rLH2_tHDR_post_lib_loess_rLH2_e.sns)/2

#Currently, below median calculation for mean scores is not used, but could be useful for normalising between SGE regions down the road.
if (length(grep("\\<SYNONYMOUS\\>",VHLx3arLH_tHDR_pos_merge_df$conseq)) >= 10) {
  VHLx3arLH_tHDR_post_lib_loess_e.sns_rLH1rLH2_syn_median <- median(VHLx3arLH_tHDR_pos_merge_df[which(VHLx3arLH_tHDR_pos_merge_df$conseq == 'SYNONYMOUS'),c('VHLx3arLH_tHDR_post_lib_loess_e.sns_rLH1rLH2_mean')])
  } else {
  VHLx3arLH_tHDR_post_lib_loess_e.sns_rLH1rLH2_syn_median <- median(VHLx3arLH_tHDR_pos_merge_df[which(VHLx3arLH_tHDR_pos_merge_df$conseq != 'not_a_conseq'),c('VHLx3arLH_tHDR_post_lib_loess_e.sns_rLH1rLH2_mean')])
}

#RNA analysis
VHLx3arLH1rLH2_tSNV_rLH1_rna_pre_by_rLH2_rna_pre_cor_s <- cor(log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna_pre_ratio_synnorm),log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna_pre_ratio_synnorm),method='spearman')
VHLx3arLH1rLH2_tSNV_rLH1_rna_pre_by_rLH2_rna_pre_cor_s

#Compute RNA enrichment fold change over the course of the experiment:
VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH1_tHDR_rna2_rna_ratio <- VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna2_pseudo_freq/VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$tHDR_rna_pseudo_freq
VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna2_rna_ratio <- VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna2_pseudo_freq/VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna_pseudo_freq
VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH1rLH2_log2mean_tHDR_rna2_rna_ratio <- (log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH1_tHDR_rna2_rna_ratio)+log2(VHLx3arLH1_prog_map_exon_thresh5_df_rLH2_int_ord_df$rLH2_tHDR_rna2_rna_ratio))/2

```
